{"data":{"site":{"siteMetadata":{"title":"Takumon Blog","author":"Takuto Inoue"}},"markdownRemark":{"html":"<p><img src=\"/thumbnail/2018/vim-beginners.png\"></p>\n<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>最近DockerまわりをやっていてLinux上でDockerfileなどを編集するのがつらいので、ちゃんとVimを覚えようと思い立ち、\nとっかかりとして下記４点取り組みました。整理もかねて本記事にまとめます。</p>\n<ol>\n<li>vimtutor実施</li>\n<li><a href=\"https://vim-jp.org/vimdoc-ja/\">Vim日本語ドキュメント</a>読む</li>\n<li>Qiitaの主要記事を読む</li>\n<li>Chromeに<a href=\"https://chrome.google.com/webstore/detail/vimium/dbepggeogbaibhgnhhndojpepiihcmeb/related\">Vimium</a>導入</li>\n</ol>\n<h2 id=\"1-vimtutor実施\"><a href=\"#1-vimtutor%E5%AE%9F%E6%96%BD\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. vimtutor実施</h2>\n<p>Vimをインストールすると<code class=\"language-text\">:vimtutor</code>で開くチュートリアルです。\n実際に手を動かしながら説明を上から下に読み進めると、最低限の操作を覚えられます。\nVimを始めたらまずコレをやるのがVimを理解する一番の近道だと思います。<br />\n1回チュートリアルを実践してみたら、後述する<a href=\"#2-vim%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E8%AA%AD%E3%82%80\">Vim日本語ドキュメント</a>や<a href=\"#4-chrome%E3%81%ABvimium%E5%B0%8E%E5%85%A5\">Vimium</a>を一通り使ってから再度挑戦すると良いです。\n私も初回はおぼつかなかったですが、再度試した時はだいぶ直感通りに操作することができVimが少しできるようになったことを実感しました。</p>\n<h3 id=\"要約\"><a href=\"#%E8%A6%81%E7%B4%84\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>要約</h3>\n<p>章末に要約があってとても分かりやすいです。各章だいたいこんな感じでした。</p>\n<ul>\n<li>【1章】上下左右の移動、保存して終了、破棄して終了、削除、ノーマルモードと挿入モードの切り替え</li>\n<li>【2章】行先頭、末尾への移動、単語ごとの移動、モーションと組み合わせた削除、アンドゥ、リドゥ</li>\n<li>【3章】ペースト、置換、変更 </li>\n<li>【4章】ファイル先頭、末尾への移動、括弧間の移動、検索・置換</li>\n<li>【5章】外部コマンド実行、外部ファイル読み込み、ビジュアルモード</li>\n<li>【6章】行挿入、コピペ、置換モード、検索時のオプション</li>\n<li>【7章】ヘルプの使い方、vimrc設定方法</li>\n</ul>\n<h2 id=\"2-vim日本語ドキュメント読む\"><a href=\"#2-vim%E6%97%A5%E6%9C%AC%E8%AA%9E%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E8%AA%AD%E3%82%80\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Vim日本語ドキュメント読む</h2>\n<p><a href=\"https://vim-jp.org/vimdoc-ja/\">Vim日本語ドキュメント</a><br /></p>\n<p>vimtutorで概要を掴み、実践的な操作を学習するためのサイトです。\n初級者編が12章分、上級者編が13章分、その他もろもろ章があって充実しています。\n自分は初心者編12章を読みました。時間があるときに上級者のほうも読みたいです。</p>\n<h2 id=\"3-qiitaの主要記事を読む\"><a href=\"#3-qiita%E3%81%AE%E4%B8%BB%E8%A6%81%E8%A8%98%E4%BA%8B%E3%82%92%E8%AA%AD%E3%82%80\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Qiitaの主要記事を読む</h2>\n<p>ささーっと下記記事を読みました。記事を見てるとフォローしている人の中に、大抵の記事にイイねしている人が何人かいて「この人はVim派なんだな～」というのが見えてちょっと面白かったです。</p>\n<ul>\n<li>\n<p><a href=\"https://qiita.com/nyantera/items/4bf29ca6f11bc797a9cb\">新人達を1ヶ月でガチvimmerにした方法</a></p>\n<ul>\n<li>行末移動は編集する場合がほとんどだから<code class=\"language-text\">g $</code>よりも<code class=\"language-text\">A</code>を使ったほうが断然楽というのが目から鱗でした。</li>\n</ul>\n</li>\n<li><a href=\"https://qiita.com/hachi8833/items/7beeee825c11f7437f54\">Vim幼稚園からVim小学校へ</a></li>\n<li>\n<p><a href=\"https://qiita.com/tekkoc/items/98adcadfa4bdc8b5a6ca\">Vimの便利な画面分割＆タブページと、それを更に便利にする方法</a></p>\n<ul>\n<li>こんなリッチな機能があることにびっくりしました。VSCodeさながらです。</li>\n</ul>\n</li>\n<li>\n<p><a href=\"https://qiita.com/takeharu/items/9d1c3577f8868f7b07b5\">【入門】Vimで高速で移動 プラグインなしでの移動まとめ</a></p>\n<ul>\n<li><code class=\"language-text\">{</code>と<code class=\"language-text\">}</code>で段落ごとの移動、<code class=\"language-text\">zz</code>カーソルの位置をウィンドウの中心に移動、<code class=\"language-text\">z Enter</code>カーソルの位置をウィンドウの最上部に移動という便利コマンドが勉強になりました。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"4-chromeにvimium導入\"><a href=\"#4-chrome%E3%81%ABvimium%E5%B0%8E%E5%85%A5\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. ChromeにVimium導入</h2>\n<p><a href=\"https://chrome.google.com/webstore/detail/vimium/dbepggeogbaibhgnhhndojpepiihcmeb/related\">Vimium | Chrome Web Store</a><br /></p>\n<p>後輩に「Vim始めた」と言ったら、めちゃめちゃ勧められたのがこのChromeエクステンションです。ブラウザ操作をVim化できるという優れものです。\nネットサーフィンで日頃からVim操作に慣れておけば、いざLinuxでファイル編集する時も手が動くようにするためでもあります。\n早速2～3日ってみたところ、ネットサーフィンでほとんどマウスを触らなくなりました。\nスクロール、タブ移動、履歴移動などの操作一通りを、ホームポジションから手を動かすことなく実現できます。</p>\n<h3 id=\"リンククリック\"><a href=\"#%E3%83%AA%E3%83%B3%E3%82%AF%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>リンククリック</h3>\n<p>めっちゃ便利です。\n<code class=\"language-text\">f</code>を押すと下記のように全リンクにショートカットキーが割り当てられ\nキー入力でリンククリックができます。\n<code class=\"language-text\">f</code>で自タブ遷移、<code class=\"language-text\">F</code>で新規タブ遷移です。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7ecd36efa5156707d4a52f3c00bb05f6/4f59c/vimium-link.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 64.74820143884892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACM0lEQVQ4y3VT7W7TMBTNC22j3aTxKNtAvBXwBmPlDXgIBBI/pgm1I2nTJnHsfDgfjh37cJO00Gpg6ejY1/HJvb7H3scP77F4eMCn+3t8Xixwd3uD87MzXM7nmM9mR3i1xxxXl1dTbD7DxcU5rq9f483dLd69vYGXlwWKXKCpa0iZI8tLQvGCRZZDEKcpQxwF4JlAXkx762CFx+Ua3x/X8OLNVxRpDN02kCWH7TvAmQmwcFbT3BEPa0DVHFXJcDycFvixEvjyrYFXVdOmsQAr7SjaVCm6NofuKqhGwBgF1RbQuoPMQxjdwlpHsBPcJGxUBU/Tx8OwtkdZCtSNQdv26ChRrR2xG9e9PcmJkj5gKGDarKoaXu/cXtAgCX9ivdkg2MbYRDtEjBEnCHYJYsEhKrpjST+VU1Vuf/bAxhgStPZPsFOK0FKpHdQ4V2OZfW+I9RgfWZsTscO873t4Zi9o6fJZtETKSySpxC4uwEVFWdKaS9QkrnoNRffqbPfPDE8Eh2CWRojjEIzKSzgDI3CylCjIImQpUQ7WScliEpOG+3+GjpoiqSlSairV0CFDPDVFtZauwO5F8CK7F4JDYGhKuPPhhxGCYEnm3ZKJqWxOjcgkhChRFJI6WaFpmqMu/8UoeGwGowfLtAQ1NqWlg03dUFyP5Q0HBt85e+Khk+ExIagRAgmLsFo+IVgzsk6E5+ctfJ9hu+MItynCMKV5iijmKOi5/vJ9LFcr+EFAzzKjJ5iPz/M3tVbIMiP3i+gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"リンク\"\n        title=\"\"\n        src=\"/static/7ecd36efa5156707d4a52f3c00bb05f6/fb8a0/vimium-link.png\"\n        srcset=\"/static/7ecd36efa5156707d4a52f3c00bb05f6/1a291/vimium-link.png 148w,\n/static/7ecd36efa5156707d4a52f3c00bb05f6/2bc4a/vimium-link.png 295w,\n/static/7ecd36efa5156707d4a52f3c00bb05f6/fb8a0/vimium-link.png 590w,\n/static/7ecd36efa5156707d4a52f3c00bb05f6/526de/vimium-link.png 885w,\n/static/7ecd36efa5156707d4a52f3c00bb05f6/4f59c/vimium-link.png 1112w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h3 id=\"スクロール\"><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スクロール</h3>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17912e3caceb6eb54aba1b9fc78c52cd/fdfa6/vimium-scroll.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 82.5543120473996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABcRAAAXEQHKJvM/AAAEHElEQVQ4y21UW29UVRSeN9R63nxATIymLwhqGO2gKSQ1SsqTfwHSOpqYmJCApCSmwSpi0pHaaKydmrYCll5GSaElFGYIZW7pBSm9zAU617Pn3Kada5sYeuacz7VPbdDEhy9r7+y1v7PWt759bHa7/dnGxkbB4Tj4vMPhECw0NAgNDW8L9gMHBDoXmpqahKPNRwS747Dw4fF2AYDw7dkTwon+0nO77cdOvbTnxb/q6+tRV1fXbhseHnb7/f5SMBjMENgOQuEwm56eZkNDQ8ztdrPen3tYT28/O3aql33w/nvszJk2sa//ovT51wPmJx9/ZLS0tKKjo6NgW1hYuLq5uQmRMSiKAlVV/wNRFJFMppBOp5ARZXT0+PDuOwdx6dJlyLKMRDJpSsp2biaTMW0rKytjhWIJybS4lRWZwRgzKNGKWVE08vm8Ua1uGJqmGqlMzhiciBuqIhuKohpEYiiyYuZyOZOTM5bb4oSecrmCbDarr62to1KpQpJkUBL43uv1weVyUZUJZJmCwclH0FSFzqVtSFYkQoU4RN0WiUQ8lXKZDnL6+Pg4urq6eOlIplLQ8nl8d+ECXn/jTdy/P09dMAxORKFpCjgBl+gfmLxlSZJ0WzQa9VQqFUhaTj/ZdhL79+239JQpUVNlLEbT+MMbQZ7WnHDo5iOoisQv/xsmJyaZdKtl0gNyLq0/WE5g6MZDlNYlpNIZaEoOD6Mifr+TwFpeBmmIsduP/5dwW0MiHB+/5nE0vIUvzv2oh5dUhB+kqKIlHDp0GOe/OQdRLuDe3CpVKyEST6FvbN7qgDEJjDTkRISnLYdCYU939/e4NnlLn1tR4J1l+HNpFadPt2F05AoiqxImp2NQZYbVZBYjUzFIOUZ2YpalOGi6Jh8krXVbPB73kPNRLq7pdwOzGBy5hXUtB26lSrmAlccyvPMKigWNfChh5PYq8ppqabwzlJ0KyRnbU15fX0exVNJbW1vw6isvg/yIRCJpDeWmN4Dz3ZeQEzNIpERcvBGn1p5Wx+3Ffci1FLmGnHBjY4N/SZ+bn4fPd8cSmnyJEtnpq44vafJ7EYtGrZcycD0GJmatcxqCRciHYlXINSTCMf70uLFVVTOpWpO+bIH7KxaLmTOzs6ZMl8g25sBE3NzcqFp5nIibmoh55LoSYTQyWq1WubBPyOk1erc1HmlvgSxVy+fXanShRoQ199Xl2tjoSM3vD9SogBq9GqNYLBn0wqhK7YlteXn5uq7XLOdrWt6KO2tKsCIRgussqQX8MLqIfa/tRXt7O7Z0E4GZRfT1udHZ6YLX54NtamrqyMzMzKeBQLA1GAw56dflDAQCTqqA4Hf6aR0KhZzhcMh5917Q+dNlr9PV2em88tuvraEF8bOjx10Te3a/EN+165l8c3PzL38D1ZNEhh/sZzkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"スクロール\"\n        title=\"\"\n        src=\"/static/17912e3caceb6eb54aba1b9fc78c52cd/fb8a0/vimium-scroll.png\"\n        srcset=\"/static/17912e3caceb6eb54aba1b9fc78c52cd/1a291/vimium-scroll.png 148w,\n/static/17912e3caceb6eb54aba1b9fc78c52cd/2bc4a/vimium-scroll.png 295w,\n/static/17912e3caceb6eb54aba1b9fc78c52cd/fb8a0/vimium-scroll.png 590w,\n/static/17912e3caceb6eb54aba1b9fc78c52cd/526de/vimium-scroll.png 885w,\n/static/17912e3caceb6eb54aba1b9fc78c52cd/fa2eb/vimium-scroll.png 1180w,\n/static/17912e3caceb6eb54aba1b9fc78c52cd/fdfa6/vimium-scroll.png 1519w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li><code class=\"language-text\">k</code>、<code class=\"language-text\">j</code>、<code class=\"language-text\">h</code>、<code class=\"language-text\">l</code>で上下左右にスクロール</li>\n<li><code class=\"language-text\">2k</code>、<code class=\"language-text\">2j</code> など数字指定で大きくスクロール可能</li>\n<li><code class=\"language-text\">u</code>、<code class=\"language-text\">d</code>で画面半分スクロール</li>\n<li><code class=\"language-text\">gg</code>で最上部へスクロール</li>\n<li><code class=\"language-text\">G</code>で最下部へスクロール</li>\n</ul>\n<h3 id=\"タブ移動\"><a href=\"#%E3%82%BF%E3%83%96%E7%A7%BB%E5%8B%95\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>タブ移動</h3>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/854bd8d2fd398f943113898fb4829fe2/412c4/vimium-tab.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 36.51238896680692%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABcRAAAXEQHKJvM/AAAB40lEQVQoz12OzWsTQRyG9z/yaMUaEmwSCQFvJhehgk1Jc4hp0npTBClYiKggeBBEPOnF3oQmsR9pPprSYLQh6ZrWtrtpts3nrpvdzaYzr7NbenHg4eF9Z+Y3w9Xr9S/9fv+k2+3ua5rGWxiGYXs4HNrWdZ03zRHrdd7QNds662VZ4RVZts+xOweCIOS4ZDJZ8vl8CAYDaAgy6qKJ6pGKw9YIvb8UA5Xg6MxE7VjFvjhiGPjdIqjUThAM3IPf70e1WoW12u32OcfCVqvVwp/DxpiMx+RYOCUup5N8/pomUm9Mzjoa+Z7bIw6Hk2zvlAkFiKqbRJEH5NfPCqlUfpChyl69HChykiTlrfBuhb8IL+cRfZmHe+Y97j9NIbM0h9SzB5h+noU39AGhpTXEXpcQe1XA7IsCUjuS/TNNH1PL3U6nyYliM2eF8PLWxbXpb3QynKau6Ca9FclQ/8wn6nv4kU7OZezuJtubmF2lNxjXQ6vU8yhNA0+y9O7jDNk76EFTByLXbJ4WrYELb8twRAu4s7gNd6IAT6KI24u7jDI8C8XLjtnLuPJUvADXfBET4XVUGjIMTZY4QRDTbJ4Zf1MaTEbWFE98U5mKbdi4Y+s2V/l/3PMbijeRVRyRtLxbO1c1tc//AxDir4qEXYyJAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"タブ\"\n        title=\"\"\n        src=\"/static/854bd8d2fd398f943113898fb4829fe2/fb8a0/vimium-tab.png\"\n        srcset=\"/static/854bd8d2fd398f943113898fb4829fe2/1a291/vimium-tab.png 148w,\n/static/854bd8d2fd398f943113898fb4829fe2/2bc4a/vimium-tab.png 295w,\n/static/854bd8d2fd398f943113898fb4829fe2/fb8a0/vimium-tab.png 590w,\n/static/854bd8d2fd398f943113898fb4829fe2/526de/vimium-tab.png 885w,\n/static/854bd8d2fd398f943113898fb4829fe2/fa2eb/vimium-tab.png 1180w,\n/static/854bd8d2fd398f943113898fb4829fe2/08f6a/vimium-tab.png 1770w,\n/static/854bd8d2fd398f943113898fb4829fe2/412c4/vimium-tab.png 2139w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li><code class=\"language-text\">J</code>で左隣に移動</li>\n<li><code class=\"language-text\">K</code>で右隣に移動</li>\n<li><code class=\"language-text\">g 0</code>で最左に移動</li>\n<li><code class=\"language-text\">g $</code>で最右に移動</li>\n</ul>\n<h3 id=\"タブ操作\"><a href=\"#%E3%82%BF%E3%83%96%E6%93%8D%E4%BD%9C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>タブ操作</h3>\n<ul>\n<li><code class=\"language-text\">t</code>で新規タブ開く</li>\n<li><code class=\"language-text\">x</code>で現在のタブを閉じる</li>\n</ul>\n<h3 id=\"更新・戻る・進む\"><a href=\"#%E6%9B%B4%E6%96%B0%E3%83%BB%E6%88%BB%E3%82%8B%E3%83%BB%E9%80%B2%E3%82%80\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>更新・戻る・進む</h3>\n<ul>\n<li><code class=\"language-text\">r</code>で更新</li>\n<li><code class=\"language-text\">H</code>で戻る</li>\n<li><code class=\"language-text\">L</code>で戻る</li>\n</ul>\n<h3 id=\"注意点\"><a href=\"#%E6%B3%A8%E6%84%8F%E7%82%B9\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>注意点</h3>\n<p>たまに入力項目にフォーカスが当たっている場合などは、操作が効かなくなるので、その時はブラウザのデフォルトショートカットを使うことをお勧めします。</p>\n<h2 id=\"その他\"><a href=\"#%E3%81%9D%E3%81%AE%E4%BB%96\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>その他</h2>\n<p>最低限マークダウンを編集できるように<a href=\"https://github.com/plasticboy/vim-markdown\">plasticboy/vim-markdown</a>を導入しました。<br />\nデフォルトのVimだとマークダウンのシンタックスハイライトは効きますがVSCodeに比べると若干編集しづらいところがありました。\n導入後は箇条書きリストで改行したときにインデントを保ったまま<code class=\"language-text\">*</code>を付けてくれたりと軽快に編集できるようになりました。<br />\nプラグインはGitHubからZIPでダウンロードして解凍したものをvimフォルダ配下の<code class=\"language-text\">plugins</code>に突っ込めば普通に動きました。\n※<code class=\"language-text\">vimrc</code>で<code class=\"language-text\">plugins</code>配下を全部読み込むような設定になっているようですね。</p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>昔、同期が「Vim最高！！」とか言ってて当時は全く理解できませんでしたが、今ならわかるような気がします。\nそこまで使いこなせていませんが、Vimの考え方などは非常に共感できるし、基本操作さえ覚えてしまえば、あとは組み合せで対応できる点が大変気に入っています。カーソル移動がとにかく楽ですね。<br />\nVimiumを日頃から使っていれば操作は忘れないし、今後はLinux上で恐れることなくVimを使っていけそうな気がしました🍅</p>","headingsDetail":[{"id":"なにこれ","value":"なにこれ","depth":2,"parents":[]},{"id":"1-vimtutor実施","value":"1. vimtutor実施","depth":2,"parents":[]},{"id":"要約","value":"要約","depth":3,"parents":[{"id":"1-vimtutor実施","value":"1. vimtutor実施","depth":2}]},{"id":"2-vim日本語ドキュメント読む","value":"2. Vim日本語ドキュメント読む","depth":2,"parents":[]},{"id":"3-qiitaの主要記事を読む","value":"3. Qiitaの主要記事を読む","depth":2,"parents":[]},{"id":"4-chromeにvimium導入","value":"4. ChromeにVimium導入","depth":2,"parents":[]},{"id":"リンククリック","value":"リンククリック","depth":3,"parents":[{"id":"4-chromeにvimium導入","value":"4. ChromeにVimium導入","depth":2}]},{"id":"スクロール","value":"スクロール","depth":3,"parents":[{"id":"4-chromeにvimium導入","value":"4. ChromeにVimium導入","depth":2}]},{"id":"タブ移動","value":"タブ移動","depth":3,"parents":[{"id":"4-chromeにvimium導入","value":"4. ChromeにVimium導入","depth":2}]},{"id":"タブ操作","value":"タブ操作","depth":3,"parents":[{"id":"4-chromeにvimium導入","value":"4. ChromeにVimium導入","depth":2}]},{"id":"更新・戻る・進む","value":"更新・戻る・進む","depth":3,"parents":[{"id":"4-chromeにvimium導入","value":"4. ChromeにVimium導入","depth":2}]},{"id":"注意点","value":"注意点","depth":3,"parents":[{"id":"4-chromeにvimium導入","value":"4. ChromeにVimium導入","depth":2}]},{"id":"その他","value":"その他","depth":2,"parents":[]},{"id":"まとめ","value":"まとめ","depth":2,"parents":[]}],"fields":{"title":"Vimを始める時に取り組んだ４つのこと","excerpt":"なにこれ最近DockerまわりをやっていてLinux上でDockerfileなどを編集するのがつらいので、ちゃんとVimを覚えようと思い立ち、とっかかりとして下記４点取り組みました。整理もかねて本記事にまとめます。vimtutor実施Vim...","date":"2018-12-09T21:00:00.000+09:00","tags":["Vim","Vimium"],"thumbnail":"/thumbnail/2018/vim-beginners.png"}}},"pageContext":{"slug":"/2018/12/09/","relatedPosts":[],"latestPosts":[{"html":"<p><img src=\"/thumbnail/2019/05/wordcloud-in-gatsby-blog.png\"></p>\n<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"/wordcloud-with-kuromoji-d3cloud-nodejs\">前回記事</a>ではNode.jsでWordCloudを出力しました。\n今回は、<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">前回のサンプル</a>をベースに自分のブログ（Gatsby製のブログ）にWordCloudを取り入れてみたので、その時の実装方法のメモです。</p>\n<p>※ソースコードは以下です。<br/>\n<a href=\"https://github.com/Takumon/blog/blob/master/gatsby-node.js\">https://github.com/Takumon/blog/blob/master/gatsby-node.js</a></p>\n<h2 id=\"wordcloudどんなかんじ？\"><a href=\"#wordcloud%E3%81%A9%E3%82%93%E3%81%AA%E3%81%8B%E3%82%93%E3%81%98%EF%BC%9F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WordCloudどんなかんじ？</h2>\n<p>(1)記事全文をインプットにしたものと、(2)記事のタグをインプットにしたものの2つを生成しました。<a href=\"./map\">全記事解析ページ</a>で見れます。</p>\n<h3 id=\"1記事全文をインプットにしたもの\"><a href=\"#1%E8%A8%98%E4%BA%8B%E5%85%A8%E6%96%87%E3%82%92%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E3%81%AB%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(1)記事全文をインプットにしたもの</h3>\n<p>キーワード以外にも、「登録」「実現」「まとめ」のような何回も使う表現がノイズとして混ざるのであまり満足度は高くありません。それでも「Gatsby」「React」が目立って表示されているので、形だけはWordCloudになっています。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/de4be7280c02fcda494c51d41a9db86e/8db7d/wordcloud-from-texts.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 52.480000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcRAAAXEQHKJvM/AAACQ0lEQVQozxWSS2/cNhSF5//v8wO6aDYFCnTRJkA3TYHErWOPx/V4NNLoQT1JiSKpx8h208XXmwUhggLOPeeeb3d93Rhnj58mgnf4pce7Qd4Mg+m41h2mbSgGRTOMWFszukBwHVNwhGlkmReuc2C7vrJ7XT3L5HhxI6uzcu/RfUPrRbBqeYtSGvNE3O+p25ReL5R2pGgadJPS2o6xMyzesi0ru//WhS0Yrs4wFyJYlWRNzSlVZFlKXVSk6d+o8o68iriUjkqc38p/VSpsL4J9Id+GdZ2+O1xpp5mqc9iHPdPDX8Sq4v6iqO4/c36856Yt+KwyjkWNKVryPKfSMmjo6Kwm6s4YnYpgYPc2WbHcscmu1n/uMOeYJLMczjX6yz3Nwy2hembMjvjswt3jhcPTmfF4gz9/RdlAYhxdr/Hjd8HR8q2ucGZgH39ijb6gniTeJWLQJ0p1IjvteRSB/JKTHs/YJGFsDrwlN6xFTKVmlraW/Y/s1uuGC4HUaFSb8a9MvT3+wof4N354fMfvya/8fPiJHx/e8zH5kzQe6OsEpQtCpzDlM1pK8UMtkVt203XFeY2Whp1En8qR7vlInP9BlH8lkt095xH78oZPlz2nk+KQtWS1xqlISosJfc3cD0zLzG6TUiY/oSV6PfSUcoK0bJUg0gWqytOpknOTUDeWIIVY1VKOrRiIRajAC0arF/xeBZtvm+M6CjLzzGgHcdpIcxWTYOCsDLEGIw56GRi05sUoZi2sCrdWXG3CqxOO50XAfln4H6dQ3Q7nZ23oAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wordcloud from texts\"\n        title=\"\"\n        src=\"/static/de4be7280c02fcda494c51d41a9db86e/fb8a0/wordcloud-from-texts.png\"\n        srcset=\"/static/de4be7280c02fcda494c51d41a9db86e/1a291/wordcloud-from-texts.png 148w,\n/static/de4be7280c02fcda494c51d41a9db86e/2bc4a/wordcloud-from-texts.png 295w,\n/static/de4be7280c02fcda494c51d41a9db86e/fb8a0/wordcloud-from-texts.png 590w,\n/static/de4be7280c02fcda494c51d41a9db86e/526de/wordcloud-from-texts.png 885w,\n/static/de4be7280c02fcda494c51d41a9db86e/fa2eb/wordcloud-from-texts.png 1180w,\n/static/de4be7280c02fcda494c51d41a9db86e/08f6a/wordcloud-from-texts.png 1770w,\n/static/de4be7280c02fcda494c51d41a9db86e/8db7d/wordcloud-from-texts.png 1875w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br/></p>\n<h3 id=\"2記事のタグをインプットにしたもの\"><a href=\"#2%E8%A8%98%E4%BA%8B%E3%81%AE%E3%82%BF%E3%82%B0%E3%82%92%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E3%81%AB%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(2)記事のタグをインプットにしたもの</h3>\n<p>上記を作ってみて満足いかなかったので、試しに記事のタグをインプットにしたものを作ってみたら、思いのほかそれっぽくなりました。自分の直感とも一致していているので、「どんなブログ書いてるの？」という質問の答えとして十分使えそうです。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a2d86827695eec6552e7881612d06b66/8db7d/wordcloud-from-tags.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 53.17333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABcRAAAXEQHKJvM/AAACY0lEQVQoz2WTW2/TQBCF8/9/Ak/wwFNBogIkWqBCFERRLylpkzSpE8dx7fjutde32PF+bFqEkBjpaLWzqzNn9swO0KGU4t/Yb/eZSXBLHNtQ1fS1oCk7ml3PRpb0Xfd0V6PftSh/AtuCwXabE1g2tczY1iky9hCBS1kWvF0cchU8YMQxNB6NaCnaHb4+y4RAFBW0LeQhLD6h2ppBVW5wjRW+OWM1vsaYXGGNb1lPPQ6mH3hzsWSkC96sHT7+2vB+5HJmRnybebw8M7mYe5h3c/Lh60fFg6TwSBYLiuwW2eqqurJ0a+y5rwmPNYnF4YXJizObZ19Nju483t04vLpac3Bxz9Ek4PnJiM4Z6f53DMqypDBNZHKNHy6xlnN8K2Rx43Pln3O2vuPSvmPo3DNyZjhhzMR2Md2IteGycAS/ZgYsj+n7joFMM/K5QRYPsTcxG9sh8jyClcR9MLiXBsnskvzbF4Ifp8iTE4rvP6hHQ/rTz/jff+K7gtZd0VWVVpikWpkgycfIqiSVEhGV2JOEWqsplxHV2KK+XpOOXRqtJpkPqYIptTUjWT3gODleICnqrTYlSbClwMumjMuK66xgqg/Pb31ths9yJVhaGZEb09sLemuESLXjuaFdjsjSXHckUc2WXg/RoMky5Ra5CrOxCtNEraJcxXamVhupbFFq+MqVkUr9RHWbWMmlpSoRqb6MVVwIta081clMPbJpWwZ7q5s/g7wPUXWkVg7d04Q3maCL1qg0hazRrUbk+t21oez4P/aE4b+o2l1Y502oyUK1z+lVf5GQbvv3jtrn+APFI55yhL8BmF02pml+TKcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wordcloud from tags\"\n        title=\"\"\n        src=\"/static/a2d86827695eec6552e7881612d06b66/fb8a0/wordcloud-from-tags.png\"\n        srcset=\"/static/a2d86827695eec6552e7881612d06b66/1a291/wordcloud-from-tags.png 148w,\n/static/a2d86827695eec6552e7881612d06b66/2bc4a/wordcloud-from-tags.png 295w,\n/static/a2d86827695eec6552e7881612d06b66/fb8a0/wordcloud-from-tags.png 590w,\n/static/a2d86827695eec6552e7881612d06b66/526de/wordcloud-from-tags.png 885w,\n/static/a2d86827695eec6552e7881612d06b66/fa2eb/wordcloud-from-tags.png 1180w,\n/static/a2d86827695eec6552e7881612d06b66/08f6a/wordcloud-from-tags.png 1770w,\n/static/a2d86827695eec6552e7881612d06b66/8db7d/wordcloud-from-tags.png 1875w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br/></p>\n<h2 id=\"処理概要\"><a href=\"#%E5%87%A6%E7%90%86%E6%A6%82%E8%A6%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理概要</h2>\n<p>Gatsbyを使う場合、画面に必要なデータはビルド時に生成するのがベーシックなやり方です。\nそのためSVG生成は、表示時のReactコンポーネントではなくビルド時の処理（gatsby-node.js）にて行いました。\nビルドはNode.jsの世界ですから、前回記事の<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">Node.jsでWordCloudのSVG画像を出力するサンプル</a>が、ほぼそのまま使えるわけです。サンプルと、Gatsbyビルド処理のお作法（gatsby-node.jsの書き方）を考慮して以下のような手順でSVG画像のデータを生成します。</p>\n<ul>\n<li>\n<p>記事全文のWordCloud生成</p>\n<ul>\n<li>記事全文を取得 ☚Gatsbyビルド処理のお作法</li>\n<li>記事全文をインプットにkuromoji.jsで形態素解析</li>\n<li>解析結果をインプットにD3-Cloudでフォーマット</li>\n<li>解析結果をインプットにd3.jsでSVG文字列生成</li>\n<li>Gatsbyページ生成時にContextのプロパティとして渡す ☚Gatsbyビルド処理のお作法</li>\n</ul>\n</li>\n<li>\n<p>記事全タグのWordCloud生成</p>\n<ul>\n<li>記事全タグを取得 ☚Gatsbyビルド処理のお作法</li>\n<li>記事全タグをインプットにタグ出現回数を算出</li>\n<li>解析結果をインプットにD3-Cloudでフォーマット</li>\n<li>解析結果をインプットにd3.jsでSVG文字列生成</li>\n<li>Gatsbyページ生成時にContextのプロパティとして渡す ☚Gatsbyビルド処理のお作法</li>\n</ul>\n</li>\n</ul>\n<p>そして表示時にコンポーネントでSVGデータを取得し画面に表示します。</p>\n<h2 id=\"処理のチューニングポイント\"><a href=\"#%E5%87%A6%E7%90%86%E3%81%AE%E3%83%81%E3%83%A5%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理のチューニングポイント</h2>\n<p>WordCloudの品質を上げるために以下のようなチューニングを実施しました。</p>\n<ul>\n<li>\n<p>「Gatsby」[gatsby」などは同じ単語とみなしてカウントしています。</p>\n<ul>\n<li>文章中で前後文脈によって大文字小文字の差があるものは、同じ単語としてカウントしています。</li>\n<li>最終的にWordCloudに表示する単語は一番大文字の数が多い単語（「Gatsby」[gatsby」なら「Gatsby」）を採用するようにしました。</li>\n</ul>\n</li>\n<li>\n<p>記事全文は、マークダウンではなくHTMLをインプットにして、HTMLタグを除外、さらにpreタグは中身ごと除外してから形態素解析のインプットとして渡しています。</p>\n<ul>\n<li>マークダウンはリンク、スタイルなどメタ情報が多いため、いったんHTMLに変換したものからHTMLタグを抜くことで純粋な文書だけを抽出しています。</li>\n<li>またソースコードには同じような表現が多く含まれ、WordCloudの対象にするにはノイズが大きく、大事な単語であればソースコード外の文章中に出てくるという前提のもと、ソースコードはすべて除外しています</li>\n<li>「時」「場合」など言い回しとして何度も出てくる単語はWordCloudの情報にしても意味がないので除外しています。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"処理詳細（実装）\"><a href=\"#%E5%87%A6%E7%90%86%E8%A9%B3%E7%B4%B0%EF%BC%88%E5%AE%9F%E8%A3%85%EF%BC%89\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理詳細（実装）</h2>\n<p>ちょっと長いですが、\nソースコード中のコメントにて詳細を説明します。</p>\n<div class=\"gatsby-code-title\">gatsby-node.jsからWordCloud生成処理抜粋</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/** HTML形式の記事本文からHTMLタグを削除するために使う */</span>\n<span class=\"token keyword\">const</span> striptags <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'striptags'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** 仮想DOM d3.js D3-CloudはDOMがある前提なのでNode.js実行時でも正常動作するように仮想Canvasを使う */</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createCanvas <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">/** 仮想DOM d3.js D3-CloudはDOMがある前提なのでNode.js実行時でも正常動作するように仮想DOMを使う */</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">JSDOM</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jsdom'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** 形態素解析のために使う */</span>\n<span class=\"token keyword\">const</span> kuromoji <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'kuromoji'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** WordCloudのSVG文字列作成用 */</span>\n<span class=\"token keyword\">const</span> d3 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** WordCloudのSVG文字列作成用 */</span>\n<span class=\"token keyword\">const</span> cloud <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3-cloud'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** createPageにてWordCloud生成処理を実装する */</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> createPage <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">/** (略)ページコンポーネント呼び出し */</span>\n\n    <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/** (略)記事情報呼び出しクエリ */</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>result <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token comment\">/** (略)もろもろのページ作成 */</span>\n\n\n      <span class=\"token comment\">// WordCloud用データ加工処理</span>\n\n      <span class=\"token comment\">/** (略)resultから記事全文の配列(allPostHtmlTexts)を取得する処理 */</span>\n\n      <span class=\"token comment\">// 記事全文文字列取得</span>\n      <span class=\"token keyword\">const</span> allPostTexts <span class=\"token operator\">=</span> allPostHtmlTexts\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>allHtmlTexts <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// HTML文字列からタグを除外</span>\n          <span class=\"token comment\">// ただしpreタグは、中身をWordCloud解析対象外とするためここではあえて残している</span>\n          <span class=\"token keyword\">const</span> stripedAllText <span class=\"token operator\">=</span> <span class=\"token function\">striptags</span><span class=\"token punctuation\">(</span>allHtmlTexts<span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;pre>'</span><span class=\"token punctuation\">)</span>\n\n          <span class=\"token comment\">// そのためpreタグとその中身を除外する。</span>\n          <span class=\"token comment\">// preタグの中見はソースコード。</span>\n          <span class=\"token comment\">// キーワードはソースコード外の文章中に記述していることを想定して</span>\n          <span class=\"token comment\">// WordCloudの対象から外す。</span>\n          <span class=\"token keyword\">return</span> <span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/&lt;pre[\\s\\S]+?>[\\s\\S]+?&lt;\\/pre>/g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// 改行でつなぐ</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n      \n\n      <span class=\"token comment\">/** (略)resultから記事全タグの配列(allPostTags)を取得する処理 */</span>\n\n      <span class=\"token comment\">// 記事タグ取得</span>\n      <span class=\"token keyword\">const</span> tagDatas <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n      <span class=\"token comment\">// 記事全タグ情報からどのタグが何回出現するか算出</span>\n      allPostTags<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>tags <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        tags<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n          <span class=\"token keyword\">const</span> targetData <span class=\"token operator\">=</span> tagDatas<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">=></span> data<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> t<span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>targetData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            targetData<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> targetData<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            tagDatas<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">:</span> t<span class=\"token punctuation\">,</span>\n              size<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n      <span class=\"token comment\">// タグ出現回数をインプットにWordCloud生成</span>\n      <span class=\"token comment\">// タグ情報の場合形態素解析せずとも単語ごとの出現回数が算出できるので</span>\n      <span class=\"token comment\">// 形態素解析はスキップしている</span>\n      <span class=\"token function\">createWordCloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        words<span class=\"token punctuation\">:</span> tagDatas<span class=\"token punctuation\">,</span>\n        w<span class=\"token punctuation\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span>\n        h<span class=\"token punctuation\">:</span> <span class=\"token number\">630</span><span class=\"token punctuation\">,</span>\n        fontSizePow<span class=\"token punctuation\">:</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">,</span>\n        fontSizeZoom<span class=\"token punctuation\">:</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span>\n        padding<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>tagSvg <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// タグをインプットにしたSVGが出来上がる</span>\n\n        <span class=\"token comment\">// 記事全文文字列をインプットに単語出現回数を算出</span>\n        <span class=\"token function\">createWordCount</span><span class=\"token punctuation\">(</span>alltext<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n            <span class=\"token comment\">// 記事全文の単語出現回数をインプットにWordCloud生成</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">createWordCloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              words<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">,</span>\n              w<span class=\"token punctuation\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span>\n              h<span class=\"token punctuation\">:</span> <span class=\"token number\">630</span><span class=\"token punctuation\">,</span>\n              fontSizePow<span class=\"token punctuation\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span>\n              fontSizeZoom<span class=\"token punctuation\">:</span> <span class=\"token number\">3.1</span><span class=\"token punctuation\">,</span>\n              padding<span class=\"token punctuation\">:</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>textSvg <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 記事全文をインプットにしたSVGが出来上がる</span>\n\n            <span class=\"token comment\">// ページ生成時にSVGをContextのプロパティとして渡す</span>\n            <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              path<span class=\"token punctuation\">:</span> <span class=\"token string\">'/map/'</span><span class=\"token punctuation\">,</span>\n              component<span class=\"token punctuation\">:</span> postRelationMapPage<span class=\"token punctuation\">,</span>\n              context<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                allPostRelations<span class=\"token punctuation\">,</span>\n                wordCloudText <span class=\"token punctuation\">:</span> textSvg<span class=\"token punctuation\">,</span>\n                wordCloudTag<span class=\"token punctuation\">:</span> tagSvg<span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\">// すべてのcreatePageを呼び終わったあとにresolveを呼んで処理終了</span>\n            <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'OK'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * ２つの単語の大文字小文字の違いをカウントする\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">countDiff</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a\n    <span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>charA<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> charA <span class=\"token operator\">===</span> b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">/**\n * 指定した文字列を形態素解析して単語ごとの出現回数を返す\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createWordCount</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// よく出る言い回しでWordCloudから除外したい単語を列挙  </span>\n  <span class=\"token keyword\">const</span> excludeWords <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'指定'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'時'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'追加'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">/** (略)除外したい単語 */</span>\n  <span class=\"token punctuation\">]</span>\n\n\n  <span class=\"token comment\">/** kuromoji.jsにバンドルされている辞書の格納場所 */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'node_modules/kuromoji/dict'</span>\n\n  <span class=\"token comment\">/** WordCloudでカウントする品詞（助詞・助動詞などは省く） */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">TARGET_POS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'名詞'</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token comment\">/** kuromoji.jsで該当プロパティの値が存在しない場合に設定されている値 */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n\n  <span class=\"token comment\">// kuromoji.jsで形態素解析</span>\n  <span class=\"token comment\">// 単語ごとの出現回数を出力</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    kuromoji<span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dicPath<span class=\"token punctuation\">:</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> tokenizer<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// 単語ごとの出現回数を出力</span>\n      <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> <span class=\"token constant\">TARGET_POS</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>basic_form <span class=\"token operator\">===</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">?</span> t<span class=\"token punctuation\">.</span>surface_form <span class=\"token punctuation\">:</span> t<span class=\"token punctuation\">.</span>basic_form<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// 大文字と小文字を区別せず出現回数をカウントする</span>\n          <span class=\"token keyword\">const</span> upperText <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>excludeWords<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>upperText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> data\n          <span class=\"token punctuation\">}</span>\n\n          <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> upperText<span class=\"token punctuation\">)</span>\n\n          <span class=\"token comment\">// 出現回数は大文字小文字を区別しないが、実際の生の単語は後の処理で使うためとっておく</span>\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>target<span class=\"token punctuation\">.</span>rawTexts<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              target<span class=\"token punctuation\">.</span>rawTexts<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">:</span> upperText<span class=\"token punctuation\">,</span>\n              rawTexts<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> text <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n              size<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> data\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n          <span class=\"token comment\">// 上記処理で保持しておいた生の単語をもとに、一番大文字が多い単語をWordCloudの単語として採用する</span>\n          <span class=\"token comment\">// 例えばGatsbyとgatsbyであればGatsbyを採用</span>\n          <span class=\"token keyword\">const</span> almostSameText <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>rawTexts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>text <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n                text<span class=\"token punctuation\">,</span>\n                diff<span class=\"token punctuation\">:</span> <span class=\"token function\">countDiff</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a<span class=\"token punctuation\">.</span>diff <span class=\"token operator\">&lt;=</span> b<span class=\"token punctuation\">.</span>diff <span class=\"token operator\">?</span> a <span class=\"token punctuation\">:</span> b<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 大文字に近いほうを採用する</span>\n            <span class=\"token punctuation\">.</span>text\n          \n          <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n            text<span class=\"token punctuation\">:</span> almostSameText<span class=\"token punctuation\">,</span>\n            size<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * 単語出現回数をもとにWordCloudのSVG文字列を返す\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createWordCloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  words<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 単語出現回数</span>\n  w<span class=\"token punctuation\">,</span> <span class=\"token comment\">// SVGの幅(単位px)</span>\n  h<span class=\"token punctuation\">,</span> <span class=\"token comment\">// SVGの高さ(単位px)</span>\n  fontSizePow<span class=\"token punctuation\">,</span> <span class=\"token comment\">// WordCloudの文字の大きさの比率調整用係数</span>\n  fontSizeZoom<span class=\"token punctuation\">,</span> <span class=\"token comment\">// WordCloudの文字の大きさの係数</span>\n  padding<span class=\"token punctuation\">,</span> <span class=\"token comment\">// WordCloudの文字間の隙間</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">cloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">canvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">words</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>word <span class=\"token operator\">=></span> word<span class=\"token punctuation\">.</span>size <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 出現回数に応じて縦か横向きに表示</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontWeight</span><span class=\"token punctuation\">(</span>word <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> fontSizePow<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> fontSizeZoom<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontSize</span><span class=\"token punctuation\">(</span>word <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> fontSizePow<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> fontSizeZoom<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">font</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">padding</span><span class=\"token punctuation\">(</span>padding<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> wordsForCloud <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// d3.jsによる解析</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>wordsForCloud <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/** 仮想DOM */</span>\n      <span class=\"token keyword\">const</span> document <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSDOM</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`&lt;body>&lt;/body>`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">.</span>document\n\n      d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svg'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ui fluid image'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'viewBox'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token string\">`0 0 </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token string\">`translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-size'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>size<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-family'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token string\">`translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)rotate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>rotate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fill'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> d3<span class=\"token punctuation\">.</span>schemeCategory10<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text-anchor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n      \n      <span class=\"token comment\">// 最終的にSVGの文字列を返す</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>自分のブログにWordCloudを導入したいと思い立ち、WordCloudについて3回にわたりブログを書いてきましたが、各種ライブラリのおかげで、すんなりと導入できました。\n人に自分のブログを紹介するときのネタとしてはとても効果的だと思います。<br/>\nなお形態素解析やWordCloud生成は重い処理なので、ビルドに時間がかかるようになってしまいますが、画面表示に関してはパフォーマンスに影響はありません。<br/>\nあと本来であればプラグイン化して配布したいところですが、プラグイン化のためには、まだまだ汎用性を高る必要があって、それは今後の課題です🍅</p>","fields":{"slug":"/wordcloud-in-gatsby-blog","title":"Gatsby製ブログにWordCloudを導入","date":"2019-05-11T17:00:00.000+09:00","excerpt":"なにこれ前回記事ではNode.jsでWordCloudを出力しました。今回は、前回のサンプルをベースに自分のブログ（Gatsby製のブログ）にWordCloudを取り入れてみたので、その時の実装方法のメモです。※ソースコードは以下です。ht...","tags":["Gatsby","kuromoji.js","d3.js","d3Cloud","形態素解析","WordCloud"],"keywords":["Gatsby"],"thumbnail":"/thumbnail/2019/05/wordcloud-in-gatsby-blog.png"}},{"html":"<p><img src=\"/thumbnail/2019/05/wordcloud-with-kuromoji-d3cloud-nodejs.png\"></p>\n<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"/wordcloud-with-kuromoji-d3cloud-react\">前回記事</a>ではReactでWordCloudを出力しました。しかし実際は、過去大量データから出力するようなツールとして使えたほうが便利です。\nそこで<a href=\"https://github.com/Takumon/playbox2019/blob/master/react-kuromoji-sample/src/App.js\">前回のサンプル</a>をベースにNode.jsでWordCloudのSVGファイルを出力するサンプルを作成しました。\n今回はサンプルの実装方法をポイントと合わせてご紹介します。</p>\n<p>※サンプルは以下に置いております。\n<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js</a></p>\n<p>この記事は、<a href=\"https://gw-advent.9wick.com/calendars/9\">challenge-every-month全員でアウトプット芸人 Advent Calendar</a> 9日目の記事です。前日の記事は、<a href=\"https://twitter.com/kojirock5260\">@kojirock5260</a>さんの記事でした。</p>\n<iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fkojirooooocks.hatenablog.com%2Fentry%2F2019%2F05%2F04%2F163742\" style=\"border: 0; width: 100%; height: 190px;\" allowfullscreen scrolling=\"no\" allow=\"autoplay; encrypted-media\"></iframe>\n<h2 id=\"処理手順\"><a href=\"#%E5%87%A6%E7%90%86%E6%89%8B%E9%A0%86\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理手順</h2>\n<p>以下4ステップです。</p>\n<ol>\n<li>kuromoji.jsで文章を解析して単語出現回数をデータ化</li>\n<li>\n<p>D3-Cloudで上記データに以下情報追加</p>\n<ol>\n<li>フォントの大きさ</li>\n<li>フォントの回転位置</li>\n<li>フォントの種類</li>\n<li>表示位置</li>\n</ol>\n</li>\n<li>d3.jsで配色を決定しSVGを<strong>仮想DOM</strong>に描画</li>\n<li>SVGをファイル出力</li>\n</ol>\n<h2 id=\"実装のポイント\"><a href=\"#%E5%AE%9F%E8%A3%85%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装のポイント</h2>\n<h3 id=\"1-d3-cloud--canvasだけでは不十分なのでd3jsを使う\"><a href=\"#1-d3-cloud--canvas%E3%81%A0%E3%81%91%E3%81%A7%E3%81%AF%E4%B8%8D%E5%8D%81%E5%88%86%E3%81%AA%E3%81%AE%E3%81%A7d3js%E3%82%92%E4%BD%BF%E3%81%86\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. D3-Cloud + Canvasだけでは不十分なのでd3.jsを使う</h3>\n<p>最初は、D3-CloudでCanvasを使えるので、<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>を使えばNode.jsでも画像を生成できるのでは？と考えたのですが、やってみるとうまくいきません。以下のような画像が出力されます。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5c0dfead862a7dffa4699ce66baf1ba5/ca9f3/wordcloud-by-canvas.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 68.43455945252353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABcRAAAXEQHKJvM/AAACb0lEQVQ4y2VU7UrjQBTtG+0+wQo+zSLsD0FsBP/5FL6DoIIb8dfuf8FCwdraNknTpq2dpk36ocZM7tk5GdNd2MDlzNy5c+6Zey+pLa6ufs0ajRsVRa66u3PVfO6qiwtXXV66qtt1VRy7Kghc1em46vraVc2m9TF+NLLYat2+9Ho33w8Pv9bQagHDIcrv+dkifb6P3Xd/D2QZEMdAUfz1v75afHgAPA8n5+f7Ne5NSCZZpqUotAD/m4hFrbXkuZY0tZgkWkajXIKgKOL4o352tldjdtluNXo9YDIB3t+B2Qzo94HBAHh5AR4fgU4HaDSA6RRoNoEwLOOk2xWMxxSlnePjvVIhs++esdkA7bYl73axKwmJ/30uv9WKd6V8pVHvOI4hNEGyXGpst4ZW27pQ4ceHrRuRfip7ewOSBFgsgDQtz2SzEYooCU9OPhWuVrq8THVURkKugwB4erI+ElQJ12ubzJDLbCZcF6b+ViGzrNea8stLNF5gLZdLYD63CfLcEvMlVErF5sw0SHi3MKKc09NPQipkE6p6VQ0iGRMxAUeGjWEt+WT6DbkRI0xQmMZaQhHIZKLLuYsiS0YbjSyJUtZYOyahn6VgvEEZDoX3ijDUTr1uCFmHdluL54lEkYjvi5ktYWC5H4/tmhYEIoOBGAEWw7D0l2MznWrn6MgQUnYUZaJUbgJzQ5CbYIscWvrm89wUP5fFIpc4zmU6tZgkpZkS6CJJsnq9/q22mz0Wmh1kM2jVnsaGVD52l1jF8Zw+g0bhfm3jeb8Tz7tJ+323NPMjSD3PrgcDi77vpr2exeqcGIbW5/u3yzD8+ePg4Msfq80DXTye9xsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wordcloud by canvas\"\n        title=\"\"\n        src=\"/static/5c0dfead862a7dffa4699ce66baf1ba5/fb8a0/wordcloud-by-canvas.png\"\n        srcset=\"/static/5c0dfead862a7dffa4699ce66baf1ba5/1a291/wordcloud-by-canvas.png 148w,\n/static/5c0dfead862a7dffa4699ce66baf1ba5/2bc4a/wordcloud-by-canvas.png 295w,\n/static/5c0dfead862a7dffa4699ce66baf1ba5/fb8a0/wordcloud-by-canvas.png 590w,\n/static/5c0dfead862a7dffa4699ce66baf1ba5/526de/wordcloud-by-canvas.png 885w,\n/static/5c0dfead862a7dffa4699ce66baf1ba5/ca9f3/wordcloud-by-canvas.png 1169w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>そのためD3-Cloud + Canvasだけの組み合わせはあきらめて、\n<a href=\"https://github.com/Yoctol/react-d3-cloud\">react-d3-cloud</a>の内部実装と同じようにd3.jsを使ってSVGを描画して、そこからファイル出力処理するようにしました。</p>\n<h3 id=\"2-domエミュレート用にnode-canvasとjsdomを使う\"><a href=\"#2-dom%E3%82%A8%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%83%88%E7%94%A8%E3%81%ABnode-canvas%E3%81%A8jsdom%E3%82%92%E4%BD%BF%E3%81%86\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. DOMエミュレート用にnode-canvasとjsdomを使う</h3>\n<p><a href=\"https://github.com/d3/d3\">d3.js</a>は、ブラウザ上での動作を前提としているためDOMが必要です。Node.jsでDOMをエミュレートするために<a href=\"https://github.com/jsdom/jsdom\">jsdom</a>を使いました。<br/>\n<a href=\"https://github.com/jasondavies/d3-cloud\">D3-Cloud</a>も同様にCanvasの指定が必須です。\nそのためCanvasをエミュレートする<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>を使いました。</p>\n<h2 id=\"実装\"><a href=\"#%E5%AE%9F%E8%A3%85\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装</h2>\n<p>ポイントを踏まえたうえで4ステップごとに実装方法を説明します。</p>\n<h3 id=\"1-kuromojijsで文章を解析して単語出現回数をデータ化\"><a href=\"#1-kuromojijs%E3%81%A7%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. kuromoji.jsで文章を解析して単語出現回数をデータ化</h3>\n<p>kuromoji.jsによるデータ加工については<a href=\"/wordcloud-with-kuromoji-d3cloud-react#1-%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96-1\">前回記事のReactアプリ</a>と同様です。\n今回はブラウザではなくNode.jsで動かすのでkuromoji.jsの辞書はnode_modules配下から移動する必要はありません。</p>\n<div class=\"gatsby-code-title\">kuromoji.jsによる解析処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> kuromoji <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'kuromoji'</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">// インプットとなる文章(長文につき一部省略)</span>\n<span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`\nそこも場合もうその病気らに対して旨の時がしんませ。\n単に事実に使用方はどうかその応用たないでもが思いてならないがも発展思いうべきて、\nあいにくにもなるだなですた。\n・・・\n`</span></span>\n\n<span class=\"token comment\">// kuromoji.jsにバンドルされている辞書のフォルダパス</span>\n<span class=\"token comment\">// kuromoji.jsは形態素解析用関数を生成する際に辞書を読み込む</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'node_modules/kuromoji/dict'</span>\n\n<span class=\"token comment\">// WordCloudの情報として抽出する品詞（助詞、助動詞などは意味がないので拾わない）</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TARGET_POS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'名詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'動詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'形容詞'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">// kuromoji.jsの解析結果の値で特に値がない場合は以下の文字が設定される</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる解析処理</span>\n  <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 辞書を読み混んでトークナイザー（形態素解析するための関数）を生成</span>\n    kuromoji<span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dicPath<span class=\"token punctuation\">:</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> tokenizer<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// テキストを引数にして形態素解析</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// pos（品詞）を参照し、'名詞', '動詞', '形容詞'のみを抽出</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> <span class=\"token constant\">TARGET_POS</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// 単語を抽出(basic_formかsurface_formに単語が存在する)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>basic_form <span class=\"token operator\">===</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">?</span> t<span class=\"token punctuation\">.</span>surface_form <span class=\"token punctuation\">:</span> t<span class=\"token punctuation\">.</span>basic_form<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// [{text: 単語, size: 出現回数}]の形にReduce</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> text<span class=\"token punctuation\">)</span>\n\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">,</span>\n              size<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> data\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// d3.jsによる描画処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// SVGファイル出力処理</span>\n  <span class=\"token comment\">// (略)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<p>これで以下のような情報が得られます。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span> \n  <span class=\"token punctuation\">{</span>\n    text<span class=\"token punctuation\">:</span> <span class=\"token string\">'相違'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 単語</span>\n    size<span class=\"token punctuation\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 出現回数</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<br/>\n<h3 id=\"2-d3-cloudで上記データに以下情報追加\"><a href=\"#2-d3-cloud%E3%81%A7%E4%B8%8A%E8%A8%98%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AB%E4%BB%A5%E4%B8%8B%E6%83%85%E5%A0%B1%E8%BF%BD%E5%8A%A0\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. D3-Cloudで上記データに以下情報追加</h3>\n<p>D3-Cloudでは解析情報に以下を追加するだけです。</p>\n<ul>\n<li>フォントの回転位置 ☚自分で定義</li>\n<li>フォントの重み ☚自分で定義</li>\n<li>フォントの大きさ ☚自分で定義</li>\n<li>フォントの種類 ☚自分で定義</li>\n<li>表示位置 ☚D3-Cloudが定義してくれる</li>\n</ul>\n<p>なおD3-CloudはbodyタグかCanvasが必須なので、今回は<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>を使います。</p>\n<div class=\"gatsby-code-title\">D3-Cloudによる解析処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> cloud <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3-cloud'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Node.jsでCanvasをエミュレートするためnode-canvasを使う</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createCanvas <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Canvasの幅(px)</span>\n<span class=\"token keyword\">const</span> w <span class=\"token operator\">=</span> <span class=\"token number\">1600</span>\n\n<span class=\"token comment\">// Canvasの高さ(px)</span>\n<span class=\"token keyword\">const</span> h <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// D3-Cloudの解析によってwordsForCloudには</span>\n  <span class=\"token comment\">// 出現回数の他にフォントの回転位置、大きさ、重み、種類が追加された状態になる</span>\n  <span class=\"token keyword\">const</span> wordsForCloud <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span>resolve <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">cloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// node-canvasを指定する(エラーを防ぐため)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">canvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// kuromoji.jsの解析結果を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">words</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの回転位置を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>word <span class=\"token operator\">=></span> word<span class=\"token punctuation\">.</span>size <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの重みを指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontWeight</span><span class=\"token punctuation\">(</span>word <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">1.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの大きさを指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontSize</span><span class=\"token punctuation\">(</span>word <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">1.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの種類を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">font</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 加工終了時のイベント登録、解析結果をd3.jsでの描画に引き継ぐ</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 解析開始</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// d3.jsによる描画処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// SVGファイル出力処理</span>\n  <span class=\"token comment\">// (略)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<p>これで以下のような情報が得られます。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> \n    text<span class=\"token punctuation\">:</span> <span class=\"token string\">'相違'</span><span class=\"token punctuation\">,</span>\n    size<span class=\"token punctuation\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// D3-Cloudによって追加された情報</span>\n    font<span class=\"token punctuation\">:</span> <span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">,</span>\n    style<span class=\"token punctuation\">:</span> <span class=\"token string\">'normal'</span><span class=\"token punctuation\">,</span>\n    weight<span class=\"token punctuation\">:</span> <span class=\"token number\">19.952623149688797</span><span class=\"token punctuation\">,</span>\n    rotate<span class=\"token punctuation\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span>\n    padding<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    width<span class=\"token punctuation\">:</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token punctuation\">:</span> <span class=\"token number\">59</span><span class=\"token punctuation\">,</span>\n    xoff<span class=\"token punctuation\">:</span> <span class=\"token number\">192</span><span class=\"token punctuation\">,</span>\n    yoff<span class=\"token punctuation\">:</span> <span class=\"token number\">957</span><span class=\"token punctuation\">,</span>\n    x1<span class=\"token punctuation\">:</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n    y1<span class=\"token punctuation\">:</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span>\n    x0<span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n    y0<span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span>\n    hasText<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    x<span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">199</span><span class=\"token punctuation\">,</span>\n    y<span class=\"token punctuation\">:</span> <span class=\"token number\">294</span> \n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h3 id=\"3-d3jsで配色を決定しsvgを仮想domに描画\"><a href=\"#3-d3js%E3%81%A7%E9%85%8D%E8%89%B2%E3%82%92%E6%B1%BA%E5%AE%9A%E3%81%97svg%E3%82%92%E4%BB%AE%E6%83%B3dom%E3%81%AB%E6%8F%8F%E7%94%BB\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. d3.jsで配色を決定しSVGを<strong>仮想DOM</strong>に描画</h3>\n<p>D3-Cloudの解析情報に文字色や配置情報を追加してSVGを仮想DOM上に描画します。\n仮想DOMは<a href=\"https://github.com/jsdom/jsdom\">jsdom</a>を使って生成します。<br/>\nフォント色のテーマは<code class=\"language-text\">schemeCategory10</code>を使いました。他にもいろいろテーマがあるようです。<br/>\n参考：<a href=\"https://wizardace.com/d3v5-scale-chromatic/\">D3.js v5 カラーテーマまとめ (d3-scale-chromatic) – データビジュアライゼーション・ラボ</a></p>\n<div class=\"gatsby-code-title\">d3.jsによるSVG描画処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> d3 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">JSDOM</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jsdom\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 仮想documentオブジェクトを生成</span>\n<span class=\"token keyword\">const</span> document <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSDOM</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`&lt;body>&lt;/body>`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">.</span>document\n\n<span class=\"token comment\">// WordCloud描画領域の幅(px) ※Canvasのやつを使いまわし</span>\n<span class=\"token keyword\">const</span> w <span class=\"token operator\">=</span> <span class=\"token number\">1600</span>\n\n<span class=\"token comment\">// WordCloud描画領域の高さ(px) ※Canvasのやつを使いまわし</span>\n<span class=\"token keyword\">const</span> h <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる形態素解析</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// d3.jsによるSVG描画処理</span>\n  <span class=\"token comment\">// 仮想DOMのbodyタグを指定</span>\n  d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// SVG形式で仮想DOMに描画</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svg'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// SVGのプロパティもろもろ指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ui fluid image'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'viewBox'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token string\">`0 0 </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// SVGのグループ要素追加して</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// SVGを中央寄せ</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token string\">`translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// テキスト要素にD3-Cloudによる解析結果を追加</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 領域を新規作成し、テキスト要素追加</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの大きさは解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-size'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>size<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの種類は解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-family'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの配色は、schemeCategory10を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fill'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> d3<span class=\"token punctuation\">.</span>schemeCategory10<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// テキストの真ん中を表示位置のポイントに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text-anchor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 位置と回転位置は解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token string\">`translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)rotate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>rotate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 単語は解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// SVGファイル出力処理</span>\n    <span class=\"token comment\">// (略)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<h3 id=\"4-svgをファイル出力\"><a href=\"#4-svg%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%87%BA%E5%8A%9B\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. SVGをファイル出力</h3>\n<p>仮想DOMに描画したSVGをファイル出力します。</p>\n<div class=\"gatsby-code-title\">d3.jsによるSVG描画処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる形態素解析</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// d3.jsによるSVG描画処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// 仮想DOMに描画されたSVGをファイル出力</span>\n  fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wordcloud.svg'</span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<p>すると以下のようなファイルが出力されます。</p>\n<div class=\"gatsby-highlight\" data-language=\"html:svgファイルの中身\"><pre class=\"language-html:svgファイルの中身\"><code class=\"language-html:svgファイルの中身\">&lt;svg class=&quot;ui fluid image&quot; viewBox=&quot;0 0 1600 1000&quot; width=&quot;100%&quot; height=&quot;100%&quot;&gt;\n  &lt;g transform=&quot;translate(800,500)&quot;&gt;\n    &lt;text style=&quot;font-size: 466px; font-family: meiryo; fill: #1f77b4;&quot; transform=&quot;translate(48, 35)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;ある&lt;/text&gt;\n    &lt;text style=&quot;font-size: 269px; font-family: meiryo; fill: #ff7f0e;&quot; transform=&quot;translate(460, 15)rotate(90)&quot; text-anchor=&quot;middle&quot;&gt;よう&lt;/text&gt;&lt;text style=&quot;font-size: 245px; font-family: meiryo; fill: #2ca02c;&quot; transform=&quot;translate(-263, -290)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;云う&lt;/text&gt;\n    &lt;text style=&quot;font-size: 191px; font-family: meiryo; fill: #d62728;&quot; transform=&quot;translate(-265, 193)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;それ&lt;/text&gt;\n   ・\n   ・\n   ・\n  &lt;/g&gt;\n&lt;/svg&gt;</code></pre></div>\n<br/>\n<p>描画すると以下のようになります。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8a36774cbb4d037a3d625981f5f8af21/fd114/wordcloud.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 62.92315959161742%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABcRAAAXEQHKJvM/AAACn0lEQVQ4y41Ty27aQBTlm7uousqqldouuqiqquori1ap0rxQWuXZhKAICISJIbYhEBwwNgSDPTbmDZ45HdNGoavmSkcz9/rO8RnNPRFZlj/5vq9SSs9dzyPUcQjtdIjIiUNd4onawO8Sv+uRnoAj6h3bIR2HEtd1F3HhOM55pNlsprAQLJEAy2YBSQIKyrzWHgJTsXpT/DcihmHE5kRBELazfkFlfUVi/UuVST9jbONIYd/zLVaw+kwxPZbTHRYlJtsiBgMHC88IBOEqYhoxTTMeEnLOA1GAYZioynlcX5Xx7iCPx2sJvI+m4WtVlGgXSkXDi+gFllO6YBmjqldhWRYXPBiPx8E/hOKPcLo2rksKqFbGt2QJTzYJXq2dYfOAIN6w8FHUltYy2M7c4KhooG7ouG1ZvGW1MZlO7wmFulA2CnYFA/8Ge5cWnm7n8WglAegKlo+ziOVyeLMvYeVEwWW+itd7GkZa+D3B5xyzyT2hkBiMZwHOvS7oZIgTxcDLXRW/5Ao2Ygre7h+jYXzBsZrBs3WCpdUzJMsU0A4RxJ9zlHbEA9gLVwYP+IwhXbahOz76po5eowVbs6BVOqhr4orqNrJmDOkawVd5HfWyClorYdTJcN5rhq+zoFAk3c4QuUMdRrGFy0QdLc1GIaXBruhQdIIfhV3Eaykk6idYlj9AIqfwKiqGvSLntVOh0Fkk5MGoP4FnTzBqVuBe1dFQhLJyS7ywhXSJIClHkS3u4LbtCKUZjKYMrJEHk1c51C2wAQ3u51DMkCD9M1eexjh1WV/tsFGFskHBZk3FZmPtgo1NldH29G7+GA8xcMVMMjEmmIZOSeIhMXtQFyLCy5+Fl4uhd4UfpTkonYPe5Z5A15Oo9zcXoGHPfE/v9jnhZfIbALe0xkdR0eEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wordcloud\"\n        title=\"\"\n        src=\"/static/8a36774cbb4d037a3d625981f5f8af21/fb8a0/wordcloud.png\"\n        srcset=\"/static/8a36774cbb4d037a3d625981f5f8af21/1a291/wordcloud.png 148w,\n/static/8a36774cbb4d037a3d625981f5f8af21/2bc4a/wordcloud.png 295w,\n/static/8a36774cbb4d037a3d625981f5f8af21/fb8a0/wordcloud.png 590w,\n/static/8a36774cbb4d037a3d625981f5f8af21/526de/wordcloud.png 885w,\n/static/8a36774cbb4d037a3d625981f5f8af21/fa2eb/wordcloud.png 1180w,\n/static/8a36774cbb4d037a3d625981f5f8af21/08f6a/wordcloud.png 1770w,\n/static/8a36774cbb4d037a3d625981f5f8af21/fd114/wordcloud.png 1861w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Node.jsでWordCloudのSVGファイルを出力する方法についてご紹介しました。\n今回の実装で、ブラウザ処理はnode-canvasとjsdomを使えばNode.jsでも再現できることがわかったので、いろんな場面で応用できそうです。\n次回は、今回の実装をベースにして自分のブログのWordCloudを生成してみようと思います🍅</p>","fields":{"slug":"/wordcloud-with-kuromoji-d3cloud-nodejs","title":"Node.js + kuromoji.js + D3-CloudでWordCloudの画像を出力","date":"2019-05-04T18:00:00.000+09:00","excerpt":"なにこれ前回記事ではReactでWordCloudを出力しました。しかし実際は、過去大量データから出力するようなツールとして使えたほうが便利です。そこで前回のサンプルをベースにNode.jsでWordCloudのSVGファイルを出力するサン...","tags":["Node.js","kuromoji.js","d3.js","d3Cloud","形態素解析","WordCloud"],"keywords":["WordCloud"],"thumbnail":"/thumbnail/2019/05/wordcloud-with-kuromoji-d3cloud-nodejs.png"}},{"html":"<p><img src=\"/thumbnail/2019/05/wordcloud-with-kuromoji-d3cloud-react.png\"></p>\n<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>WordCloudをJSだけで生成したい。Pythonとか使わずにフロントエンドだけでやりたい。というモチベーションで、\n<a href=\"https://github.com/takuyaa/kuromoji.js/\">kuromoji.js</a>と<a href=\"https://github.com/jasondavies/d3-cloud\">D3-Cloud</a>を使って文字列をインプットにWordCloudを描画するReactアプリを作ってみました。今回はそのやり方についてご紹介します。</p>\n<p>※サンプルコードは以下に置いております。\n<a href=\"https://github.com/Takumon/playbox2019/blob/master/react-kuromoji-sample/src/App.js\">https://github.com/Takumon/playbox2019/blob/master/react-kuromoji-sample/src/App.js</a></p>\n<h2 id=\"wordcloudの作り方（原理）\"><a href=\"#wordcloud%E3%81%AE%E4%BD%9C%E3%82%8A%E6%96%B9%EF%BC%88%E5%8E%9F%E7%90%86%EF%BC%89\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WordCloudの作り方（原理）</h2>\n<p>WordCloudは文章をインプットにして画像をアウトプットします。\nその過程は2つに分かれます。</p>\n<h3 id=\"1-文章を解析して単語出現回数をデータ化\"><a href=\"#1-%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 文章を解析して単語出現回数をデータ化</h3>\n<div class=\"gatsby-code-title\">たとえばこんな文章を...</div>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">そこも場合もうその病気らに対して旨の時がしんませ。単に事実に使用方はどうかその応用たないでもが思いてならないがも発展思いうべきて、あいにくにもなるだなですた。\n差が向いんものは何だか翌日からしきりにんなけれう。もちろんネルソンさんで養成道具一応束縛に致しませ示威この力誰か講演をというご妨害ないますですうば、\n...</code></pre></div>\n<p>↓↓</p>\n<div class=\"gatsby-code-title\">単語と出現回数のデータに加工します</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"そこ\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">14</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"場合\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">11</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"うそ\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"病気\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">8</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"ら\"</span><span class=\"token punctuation\">,</span>      value<span class=\"token punctuation\">:</span> <span class=\"token number\">17</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"旨\"</span><span class=\"token punctuation\">,</span>      value<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"時\"</span><span class=\"token punctuation\">,</span>      value<span class=\"token punctuation\">:</span> <span class=\"token number\">43</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"しん\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"事実\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"使用\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">6</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"方\"</span><span class=\"token punctuation\">,</span>      value<span class=\"token punctuation\">:</span> <span class=\"token number\">41</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"応用\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"ない\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">175</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"思う\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">39</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"なる\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">99</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"発展\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"思い\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"くる\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">8</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"差\"</span><span class=\"token punctuation\">,</span>      value<span class=\"token punctuation\">:</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">\"向く\"</span><span class=\"token punctuation\">,</span>    value<span class=\"token punctuation\">:</span> <span class=\"token number\">6</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token punctuation\">]</span></code></pre></div>\n<h3 id=\"2-データをもとにイイ感じの画像出力\"><a href=\"#2-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E3%82%82%E3%81%A8%E3%81%AB%E3%82%A4%E3%82%A4%E6%84%9F%E3%81%98%E3%81%AE%E7%94%BB%E5%83%8F%E5%87%BA%E5%8A%9B\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. データをもとにイイ感じの画像出力</h3>\n<p>単語と出現回数の他に、以下の値を何らかの形で決定します。</p>\n<ul>\n<li>フォントの大きさ</li>\n<li>フォントの回転位置</li>\n<li>フォントの種類</li>\n<li>フォントの色</li>\n<li>表示位置</li>\n</ul>\n<p>大体のWordCloud系ライブラリは出現回数が多い単語を大きく中心に配置し、\nその周りに敷き詰めるように他の単語を配置します。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/704eab6cfb822de63938be47f6ccc745/07c6b/wordcloud-sample.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 86.17511520737328%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEN0lEQVQ4yyWU2ZLaOBiFedh5jKnKzTzAZKlUkqlM1WRykUy2Jkl3oE3T0BCaZnWz2CzeMDYI4xVjVokz6pkLVUkq1dH5z/9JqVqt+ps8UEv67bcsEV4JknQujPWyYNYtYd7VhPPmUPhQuBc+l7vCuKkKYlkXKgVFsHq2oMuGIM0sQTLMS9G08oXr/B8pfaJmElDAk4GggwPtANAA38GBzypagCtljaK+BjYJMDWwnS4Al48dsOCHrpMDsntAnVrDlKKrX2J46FjuPtNzqBN6FPXXdFN6TOP+GUX5Gd1rt9RZULpW7ikdXfO9x5QJjyghEZ30lrQer4/fnBX0yaTFBfX0ihus6z59faOgSxIwuwX88wu2ioyd2Qda72FrBwTOFofOBZB9BDrMwtQXELtLlMOI1dd7qBNTTOnKIL3ZbuG5SzoxfUx9XkP5d5zyjxG5wF6q4zD+jiD2cGp9xKn5N0Iy5Rf1wC6f4qrt4OncZe+5Q8WYiKmBYaaxMQE5TQ9yxEOZAtWXYPWPWBMeYr+AQ+UJ9pEKGHdA8w1Y7S9suzkcf76G2rfQNm023B5h2JaYMq1ZGojBnDlddV3stBjHmQ8ot3B5ST+aI0Did9oq4rmBXeMTWOUVj+EtwvMzxIUbhLkLhukceksRUxPDSD+0a+25lHgBvAmB1mhi1GzAHUn40LDx5X4JlkSg6xAnsQ10qtisXC74FYmi4Z19wfSlBruucoezB4dAqOvU7XXhzWxIlSLk2xLEXAaRYyPdUPHkUsZZ08DFzQjS3U9g3sLJkXA8HaGM79ghjmDoNhdUlTT4wiczSrhtSzOgik1M+h30Sjc4xhZahoVfP/bxtqTiTV2GZi4QnIDVbIYke4koV2TeeIT+fVtMGaqaDuIjnNDnDI7h+3MMK2W0C1ewe1XkJQvP8yr0iCPlVPFO+hOZ8Rl6wQx9R0ZnVMQ+3rLIIZDbXPCBw2H4QHmNRlEFy1kNarOOAS9r1OvgWW6EwF/CUmV8H1zgfe8DvqtZtMZFTDhS91Yf69wVY4MhzAcOp6b5X4Z+4tE4GcI2yxjVb9Et5FC7+AZ7NsdIV7EJYrSsBl7WXnDBDHp6FUG2gFbAX+3XNFvlrtAQRTFlTf8XHIcLmtXSkAyRt7+BXjmPTukaoesiNkwUjDyyhoBz5RxfRmf4oWU4Oh2Qz58QZ/Jst3BQ7Mscm8nk7MgFJ6vloU7qbLQYMF28Z91iiS3sGVsJOeY/f8FUtc9K8k8mKS12J92wxlxmBS9hmqYxz0rTFULkh2Y7Zc/ccyDCet3H1CYgxMRxw2ANtsD2BDoYgIeDcOnxD8bDjrPKfwVsky3SXgL+rhAH19idljxXuZfSFO3NLiFxHM7tuWmTqaIQf7Eg/tIn8dIlG8chh+OO7OKYROuEbOINOUYLkng2WUcrkkQB2SSHubucebe9av5fm6Gzz267ZFMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wordcloud sample\"\n        title=\"\"\n        src=\"/static/704eab6cfb822de63938be47f6ccc745/fb8a0/wordcloud-sample.png\"\n        srcset=\"/static/704eab6cfb822de63938be47f6ccc745/1a291/wordcloud-sample.png 148w,\n/static/704eab6cfb822de63938be47f6ccc745/2bc4a/wordcloud-sample.png 295w,\n/static/704eab6cfb822de63938be47f6ccc745/fb8a0/wordcloud-sample.png 590w,\n/static/704eab6cfb822de63938be47f6ccc745/07c6b/wordcloud-sample.png 868w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h2 id=\"wordcloudの作り方（実装）\"><a href=\"#wordcloud%E3%81%AE%E4%BD%9C%E3%82%8A%E6%96%B9%EF%BC%88%E5%AE%9F%E8%A3%85%EF%BC%89\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WordCloudの作り方（実装）</h2>\n<p>自前実装の必要はありません。<a href=\"https://github.com/takuyaa/kuromoji.js/\">kuromoji.js</a>と<a href=\"https://github.com/jasondavies/d3-cloud\">D3-Cloud</a>というライブラリを使えば簡単に実装できます。\nさらに<a href=\"https://github.com/Yoctol/react-d3-cloud\">react-d3-cloud</a>というD3-CloudをReactで使うためのライブラリもあったので、それを使ってReactアプリを実装します。</p>\n<h3 id=\"1-文章を解析して単語出現回数をデータ化-1\"><a href=\"#1-%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96-1\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 文章を解析して単語出現回数をデータ化</h3>\n<p>kuromoji.jsは形態素解析で辞書を使います。\nkuromoji.jsをインストールすると辞書がバンドルされています。\nReactで使う場合は以下のように辞書の場所を移動して、辞書をブラウザから読み込めるようにしておく必要があります。</p>\n<div class=\"gatsby-code-title\">辞書をブラウザから読み込める場所にコピー</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">cp</span> -a node_modules/kuromoji/dict public/</code></pre></div>\n<br/>\n<p>kuromoji.jsの解析結果は以下のようになります。\n色々ありますが、今回は<code class=\"language-text\">pos（品詞）</code>と<code class=\"language-text\">surface_form（表層形）</code>または<code class=\"language-text\">basic_form（基本形）</code>のみを使います。</p>\n<div class=\"gatsby-code-title\">kuromoji.js解析結果の形式</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n  word_id<span class=\"token punctuation\">:</span> <span class=\"token number\">509800</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\">// 辞書内での単語ID</span>\n  word_type<span class=\"token punctuation\">:</span> <span class=\"token string\">'KNOWN'</span><span class=\"token punctuation\">,</span>       <span class=\"token comment\">// 単語タイプ(辞書に登録されている単語ならKNOWN, 未知語ならUNKNOWN)</span>\n  word_position<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>         <span class=\"token comment\">// 単語の開始位置</span>\n  surface_form<span class=\"token punctuation\">:</span> <span class=\"token string\">'黒文字'</span><span class=\"token punctuation\">,</span>    <span class=\"token comment\">// 表層形</span>\n  pos<span class=\"token punctuation\">:</span> <span class=\"token string\">'名詞'</span><span class=\"token punctuation\">,</span>               <span class=\"token comment\">// 品詞</span>\n  pos_detail_1<span class=\"token punctuation\">:</span> <span class=\"token string\">'一般'</span><span class=\"token punctuation\">,</span>      <span class=\"token comment\">// 品詞細分類1</span>\n  pos_detail_2<span class=\"token punctuation\">:</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span>        <span class=\"token comment\">// 品詞細分類2</span>\n  pos_detail_3<span class=\"token punctuation\">:</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span>        <span class=\"token comment\">// 品詞細分類3</span>\n  conjugated_type<span class=\"token punctuation\">:</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span>     <span class=\"token comment\">// 活用型</span>\n  conjugated_form<span class=\"token punctuation\">:</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span>     <span class=\"token comment\">// 活用形</span>\n  basic_form<span class=\"token punctuation\">:</span> <span class=\"token string\">'黒文字'</span><span class=\"token punctuation\">,</span>      <span class=\"token comment\">// 基本形</span>\n  reading<span class=\"token punctuation\">:</span> <span class=\"token string\">'クロモジ'</span><span class=\"token punctuation\">,</span>       <span class=\"token comment\">// 読み</span>\n  pronunciation<span class=\"token punctuation\">:</span> <span class=\"token string\">'クロモジ'</span>  <span class=\"token comment\">// 発音</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span></code></pre></div>\n<br/>\n<p>Reactコンポーネントでは以下のように実装します。</p>\n<div class=\"gatsby-code-title\">テキスト加工処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> kuromoji <span class=\"token keyword\">from</span> <span class=\"token string\">'kuromoji'</span>\n\n<span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`そこも場合もうその病気らに対して旨の時がしんませ。\n単に事実に使用方はどうかその応用たないでもが思いてならないがも発展思いうべきて、\n...\n`</span></span>\n\n<span class=\"token comment\">// 辞書格納フォルダパス</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/dict'</span>\n\n<span class=\"token comment\">// WordCloudの情報として抽出する品詞（助詞、助動詞などは意味がないので拾わない）</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TARGET_POS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'名詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'動詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'形容詞'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">// kuromoji.jsの解析結果の値で特に値がない場合は以下の文字が設定される</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる形態素解析は非同期なので</span>\n  <span class=\"token comment\">// 解析結果はstateのプロパティとしてコンストラクタで初期化しておく</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>\n      dataForD3Cloud<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 辞書を読み混んでトークナイザー（形態素解析するための関数）を生成</span>\n    kuromoji<span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dicPath<span class=\"token punctuation\">:</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> tokenizer<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// テキストを引数にして形態素解析</span>\n      <span class=\"token keyword\">const</span> tokens <span class=\"token operator\">=</span> tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\">// 解析結果から単語と出現回数を抽出</span>\n      <span class=\"token keyword\">const</span> dataForD3Cloud <span class=\"token operator\">=</span> tokens\n        <span class=\"token comment\">// pos（品詞）を参照し、'名詞', '動詞', '形容詞'のみを抽出</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> <span class=\"token constant\">TARGET_POS</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// 単語を抽出(basic_formかsurface_formに単語が存在する)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>basic_form <span class=\"token operator\">===</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">?</span> t<span class=\"token punctuation\">.</span>surface_form <span class=\"token punctuation\">:</span> t<span class=\"token punctuation\">.</span>basic_form<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// [{text: 単語, value: 出現回数}]の形にReduce</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> text<span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">,</span>\n              value<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> data\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      \n      <span class=\"token comment\">// 加工した解析結果をstateにセット</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>dataForD3Cloud<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 略</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> App<span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<h3 id=\"2-データをもとにイイ感じの画像出力-1\"><a href=\"#2-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E3%82%82%E3%81%A8%E3%81%AB%E3%82%A4%E3%82%A4%E6%84%9F%E3%81%98%E3%81%AE%E7%94%BB%E5%83%8F%E5%87%BA%E5%8A%9B-1\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. データをもとにイイ感じの画像出力</h3>\n<p><a href=\"https://github.com/Yoctol/react-d3-cloud\">react-d3-cloud</a>が専用のコンポーネントを提供しているのでそれを使うだけです。</p>\n<div class=\"gatsby-code-title\">WordCloud描画処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> WordCloud <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-d3-cloud\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// フォントの大きさを決める関数</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fontSizeMapper</span> <span class=\"token operator\">=</span> word <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span>\n\n<span class=\"token comment\">// フォントの回転位置</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">rotate</span> <span class=\"token operator\">=</span> word <span class=\"token operator\">=></span> word<span class=\"token punctuation\">.</span>value <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">90</span>\n\n<span class=\"token comment\">// フォントの種類</span>\n<span class=\"token keyword\">const</span> fontFamily <span class=\"token operator\">=</span> <span class=\"token string\">'meiryo'</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 略</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 略</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"App\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>WordCloud\n          data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>dataForD3Cloud<span class=\"token punctuation\">}</span>\n          fontSizeMapper<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>fontSizeMapper<span class=\"token punctuation\">}</span>\n          rotate<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>rotate<span class=\"token punctuation\">}</span>\n          font<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>fontFamily<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> App<span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<p>さて、ここで疑問を持たれる方もいると思います。\n前述の<a href=\"#2-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E3%82%82%E3%81%A8%E3%81%AB%E3%82%A4%E3%82%A4%E6%84%9F%E3%81%98%E3%81%AE%E7%94%BB%E5%83%8F%E5%87%BA%E5%8A%9B\">WordCloudの作り方（原理）> 2. データをもとにイイ感じの画像出力</a>で画像出力するには以下を決定する必要があると述べました。</p>\n<ol>\n<li>フォントの大きさ・・・・・☚コンポーネントで定義した👍</li>\n<li>フォントの回転位置・・・・☚コンポーネントで定義した👍</li>\n<li>フォントの種類・・・・・・☚コンポーネントで定義した👍</li>\n<li>フォントの色・・・・・・・☚コンポーネントで定義してない🤔</li>\n<li>表示位置・・・・・・・・・☚コンポーネントで定義してない🤔</li>\n</ol>\n<p><code class=\"language-text\">4</code>,<code class=\"language-text\">5</code>どうやって決めるのでしょうか？\n実は<code class=\"language-text\">4</code>はreact-d3-cloud内部でよしなり定義してくれていて、\n<code class=\"language-text\">5</code>はD3-Cloudがイイ感じに決めてくれています。</p>\n<p><a href=\"https://github.com/Yoctol/react-d3-cloud/blob/master/src/WordCloud.js#L91\"><strong>↓react-d3-cloud内部ロジック 色定義：WordCloud.js#L91</strong></a></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber 67\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">   <span class=\"token keyword\">const</span> layout <span class=\"token operator\">=</span> <span class=\"token function\">cloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">font</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">words</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">padding</span><span class=\"token punctuation\">(</span>padding<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>rotate<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontSize</span><span class=\"token punctuation\">(</span>fontSizeMapper<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> words <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> texts <span class=\"token operator\">=</span> <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wordCloud<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svg'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> layout<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> layout<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token template-string\"><span class=\"token string\">`translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>layout<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>layout<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)`</span></span>\n          <span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-size'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>size<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-family'</span><span class=\"token punctuation\">,</span> font<span class=\"token punctuation\">)</span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fill'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fill</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</span>          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text-anchor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token string\">`translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">[</span>d<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)rotate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>rotate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p><a href=\"https://github.com/jasondavies/d3-cloud/blob/master/build/d3.layout.cloud.js#L59-L73\"><strong>↓D3-Cloud内部ロジック 表示位置定義：d3.layout.cloud.js#L59-L73</strong></a></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber 56\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">    <span class=\"token keyword\">function</span> <span class=\"token function\">step</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> start <span class=\"token operator\">=</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> start <span class=\"token operator\">&lt;</span> timeInterval <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">++</span>i <span class=\"token operator\">&lt;</span> n <span class=\"token operator\">&amp;&amp;</span> timer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">var</span> d <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">        d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">        d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token function\">cloudSprite</span><span class=\"token punctuation\">(</span>contextAndRatio<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>hasText <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">place</span><span class=\"token punctuation\">(</span>board<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> bounds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">          tags<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">          event<span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"word\"</span><span class=\"token punctuation\">,</span> cloud<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>bounds<span class=\"token punctuation\">)</span> <span class=\"token function\">cloudBounds</span><span class=\"token punctuation\">(</span>bounds<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">          <span class=\"token keyword\">else</span> bounds <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>x<span class=\"token punctuation\">:</span> d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> d<span class=\"token punctuation\">.</span>x0<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> d<span class=\"token punctuation\">.</span>y0<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>x<span class=\"token punctuation\">:</span> d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> d<span class=\"token punctuation\">.</span>x1<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> d<span class=\"token punctuation\">.</span>y1<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">          <span class=\"token comment\">// Temporary hack</span>\n</span><span class=\"gatsby-highlight-code-line\">          d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-=</span> size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">          d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-=</span> size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token punctuation\">}</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">}</span>\n</span>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">>=</span> n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        cloud<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        event<span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"end\"</span><span class=\"token punctuation\">,</span> cloud<span class=\"token punctuation\">,</span> tags<span class=\"token punctuation\">,</span> bounds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>これによって以下のようなイイ感じのWordCloudを出力することができるのですね。\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/704eab6cfb822de63938be47f6ccc745/07c6b/wordcloud-sample.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 86.17511520737328%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEN0lEQVQ4yyWU2ZLaOBiFedh5jKnKzTzAZKlUkqlM1WRykUy2Jkl3oE3T0BCaZnWz2CzeMDYI4xVjVokz6pkLVUkq1dH5z/9JqVqt+ps8UEv67bcsEV4JknQujPWyYNYtYd7VhPPmUPhQuBc+l7vCuKkKYlkXKgVFsHq2oMuGIM0sQTLMS9G08oXr/B8pfaJmElDAk4GggwPtANAA38GBzypagCtljaK+BjYJMDWwnS4Al48dsOCHrpMDsntAnVrDlKKrX2J46FjuPtNzqBN6FPXXdFN6TOP+GUX5Gd1rt9RZULpW7ikdXfO9x5QJjyghEZ30lrQer4/fnBX0yaTFBfX0ihus6z59faOgSxIwuwX88wu2ioyd2Qda72FrBwTOFofOBZB9BDrMwtQXELtLlMOI1dd7qBNTTOnKIL3ZbuG5SzoxfUx9XkP5d5zyjxG5wF6q4zD+jiD2cGp9xKn5N0Iy5Rf1wC6f4qrt4OncZe+5Q8WYiKmBYaaxMQE5TQ9yxEOZAtWXYPWPWBMeYr+AQ+UJ9pEKGHdA8w1Y7S9suzkcf76G2rfQNm023B5h2JaYMq1ZGojBnDlddV3stBjHmQ8ot3B5ST+aI0Did9oq4rmBXeMTWOUVj+EtwvMzxIUbhLkLhukceksRUxPDSD+0a+25lHgBvAmB1mhi1GzAHUn40LDx5X4JlkSg6xAnsQ10qtisXC74FYmi4Z19wfSlBruucoezB4dAqOvU7XXhzWxIlSLk2xLEXAaRYyPdUPHkUsZZ08DFzQjS3U9g3sLJkXA8HaGM79ghjmDoNhdUlTT4wiczSrhtSzOgik1M+h30Sjc4xhZahoVfP/bxtqTiTV2GZi4QnIDVbIYke4koV2TeeIT+fVtMGaqaDuIjnNDnDI7h+3MMK2W0C1ewe1XkJQvP8yr0iCPlVPFO+hOZ8Rl6wQx9R0ZnVMQ+3rLIIZDbXPCBw2H4QHmNRlEFy1kNarOOAS9r1OvgWW6EwF/CUmV8H1zgfe8DvqtZtMZFTDhS91Yf69wVY4MhzAcOp6b5X4Z+4tE4GcI2yxjVb9Et5FC7+AZ7NsdIV7EJYrSsBl7WXnDBDHp6FUG2gFbAX+3XNFvlrtAQRTFlTf8XHIcLmtXSkAyRt7+BXjmPTukaoesiNkwUjDyyhoBz5RxfRmf4oWU4Oh2Qz58QZ/Jst3BQ7Mscm8nk7MgFJ6vloU7qbLQYMF28Z91iiS3sGVsJOeY/f8FUtc9K8k8mKS12J92wxlxmBS9hmqYxz0rTFULkh2Y7Zc/ccyDCet3H1CYgxMRxw2ANtsD2BDoYgIeDcOnxD8bDjrPKfwVsky3SXgL+rhAH19idljxXuZfSFO3NLiFxHM7tuWmTqaIQf7Eg/tIn8dIlG8chh+OO7OKYROuEbOINOUYLkng2WUcrkkQB2SSHubucebe9av5fm6Gzz267ZFMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wordcloud sample\"\n        title=\"\"\n        src=\"/static/704eab6cfb822de63938be47f6ccc745/fb8a0/wordcloud-sample.png\"\n        srcset=\"/static/704eab6cfb822de63938be47f6ccc745/1a291/wordcloud-sample.png 148w,\n/static/704eab6cfb822de63938be47f6ccc745/2bc4a/wordcloud-sample.png 295w,\n/static/704eab6cfb822de63938be47f6ccc745/fb8a0/wordcloud-sample.png 590w,\n/static/704eab6cfb822de63938be47f6ccc745/07c6b/wordcloud-sample.png 868w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h2 id=\"その他：日本語長文サンプルの準備には「すぐに使えるダミーテキスト」が便利\"><a href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%EF%BC%9A%E6%97%A5%E6%9C%AC%E8%AA%9E%E9%95%B7%E6%96%87%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AE%E6%BA%96%E5%82%99%E3%81%AB%E3%81%AF%E3%80%8C%E3%81%99%E3%81%90%E3%81%AB%E4%BD%BF%E3%81%88%E3%82%8B%E3%83%80%E3%83%9F%E3%83%BC%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%80%8D%E3%81%8C%E4%BE%BF%E5%88%A9\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>その他：日本語長文サンプルの準備には「すぐに使えるダミーテキスト」が便利</h2>\n<p>WordCloudを作るときにテキトーな日本語文章を大量に用意する必要があります。\nそんな時は下記サイトが便利でした。</p>\n<p><a href=\"https://lipsum.sugutsukaeru.jp/index.cgi\">https://lipsum.sugutsukaeru.jp/index.cgi</a></p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Pythonじゃないと形態素解析とWordCloud生成は無理かなと思っていましたが、JavaScriptでもライブラリが提供されていました。JavaScriptであればブラウザ上で処理を行えるので、たとえば入力フォームに入力した文字列をインプットにWordCloudを生成するなど、インタラクティブな操作が可能です。ただし生成に時間がかかるので、実際使うときはユーザーに生成中の旨をフィードバックするようなUIにする必要があるでしょう🍅</p>","fields":{"slug":"/wordcloud-with-kuromoji-d3cloud-react","title":"React + kuromoji.js + D3-CloudでWordCloudをブラウザに描画","date":"2019-05-04T12:40:00.000+09:00","excerpt":"なにこれWordCloudをJSだけで生成したい。Pythonとか使わずにフロントエンドだけでやりたい。というモチベーションで、kuromoji.jsとD3-Cloudを使って文字列をインプットにWordCloudを描画するReactアプリ...","tags":["React","kuromoji.js","d3.js","d3Cloud","形態素解析","WordCloud"],"keywords":["React"],"thumbnail":"/thumbnail/2019/05/wordcloud-with-kuromoji-d3cloud-react.png"}},{"html":"<p><img src=\"/thumbnail/2019/05/posts-relation-map-with-cytoscape-in-gatsby.png\"></p>\n<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"https://takumon.com/gatsby-related-posts-like-hugo\">以前の記事</a>で紹介した<strong>タグとキーワードから関連記事を算出するロジック</strong>と、<a href=\"http://js.cytoscape.org/\"><strong>Cytoscape.js</strong></a>を用いて記事の関連情報を視覚的に確認できるマップを作りました。\n今回はそのマップの紹介とCytoscape.jsを使ってみた感想です。</p>\n<h2 id=\"記事関連マップ\"><a href=\"#%E8%A8%98%E4%BA%8B%E9%96%A2%E9%80%A3%E3%83%9E%E3%83%83%E3%83%97\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>記事関連マップ</h2>\n<h3 id=\"使い方\"><a href=\"#%E4%BD%BF%E3%81%84%E6%96%B9\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使い方</h3>\n<p>URL: <a href=\"https://takumon.com/map\">https://takumon.com/map</a> <br/>\n遷移方法: 一覧ページのCytoscapleアイコンから遷移できます。 <br/>\n\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 94.04666130329848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABcRAAAXEQHKJvM/AAAE5UlEQVQ4y51Sa0yTVxg+crGi3Ec0UaZz6BBoaaEX2tIPRJA473MzTqYxzjCzMBc3URK8bGLGNmVziS66TaeOMBN0Ix+WIoKIbga5iDgsRRGh5SsWykcpwyjzlGenNdv/7STP97znefM9533PeUlGSMwny8Pj6taFxVW+HRZvzA1NML7PkMfwcUiCsXC61HgoUGYs9pMZjzAuCZAZvw2QG08Gyo2npyiMZUTuxaULRFF9LlBWStaExdXkvqRCXmQSCiNU+DxMjS9CGTMcD1LjtESNs/5qlBMNLgZqYJyqQe1ULS77a/Ebwy3CwLhrhgENoWoX2RwaX7ErUomCGbKJA8GJdF94Mi0OSabHpqvoOYmang1S03OBalrup6G/TNVQnmlVAUm0XqKiN4NTaGuknrZF6Z93ztSjebbGRraFJfDMBF9Gc/RIpBaf+UtxnMjxA0lAGZHiPInHRcaVbF9DZKgPUKIxikNzuA6t0xS4M00Oc4TSI8znYF6gFciHYVK+WJKIs0u30hu7v0JNTgFadh+FiXsXv6/PR0tuEVrfyMcfG/fi7ro9aFu0BvaSM7DuOoz+vCII2/fDkbPDIy7UoDtRL5D8YBn/dZASJ2Zy9OrGAlzftBdNW/ajedM+3F6bj/YVH6FjfQHu5x5E58o83EtcC+u2Qgibd2FoxwGMHj4O96ESjztWib6UVIEUBkn5k+zyvyMKepq1VMrau8Da44nC12IdwzWSiMYAOVolCtxjD3d/pgp90WrY5qowrEmHKy3TM2Hg4MjWCaRomoz/0U+J0kVLaNni11ETmYG6sDRcDzKgeVYWWuZk4u7cJTDPz0JP3FJY5ctgi0vHQFwqRFUaxjkDxvSpHqxMw/BadofFEilfTlJgUnO0OkOF8ujFKF3wDvj0zbiRuQLml7PQ+Vo2HjIzISkbA5plcKqXQEw24M80Dk+zOTxbbvBgE4fhDczwqL+Mr2SGF9loXJmegiq/ZFQHc2iYk462eTp0RWnwMFqLR/N1sC/U43GsDiNqA55kcZhYxeH5ag40h1W41QBxq0og3xM5X8eGs4Ko6OUpKjQy0zY23JaoFNyfpcPDeamwxqTiiVQFV3Kqr6rJTD0mmRneNICuN2DyPZ0Hu1MwsjdeIKf8FPy1AD1qJSlsULVojdDBPFuP7lcMsMZyeJzAYVCbgarVeTiScxgluUchrMlG4+ql6M/JAHZqMblH40GREiOfLxTITySWb2EvetM/kbZK5OgIUcASkYTeOcmwxyjhildiUJOKVdsrIdt5G9wHN3BmwxaUL34VFW9pIRZK0XUs3vPoYAzs34QL5M6J8/xfl29huKKOuvirGLt0FeOmejy9Uo9ndfWgDYwbGtB72wJTrQWV1fcw1GBC/akTMNf8Ck/3FTx5VO3x2Grh7PhZIAOuYR4vFsX/Xx7vxzU2IZCuTovPUBxyUpcowjUsYnRkBN54yOHA2OioD07nMNzuMYjiiC/vdrngeDwAa18vXCOiz1AUnQLp6OiocDqdePDgwQQD7e7upl7u6emhFouF9vb2Upb/V/PmvZogCL59e3s77e/vf/7CULQR9lONd+N2u70C2AEYHBzE+Pj4f+6bebhIU1PTp3a7/VpfX5+RsclqtZrYiSabzeaDN/bqXnhjVpmPvWCV/qNVORyOGrPZXPY3DrvXghXs5/YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"map link\"\n        title=\"\"\n        src=\"/static/406f832b6971112a20ac87e06f027a1e/fb8a0/map-link.png\"\n        srcset=\"/static/406f832b6971112a20ac87e06f027a1e/1a291/map-link.png 148w,\n/static/406f832b6971112a20ac87e06f027a1e/2bc4a/map-link.png 295w,\n/static/406f832b6971112a20ac87e06f027a1e/fb8a0/map-link.png 590w,\n/static/406f832b6971112a20ac87e06f027a1e/526de/map-link.png 885w,\n/static/406f832b6971112a20ac87e06f027a1e/fa2eb/map-link.png 1180w,\n/static/406f832b6971112a20ac87e06f027a1e/2b7c4/map-link.png 1243w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n<br/></p>\n<p>記事のサムネイル画像が、タグ・キーワードの関連線でつながっています。\n記事はドラッグ＆ドロップでグリグリ動かせます。\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e647bf984a2eb73a989cc699b2236e11/b40d2/map.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 67.08520179372198%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC0klEQVQ4y01Ty27bSBDk7+19z2Gwf+BvySWXAIYR+JRFTsnGsUXJUNaxY2dlxbYsSqJMSiTFl6gXn8OZqQyHXiUNNBqcnqmu7i4qlmV9wW9GigpFUaIsS+x2OxBSwPc3CL1if2cTBjJWeYaVaezPPc8zFdOanbEshWdMCAMYKQmLoiVzXYfdXQ/Z09Rls8srtjMGIg22XUZM//yBrZOERZ7H5jdXjFBa1YC2bQ+VueNqNI4w793Q+gU4x2RswHYchGGIIF5hcfIPSuPfpgNKsU5SzB4foH//hoxxcFGozjmOoyvD8UR7ZkwbPC4/fHuBx/8G6F3cIavYvi39+hKD/i3m4xGmtz3YMwujyy/yguu6unL25rVWpikqQugu9FFVkj0iW7AzF9jEGYqsgOm4WO0SRMMHBDMT44d7jIdDkY8RPt5LwIXn6cpdtyMZblcxNc5bKPJ8z6ZuhlKCkhAsk3zPvm4lGNxhLYCfTQIauq4rphtIQMYYfY6i6hasovjWu4XlLJoN+j4s22k6EMCpUEKSZVINtGpm0tfOdKX79pUETJKMxuEK6/Uakx8W8rREvFmLRw3jaBnD9Ru5UFHMDgLMHBu+OPeWYdPyYqEr/YuPEnDpb6hjBgJ4J1nWlgkGhJQwZ3M4bsP04voeo4kpR5MInW6EF/R5y7atK5a9aNUfaZrSvMh5FC75ba/P43jF/37/ngux8qfZnI+MaT1AniSp8ETkYx6EEY+XIXdGpww8E0XFUizrSavxfT9kRVFACBvb3UYuYLvdiqXQ338kmHMPg+EYI8PCTX+EMt8inrwTxWpAf6RMp1PJkBBS64VXtOKiVS6GLxnVnpcFn0yfeCk6cP2Y+2HMaxPF/r/zS9iHh4d/dLvdv9pt7YWI6tHRkXpwcKCenJyomqZJP2211E+np2pLxOurr+rV5YXabrfVTqcjz1pnn9Tz887L4+PjP38COHm56SUtcw8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"map\"\n        title=\"\"\n        src=\"/static/e647bf984a2eb73a989cc699b2236e11/fb8a0/map.png\"\n        srcset=\"/static/e647bf984a2eb73a989cc699b2236e11/1a291/map.png 148w,\n/static/e647bf984a2eb73a989cc699b2236e11/2bc4a/map.png 295w,\n/static/e647bf984a2eb73a989cc699b2236e11/fb8a0/map.png 590w,\n/static/e647bf984a2eb73a989cc699b2236e11/526de/map.png 885w,\n/static/e647bf984a2eb73a989cc699b2236e11/b40d2/map.png 1115w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>関連線はタグよりもキーワードのほうが太くなっています。\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/15ce0e664fd8d919af584ecff2b15472/184bd/map-relation.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 64.15094339622641%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACcUlEQVQ4y4WTzW7TQBDH94QQEsoBKeVYQcWlPACHCqlBlXiA8h5cOHDlgMQLcOLEhQNHeiiXFKtdpSku0ECiVPlwEjt27DhOYuc7uxlmFhtSJMRKI3t2Z/8z8xubFQqFN7Ztf7cs66zZbOq1alVHX5nv+7rrunqtVlNWKpXUnuM4Osbrnuep8yAIPvf7/a/oZ1mr1cqhA81WCyzThLZtg2E0gHMOGAx/LyEESCl/+yi2fjZhFxcXR0/29+Hhzs4ik8nIx3t78tHurvxwcCAxI928YoPBQKKInM1mEgWUj0uQ4GKx8NlpPq/dSqXgBmOCMQYPUjfh7vVr8DGbVVnH4zFge4Di0Ol0oF6vQ6PRoMvqfLlcUsUyrjBguq5r97e34XY6LdIbG3BvawvubG7CJ02D6XSqBEmoWq0CcgVkCQaKnus6IH+oVCqA2CQlbbfbAcNsGmUvX14KuvSjWKR3mM/nSgxbU4JU1XA4VOag//TZc/hWKMIEY6IoklQxxgcMlbWEaQJ3hpVRKyRKz9VqpYRoeHTmel04yX9RsZZlw2Q6lTHDgJmmqcUsBE0wmVzX95VQskfVJtNN9iaTieIbhqE6QER/BGlSJED2K3isBtHr9aDjOOoisoIiIsEWlRgxJiRTnDglw46uCiYVDMMQXrx8Bcc8h/wcqOEQ6kZdidGU17/DeMm4SyV4FAsu4u9JdFxPvH33XrieL6JoJAqHORHavog5UyciLiCxZcywy3DUZ/CPFYaRetpFA+R4Dv9byHbOyuXya+RxjmCPkQ0nw3duWSY3DIPjf8tN2+Jm2+L4V/DRaMSTuDU7wf1T/AoOfwKLYaonzELSHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"map relation\"\n        title=\"\"\n        src=\"/static/15ce0e664fd8d919af584ecff2b15472/fb8a0/map-relation.png\"\n        srcset=\"/static/15ce0e664fd8d919af584ecff2b15472/1a291/map-relation.png 148w,\n/static/15ce0e664fd8d919af584ecff2b15472/2bc4a/map-relation.png 295w,\n/static/15ce0e664fd8d919af584ecff2b15472/fb8a0/map-relation.png 590w,\n/static/15ce0e664fd8d919af584ecff2b15472/526de/map-relation.png 885w,\n/static/15ce0e664fd8d919af584ecff2b15472/184bd/map-relation.png 1166w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>記事にマウスカーソルを合わせると拡大され、関連線が青にハイライトされたり...\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b66fb19bd8083acf7c142c725a9445b5/87add/hover-style.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 68%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACvklEQVQ4y31TyXLTQBD1h/Ib3Dlx5gA3Ci6hUlBcgEog+BAsx0SExLGz2onj3bI10tja15YeLSWBBFJ0VZdmetQ9r9/rqbTb7eeWZbVM0/wupVQL571q27bquI4axr7q8tdaWarjOKWfn3fUZutAbezsqm9efVS3txq7rdbhj8FgsFOZzWY1/GVxHMPzPVjSQf98CmmskKQJDMMozwo7rB/C0la43OhDzrzrxByojMfjrWKdZVmS5znxknRNkD6fkzYWVP90RKPenAxT0MnxCem6TnEc0YeXNaq9bdHB+glNL8wiL0+TNKpMJpNqWZyLsZcXycUSh7UuLppTDM8WWJkudKGDu8FyucRikUKbBOCLMB4YsJd+mZimafJgwTRJ0NzRcFAbQq2eQnBrt2ZZwOpmm6TxbbhMJKKHCwZBjpX1h9Mw8uH7MXOYQ8qsjHmuh9FoVBQpcv9fsN+PMRnHHMuKA76AsL8vcXwsEUXXqHw/AE8IwjD8jfBeyywKFfE0zXF5GcE00/K/OM4ZGdDr+Tg768C2r6FzMoQQ91pmQHcQZqXCKKZCiLwAxmiKNeC6t1QEvPbYXS5sgxWH7S6xss2c55j5tZJiDqucjsl0QrPZFFdXQ2iajzBgJbWYW6O7IEpzHIvbbaHZbKK+0UJ9s53P53MWa5lUFmJR1YcCZwcdIu46YYWL4Y2SmBMd5ii6FibMGBnxl2lhas/3LjCZDfGi8RgbjfflbRmypGIH9tbm66948uhp3B9P6WfziDrdPvU6Q5JyxZ4QU0DdbkSdTkiaRmTZoIv2iD6vq7T2bo2qXxTKU2QpJWHFkKLuLnxctQewmJ9ub8iCWHCFd+855jn+NbrjN1Y5PTl95rj2Hhf+JoSuLKVUDEMogp2fpSKlqfi+y+4onucoTIPCgigsjOIHnuIFHA/cIl7nV7T9C3DXFXIT1dw5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"hover style\"\n        title=\"\"\n        src=\"/static/b66fb19bd8083acf7c142c725a9445b5/fb8a0/hover-style.png\"\n        srcset=\"/static/b66fb19bd8083acf7c142c725a9445b5/1a291/hover-style.png 148w,\n/static/b66fb19bd8083acf7c142c725a9445b5/2bc4a/hover-style.png 295w,\n/static/b66fb19bd8083acf7c142c725a9445b5/fb8a0/hover-style.png 590w,\n/static/b66fb19bd8083acf7c142c725a9445b5/526de/hover-style.png 885w,\n/static/b66fb19bd8083acf7c142c725a9445b5/87add/hover-style.png 1100w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br/></p>\n<p>記事関連マップをフルスクリーン表示できたり...\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17d62e7816cad650aef03928e4c91916/15240/fullscreen-button.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 47.3811833171678%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABcRAAAXEQHKJvM/AAABxUlEQVQoz41Rya4TMRCcT+YjOPEkkLhwCkgIcQFuXLiwJ0AShEZKQgghTCZxJok9+2KPt6Zt8fSegAMltWZst8tV1UEYho+Xy+WP1er7jLF0UZTVoqzqRdM0vuq6/quqqvqz5tj7lRAyCg6EjAEhhIArWLDWgpQSjDHwvyjLsgrG0/B9UXFgaani/ck8ex2bF58ORill+r73X3zA4APmEpxz03Wd0Vr7tTtzhEVRnINX7ybDp89fwp17D/SHyQxu3P0CNx8uwPVUdQ1t3QJaguPpBJRSr+T+YAC3L27BpbOyKG3TtJCmKQ0oPQ+n4RwGj57o65YxE08keuGswOrnHi9k0LStUwKo0Hd2LYfoW2J7oSDPcxpsNpvhbxZN4ikwuoW+V7DbxZBmmWvyxA55xoDEW+CoSggOh+PeP4bqLMe1J4yiyBPiAPR8cmEP25F1Eo3RFjOy+2Ni94T4PQCfpP+vy9qG4czi1C1mamnCICFHTzjyJt1Y/4HrmxmqUfoqGSk0ICE6EtBUHdATS4P1ev3GHfZK8+3HtzJLiFTGyDzLJE5ZokrZcS7btpOEUZmcz3L8eSYxY8k7LuNoJ1Fhj44US1nyC9gLpNpvP95EAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"fullscreen button\"\n        title=\"\"\n        src=\"/static/17d62e7816cad650aef03928e4c91916/fb8a0/fullscreen-button.png\"\n        srcset=\"/static/17d62e7816cad650aef03928e4c91916/1a291/fullscreen-button.png 148w,\n/static/17d62e7816cad650aef03928e4c91916/2bc4a/fullscreen-button.png 295w,\n/static/17d62e7816cad650aef03928e4c91916/fb8a0/fullscreen-button.png 590w,\n/static/17d62e7816cad650aef03928e4c91916/526de/fullscreen-button.png 885w,\n/static/17d62e7816cad650aef03928e4c91916/fa2eb/fullscreen-button.png 1180w,\n/static/17d62e7816cad650aef03928e4c91916/08f6a/fullscreen-button.png 1770w,\n/static/17d62e7816cad650aef03928e4c91916/15240/fullscreen-button.png 2062w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br/></p>\n<p>記事クリックで記事ページに遷移できたりします。</p>\n<h3 id=\"過去記事を視覚的に俯瞰できるのでとても良い\"><a href=\"#%E9%81%8E%E5%8E%BB%E8%A8%98%E4%BA%8B%E3%82%92%E8%A6%96%E8%A6%9A%E7%9A%84%E3%81%AB%E4%BF%AF%E7%9E%B0%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%AE%E3%81%A7%E3%81%A8%E3%81%A6%E3%82%82%E8%89%AF%E3%81%84\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>過去記事を視覚的に俯瞰できるのでとても良い</h3>\n<p>以前から関連記事機能は実装していましたが、記事関連マップにすると俯瞰できるので、改めて気付いたことがありました。\n記事関連マップを見る限り自分のブログのメインコンテンツとしては以下ですね。フロントエンド多めです。</p>\n<ul>\n<li>Gatsby(ちょっとReact)</li>\n<li>Vue.js + AppSync</li>\n<li>Angular</li>\n</ul>\n<p>また、まったく関連が存在しない記事も幾つかあることがわかります（Git,Vimあたり）。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5ce63ed33e6b3fe46bb57ad1e4380691/71f4d/no-relation-posts.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 47.27272727272727%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACCUlEQVQoz12QbYvTQBDH8zFFUfSNIuihvtKioJ9CbBQ5RBAPDqkvxAOh0vTBs2DP3J1nT+hDsnnYPCdNmm0yO27SXgX/MLvLf3Z+zIxkWfYhCvmhiyxPMUlijKIIi6JA4Bw9P0IviDBOUlwsFsgYwyzNhB+i43iYCK/yK2na/FAilq+gt4/+lysFaV+G3GhBmiOIPAxHP+H6rR3YefAQ9vZbsCoK4GUBvzQKrz+N4GXrFHrHAWTLZbEGaopETLeLeQezH4/LYNRAHnSwxLW+Kj28dO0m3rn/CF+8eoMXUkYH+PT5VXzWvI3vP7/FVbmqSwghXak6Nv9K/E9FCVh9rYIVgABQ+1mWInUNpJ6OYUS3tTXQMIwaSD2/DOJE7MWpEpimKSLfkMXNxT5LKOt7K1jn8jz/B6SUKtpcw9+HnXJ+NOTHqsp93+eiG+76lKtnR/z0XOVzMuVhGFU07niU/5mM6zBtg/uimQ1QkTzX6anjMc6e3OXqvRvYHQ63DSSFix8HH3Cv8w4Xhbf1aWjgwaCFw5mC02C8maEG9qqR21EcY3B2spx8/8ZM22Iix0SHLM0TRkOTWYHBsnzBOHAmSlmchmxCzpnmTpiXUAYlLCugruttqd/vN6ht7+qO27TDSDZNU57NZnVoc102iSVbhlW/L3xdIzK1HOHbMtENeTqdNolOdgeDQeMvXzeKnvgQ4tgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"no relation posts\"\n        title=\"\"\n        src=\"/static/5ce63ed33e6b3fe46bb57ad1e4380691/fb8a0/no-relation-posts.png\"\n        srcset=\"/static/5ce63ed33e6b3fe46bb57ad1e4380691/1a291/no-relation-posts.png 148w,\n/static/5ce63ed33e6b3fe46bb57ad1e4380691/2bc4a/no-relation-posts.png 295w,\n/static/5ce63ed33e6b3fe46bb57ad1e4380691/fb8a0/no-relation-posts.png 590w,\n/static/5ce63ed33e6b3fe46bb57ad1e4380691/526de/no-relation-posts.png 885w,\n/static/5ce63ed33e6b3fe46bb57ad1e4380691/fa2eb/no-relation-posts.png 1180w,\n/static/5ce63ed33e6b3fe46bb57ad1e4380691/71f4d/no-relation-posts.png 1320w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br/></p>\n<p>知識は点よりも線にしたほうが強みになるので、今後記事を書く際は、そこらへんの記事の関連線を増やしていく方向で学習を進めようと思います。</p>\n<h3 id=\"今後の予定\"><a href=\"#%E4%BB%8A%E5%BE%8C%E3%81%AE%E4%BA%88%E5%AE%9A\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>今後の予定</h3>\n<p>現在、関連度算出はタグとキーワードの重み付けという非常に簡素なロジックです。\n今後は、記事本文を解析して関連度を詳細に出したり、記事の傾向を解析したり、WordCloudを出したりと色々機能追加できそうです。</p>\n<h2 id=\"cytoscapejsを使ってみた感想\"><a href=\"#cytoscapejs%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9F%E6%84%9F%E6%83%B3\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cytoscape.jsを使ってみた感想</h2>\n<h3 id=\"概要\"><a href=\"#%E6%A6%82%E8%A6%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>公式ドキュメントは充実しているので実装方法に悩むことはありません。\nCanvasで描画するので、オブジェクトのスタイル指定でCSSは使えないのが若干もどかしいですが、CSSに似たプロパティ設定することで非常に細かいレイアウト調整ができます。\nまたオブジェクト毎にイベント発火時（hover, click, mouseover, etc...）の処理を指定できます。こちらはjQueryっぽい実装です。</p>\n<h3 id=\"テーマ\"><a href=\"#%E3%83%86%E3%83%BC%E3%83%9E\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>テーマ</h3>\n<p>公式サイトでは多くのテーマが紹介されています。\nインストールしてuseするだけで簡単に使えます。</p>\n<div class=\"gatsby-code-title\">テーマの使い方</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> cytoscape <span class=\"token keyword\">from</span> <span class=\"token string\">'cytoscape'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> coseBilkent <span class=\"token keyword\">from</span> <span class=\"token string\">'cytoscape-cose-bilkent'</span><span class=\"token punctuation\">;</span>\n\ncytoscape<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span> coseBilkent <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<p>テーマごとに豊富なオプションが用意されており、以下のように調査できます。</p>\n<div class=\"gatsby-code-title\">テーマの調整</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>CytoscapeComponent</span>\n  <span class=\"token attr-name\">layout</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'cose-bilkent'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Whether to include labels in node dimensions. Useful for avoiding label overlap</span>\n    nodeDimensionsIncludeLabels<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// number of ticks per frame; higher is faster but more jerky</span>\n    refresh<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Whether to fit the network view after when done</span>\n    fit<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Padding on fit</span>\n    padding<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Whether to enable incremental mode</span>\n    randomize<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Node repulsion (non overlapping) multiplier</span>\n    nodeRepulsion<span class=\"token punctuation\">:</span> <span class=\"token number\">100000000</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Ideal (intra-graph) edge length</span>\n    idealEdgeLength<span class=\"token punctuation\">:</span> <span class=\"token number\">700</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Divisor to compute edge forces</span>\n    edgeElasticity<span class=\"token punctuation\">:</span> <span class=\"token number\">0.45</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Nesting factor (multiplier) to compute ideal edge length for inter-graph edges</span>\n    nestingFactor<span class=\"token punctuation\">:</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Gravity force (constant)</span>\n    gravity<span class=\"token punctuation\">:</span> <span class=\"token number\">0.20</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Maximum number of iterations to perform</span>\n    numIter<span class=\"token punctuation\">:</span> <span class=\"token number\">2500</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Whether to tile disconnected nodes</span>\n    tile<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Type of layout animation. The option set is {'during', 'end', false}</span>\n    animate<span class=\"token punctuation\">:</span> <span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Amount of vertical space to put between degree zero nodes during tiling (can also be a function)</span>\n    tilingPaddingVertical<span class=\"token punctuation\">:</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Amount of horizontal space to put between degree zero nodes during tiling (can also be a function)</span>\n    tilingPaddingHorizontal<span class=\"token punctuation\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Gravity range (constant) for compounds</span>\n    gravityRangeCompound<span class=\"token punctuation\">:</span> <span class=\"token number\">1.5</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Gravity force (constant) for compounds</span>\n    gravityCompound<span class=\"token punctuation\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Gravity range (constant)</span>\n    gravityRange<span class=\"token punctuation\">:</span> <span class=\"token number\">3.8</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Initial cooling factor for incremental layout</span>\n    initialEnergyOnIncremental<span class=\"token punctuation\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<br/>\n<h3 id=\"拡張機能\"><a href=\"#%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>拡張機能</h3>\n<p>拡張機能も豊富です。ただ一部jQuery依存の拡張機能もあります。たとえば、ズーム機能を提供する<a href=\"https://github.com/cytoscape/cytoscape.js-panzoom\">cytoscape.js-panzoom</a>などです。今回jQueryは使えないので（GatsbyでReactベースなので）、ズーム機能は自前実装しました。スタイルや細かい挙動など設定項目が非常に多く、結構手間なので自前実装はオススメしません。</p>\n<h3 id=\"react-cytoscapejsハマりポイント\"><a href=\"#react-cytoscapejs%E3%83%8F%E3%83%9E%E3%82%8A%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>react-cytoscape.jsハマりポイント</h3>\n<p>GatsbyでCytoscape.jsを使えるようにするため<a href=\"https://github.com/plotly/react-cytoscapejs\">react-cytoscape.js</a>を採用しました。\nただ2点ハマりポイントがあったので紹介します。</p>\n<h4 id=\"1-wheelsensitivityが使えない\"><a href=\"#1-wheelsensitivity%E3%81%8C%E4%BD%BF%E3%81%88%E3%81%AA%E3%81%84\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. wheelsensitivityが使えない</h4>\n<p>Cytoscape.jsは、wheelsensitivityというプロパティを指定すれば、マウスホイールで拡大・縮小する時の拡大率を調整できます。これを設定しないとマウスホイールで拡大したときに、急に拡大されて、自分が今どこにいるのかわからなくなります。wheelsensitivityを使えば拡大率を調整できるので、それを防ぐことができます。\nただコレreact-cytoscapeではサポートしていません。そのため今回は拡大率調整を断念しました。</p>\n<h4 id=\"2-gatsbyビルド時にエラー\"><a href=\"#2-gatsby%E3%83%93%E3%83%AB%E3%83%89%E6%99%82%E3%81%AB%E3%82%A8%E3%83%A9%E3%83%BC\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Gatsbyビルド時にエラー</h4>\n<p><code class=\"language-text\">WebpackError: ReferenceError: window is not defined</code>というエラーが出ます。react-cytoscape.jsではwindowオブジェクトを直参照しており、Gatsbyビルド時に、webpackに怒られます。Gatsbyではwindowオブジェクトを直参照できないようです。</p>\n<p>対策は<a href=\"https://github.com/gatsbyjs/gatsby/issues/309#issuecomment-302043875\">GatsbyのIssue</a>にもあがっており、以下のようにライブラリの中身を直接書き換えました。</p>\n<ul>\n<li><code class=\"language-text\">node_modules\\react-cytoscapejs\\dist\\react-cytoscape.js</code>を書き換えます。</li>\n<li><code class=\"language-text\">window</code>を<code class=\"language-text\">windowGlobal</code>に置換します</li>\n<li>冒頭に<code class=\"language-text\">const windowGlobal = typeof window !== &#39;undefined&#39; &amp;&amp; window;</code>を追記します</li>\n</ul>\n<p>これでビルドが通ります。ただ手動でやるのは無理やり感があるので、npmのpostinstallのスクリプトで書き換える方法を検討中です。</p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>今回は、記事関連マップの紹介と<a href=\"http://js.cytoscape.org/\">Cytoscape.js</a>の使用感をご紹介しました。業務でもWebアプリでデータを可視化したいという要件は割とある気がするので、そんなときはCytoscape.jsの導入を検討しようと思います🍅</p>","fields":{"slug":"/posts-relation-map-with-cytoscape-in-gatsby","title":"GatsbyでCytoscape.jsを使って記事関連マップを作った","date":"2019-05-01T18:00:00.000+09:00","excerpt":"なにこれ以前の記事で紹介したタグとキーワードから関連記事を算出するロジックと、Cytoscape.jsを用いて記事の関連情報を視覚的に確認できるマップを作りました。今回はそのマップの紹介とCytoscape.jsを使ってみた感想です。記事関...","tags":["Gatsby","Cytoscape.js"],"keywords":["Gatsby"],"thumbnail":"/thumbnail/2019/05/posts-relation-map-with-cytoscape-in-gatsby.png"}},{"html":"<p><img src=\"/thumbnail/2019/04/vuetify-datatable-and-pagination-with-vuex.png\" alt=\"vuetify-datatable-and-pagination-with-vuex\"></p>\n<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>VuetifyのDataTableとPaginationを使った検索一覧画面でページングの状態を、ルーティングをまたいで保存しておきたい。という要望を満たすため、ページングの状態をVuexで管理する方法をメモします。\nDataTableだけだとすんなりできますが、Paginationもあわせて使う場合は少し雑な実装になってしまいます。</p>\n<h2 id=\"やり方\"><a href=\"#%E3%82%84%E3%82%8A%E6%96%B9\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>やり方</h2>\n<p>まずはストアに以下のように定義します。\nアクションには「ページングオブジェクト保存」と「ページングオブジェクトのページのみ保存」の2種類を用意します。</p>\n<div class=\"gatsby-code-title\">サンプル実装（Vuex側）</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vuex<span class=\"token punctuation\">.</span>Store</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  state<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    pagination<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      page<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      rowsPerPage<span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n      sortBy<span class=\"token punctuation\">:</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span>\n      descending<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  getter<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    getPagination<span class=\"token punctuation\">:</span> state <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>pagination<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  actions<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token constant\">SAVE_PAGINATION</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> commit <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n        page<span class=\"token punctuation\">,</span>\n        rowsPerPage<span class=\"token punctuation\">,</span>\n        sortBy<span class=\"token punctuation\">,</span>\n        descending<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> payload<span class=\"token punctuation\">;</span>\n\n      <span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token string\">'savePagination'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        page<span class=\"token punctuation\">,</span>\n        rowsPerPage<span class=\"token punctuation\">,</span>\n        sortBy<span class=\"token punctuation\">,</span>\n        descending<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token constant\">SAVE_PAGINATION_PAGE</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> commit <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> payload<span class=\"token punctuation\">;</span>\n      <span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token string\">'savePaginationPage'</span><span class=\"token punctuation\">,</span> page<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  mutations<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">savePagination</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> pagination<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>pagination <span class=\"token operator\">=</span> pagination<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">savePaginationPage</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> page<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>pagination<span class=\"token punctuation\">.</span>page <span class=\"token operator\">=</span> page<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<p>次にコンポーネント側です。\n<code class=\"language-text\">v-data-table</code>,<code class=\"language-text\">v-pagination</code>ともにVuexのページングオブジェクトを参照し、UIで変更があればVuexのアクションを呼び出します。それぞれのタグで微妙にやり方が違います。\nもう少しスマートにしたかったのですが、実際動かしてみた感じだとどうしてもスマートにはできませんでした。</p>\n<div class=\"gatsby-code-title\">サンプル実装（コンポーネント側）</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>template<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>\n      ページングはpaginationに任せるのでhide<span class=\"token operator\">-</span>actionsを指定している\n      pagination<span class=\"token punctuation\">.</span>syncにはgetterとsetterを持たせたpaginationを指定\n    <span class=\"token operator\">--</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>v<span class=\"token operator\">-</span>data<span class=\"token operator\">-</span>table\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">:</span>pagination<span class=\"token punctuation\">.</span>sync<span class=\"token operator\">=</span><span class=\"token string\">\"pagination\"</span>\n</span>      <span class=\"token punctuation\">:</span>items<span class=\"token operator\">=</span><span class=\"token string\">\"items\"</span>\n      hide<span class=\"token operator\">-</span>actions\n    <span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span> テーブルの中身 <span class=\"token operator\">--</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>v<span class=\"token operator\">-</span>data<span class=\"token operator\">-</span>table<span class=\"token operator\">></span>\n\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>\n      valueでVuexのページングオブジェクトを参照して\n      <span class=\"token constant\">UI</span>側からの変更は@inputでVuexのアクションを呼び出す\n    <span class=\"token operator\">--</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>v<span class=\"token operator\">-</span>pagination\n      <span class=\"token punctuation\">:</span>length<span class=\"token operator\">=</span><span class=\"token string\">\"pages\"</span>\n      v<span class=\"token operator\">-</span><span class=\"token keyword\">if</span><span class=\"token operator\">=</span><span class=\"token string\">\"pages >= 2\"</span>\n      <span class=\"token punctuation\">:</span>total<span class=\"token operator\">-</span>visible<span class=\"token operator\">=</span><span class=\"token string\">\"7\"</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">:</span>value<span class=\"token operator\">=</span><span class=\"token string\">\"paginationPage\"</span>\n</span><span class=\"gatsby-highlight-code-line\">      @input<span class=\"token operator\">=</span><span class=\"token string\">\"savePaginationPageInStore({ page: $event })\"</span>\n</span>    <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>template<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> mapActions<span class=\"token punctuation\">,</span> mapGetters <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'vuex'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n\n\n  <span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      items<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n\n  computed<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span><span class=\"token function\">mapGetters</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      paginationInStore<span class=\"token punctuation\">:</span> <span class=\"token string\">'getPagination'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n<span class=\"gatsby-highlight-code-line\">    pagination<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// Vuexのページングオブジェクトを参照</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>paginationInStore<span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// UI側から変更があった場合はSetter経由でVuexのアクションを呼び出す</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">set</span><span class=\"token punctuation\">(</span>pagination<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">savePaginationInStore</span><span class=\"token punctuation\">(</span>pagination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n</span>\n    <span class=\"token comment\">// ページネーション参照用</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">paginationPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>paginationInStore<span class=\"token punctuation\">.</span>page<span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">\n</span>    <span class=\"token comment\">// ページネーション用ページ数算出メソッド</span>\n    <span class=\"token function\">pages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pagination<span class=\"token punctuation\">.</span>rowsPerPage <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>items <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span>length <span class=\"token operator\">/</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pagination<span class=\"token punctuation\">.</span>rowsPerPage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n\n  methods<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span><span class=\"token function\">mapActions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      savePaginationInStore<span class=\"token punctuation\">:</span> <span class=\"token string\">'SAVE_PAGINATION'</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">      savePaginationPageInStore<span class=\"token punctuation\">:</span> <span class=\"token string\">'SAVE_PAGINATION_PAGE'</span><span class=\"token punctuation\">,</span>\n</span>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></code></pre></div>\n<br/>\n<p>これでルーティングをまたいでページングオブジェクトを保持できるようになりました。\n実用の場面では、検索条件もVuexに持たせて、ページングオブジェクトと連動させて使います。<br/>\n以上です🍅</p>","fields":{"slug":"/vuetify-datatable-and-pagination-with-vuex","title":"VuetifyのDataTableとPaginationの状態をVuexで管理する","date":"2019-04-28T20:30:00.000+09:00","excerpt":"なにこれVuetifyのDataTableとPaginationを使った検索一覧画面でページングの状態を、ルーティングをまたいで保存しておきたい。という要望を満たすため、ページングの状態をVuexで管理する方法をメモします。DataTabl...","tags":["Vue.js","Vuetify","Vuex"],"keywords":["Vue.js"],"thumbnail":"/thumbnail/2019/04/vuetify-datatable-and-pagination-with-vuex.png"}}],"previous":{"html":"<p><img src=\"/thumbnail/2018/react-slit-animation.png\"></p>\n<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>Slit Animationを実現するReactコンポーネントをCSSのclip-pathを使って作りました。\nSlit Animation(スリットアニメーション)は下記のようなものです。\nコマ画像を縞々にして合成した画像に、スリットを持つカバーを被せて横にスライドさせることでパラパラ漫画のようなアニメーションを実現します。</p>\n<p>デモはこちら ⇒ <a href=\"https://takumon.github.io/react-slit-animation/\">https://takumon.github.io/react-slit-animation/</a> <br>\nコンポーネントはnpmから落とせます ⇒ <a href=\"https://www.npmjs.com/package/@takumon/react-slit-animation\">@takumon/react-slit-animation</a></p>\n<p><img src=\"/animation-fa2410ba2fb6a4f63446413bfccccfe5.gif\" alt=\"animatino\"></p>\n<p><img src=\"/animation-inco-83306a709aca3018049ed4d392927fa3.gif\" alt=\"animatino\"></p>\n<p><img src=\"/animation-go-e367d0c2dfb6145fde488b4df114097f.gif\" alt=\"animatino\"></p>\n<h2 id=\"slit-animationの原理\"><a href=\"#slit-animation%E3%81%AE%E5%8E%9F%E7%90%86\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Slit Animationの原理</h2>\n<p>CSSやReactコンポーネントなどの説明の前に、純粋にSlit Animationの原理を説明します。\nSlit Animationは何個かのコマ画像を合成した画像とカバーから成り立ちます。以下では簡単のため４コマで説明します。</p>\n<h3 id=\"コマ画像\"><a href=\"#%E3%82%B3%E3%83%9E%E7%94%BB%E5%83%8F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コマ画像</h3>\n<p>それぞれのコマ画像を縞々にして１つの画像に合成します。\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ddcb9bfc8337fa63a92d150f4601bedd/8a2b3/description_image-mix.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 115.14195583596214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABcRAAAXEQHKJvM/AAAEpUlEQVQ4y5WUa1BUZRjHX9hFZ/zil0bJ+uBMKqWTfUkzI5ophYghEx0vY40DgqlcGo0YZzIdh4sICZPjZAikB1Zl8SAQE8SKIiwQiWZcLMVpL2fbRZBdQCF2OZd/z9mzEzFYk+/Mb57nvJffPs+Z9ywzmUzJv1sslfeGhs72ezxcv9vN+eM/clrjHlid3IjtAee2DXCeGTzghq2uczaL9UKjqfEwczidVVBHTg6QlgakpwMHDmioeWoq8GUBzrmuINnKId1qwIEAnxL7LeXIsF7wKwadAzeZRRDK1Ad5/nwvGBOfyIJF4trv9ojMGC4y/h2RVRGXiep1FN8W2aVIX//kAIYEVzOzOhwGv37pUnGIMdwJCYFJp8M1ooLyBprD8pWIaToIZojCnFOR0GVHQHc0HPpDbyAoYzXm1WyR7bIHg4Kr5W+h/MIScZQOD+j1cAbrYCfuUm5ThS+R8MpnYEYSctHQqZRGQV8UiaAz6zCvdrNsl9wzhXh2gdoensjixYhoIOHlWLCaTWC1Aeo2U9xIc1tkCwmHVKHNbvcL208bRVNWEZpyS9B0rFiD8sbM0/ipuBot98tg7DsCvi8bl3qzAmSjsicTl+/kyhImINj/aGEOu80vDM3rFVnGLbBD3WBf9FLsATvcB3bwNhYVWiDdjARaqdr2YOBHptEZwDxHBuywCEPTwiVHO0S2qxb6pCoEf8QheKcB+h3FYNtKsSynB2Nd6zFez+CsDsa98wy/GRh6uSD8XMrga57rF1pnCLNviCyBR0h8GXTbv4Zu6ymEfJADFleIsOO/YvxWFDy1DH1cCG4U6dByUoeGfD3qjzOI1+dpQvvgtPCZz9tEltgEtu860Uq0gKW0gSVdxcIjtzHSsRZoovaaiRamtW/WonKVyVAsWoVCQJhYcVeM+qYb7xf3IPZMN9GDDZTHUEytdUG0ZQJ33oXSuwFyTyzk7thAjKG5OKrQTRWq18Zq1a4NIOIJQ7D0o/xsCUrPnsd9i8s/R6ehBNYVDXUK5JoWSrIsSrICFYVQdzx0e9DR3oai4mKUfluKrs52eDzDARV1qUhkk2i/NFsoK4qoKPRbxIREt+rxOCYJL61NeX3wqc9q7pvCxOgoxh5PahXSfmK2UFGFsn8ej7o6UWGqQXVXBybbjKi6UgdjZysedVTih6t1KG+9DrfQERDK/yEURe3dpCRi+SfReM3wFbCdYU1KLF6+WAjsYdiUGIFFJ/MgdSf9P6F/JO9CWHIkXj13wi9ctfc9LC/LAz5m2JgQjoUncuC9nfgUQqrwxZQorOIK/MLV+2KwojzfL4xLeBOhBcfgeyph2m6sSIvGmjJqc4fW8koDVbtXbfktPFeYC98vu/9VqP1jy7JXEackeocS4rdJofGvS8vOZEuIZVLYzgjp+ZJMCR8yaf3WV6S5OYclb9d2SbttkkS+qYCwmdlsNn7WbTY3gzPX4KKlDzBloaK1DmXWXvrk8lF/7RKK+rqBieZZx8jVxcxm836Xy/W9IAhGh8PBOwSBd4yM8hMjj/jxh8O8bczHjwdyYcTLj40+5v8cdvOOgVHe4aC9dIbOVpKjhlzZfwGJHnHiCMphcgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"description_image-mix\"\n        title=\"\"\n        src=\"/static/ddcb9bfc8337fa63a92d150f4601bedd/fb8a0/description_image-mix.png\"\n        srcset=\"/static/ddcb9bfc8337fa63a92d150f4601bedd/1a291/description_image-mix.png 148w,\n/static/ddcb9bfc8337fa63a92d150f4601bedd/2bc4a/description_image-mix.png 295w,\n/static/ddcb9bfc8337fa63a92d150f4601bedd/fb8a0/description_image-mix.png 590w,\n/static/ddcb9bfc8337fa63a92d150f4601bedd/526de/description_image-mix.png 885w,\n/static/ddcb9bfc8337fa63a92d150f4601bedd/8a2b3/description_image-mix.png 951w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h3 id=\"カバー\"><a href=\"#%E3%82%AB%E3%83%90%E3%83%BC\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>カバー</h3>\n<p>カバーには等間隔で隙間があります。隙間幅は<code class=\"language-text\">縞々１個分</code>で間隔は<code class=\"language-text\">縞々１個分×コマ数</code>です。\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9fcd0d4999dd49f95f9cef706d822474/b5cbb/description_cover-slit.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 40.87591240875912%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABcRAAAXEQHKJvM/AAAB3klEQVQoz41QYW/SUBTtX/W7P8DEL37WaMS5mbkYMwbrarfJcAIpGodGt7AhjNUVal9BBqWswOugLYP27fggftDERE9ybt7NufecvCuUSqVbo9EoTSlNuJSKdDgQbbsrWlZH7Nm2SOlQdJxLsdu1RNd1eU//xiT32C0Wi7cF0zTX8Bvo1RiNZgunVRWV0zME1zN0LBvlyhn+BV3XtwXDMGKL7uZm4k/CsDcIQjqahH03CB3qh30ahAP+7jpe6I6nIZ8Moyj6gxzTuUWtVlsXCCFLvwJm05Ch+aPNhTrOv6kL/ieiedE0bUPgZcnzfHieN2u3bbQtF1+KFUjbMl7vpZHNKcjnc8hk9mG1Lb4a4eBTAZlcFjklD0VRkHmbjlqtJgxCFoZPIsYQeN60YV8yHsTqNcLkF0m2L2+x1NYGiyd22erLHda48hb6+1SW7cQ3WVqKM1ncYitrcliu6jBNbsgPuVLXNDR6PWD+xTt38e7oFWL+RzxTbTwvBWCuBHhPgeUHGD1+iOWhgtVuCbHjCAVDA8b3eU4ZNb25KVSr1XtWp9PvUar7qkqukyL5fKKQhHlApBONyEcNcmG8IWNTJP6eTJx0ikjGByKdH5Lk4QUpVL5ybf277xxb5Yr66CcBuTEn7CdgYgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"description_cover-slit\"\n        title=\"\"\n        src=\"/static/9fcd0d4999dd49f95f9cef706d822474/fb8a0/description_cover-slit.png\"\n        srcset=\"/static/9fcd0d4999dd49f95f9cef706d822474/1a291/description_cover-slit.png 148w,\n/static/9fcd0d4999dd49f95f9cef706d822474/2bc4a/description_cover-slit.png 295w,\n/static/9fcd0d4999dd49f95f9cef706d822474/fb8a0/description_cover-slit.png 590w,\n/static/9fcd0d4999dd49f95f9cef706d822474/b5cbb/description_cover-slit.png 685w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h3 id=\"アニメーション\"><a href=\"#%E3%82%A2%E3%83%8B%E3%83%A1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>アニメーション</h3>\n<p>合成画像にカバーを被せて横にスライドさせます。すると、カバーの隙間部分から<code class=\"language-text\">1→2→3→4→1→2→3→4→...</code>のようにコマが順番に繰り返し見えることになります。これによってパラパラ漫画のように見えるのです。\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a550dd3c72db23e4b3ff7c45eb1e9e22/4b878/description_slit-animation.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 66.73058485139022%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABcRAAAXEQHKJvM/AAADDElEQVQ4y02TW29bRRDH/RX5BDzy2geekBASCBQhXhBUoiICAkimWC1xTkswNEmbcAnUJA6x3SbYju1z87nuud9213/mHBe18zK7c/b8d34zs62zs7O3giA4MAyjO51OFU1VFduxFT8MFT8IlSj0Fce2FIcxxUlTxdR1xY1jZWVRzPMUNwgU0zD2GGO/9Pv9d1o6HQBZkedwHAei3kjAmi/hGEvcLBwUEhu7umocv75uvAhDVKaJ/01V1Z9bk8nkLokiYKy0AybK7zri/vb74rU7H4o3tr4UP+68LjR9ILDQRHz7U7EmHXV7W3AWCOPiQsx6vTpWYr3GYrHYbV1eXnaSJIFtWVwj4bVlI/QM6GWKoKrv9cF5AlmUyOl7lGWIVRVJHCF0bGQ2nY/jBowE91qj0agTxzE8z+PzmzlO+n0sdBO+a+OPx4d4dPQnNGPVIO1Pn8JmLszQw+GzvwBKrTc+hRv6LwXH43GHcCnjNa+D+hc7eHD3E2wNHuO9r3s4f/Q2bH3QCLb/6UH3LCwcHfcuDqiYFHu6jxVzNoLL5V5rOBx20jSFRcjmijKJIlRZCCtP4cUFHYvACV/KNcqqhOAcRVmgkgK8qlBQjHwjOJ/PN4I1su/7fDad4nQ4xMlvp5gNn6MsS1oPCNlCzbdYefjqaFT3Fw9PxxhMNERpgW+fPGsEl3WGNTJ7BVn7bBu3t27h1k/f4/OjK/T334S1PGuQr1ULH/zwd7PeObjA7+M5orzCR8r5S8E6w4w6Z9s2Ny3KJIopgYx6K+AmNA2VTchJg1wRYlZUlDlHmhdUAon63zQrXiDfbLrsum4tWNFLkYfHx7Lb3ZMPdnflCa2TyJGrlSlrS9JMZrErtcmxrDikOX0ikziUiT/jWD/HXHW7LWr1/frmuo61pfe6UNof491f93Gnd47K+AZ58G/zreI0J9yHNmpvXsawTQ3JkfljojrCwkgetqgzO3WVszR18zxnIopYlkb0bnIWpAXLEpf2MeOcszhJGA00SyKXxXHywkcsDGk4afKns5v2f++1rRFYsxEgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"description_slit-animation\"\n        title=\"\"\n        src=\"/static/a550dd3c72db23e4b3ff7c45eb1e9e22/fb8a0/description_slit-animation.png\"\n        srcset=\"/static/a550dd3c72db23e4b3ff7c45eb1e9e22/1a291/description_slit-animation.png 148w,\n/static/a550dd3c72db23e4b3ff7c45eb1e9e22/2bc4a/description_slit-animation.png 295w,\n/static/a550dd3c72db23e4b3ff7c45eb1e9e22/fb8a0/description_slit-animation.png 590w,\n/static/a550dd3c72db23e4b3ff7c45eb1e9e22/526de/description_slit-animation.png 885w,\n/static/a550dd3c72db23e4b3ff7c45eb1e9e22/4b878/description_slit-animation.png 1043w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h3 id=\"例\"><a href=\"#%E4%BE%8B\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>例</h3>\n<p>最初にお見せしたRreactのロゴがくるくる回るSlit Animationは下記のような構成になっています。コマを縞々にして合成、隙間のあるカバーを作成し上に被せています。\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/809b74624b351adf41e502a563039941/e0db6/description_image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 133.2132132132132%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAABcRAAAXEQHKJvM/AAAErElEQVRIx51WWU9bRxT2b0oVdjCVUinlLRUSqQKEvvGChNIXmiolDwEBfaGSzeaERYAUJKgQpDgJXiirocZmMyB2MGDDtQ1erte5/npmsAFVgVYd6+jMnHvmm7PNGauMRuOvu7u7xrW1tQ/Exw4PD8e2trbGtre3xxwOxxiX7e3tCRnnq6ur1+udnR0x39jY+IPmn1ZWVt6rzs/P50DD5XLh+PgYHo8H6UFK8Hq91+t4PI7NzU2Ew+FrWSAQEHqpEVYRiPHg4AD9/f0xrVbLBgYGGFnGFhcXWUtLC9NoNMxsMjOyjPX09LC2tjbB+XpmZkasiRKzs7M4PT11q8gl89LSEpqbm9nr2lq0t7fDYDBgaGgIdXV1aGhowEf9R1gsFuh0OtTWvkZHRwdsNhv0ej2amhpRX1+vjI6OckBJRS6aaYLOzk7WSmCDg4NYXl4GxRbvdG/R1tKK+fl5kDXo6uqCrr1NcPJAyHRv36G1TadMTExAlmVJRbEzM8awvr7OZk0mkCsiGNK5BOuKHeOTJsjBkJDxgz+Mm3F4dCTWkUgM1vlJbK5ZlEBQRjQakVTOoyOz+BqLMbS2IhGJQElF+E+vA/pTq5gn6cfHb6Y9RNiVhA/F/xfgGRZbYtGwxJMiAOVQiMk+H+HGoCQVcKsvA34E5RDisTgURSELoiQLkWVRJJNJkfVIJIxg0K+kquAG8OLignkI0JcCDYZC8EgeUUbBYFCUCp97PVeyCHki02Eej5evFb6HdG4AJUliZ2dnQjksy7i8vARfu9wu+P3+qwPoG69XjyTRZhn+QFDoUC0r/AAiSXVyciIACYDxIuab4+ROiAC8wiKvsI7FwtwLeH1++C7J7VgSkXBAeET7FO4+WXljIQlYjIRxihMdKwIuKww++ULMd31JyBS7SOAUcf8mkn4LpXmPQOJ871VSbgNSkFn6/iR3toFZCyTXLvRnDiztOrG1P00n2IGgjU53kpKMW+PLgDxzgsStjODCsQTT1jr83g2eNiqLEGIJ2hhPIkoTXgmpvfcDiiJ2u2GanILp02cq9g0CUPDmTT3Ky8pQWVmJp0+/x/DwsNAl4LsB012FXyUd3VmNVouBgfc4ottRVVWF/PwCFBUVISMjE93dPUI/kUjcD8hranx8XDQB3hB6e3uxv7+PFy9+xKNH3+DJk+9QUKBGX1/fvwOmQXmP4y5RO4PVahXFXV1djby8fDx+/C0ePswgC7vvB0zxdKBFc6UODuqPQjYyMiK60NycBSZqJLyPihTze3mfy2meCjgBzIn+t7CwgH+OlFf3u5w6EPTOoLS0DM+fV6CkpAQVFT+guLgYjY1NacvuB7yu0hSg3W5HYeHXIrPZ2TmCeOxevvz5tnX/HdBms0OtVhNgPrKysgXngK9e/fL/APlbo1YXIicnV1Bubh4yM7NQU1NzN6DT6TSmQOJEjBO7ulOMLGR5eXmMwNiDB18xclnwmpqfxPe0PlGCY1ADPlO53e4Z3DF4yfCEcCorK0d5eTmePSuFRqP9oj4Bh1T0ZDbTv4ApeqQ+0z8AQ5roQTfQPwHD9PS0gV434jOGqakpQfQKGm7rEo2T/gTp//433BBcuu86kc8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"description_image\"\n        title=\"\"\n        src=\"/static/809b74624b351adf41e502a563039941/fb8a0/description_image.png\"\n        srcset=\"/static/809b74624b351adf41e502a563039941/1a291/description_image.png 148w,\n/static/809b74624b351adf41e502a563039941/2bc4a/description_image.png 295w,\n/static/809b74624b351adf41e502a563039941/fb8a0/description_image.png 590w,\n/static/809b74624b351adf41e502a563039941/526de/description_image.png 885w,\n/static/809b74624b351adf41e502a563039941/fa2eb/description_image.png 1180w,\n/static/809b74624b351adf41e502a563039941/e0db6/description_image.png 1665w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h2 id=\"縞々をclip-pathで実現する\"><a href=\"#%E7%B8%9E%E3%80%85%E3%82%92clip-path%E3%81%A7%E5%AE%9F%E7%8F%BE%E3%81%99%E3%82%8B\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>縞々をclip-pathで実現する</h2>\n<p>今回コンポーネント化にともない「画像を縞々にする」という課題がありました。\n最初は、画像要素に白い長方形のdivタグをたくさん並べてトライしましたが、それだとコマ合成時に下の画像ごと隠れてしまいます。\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a17b201320db86123717996fb75b1ea2/17d9c/description_mask-pattern.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 72.50996015936255%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABcRAAAXEQHKJvM/AAADMUlEQVQ4y5WRS28bZRSGP6TCBv5D/wZCgh8AXbJgg1S2rChLtilJxSLtAgklrRqlkFaClEotcdQ7am137JDIl7Fjj+92M56b5+qZ8XjOzMsXOxJ0Q8WRHp0zGp1nvu8d1rLt0qtuN19WFOFgOBQkqS3AmglwYwHOnBMJoWMLmHHCMwJLMC1f0GwIOke1kDddlO4/2PuaYXsb5uXLiK9eRbx+DXVRwNYkhx3ONueuU4Bo+/i55OGX6hS3KlP8djxHMmsB7hYw3eH9JoCnePXy0RWGc+cwZmx+zBhF7B3K/H6N2L3PiP30MbH1D+mDXy/QpadFYhf3iX15m9jnm/TeN1nqVa7Q7D6j/h1GtetsTvnzKD7fWlkIJ1w2YAzgPNhdB7v3Kdj1T8B+/Ajv372AS08KYF89BLu4C/bFNt79VkCvsoZ4j2G8y9C7xQjF8yg840La3ISxukrm2hpCfmWpcYhN+TluDB9jY/QYO+M/cSDruFnQsHWg4UZRw+2Sg6lZAdQNQOfX1jYI0T6yLx6tMMU0Ue/1qNHpoGsYGHMQEdJZzHuCJJwjjeaYhT4oCpHGEfyphyAC+Cv4YYJpCOIhIvdin1+538fs+Jjsw78Ax0NvIuNIaaI0bqGu93EkN2BMPDysjJBvyii2VfxxNIBiTvkPb8NRDuGqZX5CEdnMD1zIT+aJIqmFAhLbQUd/jbLWhqh0IOlDVGQJlh3gSe0ExdYYRz0NmdIQqh0icgdwtTJcvUaY15HdW+VC30eoqhSMRkiDEJOpA9nRMfYM6L6FE0eD6/povDbQVSwMNAe1oQbTDRC4KjxrwBnxjAzknt1ZYRrP7LBUWmRYbzRQrYrodLtoSy3URBHjE5mnk2JZ6RtzysdTkvQsw3yBn5BXoGlkl8uwJAkmF9vNJpwgQMiJ4/hs8R/BYv7XB/jzUpjLLoWprlOYzSKo1eG1WrCrVQRESIiWawvZf3ImzC2FpBvk5F6mbr2eupKUutVqas+iNJ7P06XvrfWmEEmC2mlmzRpEqbHo0rCP/1v5fP575nmeY1mWrE8sRVVGiqrKnBPF0IaKY5uKbdtv5XTfdV0nk8l89zcyzBPwo6ORSwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"description_mask-pattern\"\n        title=\"\"\n        src=\"/static/a17b201320db86123717996fb75b1ea2/fb8a0/description_mask-pattern.png\"\n        srcset=\"/static/a17b201320db86123717996fb75b1ea2/1a291/description_mask-pattern.png 148w,\n/static/a17b201320db86123717996fb75b1ea2/2bc4a/description_mask-pattern.png 295w,\n/static/a17b201320db86123717996fb75b1ea2/fb8a0/description_mask-pattern.png 590w,\n/static/a17b201320db86123717996fb75b1ea2/526de/description_mask-pattern.png 885w,\n/static/a17b201320db86123717996fb75b1ea2/fa2eb/description_mask-pattern.png 1180w,\n/static/a17b201320db86123717996fb75b1ea2/17d9c/description_mask-pattern.png 1757w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>合成時に他の画像に干渉しないようにするには、隠すのではなく存在を消す必要があります。\nCSSの<a href=\"https://developer.mozilla.org/ja/docs/Web/CSS/clip-path\">clip-path</a>はまさにこのようなトリミング機能を実現するためのプロパティです。丸や楕円、任意の形にトリミングできます。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4023d173da17bcdfac26db1983743796/04f6f/description_clip-path.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 115.119852489244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABcRAAAXEQHKJvM/AAADu0lEQVQ4y5VVa08aWRjm77pFqxHFW9a18YNs/WQTPxg/rF3bUt2axbgVaGjSYlZTYyW0IBeBYW4Mci8wMHDw2fcMl6K0TfckT+acM2ee816e9x2L3+9flyXpXVpIuQkeQUh6+FMSBU8qlfQkk10kEonB/D7o3XE6nfZfXFw4LJqWOQGNXKmOSr2NWqODUrWFbLGBTgc/NTq9g8Vi8b1FksQ3DaONpKAY8USaJVIii10LLCnILF8osXK5zOr1OqtWq0zXdVapVMy9YZRKJYMT3tzcuC1kqo8vPn0KskcrK3A41rC8/Cs8bvfAgnA4jO3tbZydnQ0sur29HYDWbb5fKBS8A8JAIMDm5uawuLiI6elpHB0d4SStQy5Usf67A1brOObn55HNZk1STtQfNB8lvLy8ZDabzfxoamoKh4eH+CDryFUNvHi2i4cPJ7GxsQFyf0A4hFHCUCjEHj9ex8aTJ+S2Az6fb2ABxQ7BYBAUqxHrRiyUJKn/JfuZjN6zbNRCWZZ9bcq6ouVZ5qYINVuApOYhyDl010UomTxSokbIolyuoF6roTYEUkC7l+UuYU1vIZZUmKjkISo5JNJZxIUM4inVhKIVIRNEtYAv1RqRlk33+yD9fSUURdF0WVUktrv7FE7nc/z59A+cnv7bU22LEuTC3p4TL+nd8fHrEdl8MymfP4fMLNvtcxifmMCr/T0kSgwRKY/VR7/hgdWKsbExbG1t3Ynnd2UTiUQY1+DS0hJsMzNwH7nwLlXDR6EIn+cYz56/IKtPYRjGfbJvE1I1sIWFBaqSZczOzmJ//6//k+lR2fA6pXiC1qBLKNCF+ywj+hsad2XDF82mwXiwWS/gTaOFWl1HXW+Yz2HovT290TBD0Gw2TcJcLue1KIrsK1N5BSMiiwsaoikN4WsVoZiMcFyip4RASKC5jBhJ6DKUQjShIBAWkBBUVCrlgWyozr+6TOayaDSKWCzGEwRFUdBq0e2NhikTrjc6Q9Z30OCWNZtkWcOcU7hMwnw+fzcpPMsr1MLsdjsODg669Uhh427x9rW5uUnNQf9xDPuEV1dXA9lM22bgfX2IN7Ey3l5/wT9/v8IvD6yYGB/Hzs7Oj7uNIAhevqBuYkxOTnJxM6vVyl46nYxKnLXYLaPfBFtbW2Orq6tcCbyJ8AQyIjJB82bPZTclRTFrjNcnb6pu6tQul4tCcHXHJ+52vxd+bxCH33J+fr5ORf1e0zQ3ZcvbRcnLA6yqqjeTyXjpUi+XBN/jc743DDrnpgyfUE91/AeMy3O2M3RAHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"description_clip-path\"\n        title=\"\"\n        src=\"/static/4023d173da17bcdfac26db1983743796/fb8a0/description_clip-path.png\"\n        srcset=\"/static/4023d173da17bcdfac26db1983743796/1a291/description_clip-path.png 148w,\n/static/4023d173da17bcdfac26db1983743796/2bc4a/description_clip-path.png 295w,\n/static/4023d173da17bcdfac26db1983743796/fb8a0/description_clip-path.png 590w,\n/static/4023d173da17bcdfac26db1983743796/526de/description_clip-path.png 885w,\n/static/4023d173da17bcdfac26db1983743796/fa2eb/description_clip-path.png 1180w,\n/static/4023d173da17bcdfac26db1983743796/04f6f/description_clip-path.png 1627w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>今回は任意の形にトリミングできる<code class=\"language-text\">polygon</code>を使って\n<code class=\"language-text\">clip-path: polygon(5px 0px,5px 800px,6px 800px,6px 0px,11px 0px,11px 800px,...)</code>のようにして縞々化を実現しました。\nこれについても最初は、複数の長方形を指定しようとしましたが、polygonは１つの閉じた図形でなければならないという制約があり困りました。\nちょっと悩んだ末、ハック的に櫛型の図形を指定することで解決しました。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d6f21716e0270458e036051819edd5ac/82d92/description_clip-path-stripe.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 67.71300448430493%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABcRAAAXEQHKJvM/AAAB4UlEQVQ4y5WTW4+aUBSF+fdN+l/aPjWpb1VJJqmXyThm6mUQBQ4ogjfuuD2r+6AYa6aJJXxZm33Yi8VNE0J0HcdpMbrrurplWbpt2/pyudSDIHiMMNRDptFofNaCYA0hHNjWAu5F1/4KkCf879bv979rUVLCEn45d3yy3TUtxJpM2yfroo4X0MT0rr3p3CNjsazOnVkr8lYhhZvdabfbnZ6enr5q20OK8btFU1PAmAv8nlqYzBxMGaWzhYuxYaNaX3gV73MXpsVquhxmJddBiM1mAzb8pqmo0WFPcXRAxGRpgrqOY0VUaVnk/7pTqXYpJTqdztkwSVJK0xSKvCj4OKlQx1mWsWYoyvI8LeU9sna+GsZxTIxS5HmOuq5NlRZ8oYcNizynkhOoIUWdVqXLGaXHm4R/3e+9oXBdOEKQZdtQ9emyLu/4yOxDw3w8xnY0onA4xPb1FYXnIZ1MKjLDQD6bIeO1Iyd+KCFGI6Rvb6SGsufnyiDpds+8vCAdDJC22yii6DFDyani4bBIBgOKez3KDYPibreCDYkNKWm3iQ2JZ4jn7znWNRt+0bDfAyv+1Xwf4GcIlUSIM3XfNB/69Xq93g+N3+CvKIp+8mfSYm3VWte3ff58rr1bVF/RbDY//QHrER0GZGLOQgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"description_clip-path-stripe\"\n        title=\"\"\n        src=\"/static/d6f21716e0270458e036051819edd5ac/fb8a0/description_clip-path-stripe.png\"\n        srcset=\"/static/d6f21716e0270458e036051819edd5ac/1a291/description_clip-path-stripe.png 148w,\n/static/d6f21716e0270458e036051819edd5ac/2bc4a/description_clip-path-stripe.png 295w,\n/static/d6f21716e0270458e036051819edd5ac/fb8a0/description_clip-path-stripe.png 590w,\n/static/d6f21716e0270458e036051819edd5ac/526de/description_clip-path-stripe.png 885w,\n/static/d6f21716e0270458e036051819edd5ac/fa2eb/description_clip-path-stripe.png 1180w,\n/static/d6f21716e0270458e036051819edd5ac/82d92/description_clip-path-stripe.png 1561w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h2 id=\"reactコンポーネント\"><a href=\"#react%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reactコンポーネント</h2>\n<h3 id=\"実装\"><a href=\"#%E5%AE%9F%E8%A3%85\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装</h3>\n<p>縞々化の<code class=\"language-text\">polygon</code>を組み立てロジックは、Slit Animationの原理で説明したようなロジックをもとに、先に説明したCSSのclip-pathで実現しました。</p>\n<div class=\"gatsby-code-title\">縞々生成ロジック</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">craeteFramePolygonPoints</span><span class=\"token punctuation\">(</span>\n  coverSlitWidth<span class=\"token punctuation\">,</span>  <span class=\"token comment\">// カバーの隙間幅</span>\n  coverWidth<span class=\"token punctuation\">,</span>      <span class=\"token comment\">// カバー全体の幅</span>\n  coverHeight<span class=\"token punctuation\">,</span>     <span class=\"token comment\">// カバー全体の高さ</span>\n  frameCount<span class=\"token punctuation\">,</span>      <span class=\"token comment\">// コマ数</span>\n  frameIndex       <span class=\"token comment\">// 何番目のコマか</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// カバーの隙間を配置する間隔</span>\n  <span class=\"token keyword\">const</span> unitWidth <span class=\"token operator\">=</span> coverSlitWidth <span class=\"token operator\">*</span> frameCount<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 隙間を何個並べるか</span>\n  <span class=\"token keyword\">const</span> unitCount <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>coverWidth <span class=\"token operator\">/</span> unitWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 櫛型とpolygonを生成</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">range</span><span class=\"token punctuation\">(</span>unitCount<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=></span>\n      <span class=\"token function\">range</span><span class=\"token punctuation\">(</span>frameCount<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=></span> i <span class=\"token operator\">%</span> frameCount <span class=\"token operator\">===</span> frameIndex  <span class=\"token operator\">%</span> frameCount<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>countInUnit <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> offset <span class=\"token operator\">=</span> i <span class=\"token operator\">*</span> unitWidth\n          <span class=\"token keyword\">const</span> offsetInUnit <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>countInUnit <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> coverSlitWidth\n          <span class=\"token keyword\">const</span> xStart <span class=\"token operator\">=</span>  offset <span class=\"token operator\">+</span> offsetInUnit\n          <span class=\"token keyword\">const</span> xEnd <span class=\"token operator\">=</span> xStart <span class=\"token operator\">+</span> coverSlitWidth\n          <span class=\"token keyword\">const</span> yStart <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n          <span class=\"token keyword\">const</span> yEnd <span class=\"token operator\">=</span> coverHeight\n\n          <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>xStart<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>yStart<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px,`</span></span> <span class=\"token operator\">+</span>\n            <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>xStart<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>yEnd<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px,`</span></span> <span class=\"token operator\">+</span>\n            <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>xEnd<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>yEnd<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px,`</span></span> <span class=\"token operator\">+</span>\n            <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>xEnd<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>yStart<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px`</span></span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`,`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`,`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 補助関数</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">range</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">,</span> startAt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token function\">Array</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">=></span> i <span class=\"token operator\">+</span> startAt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>縞々ロジックが確立してしまえば後は簡単で、淡々とコンポーネントを作成していきます。</p>\n<p>縞々画像のコンポーネント</p>\n<div class=\"gatsby-code-title\">縞々画像のコンポーネント</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> styled <span class=\"token keyword\">from</span> <span class=\"token string\">'styled-components'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">SlitAnimationFrame</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    coverSlitWidth <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    imageWidth <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    imageHeight <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    frameIndex<span class=\"token punctuation\">,</span>\n    frameCount<span class=\"token punctuation\">,</span>\n    image\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>frameIndex <span class=\"token operator\">&amp;&amp;</span> frameIndex <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set frameIndex.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>frameCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set frameCount.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>frameCount <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;</span> frameIndex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set frameIndex which is smaller then lastIndex of frame.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>image<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set image.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 縞々ロジックを使う</span>\n  <span class=\"token keyword\">const</span> freamePolygonPoints <span class=\"token operator\">=</span> <span class=\"token function\">craeteFramePolygonPoints</span><span class=\"token punctuation\">(</span>\n    coverSlitWidth<span class=\"token punctuation\">,</span>\n    imageWidth<span class=\"token punctuation\">,</span>\n    imageHeight<span class=\"token punctuation\">,</span>\n    frameCount<span class=\"token punctuation\">,</span>\n    frameIndex\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n  <span class=\"token keyword\">const</span> FrameImage <span class=\"token operator\">=</span> styled<span class=\"token punctuation\">.</span>img<span class=\"token template-string\"><span class=\"token string\">`\n    position: absolute;\n    width: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>imageWidth<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    height: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>imageHeight<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    display: block;\n    top: 50%;\n    left: 50%;\n    -webkit-transform: translateX(-50%) translateY(-50%);\n    -ms-transform: translateX(-50%) translateY(-50%);\n    transform: translateX(-50%) translateY(-50%);\n    -webkit-clip-path: polygon(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>freamePolygonPoints<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">);\n    clip-path: polygon(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>freamePolygonPoints<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">);\n  `</span></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>FrameImage key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>frameIndex<span class=\"token punctuation\">}</span> src<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>image<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>続いてカバーのコンポーネント</p>\n<div class=\"gatsby-code-title\">カバーのコンポーネント</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> styled <span class=\"token keyword\">from</span> <span class=\"token string\">'styled-components'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">SlitAnimationCover</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    frameCount<span class=\"token punctuation\">,</span> <span class=\"token comment\">//required</span>\n    coverWidth <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    coverHeight <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    coverColor <span class=\"token operator\">=</span> <span class=\"token string\">'#000'</span><span class=\"token punctuation\">,</span>\n    coverSlitWidth <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    startAt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    endAt <span class=\"token operator\">=</span> coverWidth<span class=\"token punctuation\">,</span>\n    duration <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>frameCount <span class=\"token operator\">&amp;&amp;</span> frameCount <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set frameCount.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ここでも縞々ロジックを使う</span>\n  <span class=\"token keyword\">const</span> coverPolygonPoints <span class=\"token operator\">=</span> <span class=\"token function\">craeteCoverPolygonPoints</span><span class=\"token punctuation\">(</span>\n    coverSlitWidth<span class=\"token punctuation\">,</span>\n    coverWidth<span class=\"token punctuation\">,</span>\n    coverHeight<span class=\"token punctuation\">,</span>\n    frameCount<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> CoverDiv <span class=\"token operator\">=</span> styled<span class=\"token punctuation\">.</span>div<span class=\"token template-string\"><span class=\"token string\">`\n    top: 0;\n    left: 0;\n    position: absolute;\n    width: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverWidth<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    height: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverHeight<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    overflow: hidden;\n    &amp;:after {\n      top: 0;\n      left: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>startAt<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n      position: absolute;\n      content: '';\n      display: block;\n      width: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverWidth<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n      height: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverHeight<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n      background: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverColor<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">;\n      -webkit-clip-path: polygon(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverPolygonPoints<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">);\n      clip-path: polygon(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverPolygonPoints<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">);\n    }\n    &amp;:hover:after {\n      left: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>endAt<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n      transition: left </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>duration<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">s linear;\n    }\n  `</span></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>CoverDiv <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n最後に全体を取りまとめるコンポーネント。<br>\n縞々画像とカバーを重ねて表示します。<br>\nホバー時にカバーを横スライドするようにしました。\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> styled <span class=\"token keyword\">from</span> <span class=\"token string\">'styled-components'</span>\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">SlitAnimation</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>  <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    images<span class=\"token punctuation\">,</span> <span class=\"token comment\">// required</span>\n    imageWidth <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    imageHeight <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    coverWidth <span class=\"token operator\">=</span> imageWidth<span class=\"token punctuation\">,</span>\n    coverHeight <span class=\"token operator\">=</span> imageHeight<span class=\"token punctuation\">,</span>\n    coverColor <span class=\"token operator\">=</span> <span class=\"token string\">'#000'</span><span class=\"token punctuation\">,</span>\n    coverSlitWidth <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    startAt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    endAt <span class=\"token operator\">=</span> coverWidth<span class=\"token punctuation\">,</span>\n    duration <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>images <span class=\"token operator\">||</span> images<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set images.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> frameCount <span class=\"token operator\">=</span> images<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> cover <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>SlitAnimationCover <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n    frameCount<span class=\"token punctuation\">,</span>\n    coverWidth<span class=\"token punctuation\">,</span>\n    coverHeight<span class=\"token punctuation\">,</span>\n    coverColor<span class=\"token punctuation\">,</span>\n    coverSlitWidth<span class=\"token punctuation\">,</span>\n    startAt<span class=\"token punctuation\">,</span>\n    endAt<span class=\"token punctuation\">,</span>\n    duration\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> frame <span class=\"token operator\">=</span> <span class=\"token function\">range</span><span class=\"token punctuation\">(</span>frameCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>frameIndex <span class=\"token operator\">=></span>\n    <span class=\"token operator\">&lt;</span>SlitAnimationFrame <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n      coverSlitWidth<span class=\"token punctuation\">,</span>\n      imageWidth<span class=\"token punctuation\">,</span>\n      imageHeight<span class=\"token punctuation\">,</span>\n      frameCount<span class=\"token punctuation\">,</span>\n      frameIndex<span class=\"token punctuation\">,</span>\n      image<span class=\"token punctuation\">:</span> images<span class=\"token punctuation\">[</span>frameIndex<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> Container <span class=\"token operator\">=</span> styled<span class=\"token punctuation\">.</span>div<span class=\"token template-string\"><span class=\"token string\">`\n    position: relative;\n    width: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverWidth<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    height: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverHeight<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    overflow: hidden;\n  `</span></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Container<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>frame<span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>cover<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Container<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>これで完成です。</p>\n<h3 id=\"使い方\"><a href=\"#%E4%BD%BF%E3%81%84%E6%96%B9\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使い方</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i @takumon/react-slit-animation</code></pre></div>\n<p>でインストールして下記のように使えます。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> SlitAnimation <span class=\"token keyword\">from</span> <span class=\"token string\">'@takumon/react-slit-animation'</span>\n\n<span class=\"token keyword\">import</span> parrot1 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/1.png'</span>\n<span class=\"token keyword\">import</span> parrot2 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/2.png'</span>\n<span class=\"token keyword\">import</span> parrot3 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/3.png'</span>\n<span class=\"token keyword\">import</span> parrot4 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/4.png'</span>\n<span class=\"token keyword\">import</span> parrot5 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/5.png'</span>\n<span class=\"token keyword\">import</span> parrot6 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/6.png'</span>\n<span class=\"token keyword\">import</span> parrot7 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/7.png'</span>\n<span class=\"token keyword\">import</span> parrot8 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/8.png'</span>\n<span class=\"token keyword\">import</span> parrot9 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/9.png'</span>\n<span class=\"token keyword\">import</span> parrot10 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/10.png'</span>\n\n<span class=\"token operator\">&lt;</span>SlitAnimation <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n    imageWidth<span class=\"token punctuation\">:</span> <span class=\"token number\">800</span><span class=\"token punctuation\">,</span>\n    imageHeight<span class=\"token punctuation\">:</span> <span class=\"token number\">800</span><span class=\"token punctuation\">,</span>\n    images<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n      parrot1<span class=\"token punctuation\">,</span>\n      parrot2<span class=\"token punctuation\">,</span>\n      parrot3<span class=\"token punctuation\">,</span>\n      parrot4<span class=\"token punctuation\">,</span>\n      parrot5<span class=\"token punctuation\">,</span>\n      parrot6<span class=\"token punctuation\">,</span>\n      parrot7<span class=\"token punctuation\">,</span>\n      parrot8<span class=\"token punctuation\">,</span>\n      parrot9<span class=\"token punctuation\">,</span>\n      parrot10<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    duration<span class=\"token punctuation\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span>\n    coverColor<span class=\"token punctuation\">:</span> <span class=\"token string\">'#444'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre></div>\n<h3 id=\"いけてないところ\"><a href=\"#%E3%81%84%E3%81%91%E3%81%A6%E3%81%AA%E3%81%84%E3%81%A8%E3%81%93%E3%82%8D\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>いけてないところ</h3>\n<p>スリット幅、カバーの色、カバーのスライド速度など調整できるようにはしていますが色々と難点があります。</p>\n<ul>\n<li>使う画像ごとに、うまく調整しないとなかなか動いているように見えない</li>\n<li>ピクセル幅にシビアなのでサイズをレスポンシブにできない</li>\n<li>モバイルで見ると固まる（レンダリングがかなり高負荷）</li>\n</ul>\n<p>などなど実用的なコンポーネントとは程遠いです<img null=\"\" data-icon=\"emoji-cold_sweat\" style=\"display: inline; margin: 0; margin-top: 1px; position: relative; top: 5px; width: 25px\" src=\"data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAWv0lEQVR4Ae2bBXAcx9a2n9MDi1pJlmzJdmSmMCcXQ5eZmZmZmZmZmZkpzHTtsG9MchyzbOFK2t2hPv9K6iqpFNvXf5x8fKre6llpt6ef95weHuF/eZj/M+B/d/yfAT73erzf5E555bLQ1+NVvWNFWGHxu1VMmyBFAEVronbYkO5VZYtItj5O41ujG76zFbDciyHw/nsDWiqn7jhDvcJjEf+h1guP8XxTFGMQz8MIiAEEAFBQC1ZBswy1liy1NZPF/0LT8yWr/7G6rud6QO95A+7JOHV3scX4T1UTvBA/f38v8IwXehjfIIAKAIhMiWl+VKfxxLVZqmRxSpZklrRxldjku6M2/SVQu8cMaA6aI451G/2W0499tvUKbzJheJwf+vihQQxYIBdCWxm65sDcNujqgHIBQh8A4hTG67B3APqHm+0gDI9BHIMAaiGNbVMpNo5uM1njM6P/XP9jID1yA7iEI4nKaYvPwG//qAbFBwX5gCAnIOAHcNRcOH4FnLQSlnZDRwXyAXgeAOisMswyiBIYqMLWvXDTZrh1C+zcD2kCKCSRkjQSJKldRDr0TuD6IzKgctpW7k5U1y6TljP73ihB5QN+PlfKFQTxIAzgmKVw3mlw0nJobwGA1IJOSEEPMR/FbR98AwBDo3BTL1y8Fv51hxIngmYQNZSsHo/bZOR9o9d1fRbQ/6htgLSfuraiucVfNmHl2bmSkMsJeLBsgfDoBwinr5JJI5IU7N1ckbrWAIEPUQJrNyl/ulLZtlunTIiUaNxi49EfS3Tnq4fWnVYF9N40QDpPvmG+Fnt+4heL5xRKQhBCmBPOPdXjEfcxtBYhykD00GuSuwIf9A/qKiP0YKQGf7vWcsm6jDhS0hhq40paq10qtR3P6r/xlD2A3hvHAdJ5/yvne6b790ExOL3YkuIH0F4RHnd2yGlrhCxTxhsgcgQuH8KUJJky4YlnCYvmCX+4LGGoqgQ+1ExwTtIcW3OMj++/6gHOhHvOADnq2F+2W3/hz3Il7/RSS4wfCp3thiedV2DFQqEWZQgg3LuRAprCySuFSsnn1xfV6R+yhJ4y7nmnR+MLf9Yc6xN2rn/qEKD3hAECmGDu0V/0S+asciUmlzO0thoef06JxV0TWU8xs7N+Dzuhs1DGU1g8D550bsDvLx1nZMQSGMuYmLNSOfqLwPMAC+jdN8DBLz/78jf6peBZldaYYtEjnzc8+IwSCzuhHk3Bz17TPcx/l74VqEU0xyDNsfhceM04Dd/iS0aV4FnNMd/ce9lZn/13Jvj/Dn7VA39yalAsva9SSSiVlSDMOGlNkRULPBpRgjGQHWnGj6AiopTJsQyuMdy8oUFgFF9Tqlnpfc2xX7bpimetO5QJcij4rq6H5rtOfPNfy22tZ1XaQnJ5YV5njrNPayMMBAUEOWBPxhjUWpQjCwHEGKy1By4JtxAnymVrh9nXHxE1lOpwzNjIyOV9N336kX195zcOZoJ/KAMWnPjcpxXK3lltlYRyUcnlDWuWFAn8FJspgqAzwRXECEEYMFodxvdDPM9wJJFmljSNaalUSOIEtQqz1qkogS8cvcSjUYuJjMXYFFLvLK/J0Hf++T8C9PAMcPAL1zyhUsqFb21tSaiUDIVCRsecPPPaBU0jAHRW5gN3cP+XX/2Vi/58Pm/64JvoXjCfNE25O+H7Pvv37uEz7/0MD3r0Q3nEEx8KHiRxCswywcLcdqG7QxkcjPDUIkmCScK3Nln+sGvD70amTTi0AQbwViw960nFsl3dWk5oKQr5gmH+3AKhl2CtMjM8z5ArBOzevptffv9vXHLxlRy/ejk9C9uoRTVQ5e5EYmOOavZRzrfx7a/8jN7bd/DU5z+CBYvmEdUTsswyM0JPmmMU4nqMj0XSBBvb1RMsTQN+4OCzQxkggMyZsyJXynkvqpQzKsWEUkEpFgPaSgq2gSgg4HuGMBdQHaly/h/W8ZdfXseewRotuR7e/O7nEgRArY7czS2kWiUMipN9vfrF324au4ENN23nUU89k3MediqV1jJxlExOExSw0F5ShoopPgmSptg4Q+rei5pMPx8c3JI5Rj2UAd4ppzz6lHJJT2stJpRLhnLeUi4K5VxG4IPvG1Qt+/tGuP7qjVz819u4c9soliIt4Vw+8aknsPq4LrZt34dnzBFtAavDtYm+mn0+h7e9+XfsH4z54dev5LK/38x5jzyOM+63mrldrYgY0tQi+YzWYopnY4xN0DjBNlkmmC688PPXAPZQBhjAay15j20pJKZSimgtQD5nJ7cDNqmyY8cw27bu59Ybd3HbTXsYGEwRSqS0sayngw9//JGsOamNzVu2E4iAckThCezYvp37PegovvW95/Dut/+VrTsG2L4t5XtfvZY//nwtx500n+NPXsiSZXOZ191GpZSgSYSvCcQR6XhisiYTcD2QAfZABghg2tvbg3IxPbe1GDfhY8o5KBaVrB7xvg/8nC1bpzKtFPAoAmU6Wyo8/inH87JXnYqaYbZu3jQJf6AQhNmhgOCWD+CYB5N9rjymm1/+/tl84yvr+P2vbqV/NGDfYMIFF+/kwos3Y6ixYlkLb3jrw2ktCjWNocmQFWPSJtME29DQUAoIoAc04D7H32dZa86ubismVPIRpRyEfkrb3A6e9JQH84+/9DJWNRQKJXoWdXDfByzh3Acvonu+NqfBJqojY4SeQZBpGFV0dqs66zqAQFMGJltxLe5/KsqubVsn5/3b330Cz3/RiVxy4XauuXJbs0IGqNfHKVcsD3vUchZ2FxkeGsDLWUwSYYsJaZNpgu1vl//t9kMZ4M2rhMe35NNCJZ804SMKoRJ4PqRDPO+5J/DSl55FrWYJAiFfyIjqw+zfdzu33zICqvgikFmszdBJ0IllBRRVAAU9UKbF8U63xggiZsoY42HEUBsZb65rH21zWnnq07p5zvMfSKPukSRKsWiIGwNsvP0W8l6MF6aQi7H5hKjJNMEGbALkoFNgTp5j2nIJLfkGLaGQCxU/SDEas23jdYS5PEEQkGUZSRyT2QzU4qEOWKEpM6NTzGEef+pBDnkVxLrKcBrtH2Z0YAee8Qhy4WTblyTEUQNfE4qhJZUMP4mgyRLnEmpNNuB3BzPAAKYcpMtbwpRSGFMIDDkfgsAHI6ARktRIEwHAV8XDztqJ3vtnQy6cMQZtCCkgKCEWPMAoiaaYIMKGMUmYMtpkw3HONkCcvEqQzCvlYorBhITQB9/LQByR6mzYA9AqIkIQ+hgR0jSb1OG7ovi+NymrShKnqOqB1nNXc4zM6CPFCyI0iElyMeUmG+AB4qSzp0BQNlFbeQLea1DwIDCK5/mAHhaAoBjPYK3yr1u3MTw8zupVRzF/fgdxnBzWHAjDgD17+ti4aSdtbSWOOXoJxgg2syhymOUi+FmKZ2LUa5AFMZUmGxAcchtQ9LN8wUTkPZ+cEQLfTs6vwyB3CRAyq/zy55dw87oNeAKXFAs881kP4YQTFhPH6SHHHeZ8brmll5/+5AKSWp1M4cRT1/CMZ5xL6AtWp7N+aHzI/AzjJVivQWoiJtgAcyADxLWmJBG5SXmEIgSSYcRjpC58+o95nn7/mON6MgCQu+Yyl/O57IqNbLp5Ayu7AwJfGKg2mrvPK1i9opVCPsBa5UBhjFCvjU1+t9Vr0LEwJEl1sq+bVs/j7AesJorSaX49yNmxaz0yRBKsNEglYoINMAeaAupaE2rSyNMgL4ZQlECCSQN+dEUXv7hxBbure/nhS3sxMjXPQae7AzwJ6N20ja5Ww7yKwTdCIQjYPlBl967dnHhcF9FBqiAX+vT29hGPVlnUEVDOGVKrJImhd+M2zntgD6GXgE6nWRF3XCF3mV1WpgxAIlIaTLABBtfDAc8FfI2qoTYILIRk+BIwUsvxy/UnQlcPV++fz23b7+S0JSMgM+DN1LLxAtK4QUveUAwE3wNVIWeULB0jF5bQ7AAGCORDf+o7RimFQjGENJPJvib69PwxRBOwgAooqDoTxCEhqIKIYsVOfl9txATTBNuhrgcogMmi/lB9fJSAFE8D/nzrUextWY3f00Ha38YP167gPksvRQwOHsSZEeZDuheU2L6/HzHTCcnnA7rm+/iMEPqWA4WHmfjO5HfBeWvAZnayz2I4TpzFqABWQHGaMlnFmQKIglWLkGBJJgyYZDvY2aA6UYujO73Uw8sUz6ZkieX7609n4cnd/PpFi3jHP/r582/P5K39V7J83ogzwWVfwKfBfc6ey5abdjJes+RzwuBQwqJjulix2mDHq3i+cJewYDNlxaoyi9bMYd+/+gg6AxqREqs32acvVTKToQquxh2JOCpBVZwBgLUYm2LSBC+NJtlm886ugHTfSKP3mNjDpCA24/wNi9ngHcvbzpnLfeYHvPqBc7j82gXNKjiaDz/mElz5I0JTStpQTjimhUe+aCVX/OZOqtWU7uM7ecqLe8jpEIlJDnwF1QCqBJrwtJf28KvvZPRtHCEoBc2+Fjf7VBr7RvFEUAQMgMt4JiAAghoDFtz5hjOgqThigg3IDnY6bIH0n7vqW89Z7TdMonnJfL63/r60rurgkcuKrB9Sju0IOe7kDn550QN4Y+0SOltquCnguJR0sM6Dz2rh5PuupFazzOs0+NVBkvEY48khj/SyqE5XucHL37GAfQPdFIuGjiClsXsfxpue41hngk5lnQnhpgECMgHfVJZikhTiuDHBBiSAPZgByc/X13a+5oxcbzmWY/+5vYerkjN51AntdJc89jegMy88+vhWPnr9Cn5+wzG87pyrABAAZwKiRHsbtBc9OkJDsj8lzayD//d3Q9NaA9MYo6fgY+uWaCBDjGBUwALIjJ/IjIoyKAYUFDDWYlKLxCmNsbh3gu1QBigQjSck/dXo2rkNPfbbvQ9Aejp53JoWxlMhsTAUKQ9eXODbq9r57s0P5WX3v4pSLkZEYVKA2y5kMWQJYMC4vx3ObVpxQEktAgXjzdjowcyMu6wzveyqQDJtCkgyJIrpr8bXTrABEaAHMyAB6pdtj65kTtcL/p6cZ045dg4nzA0ZbCgqQjURuvIeDzmunZ9sOI4/3rqaZ5+xbgrOcIB2lgDQf++CAuLaGVkHZ4QIOgMacaaocc8aKZI0Vc/Q8chetj2+EqgDycEMALBA7Qv/zDasbXv0SLZmfvtDV5exCA0reAJWYSSBhywr8pdlnXzuxsfzlFPXkQ9TMCB3NWLG2OXwTod1RiXpNLgyywgctJOIoNYgGWiqSGShnjI6kt42wQTUHCOHMqBenfeYRf8oPryyaHEbazpyVBOwbkwWGEtgbsln5aIy6+44lV/ccAIvuN91YHAHRLMqAAUPyAHejMxmTIMCWPe3GFAcGFMy4vwTcC3qKsCKmyIGtRlkgqYWogwZTbl5d/r7akIdJnVIAxSo0/2AhxQWdHlHdRRQMSTWrdwNPFOwKnS35Wlb2Mb3bj6PFzzgOvAcPDOyHwB5iEdh8y3Kxo3KnXfC4BDEEYhAoQCdnbBsmbB6dbNdLJAD6goZYFzpIeDpFCx3vc2hmTYlaJxh6xY7mjEylG1715VcBlSB+uHcGElpXXBy27wi7eWQ0UToLDo2poQRBhvQkguaAy+wfvMa8GUaGplqi8LoEPz6R5aLLlB2bYcsBl/AN2AcR2Yh1Qkp+RIsXwWPfYzwiIcKkgMiwBOAKXgRZ8qUhOllTcA2IBtTsmHLNTv0h70jjMKk0sO5NaYUCu2VckBr3mMoFnoUcgYAcMnY34BCKLQWfXaaCngyo+SBPGzcoHzwA5adW2FuWVjeAbkAAgcvAqibDQpJBrUY9myGj31EueRS5d3v8mitAMmshwxVnNEOfEIpaGTJ6pZ0JKOv397wiou4DBgGxg775qhgCY1S9BWA/XXoKkDOg9RCfwSRhZLvLpgYO20AgAdjVfj4xzOqfXDSMmjJQc4Hbwb8zFALmU71Pz+F4TrccB185WuWd7zTQ6yAMgPamZAJqqAZ2IYlGdcmvKUxmDW+cZN+ZaRB1RkQARyWAdqo9iVRtMymKb5YUjUMxxA6A+op+GqxWUaaJJTsgKNiSiHcsV4Z3A+rFsPcFigEYAzIQXaCM/+eZlCKQD3YsAHqo0KxJJAB6gxgSmpBE9CGxY4rdsSSDWRcd4d85/NrtRcYcPNfD9sARndeMdx3zH2rSxtE7QU052FVSDLIFFAlyTJG6xHD/WMc13ITWAEPUCCFuQsMXd0Q+EKuqBgD1jLVRwrWKlYBpozxjOB54E8ogLwPXhWWLBVyLQYSnYKfOd9T0BhsHeyokgxb4v0pvTvs+Y//nf4B6AcGgRjg8A3Yfdlv929Z88I7F7V1zmkJCT3B5n0CT0itMh5n9I3U2bl3mL2b9/Cu0y+CdMY+Pla6Fxie+Lwcf/lJzL5RKJaFfEkotgqFCoR5aQrUQtyAqK7URpR6FRpjyti4UpgrPP3FIZ4BLKAzyj4GYkFriq1akqGm9mXs22Vves6f9ZvAkIMf+/9/RGbnJbuSjhM/tnFd62dyPiRxSmclT873SKxleDyid/cI62/cyZMq3+e+XVvRhoEAxBcwCqPKwx/uc/TJPiPDSqVV6egQikXwzMynonFgkGTC6BgM9EN9HOYvEOYWFYYsYMBlnUTQCLer0yn4vgn47PYX/10/uWGQvcA+N/ezu/Og5Bygk1Pf9vTy8jPfvOiYhS3zuisU8j5xnDEwUGP7pj4ekf2At5z8B9o7YeEiD8mBhIoETB8UlQVCIFWIdaqd/djXzAMcXyB087yhUMOVvJvrqaB10JolHVWyEUuyN2X3Dnvjy/6un75yJzuB3UAfMApwdwzwgcWAx8onr6Lr1Gfm2xbcz8/nK1lUT9L+rTtf0fb78DlL1x/nzzH0LPWodAhSEkxeICeID+IpeC7T4loAc5DLuBYAHLArd9DMZT5WbEPRMSV1+/lkf8aW7faCZ/5Jv71lMvOT2g8MHemjsi3A/FnfrYCrDih/9Gxz9mOP0yce1ePl/A4PryJ4ZYPkQSZMCHFGAGaGZNbaFdc6pUyBW3AbOjRStA7ZuCWrKulgRn0ga1zdK9970m/t34Bhl/X9blk5jPA4eMRuKMUZQ01m3F+Xi+7UXt9y5aqCdhWtzlf3n8k2E7C4bwuaCaiTBRS3PCEctEAqaDwh0IaiNbBjkI3aqXIfsKR92UTJ3/D5q/VTb7pYrwcGHHw/MALoPfmwdA5odUZ4gAK+UxFoL3i0fOXh3O+cpfLEtk6z1Gs1eC0GUxSkIHghEAoSAB6IAYzAzAqwijrDNAEiJYtB64qtKdnYlAHD/faOS+/Q377q71xdzxh1pT7gNArof9QrM2VnTDvQBlQWlil/+BxOu2+PPKyjXY73y0YmTPCKZnpKBAIekzIGAKwDR12pu5LPanYSPh2zOjCot16zU//x7ktZu2uMMcAd4THksj72n/HOUA5oASrOhBZnjP/601j6qJXmtKXtelq5hSVhweRMTiAQxAfjz6wAsKm6XZxiIyWu22hslG13DMnav2y2az+/ljuA1IGOOviqW47+M1+aMkDBwTtRBEpAzgPzmFXMO6uHhas7TE9nURcUA+bkfMqBRw4gyYiilLFawmB/TXZvHLA7Lt/Brj9tYl8G1gGOAzUH7EQdsP9V3hrznRElp6L7nAdCJ8/J4toZJma41il2agB1Bz/uVAfS/3qvzU0bkQPyTgUgnGWCce3MyAA7Cz52sA2naCb4f1UDZvYdzJLvWmcAAgDoDAMSB5nMkt47g/yPCweNcTrQ4x7WyZlx78f/A5XVFJimBjmKAAAAAElFTkSuQmCC\"></p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>思い付きで作ってみて一応Reactコンポーネント化できたのはとてもうれしかったです。\n最近のCSS周りは、なんでもできるようになってて楽しいですね🍅</p>","fields":{"slug":"/2018/12/02/","title":"CSSのclip-pathでSlit Animationを実現する","date":"2018-12-02T16:00:00.000+09:00","excerpt":"なにこれSlit Animationを実現するReactコンポーネントをCSSのclip-pathを使って作りました。Slit Animation(スリットアニメーション)は下記のようなものです。コマ画像を縞々にして合成した画像に、スリット...","tags":["CSS","clip-path","React"],"keywords":["React"],"thumbnail":"/thumbnail/2018/react-slit-animation.png"}},"next":{"fields":{"slug":"/38a98fba-b86d-5919-9db1-9defd84588e1/","title":"Reactコンポーネントをnpmで公開する（GitHub Pages付き、Babel7、webpack4）","date":"2018-12-12T00:56:33+09:00","excerpt":"なにこれTIS Advent Calendar 2018の13日目の記事です。よろしくお願いします！最近Reactコンポーネントをnpm公開してみました（参考記事：CSSのclip-pathでSlit Animationを実現する）。そこで...","tags":["npm","github-pages","webpack","React","babel","Qiita"],"keywords":["npm"],"thumbnail":""},"id":"38a98fba-b86d-5919-9db1-9defd84588e1","title":"Reactコンポーネントをnpmで公開する（GitHub Pages付き、Babel7、webpack4）","rendered_body":"\n<h2>\n<span id=\"なにこれ\" class=\"fragment\"></span><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\"><i class=\"fa fa-link\"></i></a>なにこれ</h2>\n\n<p><a href=\"https://qiita.com/advent-calendar/2018/tis\">TIS Advent Calendar 2018</a>の13日目の記事です。よろしくお願いします！</p>\n\n<p>最近Reactコンポーネントをnpm公開してみました（参考記事：<a href=\"https://takumon.com/2018/12/02/\" rel=\"nofollow noopener\" target=\"_blank\">CSSのclip-pathでSlit Animationを実現する</a>）。そこで今回は<strong>簡単なReactコンポーネントを作って、npm公開する方法を紹介します。</strong><br>\n「React始めたんだけど...npmアカウント作ったんだけど...」という方でも30分くらいで公開できるので、とりあえず手を動かしたい人向けのチュートリアルです。<br>\n下記のような手順でnpm公開するまでの方法を見ていきましょう。</p>\n\n<ol>\n<li><a href=\"#1-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">コンポーネントを作成する</a></li>\n<li><a href=\"#2-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">デモページを作成する</a></li>\n<li><a href=\"#3-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92github-pages%E3%81%A7%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\">デモページをGitHub Pagesで公開する</a></li>\n<li><a href=\"#4-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92npm%E3%81%AB%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\">コンポーネントをnpmに公開する</a></li>\n</ol>\n\n<p>※ 完成品はGitHubに公開しています =&gt; <a href=\"https://github.com/Takumon/react-component-sample/tree/step4\" rel=\"nofollow noopener\" target=\"_blank\">Takumon/react-component-sample</a><br>\n※ 完成品は下記のようなプロジェクト構成になります。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>プロジェクトルート\n├─dist              ・・・ コンポーネントビルド資産出力場所\n├─src               ・・・ コンポーネント資産\n│   ├─index.js\n│   └─styles.css\n├─examples          ・・・ デモページ用資産\n│  ├─dist           ・・・ デモページビルド資産出力場所\n│  └─src\n│     ├─index.html\n│     └─index.js\n├─node_modules\n├─.babelrc          ・・・トランスコンパイル用設定ファイル\n├─webpack.config.js ・・・ビルド用設定ファイル\n├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n├─.npmignore        ・・・npm登録除外対処定義ファイル\n└─.gitignore\n</pre></div></div>\n\n<h2>\n<span id=\"1-コンポーネントを作成する\" class=\"fragment\"></span><a href=\"#1-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>1. コンポーネントを作成する</h2>\n\n<p>まずはコンポーネントを作ってトランスパイルするところまで完成させましょう。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step1\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n<span class=\"gi\">+ ├─dist          ・・・ コンポーネントビルド資産出力場所\n+ ├─src           ・・・ コンポーネント資産\n+ │   ├─index.js\n+ │   └─styles.css\n+ ├─node_modules\n+ ├─.babelrc      ・・・トランスコンパイル用設定ファイル\n+ └─package.json  ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n</span></pre></div></div>\n\n<ul>\n<li>最初にプロジェクトの雛形を作ります。<code>npm init</code>で色々聞かれますが全てデフォルトで構いません。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><span class=\"nb\">mkdir </span>react-component-sample\n<span class=\"nb\">cd </span>react-component-sample\nnpm init\n</pre></div></div>\n\n<ul>\n<li>最低限のReact系ライブラリをインストールします。開発用ライブラリとしてインストールするので<code>-D</code>オプションを付けてください。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm i <span class=\"nt\">-D</span> react react-dom\n</pre></div></div>\n\n<ul>\n<li>BabelでReactをトランスコンパイルするためのライブラリをインストールします。こちらも開発用ライブラリなので<code>-D</code>オプションを付けましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>npm i -D @babel/cli @babel/cli @babel/core @babel/preset-env @babel/preset-react babel-loader\n</pre></div></div>\n\n<ul>\n<li>\n<code>.babelrc</code>を作成し、Reactをトランスコンパイルするための定義を記載します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"javascript\">\n<div class=\"code-lang\"><span class=\"bold\">.babelrc</span></div>\n<div class=\"highlight\"><pre><span class=\"p\">{</span>\n    <span class=\"s2\">\"presets\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s2\">\"@babel/preset-env\"</span><span class=\"p\">,</span>\n        <span class=\"s2\">\"@babel/react\"</span>\n    <span class=\"p\">]</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n\n<ul>\n<li>コンポーネントを作ります。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"jsx\">\n<div class=\"code-lang\"><span class=\"bold\">src/index.js</span></div>\n<div class=\"highlight\"><pre><span class=\"k\">import</span> <span class=\"nx\">React</span> <span class=\"k\">from</span> <span class=\"s1\">'react'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"s1\">'./styles.css'</span><span class=\"p\">;</span>\n<span class=\"kd\">const</span> <span class=\"nx\">MyComponent</span> <span class=\"o\">=</span> <span class=\"p\">()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">(</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">h1</span><span class=\"p\">&gt;</span>Hello from My Component<span class=\"p\">&lt;/</span><span class=\"nt\">h1</span><span class=\"p\">&gt;</span>\n<span class=\"p\">);</span>\n<span class=\"k\">export</span> <span class=\"k\">default</span> <span class=\"nx\">MyComponent</span><span class=\"p\">;</span>\n</pre></div>\n</div>\n\n<ul>\n<li>コンポーネントで読み込むCSSを作ります。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"css\">\n<div class=\"code-lang\"><span class=\"bold\">src/styles.css</span></div>\n<div class=\"highlight\"><pre><span class=\"nt\">h1</span> <span class=\"p\">{</span>\n    <span class=\"nl\">color</span><span class=\"p\">:</span> <span class=\"no\">red</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n\n<ul>\n<li>トランスパイル用スクリプトをpackage.jsonに追加します。具体的にはJSファイルをトランスパイルしdistフォルダに出力、それ以外のファイル(CSS)をdistファイルにコピーするスクリプトです。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"transpile\": \"babel src -d dist --copy-files\"\n</span>    },\n</pre></div>\n</div>\n\n<h3>\n<span id=\"確認\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>準備が整ったので、トランスパイルしてみましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm run transpile\n</pre></div></div>\n\n<ul>\n<li>下記のようにdistフォルダ配下にindex.jsとstyles.cssが生成されればトランスパイル成功です。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"\">\n<div class=\"code-lang\"><span class=\"bold\">トランスパイル後の資産</span></div>\n<div class=\"highlight\"><pre>プロジェクトルート\n├─dist           ・・・ コンポーネントビルド資産出力場所\n│   ├─index.js\n│   └─styles.css\n</pre></div>\n</div>\n\n<h2>\n<span id=\"2-デモページを作成する\" class=\"fragment\"></span><a href=\"#2-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>2. デモページを作成する</h2>\n\n<p>実際にコンポーネントを使用したデモページもあわせて用意しておきましょう。コンポーネントの使い方をユーザーにわかりやすく示すことができます。<br>\nここではローカルでデモページが見れるところまでを作成します。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step2\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n  ├─dist\n  ├─src\n  │   ├─index.js\n  │   └─styles.css\n  ├─node_modules\n  ├─.babelrc\n<span class=\"gi\">+ ├─examples          ・・・ デモページ用資産\n+ │  ├─dist           ・・・ デモページビルド資産出力場所\n+ │  └─src\n+ │     ├─index.html\n+ │     └─index.js\n+ ├─webpack.config.js ・・・ビルド用設定ファイル\n+ └─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n</span></pre></div></div>\n\n<ul>\n<li>デモページはwebpackでビルドするので必要なライブラリをインストールします。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>npm i -D html-webpack-plugin webpack webpack-cli webpack-dev-server css-loader style-loader\n</pre></div></div>\n\n<ul>\n<li>デモページのHTMLを作成します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"html\">\n<div class=\"code-lang\"><span class=\"bold\">examples/src/index.html</span></div>\n<div class=\"highlight\"><pre><span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;head&gt;</span>\n    <span class=\"nt\">&lt;title&gt;</span>My Component Demo<span class=\"nt\">&lt;/title&gt;</span>\n    <span class=\"nt\">&lt;meta</span> <span class=\"na\">charset=</span><span class=\"s\">\"utf-8\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;meta</span> <span class=\"na\">name=</span><span class=\"s\">\"viewport\"</span> <span class=\"na\">content=</span><span class=\"s\">\"width=device-width, initial-scale=1, shrink-to-fit=no\"</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;/head&gt;</span>\n<span class=\"nt\">&lt;body&gt;</span>\n    <span class=\"nt\">&lt;noscript&gt;</span>\n        You need to enable JavaScript to run this app.\n    <span class=\"nt\">&lt;/noscript&gt;</span>\n    <span class=\"nt\">&lt;div</span> <span class=\"na\">id=</span><span class=\"s\">\"root\"</span><span class=\"nt\">&gt;&lt;/div&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</pre></div>\n</div>\n\n<ul>\n<li>デモページの起点となるコンポーネントを作成します。この時、<a href=\"#1-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">1. コンポーネントを作成する</a>で作成したコンポーネントを使います。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"jsx\">\n<div class=\"code-lang\"><span class=\"bold\">examples/src/index.js</span></div>\n<div class=\"highlight\"><pre><span class=\"k\">import</span> <span class=\"nx\">React</span> <span class=\"k\">from</span> <span class=\"s1\">'react'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">render</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"s1\">'react-dom'</span>\n<span class=\"k\">import</span> <span class=\"nx\">MyComponent</span> <span class=\"k\">from</span> <span class=\"s1\">'../../src'</span>\n\n<span class=\"kd\">const</span> <span class=\"nx\">App</span> <span class=\"o\">=</span> <span class=\"p\">()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">&lt;</span><span class=\"nc\">MyComponent</span><span class=\"p\">/&gt;;</span>\n<span class=\"nx\">render</span><span class=\"p\">(&lt;</span><span class=\"nc\">App</span> <span class=\"p\">/&gt;,</span> <span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">getElementById</span><span class=\"p\">(</span><span class=\"s1\">'root'</span><span class=\"p\">));</span>\n</pre></div>\n</div>\n\n<ul>\n<li>デモページのビルド設定ファイル（webpack.config.js）を作りましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"javascript\">\n<div class=\"code-lang\"><span class=\"bold\">webpack.config.js</span></div>\n<div class=\"highlight\"><pre><span class=\"kd\">const</span> <span class=\"nx\">path</span> <span class=\"o\">=</span> <span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s1\">'path'</span><span class=\"p\">);</span>\n<span class=\"kd\">const</span> <span class=\"nx\">HtmlWebpackPlugin</span> <span class=\"o\">=</span> <span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s1\">'html-webpack-plugin'</span><span class=\"p\">);</span>\n<span class=\"c1\">// HTMLファイルのビルド設定</span>\n<span class=\"kd\">const</span> <span class=\"nx\">htmlWebpackPlugin</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nx\">HtmlWebpackPlugin</span><span class=\"p\">({</span>\n    <span class=\"na\">template</span><span class=\"p\">:</span> <span class=\"nx\">path</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"nx\">__dirname</span><span class=\"p\">,</span> <span class=\"s1\">'examples/src/index.html'</span><span class=\"p\">),</span>\n    <span class=\"na\">filename</span><span class=\"p\">:</span> <span class=\"s1\">'./index.html'</span>\n<span class=\"p\">});</span>\n<span class=\"nx\">module</span><span class=\"p\">.</span><span class=\"nx\">exports</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"c1\">// 依存関係解決の起点となる資産を指定します。</span>\n    <span class=\"na\">entry</span><span class=\"p\">:</span> <span class=\"nx\">path</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"nx\">__dirname</span><span class=\"p\">,</span> <span class=\"s1\">'examples/src/index.js'</span><span class=\"p\">),</span>\n    <span class=\"c1\">// Babelのトランスパイル対象資産を指定します。</span>\n    <span class=\"na\">module</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"na\">rules</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n            <span class=\"p\">{</span>\n                <span class=\"na\">test</span><span class=\"p\">:</span> <span class=\"sr\">/</span><span class=\"se\">\\.(</span><span class=\"sr\">js|jsx</span><span class=\"se\">)</span><span class=\"sr\">/</span><span class=\"p\">,</span>\n                <span class=\"na\">use</span><span class=\"p\">:</span> <span class=\"s1\">'babel-loader'</span><span class=\"p\">,</span>\n                <span class=\"na\">exclude</span><span class=\"p\">:</span> <span class=\"sr\">/node_modules/</span>\n            <span class=\"p\">},</span>\n            <span class=\"p\">{</span>\n                <span class=\"na\">test</span><span class=\"p\">:</span> <span class=\"sr\">/</span><span class=\"se\">\\.</span><span class=\"sr\">css$/</span><span class=\"p\">,</span>\n                <span class=\"na\">use</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">\"style-loader\"</span><span class=\"p\">,</span> <span class=\"s2\">\"css-loader\"</span><span class=\"p\">]</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"na\">plugins</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"nx\">htmlWebpackPlugin</span><span class=\"p\">],</span>\n    <span class=\"na\">resolve</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"na\">extensions</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">'.js'</span><span class=\"p\">,</span> <span class=\"s1\">'.jsx'</span><span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"c1\">// 開発用Webサーバのポートを指定します。</span>\n    <span class=\"na\">devServer</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"na\">port</span><span class=\"p\">:</span> <span class=\"mi\">3001</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n\n<ul>\n<li>デモページ起動用スクリプトをpackage.jsonに追記します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.jsonの一部</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"start\": \"webpack-dev-server --mode development\"\n</span>    },\n</pre></div>\n</div>\n\n<h3>\n<span id=\"確認-1\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D-1\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>準備が整ったのでデモページを起動しましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm start\n</pre></div></div>\n\n<ul>\n<li>ブラウザで<code>http://localhost:3001</code>にアクセスしてコンポーネントが表示されればOKです。</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/a12b4f44783c0003093566184a9ea5badc8efc4d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f64363538373137352d323164372d613135622d343865392d3363366563333165643130352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/a12b4f44783c0003093566184a9ea5badc8efc4d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f64363538373137352d323164372d613135622d343865392d3363366563333165643130352e706e67\" alt=\"図1.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/d6587175-21d7-a15b-48e9-3c6ec31ed105.png\"></a></p>\n\n<h2>\n<span id=\"3-デモページをgithub-pagesで公開する\" class=\"fragment\"></span><a href=\"#3-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92github-pages%E3%81%A7%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>3. デモページをGitHub Pagesで公開する</h2>\n\n<p>デモページをローカルで見れるようになったら、次はGitHubに資産を登録し、GitHub Pagesで公開しましょう。プラグインで簡単に公開できます。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step3\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n<span class=\"gi\">+ ├─webpack.config.js ・・・ビルド用設定ファイル（追記）\n+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n+ └─.gitignore\n</span></pre></div></div>\n\n<ul>\n<li>github-pagesというGitHub公開用プラグインをインストールします。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm i <span class=\"nt\">-D</span> gh-pages\n</pre></div></div>\n\n<ul>\n<li>package.jsonにGitHubPages公開用スクリプトを３個追加します。\n\n<ul>\n<li>\n<code>publish-demo</code>はビルドとデプロイをいっぺんにやるスクリプトです。デプロイ前に大抵の場合ビルドするので、1つにまとめておくと便利です。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"build\": \"webpack --mode production\",\n+     \"deploy\": \"gh-pages -d examples/dist\",\n+     \"publish-demo\": \"npm run build &amp;&amp; npm run deploy\"\n</span>    },\n</pre></div>\n</div>\n\n<ul>\n<li>webpack.config.jsに出力先を指定します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">webpack.config.jsの一部</span></div>\n<div class=\"highlight\"><pre>  module.exports = {\n<span class=\"gi\">+     output: {\n+        path: path.join(__dirname, \"examples/dist\"),\n+        filename: \"bundle.js\"\n+    },\n</span>  }\n</pre></div>\n</div>\n\n<ul>\n<li>ではビルドしてみましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm run build\n</pre></div></div>\n\n<ul>\n<li><p>ビルドされて最小化された資産が<code>examples/dist</code>配下に出力されたのが確認できればOKです。</p></li>\n<li><p>Gitにあげる準備として<code>.gitignore</code>を作りましょう。</p></li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"txt\">\n<div class=\"code-lang\"><span class=\"bold\">.gitignore</span></div>\n<div class=\"highlight\"><pre>node_modules\ndist\n</pre></div>\n</div>\n\n<ul>\n<li>GitHubでリポジトリを新規作成して資産を登録しましょう。新規作成後の「...or create a new respository on the command line」の説明に従ってください。</li>\n</ul>\n\n<h3>\n<span id=\"確認-2\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D-2\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>下記を実行してGitHub Pagesに登録しましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm run publish-demo\n</pre></div></div>\n\n<ul>\n<li>2～3分後にGitHub PagesでWeb公開されていれば成功です。\n\n<ul>\n<li>例 =&gt; 　<a href=\"https://takumon.github.io/react-component-sample/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://takumon.github.io/react-component-sample/</a>\n</li>\n</ul>\n</li>\n</ul>\n\n<h3>\n<span id=\"補足画像ファイルを扱う場合\" class=\"fragment\"></span><a href=\"#%E8%A3%9C%E8%B6%B3%E7%94%BB%E5%83%8F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%89%B1%E3%81%86%E5%A0%B4%E5%90%88\"><i class=\"fa fa-link\"></i></a>(補足)画像ファイルを扱う場合</h3>\n\n<p>もしデモページで画像を読み込む場合は<code>file-loader</code>と<code>url-loader</code>を開発用依存ライブラリに追加してください。ビルド設定も下記のように修正が必要です。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>npm i -D file-loader url-loader\n</pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">webpack.config.jsの一部</span></div>\n<div class=\"highlight\"><pre>  module.exports = {\n    module: {\n<span class=\"gi\">+     {\n+       test: /\\.(jpg|png|ico)$/,\n+       use: 'url-loader'\n+     },\n</span>    },\n  }\n</pre></div>\n</div>\n\n<p><br><br>\nこれであとは最終手順のnpm公開を残すのみです！<br>\n<br></p>\n\n<h2>\n<span id=\"4-コンポーネントをnpmに公開する\" class=\"fragment\"></span><a href=\"#4-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92npm%E3%81%AB%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>4. コンポーネントをnpmに公開する</h2>\n\n<p>デモページも準備できたので、いよいよコンポーネントをnpmに公開しましょう。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step4\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n  ├─webpack.config.js ・・・ビルド用設定ファイル\n<span class=\"gi\">+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル(追記)\n+ ├─.npmignore        ・・・npm登録除外対処定義ファイル\n</span>  └─.gitignore\n</pre></div></div>\n\n<ul>\n<li>トランスパイル後に生成されるdist/index.jsを、npm公開資産のメインファイルに指定します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json</span></div>\n<div class=\"highlight\"><pre><span class=\"gi\">+   \"main\": \"dist/index.js\",\n</span></pre></div>\n</div>\n\n<ul>\n<li>次にnpm公開時に自動で走るスクリプト<code>prepublishOnly</code>を追加します。これによりnpm公開時にビルドし忘れるということを防ぎます。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.jsonの一部</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"prepublishOnly\": \"npm run transpile\"\n</span>    }\n</pre></div>\n</div>\n\n<ul>\n<li>このコンポーネントを使う側には、Reactがインストール済という想定ですのでpeerDependenciesを指定します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.jsonの一部</span></div>\n<div class=\"highlight\"><pre><span class=\"gi\">+   \"peerDependencies\": {\n+     \"react\": \"^16.3.0\",\n+     \"react-dom\": \"^16.3.0\"\n+   },\n</span></pre></div>\n</div>\n\n<ul>\n<li>\n<code>.npmignore</code>を作成して、npm公開資産として不用な資産（トランスパイル前のjsファイルなど）は公開対象外としましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"txt\">\n<div class=\"code-lang\"><span class=\"bold\">.npmignore</span></div>\n<div class=\"highlight\"><pre>src\nexamples\n.babelrc\n.gitignore\nwebpack.config.js\n</pre></div>\n</div>\n\n<ul>\n<li>最後にパッケージ名(package.jsonのname)を決めます。現段階では<code>react-component-sample</code>となっていて、お試しで作るコンポーネントとしては少し汎用的すぎる名前なので、<code>@自分のnpmアカウント名/raect-component-sample</code>のようにしましょう。例えば下記のように修正します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json修正例</span></div>\n<div class=\"highlight\"><pre><span class=\"gd\">-   \"name\": \"react-component-sample\",\n</span><span class=\"gi\">+   \"name\": \"@takumon/react-component-sample\",\n</span></pre></div>\n</div>\n\n<h3>\n<span id=\"確認-3\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D-3\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>ではnpm公開してみましょう。\n\n<ul>\n<li>\n<code>@takumon/react-component-sample</code>のようなパッケージ名は、<a href=\"https://docs.npmjs.com/about-scopes\" rel=\"nofollow noopener\" target=\"_blank\">Scoped Packag</a>(npmのプライベートなパッケージの命名規約)に沿っているのでデフォルトでプライベート公開になってしまいます。npmで有料契約をせずにプライベート公開しようとすると402エラーになります。そのため、ここでは<code>--access=public</code>をつけて一般公開するようにしています。（参考：<a href=\"https://stackoverflow.com/questions/45820881/npm-publish-failed-put-402\" rel=\"nofollow noopener\" target=\"_blank\">stachoverflow</a>)</li>\n<li>\n<code>Failed PUT 403</code>になる場合は、npmの認証エラーです。<code>npm login</code>しましょう。\nそれか<code>package.json</code>の<code>version</code>が古いのが原因です。いったん公開したバージョンで再公開はできません。バージョンをインクリメントしましょう。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm publish <span class=\"nt\">--access</span><span class=\"o\">=</span>public\n</pre></div></div>\n\n<ul>\n<li>これで、npm公式サイトを確認しパッケージが追加されていれば、公開完了です！</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/1c02995625c7b4d57870910d6302e8e5b7d1fdfa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f32393534363963312d623664302d626563382d303036642d6437306230393564393830362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/1c02995625c7b4d57870910d6302e8e5b7d1fdfa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f32393534363963312d623664302d626563382d303036642d6437306230393564393830362e706e67\" alt=\"図4.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/295469c1-b6d0-bec8-006d-d70b095d9806.png\"></a></p>\n\n<h2>\n<span id=\"おわりに\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>おわりに</h2>\n\n<p>今回紹介したように、わりと簡単にnpm公開できるので、普段使いまわしているようなコンポーネントがあれば公開してみるのもいいかもしれません。</p>\n\n<h2>\n<span id=\"参考\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83\"><i class=\"fa fa-link\"></i></a>参考</h2>\n\n<ul>\n<li><a href=\"https://medium.com/dailyjs/building-a-react-component-with-webpack-publish-to-npm-deploy-to-github-guide-6927f60b3220\" rel=\"nofollow noopener\" target=\"_blank\">A guide to building a React component with webpack 4, publishing to npm, and deploying the demo to GitHub Pages | Medium</a></li>\n<li><a href=\"https://hackernoon.com/creating-a-library-of-react-components-using-create-react-app-without-ejecting-d182df690c6b\" rel=\"nofollow noopener\" target=\"_blank\">Creating a library of React components using Create React App | Medium</a></li>\n</ul>\n","body":"## なにこれ\n\n[TIS Advent Calendar 2018](https://qiita.com/advent-calendar/2018/tis)の13日目の記事です。よろしくお願いします！\n\n最近Reactコンポーネントをnpm公開してみました（参考記事：[CSSのclip-pathでSlit Animationを実現する](https://takumon.com/2018/12/02/)）。そこで今回は**簡単なReactコンポーネントを作って、npm公開する方法を紹介します。**\n「React始めたんだけど...npmアカウント作ったんだけど...」という方でも30分くらいで公開できるので、とりあえず手を動かしたい人向けのチュートリアルです。\n下記のような手順でnpm公開するまでの方法を見ていきましょう。\n\n1. [コンポーネントを作成する](#1-コンポーネントを作成する)\n2. [デモページを作成する](#2-デモページを作成する)\n3. [デモページをGitHub Pagesで公開する](#3-デモページをgithub-pagesで公開する)\n4. [コンポーネントをnpmに公開する](#4-コンポーネントをnpmに公開する)\n\n\n※ 完成品はGitHubに公開しています => [Takumon/react-component-sample](https://github.com/Takumon/react-component-sample/tree/step4)\n※ 完成品は下記のようなプロジェクト構成になります。\n\n```\nプロジェクトルート\n├─dist              ・・・ コンポーネントビルド資産出力場所\n├─src               ・・・ コンポーネント資産\n│   ├─index.js\n│   └─styles.css\n├─examples          ・・・ デモページ用資産\n│  ├─dist           ・・・ デモページビルド資産出力場所\n│  └─src\n│     ├─index.html\n│     └─index.js\n├─node_modules\n├─.babelrc          ・・・トランスコンパイル用設定ファイル\n├─webpack.config.js ・・・ビルド用設定ファイル\n├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n├─.npmignore        ・・・npm登録除外対処定義ファイル\n└─.gitignore\n```\n\n\n## 1. コンポーネントを作成する\n\nまずはコンポーネントを作ってトランスパイルするところまで完成させましょう。\n\n<small>※ 本手順完了時のソースコードは**[こちら](https://github.com/Takumon/react-component-sample/tree/step1)**</small>\n<small>※ 本手順完了時のプロジェクト構成 ↓</small>\n\n```diff\nプロジェクトルート\n+ ├─dist          ・・・ コンポーネントビルド資産出力場所\n+ ├─src           ・・・ コンポーネント資産\n+ │   ├─index.js\n+ │   └─styles.css\n+ ├─node_modules\n+ ├─.babelrc      ・・・トランスコンパイル用設定ファイル\n+ └─package.json  ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n```\n\n\n\n* 最初にプロジェクトの雛形を作ります。`npm init`で色々聞かれますが全てデフォルトで構いません。\n\n```bash\nmkdir react-component-sample\ncd react-component-sample\nnpm init\n```\n\n\n* 最低限のReact系ライブラリをインストールします。開発用ライブラリとしてインストールするので`-D`オプションを付けてください。\n\n```bash\nnpm i -D react react-dom\n```\n\n\n* BabelでReactをトランスコンパイルするためのライブラリをインストールします。こちらも開発用ライブラリなので`-D`オプションを付けましょう。\n\n```\nnpm i -D @babel/cli @babel/cli @babel/core @babel/preset-env @babel/preset-react babel-loader\n```\n\n\n* `.babelrc`を作成し、Reactをトランスコンパイルするための定義を記載します。\n\n```javascript:.babelrc\n{\n    \"presets\": [\n        \"@babel/preset-env\",\n        \"@babel/react\"\n    ]\n}\n```\n\n\n* コンポーネントを作ります。\n\n```jsx:src/index.js\nimport React from 'react';\nimport './styles.css';\nconst MyComponent = () => (\n    <h1>Hello from My Component</h1>\n);\nexport default MyComponent;\n```\n\n\n* コンポーネントで読み込むCSSを作ります。\n\n```css:src/styles.css\nh1 {\n    color: red;\n}\n```\n\n\n* トランスパイル用スクリプトをpackage.jsonに追加します。具体的にはJSファイルをトランスパイルしdistフォルダに出力、それ以外のファイル(CSS)をdistファイルにコピーするスクリプトです。\n\n```diff:package.json\n    \"scripts\": {\n+     \"transpile\": \"babel src -d dist --copy-files\"\n    },\n```\n\n### 確認\n\n* 準備が整ったので、トランスパイルしてみましょう。\n\n```bash\nnpm run transpile\n```\n\n\n* 下記のようにdistフォルダ配下にindex.jsとstyles.cssが生成されればトランスパイル成功です。\n\n```:トランスパイル後の資産\nプロジェクトルート\n├─dist           ・・・ コンポーネントビルド資産出力場所\n│   ├─index.js\n│   └─styles.css\n```\n\n\n\n## 2. デモページを作成する\n\n実際にコンポーネントを使用したデモページもあわせて用意しておきましょう。コンポーネントの使い方をユーザーにわかりやすく示すことができます。\nここではローカルでデモページが見れるところまでを作成します。\n\n<small>※ 本手順完了時のソースコードは**[こちら](https://github.com/Takumon/react-component-sample/tree/step2)**</small>\n<small>※ 本手順完了時のプロジェクト構成 ↓</small>\n\n```diff\nプロジェクトルート\n  ├─dist\n  ├─src\n  │   ├─index.js\n  │   └─styles.css\n  ├─node_modules\n  ├─.babelrc\n+ ├─examples          ・・・ デモページ用資産\n+ │  ├─dist           ・・・ デモページビルド資産出力場所\n+ │  └─src\n+ │     ├─index.html\n+ │     └─index.js\n+ ├─webpack.config.js ・・・ビルド用設定ファイル\n+ └─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n```\n\n\n\n* デモページはwebpackでビルドするので必要なライブラリをインストールします。\n\n```\nnpm i -D html-webpack-plugin webpack webpack-cli webpack-dev-server css-loader style-loader\n```\n\n\n* デモページのHTMLを作成します。\n\n```html:examples/src/index.html\n<html>\n<head>\n    <title>My Component Demo</title>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n</head>\n<body>\n    <noscript>\n        You need to enable JavaScript to run this app.\n    </noscript>\n    <div id=\"root\"></div>\n</body>\n</html>\n```\n\n\n* デモページの起点となるコンポーネントを作成します。この時、[1. コンポーネントを作成する](#1-コンポーネントを作成する)で作成したコンポーネントを使います。\n\n```jsx:examples/src/index.js\nimport React from 'react';\nimport { render } from 'react-dom'\nimport MyComponent from '../../src'\n\nconst App = () => <MyComponent/>;\nrender(<App />, document.getElementById('root'));\n```\n\n\n* デモページのビルド設定ファイル（webpack.config.js）を作りましょう。\n\n```javascript:webpack.config.js\nconst path = require('path');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\n// HTMLファイルのビルド設定\nconst htmlWebpackPlugin = new HtmlWebpackPlugin({\n    template: path.join(__dirname, 'examples/src/index.html'),\n    filename: './index.html'\n});\nmodule.exports = {\n    // 依存関係解決の起点となる資産を指定します。\n    entry: path.join(__dirname, 'examples/src/index.js'),\n    // Babelのトランスパイル対象資産を指定します。\n    module: {\n        rules: [\n            {\n                test: /\\.(js|jsx)/,\n                use: 'babel-loader',\n                exclude: /node_modules/\n            },\n            {\n                test: /\\.css$/,\n                use: [\"style-loader\", \"css-loader\"]\n            }\n        ]\n    },\n    plugins: [htmlWebpackPlugin],\n    resolve: {\n        extensions: ['.js', '.jsx']\n    },\n    // 開発用Webサーバのポートを指定します。\n    devServer: {\n        port: 3001\n    }\n}\n```\n\n\n* デモページ起動用スクリプトをpackage.jsonに追記します。\n\n```diff:package.jsonの一部\n    \"scripts\": {\n+     \"start\": \"webpack-dev-server --mode development\"\n    },\n```\n\n### 確認\n\n* 準備が整ったのでデモページを起動しましょう。\n\n```bash\nnpm start\n```\n\n\n* ブラウザで`http://localhost:3001`にアクセスしてコンポーネントが表示されればOKです。\n\n\n![図1.png](https://qiita-image-store.s3.amazonaws.com/0/49915/d6587175-21d7-a15b-48e9-3c6ec31ed105.png)\n\n\n\n## 3. デモページをGitHub Pagesで公開する\n\nデモページをローカルで見れるようになったら、次はGitHubに資産を登録し、GitHub Pagesで公開しましょう。プラグインで簡単に公開できます。\n\n\n<small>※ 本手順完了時のソースコードは**[こちら](https://github.com/Takumon/react-component-sample/tree/step3)**</small>\n<small>※ 本手順完了時のプロジェクト構成 ↓</small>\n\n```diff\nプロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n+ ├─webpack.config.js ・・・ビルド用設定ファイル（追記）\n+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n+ └─.gitignore\n```\n\n\n\n* github-pagesというGitHub公開用プラグインをインストールします。\n\n```bash\nnpm i -D gh-pages\n```\n\n\n* package.jsonにGitHubPages公開用スクリプトを３個追加します。\n  * `publish-demo`はビルドとデプロイをいっぺんにやるスクリプトです。デプロイ前に大抵の場合ビルドするので、1つにまとめておくと便利です。\n\n```diff:package.json\n    \"scripts\": {\n+     \"build\": \"webpack --mode production\",\n+     \"deploy\": \"gh-pages -d examples/dist\",\n+     \"publish-demo\": \"npm run build && npm run deploy\"\n    },\n```\n\n* webpack.config.jsに出力先を指定します。\n\n```diff:webpack.config.jsの一部\n  module.exports = {\n+     output: {\n+        path: path.join(__dirname, \"examples/dist\"),\n+        filename: \"bundle.js\"\n+    },\n  }\n```\n\n* ではビルドしてみましょう。\n\n```bash\nnpm run build\n```\n\n* ビルドされて最小化された資産が`examples/dist`配下に出力されたのが確認できればOKです。\n\n\n* Gitにあげる準備として`.gitignore`を作りましょう。\n\n```txt:.gitignore\nnode_modules\ndist\n```\n\n\n* GitHubでリポジトリを新規作成して資産を登録しましょう。新規作成後の「...or create a new respository on the command line」の説明に従ってください。\n\n### 確認\n* 下記を実行してGitHub Pagesに登録しましょう。\n\n```bash\nnpm run publish-demo\n```\n\n* 2～3分後にGitHub PagesでWeb公開されていれば成功です。\n    * 例 => 　https://takumon.github.io/react-component-sample/\n\n\n\n### (補足)画像ファイルを扱う場合\n\nもしデモページで画像を読み込む場合は`file-loader`と`url-loader`を開発用依存ライブラリに追加してください。ビルド設定も下記のように修正が必要です。\n\n```\nnpm i -D file-loader url-loader\n```\n\n```diff:webpack.config.jsの一部\n  module.exports = {\n    module: {\n+     {\n+       test: /\\.(jpg|png|ico)$/,\n+       use: 'url-loader'\n+     },\n    },\n  }\n```\n\n\n\n<br />\nこれであとは最終手順のnpm公開を残すのみです！\n<br />\n\n\n\n\n## 4. コンポーネントをnpmに公開する\n\nデモページも準備できたので、いよいよコンポーネントをnpmに公開しましょう。\n\n<small>※ 本手順完了時のソースコードは**[こちら](https://github.com/Takumon/react-component-sample/tree/step4)**</small>\n<small>※ 本手順完了時のプロジェクト構成 ↓</small>\n\n```diff\nプロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n  ├─webpack.config.js ・・・ビルド用設定ファイル\n+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル(追記)\n+ ├─.npmignore        ・・・npm登録除外対処定義ファイル\n  └─.gitignore\n```\n\n\n\n* トランスパイル後に生成されるdist/index.jsを、npm公開資産のメインファイルに指定します。\n\n```diff:package.json\n+   \"main\": \"dist/index.js\",\n```\n\n\n* 次にnpm公開時に自動で走るスクリプト`prepublishOnly`を追加します。これによりnpm公開時にビルドし忘れるということを防ぎます。\n\n\n```diff:package.jsonの一部\n    \"scripts\": {\n+     \"prepublishOnly\": \"npm run transpile\"\n    }\n```\n\n\n* このコンポーネントを使う側には、Reactがインストール済という想定ですのでpeerDependenciesを指定します。\n\n```diff:package.jsonの一部\n+   \"peerDependencies\": {\n+     \"react\": \"^16.3.0\",\n+     \"react-dom\": \"^16.3.0\"\n+   },\n```\n\n\n* `.npmignore`を作成して、npm公開資産として不用な資産（トランスパイル前のjsファイルなど）は公開対象外としましょう。\n\n```txt:.npmignore\nsrc\nexamples\n.babelrc\n.gitignore\nwebpack.config.js\n```\n\n* 最後にパッケージ名(package.jsonのname)を決めます。現段階では`react-component-sample`となっていて、お試しで作るコンポーネントとしては少し汎用的すぎる名前なので、`@自分のnpmアカウント名/raect-component-sample`のようにしましょう。例えば下記のように修正します。\n\n```diff:package.json修正例\n-   \"name\": \"react-component-sample\",\n+   \"name\": \"@takumon/react-component-sample\",\n```\n\n\n### 確認\n\n* ではnpm公開してみましょう。\n  * `@takumon/react-component-sample`のようなパッケージ名は、[Scoped Packag](https://docs.npmjs.com/about-scopes)(npmのプライベートなパッケージの命名規約)に沿っているのでデフォルトでプライベート公開になってしまいます。npmで有料契約をせずにプライベート公開しようとすると402エラーになります。そのため、ここでは`--access=public`をつけて一般公開するようにしています。（参考：[stachoverflow](https://stackoverflow.com/questions/45820881/npm-publish-failed-put-402))\n  * `Failed PUT 403`になる場合は、npmの認証エラーです。`npm login`しましょう。\nそれか`package.json`の`version`が古いのが原因です。いったん公開したバージョンで再公開はできません。バージョンをインクリメントしましょう。\n\n```bash\nnpm publish --access=public\n```\n\n\n* これで、npm公式サイトを確認しパッケージが追加されていれば、公開完了です！\n\n![図4.png](https://qiita-image-store.s3.amazonaws.com/0/49915/295469c1-b6d0-bec8-006d-d70b095d9806.png)\n\n\n\n\n\n## おわりに\n\n今回紹介したように、わりと簡単にnpm公開できるので、普段使いまわしているようなコンポーネントがあれば公開してみるのもいいかもしれません。\n\n\n\n## 参考\n* [A guide to building a React component with webpack 4, publishing to npm, and deploying the demo to GitHub Pages | Medium](https://medium.com/dailyjs/building-a-react-component-with-webpack-publish-to-npm-deploy-to-github-guide-6927f60b3220)\n* [Creating a library of React components using Create React App | Medium](https://hackernoon.com/creating-a-library-of-react-components-using-create-react-app-without-ejecting-d182df690c6b)\n\n","comments_count":0,"created_at":"2018-12-12T00:56:33+09:00","likes_count":22,"reactions_count":0}}}