{"data":{"site":{"siteMetadata":{"title":"Takumon Blog","author":"Takuto Inoue"}},"markdownRemark":{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 133.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAIAAADzvTiPAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGeklEQVQ4ywFvBpD5ACoiCyohDSwiDykgDD0yH3NcS3BSRm5QQ3FURnVXSIBkUoVqV410XpV6YpJ3XZR9Yo55YTMiGCEcEzAqGQAtIw0tJA0wJw4zKRItIgxiTDe3qZK4qpS8rJbPx7Gyp5G9s5zUy7SzoYe5qZDLv6eyoo4lFQ05MR13ZDoANiwQNisQOCsQOy8UNioRalE54ta63dK4xLCa5+HJuauUxbqk3NO8tKKGy7+owbKZmYVxGw8LTEEmkHlHAEg6FUo7FkEzE0E0FjwwE11ELM61ntPAqrink8W+p7ywmb+0ncK0mbOjia2dhLWmjX9vXBMLBkc+JnxpQABOPxZURBhNPhhKOxlDNRZSPSWxmom4o5Kxno6wmYO3n4m3nomphGWWbVCNZEyYbVRcNygWDghEPixoW0EATD0VTz8WTj4XSzwYRDkYUTYeqYh80sCvtpuRy7WizLWi2Me2r4VriVhBiltGk2NPWywgGhELRUU/Y2BaAEc5E0g6FEc4FUc5F0I3F0wyGqWDfN3QwL6po9C+rsiypNrMv6R+aXxJOXhUQ2dVRUokGBsVEVljbXmIlwBANBFBNBJBNBRDNhZBNhhELRapi4PYyr+9qanJt6zItavXyb+Wbl5pOy9tSj1PSTkvGw8dGhhleZCBmrUAPC8QPTARPjETQTMVQDYZPCUPk3Bu1sfAsp6ms5qV3dPFzr+5hFtTRDcqXkg7TjwuFxMIFhcXS1ttXG+FADstEDsuED0vEj8xFD81GTolDopkY9fLw6eRmrSemu/r2tTHv3ZGQ0gvJkdFODwyJhQQBxITESwyODg8QgA5LA46LQ87LhE9MBU/NBo4JQ6HX1vJuLOynqGii4vGs627paVvQD1VIx9OOC8vKh0RDgYTEQ0kIx0vKyUANywPOCwPOi0RPDAUPjQaNiQPnXxu28vAw6ypa1VagH18p46PWicnVyEeVSgjKSAVDAwFFBILKCMWNCscADktEDgtEDotETwvFT4yGjoqE3NFP8CmoaKAg3BKT4yOiJyflyscGEseGjwjGyUbEBYLBhYTCiwkFDctGQA5LBA4LBA5LRI9MBU/Mxs8LhdkMSu7m5WEVlx+T1HDurB5fHYWFxElHRU3HBRNGREpDgoUEgkrIhE5LhcAOCsQOCwQOi0RPDAVQDQcPzIaXysjwJ6Xg1FTbzc6sJmSXl9cFRIMFBUNEhYNHhAIFwYDFRIIJx4POS4YADcrDzUpDzgsETwvFT8zHT8zHFwoH7WNh39JSnE7PObSw3l5cRQMB4E3LI4sIUspGzUyIhINBScfDzcsFwAwJg00Kg83Kw86LhU+Mx04LhhtQja0jIWngHpyOTiwi4NXT0uSTkboYVbdPzSoNSk7NyUZEggrIhI7LxcAOi4RKSEMMSYOPC4VPTIcOTEbYzYpnWxmmG5oaCkpyayjaWFalCsq3UlDwSQgjjMlREAsFQ4EKR8ONioTAHNXI1dDHDMoEC4jETswGzguGWU7L8Ohl3I3NF8eHbSNhlhDPldBOJtJQX48MbylelpPOAsGACYdDCwiDAB4WyV5WiZvVCNQPRowJhUpIhNpQzbXvLKfdm9mKCXCoZtZRUKWlIft6c/Y0Kzw2ahNQS8KBQAdFQgsIAsAeVkldFYkdVgmeVspaE0lPjEYVy0jp3hykWNdYyUi3cjCYF9afHdu//jk5dS25c+mSD4sDAgAFhEHPi4UAH1cKHhZJ3VXJ3FUJ3NUKG9XK1sjE6NzcXc9OlwZFm04NjUZGHpwavXt3ePWvePQrUU7KQsHAC4kEFtEIAB/Xip6WilyVSdvUyZxUyhrUihlMR+kdnSDTkthIh9dHBoyDAtjWlbw5tjm2cPgz7E9NCQjGAdfRiFQOxwAfl4qelsqdlcpdVYpcVIoa1IoaTcofkBCsY+LazAtZCMhThgWRkA77OLV6dzH282yPTMlVz0ZcFIlWUEeAH1cKnxbK3taK3ZXKXFRJn9nO5ZvVKF0aYJPR1IPDF8bG0QQECclI9zUy/jr2NXHsFhEJmhKIGVJIWJHHwCAXit9XCp4Vyp3WCttTR+ijGz18uDv6NTdzbjHrpaqhG96W0hGPC3IvK7u4tFoWk5kSSVoSyFmSiJgRR8AhmMvf10sfVsreFgsdVUqel03inBUlIFstKuf3tzX/f77///19O3X8+jE5tWpp4hej3JFX0Mea00haUog7Lc/iWKrFNIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"jjug\"\n        title=\"\"\n        src=\"/static/f007bb42cf8b1fea5b9c8267547bc3f7/fb8a0/jjug.png\"\n        srcset=\"/static/f007bb42cf8b1fea5b9c8267547bc3f7/1a291/jjug.png 148w,\n/static/f007bb42cf8b1fea5b9c8267547bc3f7/2bc4a/jjug.png 295w,\n/static/f007bb42cf8b1fea5b9c8267547bc3f7/fb8a0/jjug.png 590w,\n/static/f007bb42cf8b1fea5b9c8267547bc3f7/526de/jjug.png 885w,\n/static/f007bb42cf8b1fea5b9c8267547bc3f7/fa2eb/jjug.png 1180w,\n/static/f007bb42cf8b1fea5b9c8267547bc3f7/08f6a/jjug.png 1770w,\n/static/f007bb42cf8b1fea5b9c8267547bc3f7/7e026/jjug.png 3024w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>Java CCC 2018 Fallに参加してきました。\n見てきたセッションは以下の通りです。</p>\n<ol>\n<li>\n<p>【JJUG基調講演】Javaの未来を考えよう </p>\n<ul>\n<li><a href=\"http://www.java-users.jp/ccc2018fall/#/sessions/e1dbadf5-158a-4138-a3fa-f139329b2cdf\">セッション概要</a></li>\n<li><a href=\"https://twitter.com/search?q=%23ccc_e1\">#ccc_e1</a></li>\n</ul>\n</li>\n<li>\n<p>マネーフォワードのアカウントアグリゲーションの現状と課題点について／Selenium WebDriverとヘッドレスChromeを用いたスクレイピング</p>\n<ul>\n<li><a href=\"http://www.java-users.jp/ccc2018fall/#/sessions/2f1cc228-b536-4775-8dad-5cbafffab39e\">セッション概要</a></li>\n<li><a href=\"https://twitter.com/search?q=%23ccc_g2\">#ccc_g2</a></li>\n</ul>\n</li>\n<li>\n<p>思考停止しないアーキテクチャ設計</p>\n<ul>\n<li><a href=\"http://www.java-users.jp/ccc2018fall/#/sessions/d4cbd28c-0028-46d7-9589-5883af93825c\">セッション概要</a> </li>\n<li><a href=\"https://www.slideshare.net/kawasima/jjug-ccc-2018-fall\">スライド</a></li>\n<li><a href=\"https://twitter.com/search?q=%23ccc_e3\">#ccc_e3</a> </li>\n</ul>\n</li>\n<li>\n<p>エムスリーでのKotlinへの取り組み</p>\n<ul>\n<li><a href=\"http://www.java-users.jp/ccc2018fall/#/sessions/331c1102-be76-4e17-bf7c-43f55dbc73da\">セッション概要</a></li>\n<li><a href=\"https://speakerdeck.com/m3_engineering/jjug-ccc-2018fall-kotlin-in-m3?slide=69\">スライド</a></li>\n<li><a href=\"https://twitter.com/search?q=%23ccc_a4\">#ccc_a4</a> </li>\n</ul>\n</li>\n<li>\n<p>既存アプリケーションでKotlinを導入してみた</p>\n<ul>\n<li><a href=\"http://www.java-users.jp/ccc2018fall/#/sessions/9f265f00-8a25-40e2-9ca3-c701bb5154e4\">セッション概要</a> </li>\n<li><a href=\"https://docs.google.com/presentation/d/1wTm_eSbsM2ihfz27QpSHzuRcCIhcRYKom-Vx_-FfUts\">スライド</a></li>\n<li><a href=\"https://twitter.com/search?q=%23ccc_c5\">#ccc_c5</a> </li>\n</ul>\n</li>\n<li>\n<p>コードをどまんなかに据えた設計アプローチ(irof)</p>\n<ul>\n<li><a href=\"http://www.java-users.jp/ccc2018fall/#/sessions/536c5e49-1730-430c-811e-c38a77cedd45\">セッション概要</a> </li>\n<li><a href=\"https://speakerdeck.com/irof/kodowodomannakaniju-etashe-ji-apuroti\">スライド</a></li>\n<li><a href=\"https://twitter.com/search?q=%23ccc_e6\">#ccc_e6</a> </li>\n</ul>\n</li>\n<li>\n<p>「マイクロソフト牛尾さん渡米直前記念」外資系企業で働くエンジニアの生産性向上物語(日本マイクロソフト株式会社)</p>\n<ul>\n<li><a href=\"http://www.java-users.jp/ccc2018fall/#/sessions/b0657145-4de3-4a64-b02b-83fbc2fdc6b9\">セッション概要</a></li>\n<li><a href=\"https://twitter.com/search?q=%23ccc_g7\">#ccc_g7</a></li>\n</ul>\n</li>\n</ol>\n<p>それぞれの感想を下記に示します。</p>\n<h2 id=\"イベント概要\"><a href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E6%A6%82%E8%A6%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>イベント概要</h2>\n<ul>\n<li>\n<p>公式サイト</p>\n<ul>\n<li><a href=\"http://www.java-users.jp/ccc2018fall\">JJUG CCC 2018 Fall</a></li>\n</ul>\n</li>\n<li>\n<p>開催日時</p>\n<ul>\n<li>2018/012/15(土) 09:30 - 21:00</li>\n</ul>\n</li>\n<li>\n<p>開催場所</p>\n<ul>\n<li><a href=\"https://www.bellesalle.co.jp/shisetsu/shinjuku/bs_shinjukugrand/\">ベルサール新宿グランド　コンファレンスセンター </a></li>\n</ul>\n</li>\n<li>\n<p>ハッシュタグ</p>\n<ul>\n<li><a href=\"https://twitter.com/search?q=%23jjug_ccc\">#jjug_ccc</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"【jjug基調講演】javaの未来を考えよう\"><a href=\"#%E3%80%90jjug%E5%9F%BA%E8%AA%BF%E8%AC%9B%E6%BC%94%E3%80%91java%E3%81%AE%E6%9C%AA%E6%9D%A5%E3%82%92%E8%80%83%E3%81%88%E3%82%88%E3%81%86\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>【JJUG基調講演】Javaの未来を考えよう</h2>\n<p>※スライドなし（いまのところ）</p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADnklEQVQozwGTA2z8AKCVkpmOip+VkLWwrMnFw8K9uqWfmaOdlqOdmKWfma6rqL25ua+qp6Odl6OclJ+WjJ6Vi6GWjqSZlLOopACglZGTiISSioSTjomjnpqhm5WalI6empSfmpSfm5SjoJuin5uyr6qrp6GclYuakoebkoejmpHJwr/NxsMAiX97iYF8o5yYop2Zi4WBhH54nJeTwr+8n5uWko+ImJWPo6CZv724qaWfl5CHlo6Fl4+Fp6Gbtq+rpJqTAIZ+eX93cpeSjpaTkHd0cY6Lh4iFgIyJg5yZk52bloaEfomHgKKemKSemYmDfIqCepOLhLCqppeQin52bgBxa2d9eHSKhYFrZ2RoZ2N/f3twc29kaWRxeHR0e3dna2hpamdubmtoZ2NhXllfXFdfXFheW1dNTEdgW1YAOzo6hX96gXt1fHdwg392UlJNWmJegZaQfpSOfpOOYmpnTk9LUFFLTExGTUtFS0pER0ZARkQ/KiwqaWRcACAgIrWrn8i9r7uwpL+2qXdyanqCdsrj0OX/8N7/6o6cj1pZUV1dVWFfVmJfVl5bU1dUTFZTSy8uLHdwZwAoJiVzbWWVjIOMhHpbWFJpZV5yc2uwvreJm5WQopqDi4JTUUtmZl5zcGhDQj49PThgXVRTT0clIyJ6cmgAJyQiREFDdW9yQEBCODk4Qz49RDw7RERDY15YTD89eG1oiYZ8SEhDWFdPNS4tMCcoW1NMaGJgMjZEV0VBADIpJU1MTVVSUVpYVmJfW15bVkdFQ2djXIB6cFZUTjMzMT89Ojg4NS0vLSIjIx4bHCknJ3BsaGliYzIkJgBDPz0VFRZhXViOi4OWkoqHhH2cmJCwraOKhn09PDgmJyQgICAlJiUZGhwlJygjJicWGRojJCRVUExnYVwAvLCkW1ZRGhscICEiJycoICAhJSUlQD88MTEvFRYWFBUWNjYyQUA5JSUlGBkcHB0fICAiHyAhiYJ5j4d/AK+glcK0ptXKv/Ds3r25rTk4NgUHCQwODxkZGRITFCQkIlxbU3p5cT08PCwsLSIjJBobHhcYGgcIDAIFCQA/ODVrYVmrn5KUj4Q/PDcfHh0REhIUFhYqKicbGxo3NjHIx8D////8+uzv59nYzsPDuq+7s6mnn5eOhX4ABQUGGhgWJiQgEhEQIR8dHx4cGBgWHh4cMjEuKSckcW1n///8/v77/v/1//7u//vr//3t///y///x//zrho6EI/vUBXkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"基調講演\"\n        title=\"\"\n        src=\"/static/ca454f13bf9c03896b1c0d2bdc85a252/fb8a0/kityokoen.png\"\n        srcset=\"/static/ca454f13bf9c03896b1c0d2bdc85a252/1a291/kityokoen.png 148w,\n/static/ca454f13bf9c03896b1c0d2bdc85a252/2bc4a/kityokoen.png 295w,\n/static/ca454f13bf9c03896b1c0d2bdc85a252/fb8a0/kityokoen.png 590w,\n/static/ca454f13bf9c03896b1c0d2bdc85a252/526de/kityokoen.png 885w,\n/static/ca454f13bf9c03896b1c0d2bdc85a252/fa2eb/kityokoen.png 1180w,\n/static/ca454f13bf9c03896b1c0d2bdc85a252/08f6a/kityokoen.png 1770w,\n/static/ca454f13bf9c03896b1c0d2bdc85a252/285f8/kityokoen.png 4032w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<br />\n<p>CCCには過去4回ほど午後からグダグダ参加でしたが、今回初めて朝一で基調講演を聞きに行きました。\n前半は、鈴木会長(withお子様)のお話で、後半は、せろさん、じゅくちょーさん、きしださんのによるパネルディスカッションでした。</p>\n<p>ところで毎回JJUGで思うのですが、@nakayama_san さんの絵がすごいです。これを見るとJJUG来たなーって感じます。</p>\n<blockquote class=\"twitter-tweet\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">Javaの未来を考えよう を聞いてきたメモ<a href=\"https://twitter.com/hashtag/ccc_e1?src=hash&amp;ref_src=twsrc%5Etfw\">#ccc_e1</a> <a href=\"https://twitter.com/hashtag/jjug_ccc?src=hash&amp;ref_src=twsrc%5Etfw\">#jjug_ccc</a> <a href=\"https://t.co/rc8m8EmUvT\">pic.twitter.com/rc8m8EmUvT</a></p>&mdash; Nakayama san (@nakayama_san) <a href=\"https://twitter.com/nakayama_san/status/1073756080910430209?ref_src=twsrc%5Etfw\">2018年12月15日</a></blockquote>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<h4 id=\"javaの歴史\"><a href=\"#java%E3%81%AE%E6%AD%B4%E5%8F%B2\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Javaの歴史</h4>\n<p>正直Sun時代のJavaの歴史などは、自分の中で曖昧だったので、サクッと知れ良かったです。\nJavaのサポートについては、Oracleから配布されているJDK使っていればOKという状況ではなくなっているので、\n有償サポート・無償サポートなどの状況を正確に把握する必要があるなぁと感じました。</p>\n<div class=\"gatsby-code-title\">Javaの歴史</div>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\"><span class=\"token list punctuation\">*</span> 1999年\n<span class=\"token code keyword\">    * Apatch Jakarta ProjectからTomcatがリリース</span>\n<span class=\"token code keyword\">    * Java OSSの受け皿としてApack Jakarta Project開始</span>\n<span class=\"token code keyword\">        * 今のJavaの技術の基礎を作った</span>\n<span class=\"token code keyword\">    * 2011年に役目を終えた（全プロジェクトがトップレベルに移行）</span>\n<span class=\"token list punctuation\">*</span> 2004年\n<span class=\"token code keyword\">    * Eclipse Foundation が非営利団体として設立</span>\n<span class=\"token list punctuation\">*</span> 2006年\n<span class=\"token code keyword\">    * SunがOpen JDKを公開（GPLv2ライセンス）</span>\n<span class=\"token list punctuation\">*</span> 2010年\n<span class=\"token code keyword\">    * OracleがSunを74億ドルで買収</span>\n<span class=\"token list punctuation\">*</span> 2016年\n<span class=\"token code keyword\">    Java EE Guardians</span>\n<span class=\"token code keyword\">    * OracleのJava EE仕様策定遅延を懸念し、Java EEを守ろうとする団体が発足</span>\n<span class=\"token list punctuation\">*</span> 2017年9月\n<span class=\"token code keyword\">    * Java EE オープンソース化しEclipse Foundationへ移管</span>\n<span class=\"token code keyword\">    * EE4J(Eclipse Enterprise for Java)発足</span>\n<span class=\"token list punctuation\">*</span> 2017年9月以降～現在\n<span class=\"token code keyword\">    * Eclipse MicroProfile発足</span>\n<span class=\"token code keyword\">    * Java SEリリースモデル変更</span>\n<span class=\"token code keyword\">        * 半年に一回のバージョンアップ</span>\n<span class=\"token code keyword\">        * サポートは次バージョンが出るまで</span>\n<span class=\"token code keyword\">        * 3年置おきの長期間サポートバージョンの提供</span>\n<span class=\"token code keyword\">    * 有償・無償など</span>\n<span class=\"token code keyword\">        * 有償：Oracle, IBM, RedHat, Azul</span>\n<span class=\"token code keyword\">        * 無償：AdoptOpenJDK HotSpot/OpenJ9, Amazon Corretto</span>\n<span class=\"token code keyword\">        * 条件付き無償：Azure上の Azul Systems Zulu Enterprise</span>\n<span class=\"token code keyword\">    * 買収</span>\n<span class=\"token code keyword\">        * IBMがRedHat買収</span>\n<span class=\"token code keyword\">        * MicrosoftがGitHub買収 などなど</span></code></pre></div>\n<h4 id=\"パネルディスカッション\"><a href=\"#%E3%83%91%E3%83%8D%E3%83%AB%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>パネルディスカッション</h4>\n<p>コミュニティ活性化への熱い思いを感じました。\n確かに、フリーライドするだけでなく、コミュニティに貢献したり、プルリク出したりと、自分から積極的に関わることが重要だと思います。\nまたブログの重要性についても触れていて、きしださんの「ブログ書くと他人に影響を与えられて、自分の都合のいい世界になっていく」という言葉が印象的でした。</p>\n<div class=\"gatsby-code-title\">パネルディスカッション</div>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\"><span class=\"token list punctuation\">*</span> 「Java有償化」というワードの一人歩き\n<span class=\"token list punctuation\">*</span> VM\n  <span class=\"token list punctuation\">*</span> JVM実行環境が変わってきている。GraalVM登場、動的型付け言語をサポート\n  <span class=\"token list punctuation\">*</span> Project Metropolis\n<span class=\"token code keyword\">    * C++で書かれているJVMをJavaで書き換えようというプロジェクト</span>\n  <span class=\"token list punctuation\">*</span> 個人で作るときはJavaは配布がめんどい、Nativeコンパイルが流行ってくれていれば\n<span class=\"token code keyword\">      * Javaもそうなろうとしている</span>\n  <span class=\"token list punctuation\">*</span> AWS Lamdaなどのファンクションとして起動するものが増えてきた。Javaもそれに合わせて変わってきている\n<span class=\"token code keyword\">    * JITコンパイル時にNativeコードに変換するから起動が早くなってる</span>\n<span class=\"token code keyword\">    * Javaのコアモジュールの分割</span>\n<span class=\"token code keyword\">      * モジュール分割されて　必要最低限のコアモジュールだけ取り込むことが可能</span>\n<span class=\"token list punctuation\">*</span> Javaコミュニティ\n  <span class=\"token list punctuation\">*</span> Javaライフサイクル短縮により、情報をより頻繁に取り入れる必要が出てくるため。コミュニティ活性化につながる。国際交流の機会が増える。\n  <span class=\"token list punctuation\">*</span> 日本の新元号がJava11で組み込まれているけど　メーリングリストではあまり話題にならなかったなぁ。日本の人が声を上げないと不都合な変更がそのままになる\n  <span class=\"token list punctuation\">*</span> StrutsのEOL\n<span class=\"token code keyword\">    * 日本人でコミッターがいれば日本で引き継げたのかも</span>\n  <span class=\"token list punctuation\">*</span> フリーライドするだけでもいいが、積極的に貢献することも重要\n  <span class=\"token list punctuation\">*</span> ブログを書く\n<span class=\"token code keyword\">    * 自分から情報を公開すると自分の都合のいい世界に変わっていく</span>\n  <span class=\"token list punctuation\">*</span> 積極的にコミュニティにかかわっていってください\n<span class=\"token list punctuation\">*</span> QA\n  <span class=\"token list punctuation\">*</span> 各人のNextStepは何ですか\n<span class=\"token code keyword\">    * きしださん</span>\n<span class=\"token code keyword\">      * 朝起きれる人になりたい</span>\n<span class=\"token code keyword\">    * じゅくちょーさん</span>\n<span class=\"token code keyword\">      * JVMになりたい</span>\n<span class=\"token code keyword\">      * 読むだけではなくコントリビュートしたい</span>\n<span class=\"token code keyword\">    * せろさん</span>\n<span class=\"token code keyword\">      * エンターテイメントに関わっていきたい。を盛り上げたい</span></code></pre></div>\n<h2 id=\"マネーフォワードのアカウントアグリゲーションの現状と課題点について／selenium-webdriverとヘッドレスchromeを用いたスクレイピング\"><a href=\"#%E3%83%9E%E3%83%8D%E3%83%BC%E3%83%95%E3%82%A9%E3%83%AF%E3%83%BC%E3%83%89%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%82%A2%E3%82%B0%E3%83%AA%E3%82%B2%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E7%8F%BE%E7%8A%B6%E3%81%A8%E8%AA%B2%E9%A1%8C%E7%82%B9%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%EF%BC%8Fselenium-webdriver%E3%81%A8%E3%83%98%E3%83%83%E3%83%89%E3%83%AC%E3%82%B9chrome%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>マネーフォワードのアカウントアグリゲーションの現状と課題点について／Selenium WebDriverとヘッドレスChromeを用いたスクレイピング</h2>\n<p>※スライドなし(いまのところ)</p>\n<p>マネーフォワードさんではお金に関する４つのサービスを提供しているそうです。\n今回はそのうちの１つ「Money Forword Home」のアプリについてのお話でした。</p>\n<div class=\"gatsby-code-title\">会社概要</div>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\"><span class=\"token list punctuation\">*</span> マネーフォワードが提供しているサービス\n  <span class=\"token list punctuation\">*</span> Money Forword Home\n<span class=\"token code keyword\">    * 個人向け　家計簿　スマホアプリ</span>\n  <span class=\"token list punctuation\">*</span> Noney Forword Business\n<span class=\"token code keyword\">    * 法人向け お金の状態を可視化するアプリ</span>\n  <span class=\"token list punctuation\">*</span> Money Forword X\n<span class=\"token code keyword\">    * パートナーとともにサービスを提供する</span>\n  <span class=\"token list punctuation\">*</span> Money Forward Finance</code></pre></div>\n<br />\n<p>HtmlUnitってテストライブラリじゃないの!?と思いましたが、マネーフォワードさんではスクレイピングに使用しているそうです。\n確かにそんな使い方もできないことはないけれど...ちょっとびっくりです。\n最新ブラウザとの挙動を合わせるためにHtmlUnitにコミットしたり、スクレイピング対象のサイトがリニューアルしたら、スクレイピングのロジックを変えたりと、地道な努力が伝わってきました。</p>\n<div class=\"gatsby-code-title\">現状のスクレイピング</div>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\"><span class=\"token list punctuation\">*</span> 自動家計簿\n  <span class=\"token list punctuation\">*</span> インターネットサービス上に散らばったお金のやり取りの情報を集約・自動分類して家計簿を出力するサービス\n  <span class=\"token list punctuation\">*</span> Java8で動いている\n  <span class=\"token list punctuation\">*</span> HtmlUnitでスクレイピングしてお金のやり取り情報を収集する\n\n<span class=\"token list punctuation\">*</span> HtmlUnitでのスクレイピング\n  <span class=\"token list punctuation\">*</span> HtmlUnitはUnitテストで使うことが多いが、マネーフォワードでは、スクレイピングに使っている\n  <span class=\"token list punctuation\">*</span> HtmlUnitを拡張してスクレイピングに特化した機能を追加している\n  <span class=\"token list punctuation\">*</span> メリット\n<span class=\"token code keyword\">    * 通常のスクレイピングと違い、ブラウザ操作と同じ仕組みでスクレイピングできるので、Webブラウジングの根っこの部分からハンドリングできる</span>\n  <span class=\"token list punctuation\">*</span> デメリット\n<span class=\"token code keyword\">    * HtmlUnitは独自ブラウザを使っているので、最新のChromeと挙動が違ったりする</span>\n<span class=\"token code keyword\">      * 特にJavaScriptで動的にレンダリングする部分</span>\n<span class=\"token code keyword\">      * 挙動が違う場合、HTMLUnitにコミットして最新のブラウザに仕様を追従させる必要がある</span></code></pre></div>\n<br />\n<p>後半は、「HtmlUnitだとつらいのでSelenium WebDriverかヘッドレスChromeを検討中」というお話でした。\nコチラも、Selenium WebDriverを使う場合に、ファイルダウンロード完了通知の仕組みを自分たちで考えたりと、地道な努力が伝わってきました。</p>\n<div class=\"gatsby-code-title\">Selenium WebDriverとヘッドレスChromeを用いたスクレイピング</div>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\"><span class=\"token list punctuation\">*</span> 脱HtmlUnit計画\n  <span class=\"token list punctuation\">*</span> HtmlUnitだと最新ブラウザのAPIに追従していないのでスクレイピング時にエラーが発生する。つらい。\n  <span class=\"token list punctuation\">*</span> Selenimu WebDriverかヘッドレスChromeを検討\n<span class=\"token list punctuation\">*</span> ヘッドレスChroem(Chrome DevTools Protocol)\n  <span class=\"token list punctuation\">*</span> 仕組み\n<span class=\"token code keyword\">    * |App| ====CDP====> |Chrome|</span>\n  <span class=\"token list punctuation\">*</span> 検証した感じ\n<span class=\"token code keyword\">    * 結構ローレベルなAPIしかないので処理が煩雑になる</span>\n<span class=\"token code keyword\">    * 学習コスト高</span>\n<span class=\"token list punctuation\">*</span> Selenium WebDriver\n  <span class=\"token list punctuation\">*</span> 仕組み\n<span class=\"token code keyword\">    * |App| ====HTTP====> |ChromeDriver| =====CDP====> |Chrome|</span>\n  <span class=\"token list punctuation\">*</span> 検証した感じ\n<span class=\"token code keyword\">    * マルチデバイスでスクレイピングできていいね</span>\n<span class=\"token code keyword\">    * WebDriver標準API以外にもいろんなエンドポイントを受け付けることが可能</span>\n<span class=\"token code keyword\">    * APIの粒度はCDP程細かくなくイイ感じ</span>\n  <span class=\"token list punctuation\">*</span> 業務要件にマッチしているか\n<span class=\"token code keyword\">    * プロキシ設定できるか ⇒ 〇</span>\n<span class=\"token code keyword\">    * Cookie使えるか ⇒ 〇</span>\n<span class=\"token code keyword\">    * ファイルダウンロード使えるか ⇒ △ ファイルダウンロードはできるがアプリ側にダウンロード完了を伝える仕組みがない</span>\n<span class=\"token code keyword\">      * ⇒ 自分たちで実装</span>\n<span class=\"token code keyword\">        * Seleniumの場合、アプリとは別プロセスでブラウザが起動しているため、ファイルシステムを介してやり取りすることにした</span>\n<span class=\"token code keyword\">        * ダウンロード中のファイル名を決めておき、それがファイルがなくなったら、ダウンロード完了とみなす</span>\n  <span class=\"token list punctuation\">*</span> 残課題\n<span class=\"token code keyword\">    * WebDriverのバージョンアップ対応</span>\n<span class=\"token code keyword\">    * Chromeバージョンアップへの対応</span></code></pre></div>\n<br />\n<p>技術的に突出して新しいものを使っているわけではありませんが、開発現場のリアルな試行錯誤が聞けて大変楽しいセッションでした。</p>\n<h2 id=\"思考停止しないアーキテクチャ設計\"><a href=\"#%E6%80%9D%E8%80%83%E5%81%9C%E6%AD%A2%E3%81%97%E3%81%AA%E3%81%84%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E8%A8%AD%E8%A8%88\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>思考停止しないアーキテクチャ設計</h2>\n<div>\n          <div\n            class=\"gatsby-resp-iframe-wrapper\"\n            style=\"padding-bottom: 81.5126050420168%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem\"\n          >\n            <iframe src=\"//www.slideshare.net/slideshow/embed_code/key/il0sIDu2XdnYo6\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\" style=\"\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          \" allowfullscreen> </iframe>\n<div style=\"margin-bottom:5px\">\n\t<strong>\n\t\t<a href=\"//www.slideshare.net/kawasima/jjug-ccc-2018-fall\" title=\"&#x601D;&#x8003;&#x505C;&#x6B62;&#x3057;&#x306A;&#x3044;&#x30A2;&#x30FC;&#x30AD;&#x30C6;&#x30AF;&#x30C1;&#x30E3;&#x8A2D;&#x8A08; &#x2796; JJUG CCC 2018 Fall\" target=\"_blank\">&#x601D;&#x8003;&#x505C;&#x6B62;&#x3057;&#x306A;&#x3044;&#x30A2;&#x30FC;&#x30AD;&#x30C6;&#x30AF;&#x30C1;&#x30E3;&#x8A2D;&#x8A08; &#x2796; JJUG CCC 2018 Fall</a>\n\t\t</strong> from <strong>\n\t\t<a href=\"https://www.slideshare.net/kawasima\" target=\"_blank\">Yoshitaka Kawashima</a>\n\t</strong>\n</div>\n          </div>\n          </div>\n<br />\n<p>元T社の川島さんのセッション。一番広い部屋でしたが、立ち見が出るほど人気でした。\nお話の内容はかなり抽象度が高く上級者向けで、わからない単語もチラホラ出てきました。\n川島さんは、応募時点で無職、現在は<a href=\"https://www.wolfchief.jp/about/\">ウルフチーフ</a>という個人の会社を設立されています。\nセッション冒頭紹介があった「企業クエスト」やってみましたが確かに企業はめんどくさそうですね（したことないからわかりませんが...）</p>\n<blockquote class=\"twitter-tweet\" data-partner=\"tweetdeck\"><p lang=\"ja\" dir=\"ltr\">吉祥寺.pm16で発表した「起業クエスト」を公開しました！<br>かなりの難度のゲームです。<a href=\"https://t.co/JMARTHIHxU\">https://t.co/JMARTHIHxU</a><br>回線容量喰うので、おうちでお試しください！</p>&mdash; :craftsman/kawasima (@kawasima) <a href=\"https://twitter.com/kawasima/status/1073595586199187457?ref_src=twsrc%5Etfw\">December 14, 2018</a></blockquote>\n<script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n<p>セッション中の「The Patterns of Stop Thinking」は<a href=\"https://anond.hatelabo.jp/20150805115616\">思考停止の分類 | はてな匿名ダイアリー</a>に詳細が記載されています。\n自分も無意識のうちに思考停止になってないか、チェックする時にコレを使ってみようと思います。</p>\n<h2 id=\"エムスリーでのkotlinへの取り組み\"><a href=\"#%E3%82%A8%E3%83%A0%E3%82%B9%E3%83%AA%E3%83%BC%E3%81%A7%E3%81%AEkotlin%E3%81%B8%E3%81%AE%E5%8F%96%E3%82%8A%E7%B5%84%E3%81%BF\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>エムスリーでのKotlinへの取り組み</h2>\n<div style=\"left: 0; width: 100%; height: 0; position: relative; padding-bottom: 74.9288%;\"><iframe src=\"//speakerdeck.com/player/e2d72cafdacd458280575d5cd4838863\" style=\"border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;\" allowfullscreen scrolling=\"no\" allow=\"autoplay; encrypted-media\"></iframe></div>\n<br />\n<p>エムスリーさんではAndriod、サーバーサイドの両方で、積極的にJavaからKotlinへ移行しているようです。</p>\n<div class=\"gatsby-code-title\">Kotlinとエムスリー</div>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\"><span class=\"token list punctuation\">*</span> だんだんとKotlinの導入が進んでいる(約6グループ)\n<span class=\"token list punctuation\">*</span> Andriod、サーバーサイドともに導入が進んでいる\n<span class=\"token list punctuation\">*</span> Kotlin導入理由\n  <span class=\"token list punctuation\">*</span> Better Javaとして\n  <span class=\"token list punctuation\">*</span> エンジニアとして新しいものに挑戦したい欲求\n  <span class=\"token list punctuation\">*</span> Andriodで導入済なのでサーバサイドに導入してオールKotlinにしたい\n  <span class=\"token list punctuation\">*</span> 他プロジェクトでの導入成功事例があるため\n<span class=\"token list punctuation\">*</span> 技術選定はチームごとに自由\n  <span class=\"token list punctuation\">*</span> 自分のチームはKotlin, Go, React が主流</code></pre></div>\n<br />\n<p>移行方法は大きく3パターンあり、刷新する方法について詳しく説明されていました。\nテストコードはJavaのまま。リグレッションテストはGolden file testingを使用するなど素早く移行するためのノウハウを聞くことができました。</p>\n<div class=\"gatsby-code-title\">【サーバーサイド】JavaからKotlinの移行方法</div>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\"><span class=\"token list punctuation\">*</span> 移行方法\n  <span class=\"token list punctuation\">*</span> 段階的\n  <span class=\"token list punctuation\">*</span> なかったことにする\n  <span class=\"token list punctuation\">*</span> 刷新\n<span class=\"token code keyword\">    * IntelliJで自動コンバートして、なんとかする</span>\n<span class=\"token code keyword\">      * 他機能開発と調整が必要</span>\n<span class=\"token code keyword\">        * `xxx.java`から`xxx.kt`になるためGitで差分が見づらい</span>\n<span class=\"token code keyword\">          * 差分が見づらいゆえ、他で同時に機能開発が走っている場合、デグレの可能性がある</span>\n<span class=\"token code keyword\">    * リグレッションテストをたくさん作っておく</span>\n<span class=\"token code keyword\">      * テストコードはJavaのまま</span>\n<span class=\"token code keyword\">    * 自動コンバートをレビューしても仕方がない</span>\n<span class=\"token code keyword\">    * Golden file testingを用いたリグレッションテスト</span>\n<span class=\"token code keyword\">      * APIのレスポンスとGolden fileと比較してレスポンスがかわらないことを確認する</span>\n<span class=\"token code keyword\">        * assert地獄から解放される</span>\n<span class=\"token code keyword\">    * Swagger Codege, UI (Open API)</span>\n<span class=\"token code keyword\">      * ソースコードからクライアントライブラリとドキュメント生成</span></code></pre></div>\n<br />\n<p>発表者の方が「エムスリー社内Slackの<code class=\"language-text\">#spring-boot</code>チャンネルに質問したら、有識者が回答がかえってきてすぐに解決した。」と言っていて、\nこういう風に社内で横断的にコミュニケーションがとれる文化は素晴らしいなぁと思いました。</p>\n<h2 id=\"既存アプリケーションでkotlinを導入してみた\"><a href=\"#%E6%97%A2%E5%AD%98%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7kotlin%E3%82%92%E5%B0%8E%E5%85%A5%E3%81%97%E3%81%A6%E3%81%BF%E3%81%9F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>既存アプリケーションでKotlinを導入してみた</h2>\n<div style=\"left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.2493%; padding-top: 30px;\"><iframe src=\"https://docs.google.com/presentation/d/1wTm_eSbsM2ihfz27QpSHzuRcCIhcRYKom-Vx_-FfUts/preview?usp=embed_googleplus\" style=\"border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;\" allowfullscreen scrolling=\"no\" allow=\"autoplay; encrypted-media\"></iframe></div>\n<br />\n<p>フリューさんのピクトリンクをJavaからKotlinに移行したというお話でした。\nピクトリンクとはプリ画のSNSだそう。僕が高校生の頃はプリクラ手帳とかで物理的にやっていましたが、今はWebでSNSでできちゃうんですね。\nJavaとKotlinのソースコードの比較と、デモを織り交ぜながら、初心者にも非常にわかりやすい説明でした！</p>\n<div class=\"gatsby-highlight\" data-language=\"markdown:メモ\"><pre class=\"language-markdown:メモ\"><code class=\"language-markdown:メモ\">* 使う理由\n  * Javaから移行簡単\n  * SpringでもKotlinサポートしている\n* 便利な書き方\n  * 用法要領をまもろう\n    * みじかくかける != わかりやすい\n    * it多様すると記述量は少なくなるけど、可読性が落ちる場合がある\n  * 分割宣言はpublicAPIでは使いにくいので気を付けよう\n  * alsoというスコープ関数便利\n  * DataClass\n    * cloneやtoStringメソッドがあらかじめある。Lombokみたいな感じ\n  * 拡張関数\n    * 既存クラスに対して　関数を追加できる\n    * Nullableクラスに対しても追加できる\n    * 注意点\n      * mixinのようとでガンガン追加するとオレオレになってしまう\n      * カオスになる要因なので、ルールを決めて使いましょう\n  * Smart Cast\n    * このパターンだったらコレで大丈夫的なやつをDSLで定義する\n    * これもカオスになる要因。できればインターフェース設計とかで解決したい\n* ツールサポート\n  * IntelliJ IDEA を使ったJava to Kotlinの自動変換が便利\n  * Gralde Kotlin DSL\n    * GradleをKotlinでかける、既存Gradleファイルと共存可能\n* 注意点\n  * Java側がNullを返すパターンがややこしい\n    * コンパイルは通るが実行時例外になるケースがある\n  * バージョンアップが激しい\n    * 結構非互換ある\n    * チームのスキルセットと相談</code></pre></div>\n<h2 id=\"コードをど真ん中に据えた設計アプローチ\"><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E3%81%A9%E7%9C%9F%E3%82%93%E4%B8%AD%E3%81%AB%E6%8D%AE%E3%81%88%E3%81%9F%E8%A8%AD%E8%A8%88%E3%82%A2%E3%83%97%E3%83%AD%E3%83%BC%E3%83%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コードをど真ん中に据えた設計アプローチ</h2>\n<div style=\"left: 0; width: 100%; height: 0; position: relative; padding-bottom: 74.9288%;\"><iframe src=\"//speakerdeck.com/player/a8bb0866f87c4c1da18793db49f5b9e0\" style=\"border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;\" allowfullscreen scrolling=\"no\" allow=\"autoplay; encrypted-media\"></iframe></div>\n<br />\n<p>「ソースコードを読むときに、だいたいIDEを使う。IDEのおかげで括弧の強調表示や、メソッドにジャンプが可能になる。\nこの発展系で、コードをドキュメントのように見せることができれば、コードをど真ん中に見据えた設計ができるのではないか」\nこの仮説のもと、コードをど真ん中に見据えた設定を実現を補助するツール、<a href=\"https://github.com/dddjava/Jig\">JIG</a>(Java Instant-document Gazer)の紹介という流れでした。</p>\n<p>※このセッションのメモはありません。疲れてきたからメモを取らなかったとかいう理由では決してありません。</p>\n<h2 id=\"「マイクロソフト牛尾さん渡米直前記念」外資系企業で働くエンジニアの生産性向上物語\"><a href=\"#%E3%80%8C%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%82%BD%E3%83%95%E3%83%88%E7%89%9B%E5%B0%BE%E3%81%95%E3%82%93%E6%B8%A1%E7%B1%B3%E7%9B%B4%E5%89%8D%E8%A8%98%E5%BF%B5%E3%80%8D%E5%A4%96%E8%B3%87%E7%B3%BB%E4%BC%81%E6%A5%AD%E3%81%A7%E5%83%8D%E3%81%8F%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%8B%E3%82%A2%E3%81%AE%E7%94%9F%E7%94%A3%E6%80%A7%E5%90%91%E4%B8%8A%E7%89%A9%E8%AA%9E\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>「マイクロソフト牛尾さん渡米直前記念」外資系企業で働くエンジニアの生産性向上物語</h2>\n<p>最後のセッション。当初はScalaの話でも聞こうかと思っていましたが、疲れ切っていたのでこのセッションを見ることにしました。\n寺田さんと牛尾さんの掛け合いで、とても面白い話を聞くことができました。</p>\n<p>「外資はいいぞ」という話をしていたのですが、そんなに変わるものなんでしょうか？\n僕は日本企業しか経験がないので、ぜひ外資の知り合いに聞いてみたいですね。\nあとは<br />\n(1) 英語力を身に着けてインプットを加速させる<br />\n(2) ブログを書いてアウトプットする<br />\nこの２点の重要性について語られていました。<br />\n僕もブログは書いているのですが、英語に関してはサッパリ...なので英語やらねばならんですね。</p>\n<div class=\"gatsby-highlight\" data-language=\"markdown:メモ\"><pre class=\"language-markdown:メモ\"><code class=\"language-markdown:メモ\">* 外資はいいよ\n  * 上司が技術にたけているので上司説得の場面がない。\n  * 無駄なやり取りが少ない\n  * スピードが速い\n* ブログを書く\n  * 面白いとおもったことを共有したい\n  * 自分の学んだことをメモする\n  * プログラミングをうまくなるコツはブログを書くこと\n  * 世界にシェアしたいものを英語でブログ書く\n* 英語力\n  * 英語力は必須\n    * 最新の技術動向はだいたい英語\n  * 英語力が技術力に直結する\n  * しゃべれるようになるには大阪のおばちゃんみたいになる</code></pre></div>\n<h2 id=\"おわりに\"><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>おわりに</h2>\n<p>久しぶりに前職の人と再開でき、今の職場の人にも会えてとても楽しい時間を過ごすことができました。\n懇親会ではお寿司も大量に食べれて（お寿司は結構余ってた）、色んな方と話せたので満足です。</p>\n<p>こんな素敵なJJUGを支えてくれるスタッフ、ボランティア、登壇者の皆様、本当にありがとうございました。\nJJUG CCC 2019 Springも楽しみにしています🍅</p>\n<h2 id=\"参考\"><a href=\"#%E5%8F%82%E8%80%83\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"http://d.hatena.ne.jp/chiheisen/20181215/1544897520\">JJUG CCC 2018 Fall( #jjug_ccc ) - セッション資料の一覧 | 地平線に行く</a></li>\n<li><a href=\"https://qiita.com/ryuichi1208/items/1ed16c162c0205d1514e\">JJUG CCC Fall 2018 資料まとめ| Qiita</a></li>\n</ul>","headingsDetail":[{"id":"なにこれ","value":"なにこれ","depth":2,"parents":[]},{"id":"イベント概要","value":"イベント概要","depth":2,"parents":[]},{"id":"【jjug基調講演】javaの未来を考えよう","value":"【JJUG基調講演】Javaの未来を考えよう","depth":2,"parents":[]},{"id":"javaの歴史","value":"Javaの歴史","depth":4,"parents":[{"id":"【jjug基調講演】javaの未来を考えよう","value":"【JJUG基調講演】Javaの未来を考えよう","depth":2}]},{"id":"パネルディスカッション","value":"パネルディスカッション","depth":4,"parents":[{"id":"【jjug基調講演】javaの未来を考えよう","value":"【JJUG基調講演】Javaの未来を考えよう","depth":2}]},{"id":"マネーフォワードのアカウントアグリゲーションの現状と課題点について／selenium-webdriverとヘッドレスchromeを用いたスクレイピング","value":"マネーフォワードのアカウントアグリゲーションの現状と課題点について／Selenium WebDriverとヘッドレスChromeを用いたスクレイピング","depth":2,"parents":[]},{"id":"思考停止しないアーキテクチャ設計","value":"思考停止しないアーキテクチャ設計","depth":2,"parents":[]},{"id":"エムスリーでのkotlinへの取り組み","value":"エムスリーでのKotlinへの取り組み","depth":2,"parents":[]},{"id":"既存アプリケーションでkotlinを導入してみた","value":"既存アプリケーションでKotlinを導入してみた","depth":2,"parents":[]},{"id":"コードをど真ん中に据えた設計アプローチ","value":"コードをど真ん中に据えた設計アプローチ","depth":2,"parents":[]},{"id":"「マイクロソフト牛尾さん渡米直前記念」外資系企業で働くエンジニアの生産性向上物語","value":"「マイクロソフト牛尾さん渡米直前記念」外資系企業で働くエンジニアの生産性向上物語","depth":2,"parents":[]},{"id":"おわりに","value":"おわりに","depth":2,"parents":[]},{"id":"参考","value":"参考","depth":2,"parents":[]}],"fields":{"title":"JJUG CCC 2018 Fallに行ってきました","excerpt":"なにこれJava CCC 2018 Fallに参加してきました。見てきたセッションは以下の通りです。【JJUG基調講演】Javaの未来を考えよう セッション概要#ccc_e1マネーフォワードのアカウントアグリゲーションの現状と課題点について...","date":"2018-12-16T21:50:00.000+09:00","tags":["Java","Kotlin","JJUG CCC","イベントレポート"],"thumbnail":""}}},"pageContext":{"slug":"/2018/12/16/","relatedPosts":[{"fields":{"slug":"/4bf6ffd5-8640-508e-ab47-1a55df05d72e/","title":"Declarative PipelineでJenkinsfileを書いてみた(Checkstyle,Findbugs,PMD,CPDとか)","date":"2017-04-07T02:38:55+09:00","excerpt":"GradleのJavaアプリをJenkinsで１人CIするためのJenkinsfileを書いてみた。Githubにプッシュ時に、AWS上のJenkinsのパイプラインジョブが動いて、テストが成功したら同じくAWS上のTomcatにデプロイす...","tags":["Java","Jenkins","CI","gradle","Pipeline","Qiita"],"keywords":["Java"],"thumbnail":""},"id":"4bf6ffd5-8640-508e-ab47-1a55df05d72e","title":"Declarative PipelineでJenkinsfileを書いてみた(Checkstyle,Findbugs,PMD,CPDとか)","rendered_body":"<p>GradleのJavaアプリをJenkinsで１人CIするためのJenkinsfileを書いてみた。<br>\nGithubにプッシュ時に、AWS上のJenkinsのパイプラインジョブが動いて、テストが成功したら同じくAWS上のTomcatにデプロイするみたいな感じで使ってます。</p>\n\n<h1>\n<span id=\"declarative-pipeline\" class=\"fragment\"></span><a href=\"#declarative-pipeline\"><i class=\"fa fa-link\"></i></a>Declarative Pipeline</h1>\n\n<p>いままではJenkinsfileを</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>node {\n  ....\n}\n</pre></div></div>\n\n<p>のように書いてましたが、<a href=\"https://jenkins.io/doc/book/pipeline/syntax/\" rel=\"nofollow noopener\" target=\"_blank\">Jenkinsの公式サイト</a>を見ると<br>\nこれはScripted Pipelinesの記法であり、<br>\nPipeline Pluginのバージョン2.5移行からは</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>pipeline {\n  ....  \n}\n</pre></div></div>\n\n<p>のように書くDeclarative Pipelineという記法が導入されて、<br>\nそっちのほうがシンプルでわかりやすく書けるよ!ということだったので書き直してみました。<br>\n確かにすっきりしたし（特に最後のメールおくるとことか、デプロイするとことか）、<br>\nいざとなったら従来のScripted Pipelinesもミックスできるのでいい感じです。</p>\n\n<h1>\n<span id=\"追加したプラグイン\" class=\"fragment\"></span><a href=\"#%E8%BF%BD%E5%8A%A0%E3%81%97%E3%81%9F%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3\"><i class=\"fa fa-link\"></i></a>追加したプラグイン</h1>\n\n<p>Jenkins初期設定時のSuggested Pluginに入っていないもの</p>\n\n<ul>\n<li>\n<a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Checkstyle+Plugin;jsessionid=E9D4FA5064ACAE1CED7B19928DE0788F\" rel=\"nofollow noopener\" target=\"_blank\">Checkstyle Plugin</a>（v3.47） - Checkstyeの結果収集用</li>\n<li>\n<a href=\"https://wiki.jenkins-ci.org/display/JENKINS/FindBugs+Plugin\" rel=\"nofollow noopener\" target=\"_blank\">FindBugs Plugin</a>（v4.69） - Findbugsのレポート生成用 </li>\n<li>\n<a href=\"https://wiki.jenkins-ci.org/display/JENKINS/PMD+Plugin\" rel=\"nofollow noopener\" target=\"_blank\">PMD Plugin</a>（v3.46） - PMDのレポート生成用</li>\n<li>\n<a href=\"https://wiki.jenkins-ci.org/display/JENKINS/DRY+Plugin\" rel=\"nofollow noopener\" target=\"_blank\">DRY Plugin</a>（v2.46） - CPD(重複コードチェック)のレポート生成用</li>\n<li>\n<a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Step+Counter+Plugin\" rel=\"nofollow noopener\" target=\"_blank\">Step Counter Plugin</a>（v2.0.0） - ソースコードのステップ数を集計してくれる</li>\n<li>\n<a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Task+Scanner+Plugin\" rel=\"nofollow noopener\" target=\"_blank\">Task Scanner Plugin</a>（v4.50） - ソースコード中のTODOとかを一覧化してくれる</li>\n<li>\n<a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Javadoc+Plugin\" rel=\"nofollow noopener\" target=\"_blank\">Javadoc Plugin</a>（v1.4） - JavaDoc生成用</li>\n<li>\n<a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Warnings+Plugin\" rel=\"nofollow noopener\" target=\"_blank\">Warnings Plugin</a>（v4.60） - ジョブ実行時の警告メッセージを収集してくれる</li>\n<li>\n<a href=\"https://wiki.jenkins-ci.org/display/JENKINS/JaCoCo+Plugin\" rel=\"nofollow noopener\" target=\"_blank\">JaCoCo Plugin</a>（v2.2.0） - テストカバレッジのレポート生成用</li>\n</ul>\n\n<h1>\n<span id=\"jenkinsfile\" class=\"fragment\"></span><a href=\"#jenkinsfile\"><i class=\"fa fa-link\"></i></a>Jenkinsfile</h1>\n\n<p>GithubからWebhookでJenkinsのパイプラインジョブを実行する。<br>\nパイプラインジョブではGithubのJenkinsfileを使う。<br>\nジョブの流れは下記。デプロイは静的コード解析とテストが成功したときだけ実行する。<br>\n<a href=\"https://camo.qiitausercontent.com/a055f84cfb5b829f162a94d38542e6ab990a5199/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f35366338653132642d323637622d613633372d323234652d6663386362333437346466612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/a055f84cfb5b829f162a94d38542e6ab990a5199/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f35366338653132642d323637622d613633372d323234652d6663386362333437346466612e706e67\" alt=\"image\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/56c8e12d-267b-a637-224e-fc8cb3474dfa.png\"></a></p>\n\n<div class=\"code-frame\" data-lang=\"groovy\">\n<div class=\"code-lang\"><span class=\"bold\">Jenkinsfile</span></div>\n<div class=\"highlight\"><pre><span class=\"n\">pipeline</span> <span class=\"o\">{</span>\n    <span class=\"n\">agent</span> <span class=\"n\">any</span>\n    <span class=\"c1\">// 定数や変数を定義する</span>\n    <span class=\"n\">environment</span> <span class=\"o\">{</span>\n        <span class=\"n\">reportDir</span> <span class=\"o\">=</span> <span class=\"s1\">'build/reports'</span>\n        <span class=\"n\">javaDir</span> <span class=\"o\">=</span> <span class=\"s1\">'src/main/java'</span>\n        <span class=\"n\">resourcesDir</span> <span class=\"o\">=</span> <span class=\"s1\">'src/main/resources'</span>\n        <span class=\"n\">testReportDir</span> <span class=\"o\">=</span> <span class=\"s1\">'build/test-results/test'</span>\n        <span class=\"n\">jacocoReportDir</span> <span class=\"o\">=</span> <span class=\"s1\">'build/jacoco'</span> \n        <span class=\"n\">javadocDir</span> <span class=\"o\">=</span> <span class=\"s1\">'build/docs/javadoc'</span>\n        <span class=\"n\">libsDir</span> <span class=\"o\">=</span> <span class=\"s1\">'build/libs'</span>\n        <span class=\"n\">appName</span> <span class=\"o\">=</span> <span class=\"s1\">'SampleApp'</span>\n        <span class=\"n\">appVersion</span> <span class=\"o\">=</span> <span class=\"s1\">'1.0.0'</span>\n    <span class=\"o\">}</span>\n\n    <span class=\"c1\">// stagesブロック中に一つ以上のstageを定義する</span>\n    <span class=\"n\">stages</span> <span class=\"o\">{</span>\n        <span class=\"n\">stage</span><span class=\"o\">(</span><span class=\"s1\">'事前準備'</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n            <span class=\"c1\">// 実際の処理はstepsブロック中に定義する</span>\n            <span class=\"n\">steps</span> <span class=\"o\">{</span>\n                <span class=\"n\">deleteDir</span><span class=\"o\">()</span>\n\n                <span class=\"c1\">// このJobをトリガーしてきたGithubのプロジェクトをチェックアウト</span>\n                <span class=\"n\">checkout</span> <span class=\"n\">scm</span>\n\n                <span class=\"c1\">// ジョブ失敗の原因調査用にJenkinsfileとbuild.gradleは最初に保存する</span>\n                <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"Jenkinsfile\"</span>\n                <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"build.gradle\"</span>\n\n                <span class=\"c1\">// scriptブロックを使うと従来のScripted Pipelinesの記法も使える</span>\n                <span class=\"n\">script</span> <span class=\"o\">{</span>\n                    <span class=\"c1\">// Permission deniedで怒られないために実行権限を付与する</span>\n                    <span class=\"k\">if</span><span class=\"o\">(</span><span class=\"n\">isUnix</span><span class=\"o\">())</span> <span class=\"o\">{</span>\n                        <span class=\"n\">sh</span> <span class=\"s1\">'chmod +x gradlew'</span>\n                    <span class=\"o\">}</span>\n                <span class=\"o\">}</span>\n                <span class=\"n\">gradlew</span> <span class=\"s1\">'clean'</span>\n            <span class=\"o\">}</span>\n        <span class=\"o\">}</span>\n\n        <span class=\"n\">stage</span><span class=\"o\">(</span><span class=\"s1\">'コンパイル'</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n            <span class=\"n\">steps</span> <span class=\"o\">{</span>\n                <span class=\"n\">gradlew</span> <span class=\"s1\">'classes testClasses'</span>\n            <span class=\"o\">}</span>\n\n            <span class=\"c1\">// postブロックでstepsブロックの後に実行される処理が定義できる</span>\n            <span class=\"n\">post</span> <span class=\"o\">{</span>\n                <span class=\"c1\">// alwaysブロックはstepsブロックの処理が失敗しても成功しても必ず実行される</span>\n                <span class=\"n\">always</span> <span class=\"o\">{</span>\n\n                    <span class=\"c1\">// JavaDoc生成時に実行するとJavaDocの警告も含まれてしまうので</span>\n                    <span class=\"c1\">// Javaコンパイル時の警告はコンパイル直後に収集する</span>\n                    <span class=\"n\">step</span><span class=\"o\">([</span>\n\n                        <span class=\"c1\">// プラグインを実行するときのクラス指定は完全修飾名でなくてもOK</span>\n                        <span class=\"n\">$class</span><span class=\"o\">:</span> <span class=\"s1\">'WarningsPublisher'</span><span class=\"o\">,</span>\n\n                        <span class=\"c1\">// Job実行時のコンソールから警告を収集する場合はconsoleParsers、</span>\n                        <span class=\"c1\">// pmd.xmlなどのファイルから収集する場合はparserConfigurationsを指定する。</span>\n                        <span class=\"c1\">// なおparserConfigurationsの場合はparserNameのほかにpattern(集計対象ファイルのパス)も指定が必要</span>\n                        <span class=\"c1\">// パーサ名は下記プロパティファイルに定義されているものを使う</span>\n                        <span class=\"c1\">// https://github.com/jenkinsci/warnings-plugin/blob/master/src/main/resources/hudson/plugins/warnings/parser/Messages.properties</span>\n                        <span class=\"nl\">consoleParsers:</span> <span class=\"o\">[</span>\n                            <span class=\"o\">[</span><span class=\"nl\">parserName:</span> <span class=\"s1\">'Java Compiler (javac)'</span><span class=\"o\">],</span>\n                        <span class=\"o\">],</span>\n                        <span class=\"nl\">canComputeNew:</span> <span class=\"kc\">false</span><span class=\"o\">,</span>\n                        <span class=\"nl\">canResolveRelativesPaths:</span> <span class=\"kc\">false</span><span class=\"o\">,</span>\n                        <span class=\"nl\">usePreviousBuildAsReference:</span> <span class=\"kc\">true</span>\n                    <span class=\"o\">])</span>\n                <span class=\"o\">}</span>\n            <span class=\"o\">}</span>\n        <span class=\"o\">}</span>\n\n        <span class=\"n\">stage</span><span class=\"o\">(</span><span class=\"s1\">'静的コード解析'</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n            <span class=\"n\">steps</span> <span class=\"o\">{</span>\n                <span class=\"c1\">// 並列処理の場合はparallelメソッドを使う</span>\n                <span class=\"n\">parallel</span><span class=\"o\">(</span>\n                    <span class=\"s1\">'静的コード解析'</span> <span class=\"o\">:</span> <span class=\"o\">{</span>\n                        <span class=\"n\">gradlew</span> <span class=\"s1\">'check -x test'</span>\n\n                        <span class=\"c1\">// dirメソッドでカレントディレクトリを指定できる</span>\n                        <span class=\"n\">dir</span><span class=\"o\">(</span><span class=\"n\">reportDir</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n                            <span class=\"n\">step</span><span class=\"o\">([</span>\n                                <span class=\"n\">$class</span><span class=\"o\">:</span> <span class=\"s1\">'CheckStylePublisher'</span><span class=\"o\">,</span>\n                                <span class=\"nl\">pattern:</span> <span class=\"s2\">\"checkstyle/*.xml\"</span>\n                            <span class=\"o\">])</span>\n                            <span class=\"n\">step</span><span class=\"o\">([</span>\n                                <span class=\"n\">$class</span><span class=\"o\">:</span> <span class=\"s1\">'FindBugsPublisher'</span><span class=\"o\">,</span>\n                                <span class=\"nl\">pattern:</span> <span class=\"s2\">\"findbugs/*.xml\"</span>\n                            <span class=\"o\">])</span>\n                            <span class=\"n\">step</span><span class=\"o\">([</span>\n                                <span class=\"n\">$class</span><span class=\"o\">:</span> <span class=\"s1\">'PmdPublisher'</span><span class=\"o\">,</span>\n                                <span class=\"nl\">pattern:</span> <span class=\"s2\">\"pmd/*.xml\"</span>\n                            <span class=\"o\">])</span>\n                            <span class=\"n\">step</span><span class=\"o\">([</span>\n                                <span class=\"n\">$class</span><span class=\"o\">:</span> <span class=\"s1\">'DryPublisher'</span><span class=\"o\">,</span>\n                                <span class=\"nl\">pattern:</span> <span class=\"s2\">\"cpd/*.xml\"</span>\n                            <span class=\"o\">])</span>\n\n                            <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"checkstyle/*.xml\"</span>\n                            <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"findbugs/*.xml\"</span>\n                            <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"pmd/*.xml\"</span>\n                            <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"cpd/*.xml\"</span>\n                        <span class=\"o\">}</span>\n                    <span class=\"o\">},</span>\n                    <span class=\"s1\">'ステップカウント'</span><span class=\"o\">:</span> <span class=\"o\">{</span>\n                        <span class=\"c1\">// レポート作成</span>\n                        <span class=\"c1\">// outputFileとoutputFormatを指定するとエクセルファイルも作成してくれる</span>\n                        <span class=\"n\">stepcounter</span> <span class=\"nl\">outputFile:</span> <span class=\"s1\">'stepcount.xls'</span><span class=\"o\">,</span> <span class=\"nl\">outputFormat:</span> <span class=\"s1\">'excel'</span><span class=\"o\">,</span> <span class=\"nl\">settings:</span> <span class=\"o\">[</span>\n                            <span class=\"o\">[</span><span class=\"nl\">key:</span><span class=\"s1\">'Java'</span><span class=\"o\">,</span> <span class=\"nl\">filePattern:</span> <span class=\"s2\">\"${javaDir}/**/*.java\"</span><span class=\"o\">],</span>\n                            <span class=\"o\">[</span><span class=\"nl\">key:</span><span class=\"s1\">'SQL'</span><span class=\"o\">,</span> <span class=\"nl\">filePattern:</span> <span class=\"s2\">\"${resourcesDir}/**/*.sql\"</span><span class=\"o\">],</span>\n                            <span class=\"o\">[</span><span class=\"nl\">key:</span><span class=\"s1\">'HTML'</span><span class=\"o\">,</span> <span class=\"nl\">filePattern:</span> <span class=\"s2\">\"${resourcesDir}/**/*.html\"</span><span class=\"o\">],</span>\n                            <span class=\"o\">[</span><span class=\"nl\">key:</span><span class=\"s1\">'JS'</span><span class=\"o\">,</span> <span class=\"nl\">filePattern:</span> <span class=\"s2\">\"${resourcesDir}/**/*.js\"</span><span class=\"o\">],</span>\n                            <span class=\"o\">[</span><span class=\"nl\">key:</span><span class=\"s1\">'CSS'</span><span class=\"o\">,</span> <span class=\"nl\">filePattern:</span> <span class=\"s2\">\"${resourcesDir}/**/*.css\"</span><span class=\"o\">]</span>\n                        <span class=\"o\">]</span>\n                        <span class=\"c1\">// 一応エクセルファイルも成果物として保存する</span>\n                        <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"stepcount.xls\"</span>\n                    <span class=\"o\">},</span>\n                    <span class=\"s1\">'タスクスキャン'</span><span class=\"o\">:</span> <span class=\"o\">{</span>\n                        <span class=\"n\">step</span><span class=\"o\">([</span>\n                            <span class=\"n\">$class</span><span class=\"o\">:</span> <span class=\"s1\">'TasksPublisher'</span><span class=\"o\">,</span>\n                            <span class=\"nl\">pattern:</span> <span class=\"s1\">'./**'</span><span class=\"o\">,</span>\n                            <span class=\"c1\">// 集計対象を検索するときに大文字小文字を区別するか</span>\n                            <span class=\"nl\">ignoreCase:</span> <span class=\"kc\">true</span><span class=\"o\">,</span>\n                            <span class=\"c1\">// 優先度別に集計対象の文字列を指定できる</span>\n                            <span class=\"c1\">// 複数指定する場合はカンマ区切りの文字列を指定する</span>\n                            <span class=\"nl\">high:</span> <span class=\"s1\">'System.out.System.err'</span><span class=\"o\">,</span>\n                            <span class=\"nl\">normal:</span> <span class=\"s1\">'TODO,FIXME,XXX'</span><span class=\"o\">,</span>\n                        <span class=\"o\">])</span>\n                    <span class=\"o\">},</span>\n                    <span class=\"s1\">'JavaDoc'</span><span class=\"o\">:</span> <span class=\"o\">{</span>\n                        <span class=\"n\">gradlew</span> <span class=\"s1\">'javadoc -x classes'</span>\n                        <span class=\"n\">step</span><span class=\"o\">([</span>\n                            <span class=\"n\">$class</span><span class=\"o\">:</span> <span class=\"s1\">'JavadocArchiver'</span><span class=\"o\">,</span>\n                            <span class=\"c1\">// Javadocのindex.htmlがあるフォルダのパスを指定する</span>\n                            <span class=\"nl\">javadocDir:</span> <span class=\"s2\">\"${javadocDir}\"</span><span class=\"o\">,</span>\n                            <span class=\"nl\">keepAll:</span> <span class=\"kc\">true</span>\n                        <span class=\"o\">])</span>\n                    <span class=\"o\">}</span>\n                <span class=\"o\">)</span>\n            <span class=\"o\">}</span>\n\n            <span class=\"n\">post</span> <span class=\"o\">{</span>\n                <span class=\"n\">always</span> <span class=\"o\">{</span>\n                   <span class=\"c1\">// JavaDocの警告を収集</span>\n                    <span class=\"n\">step</span><span class=\"o\">([</span>\n                        <span class=\"n\">$class</span><span class=\"o\">:</span> <span class=\"s1\">'WarningsPublisher'</span><span class=\"o\">,</span>\n                        <span class=\"nl\">consoleParsers:</span> <span class=\"o\">[</span>\n                            <span class=\"o\">[</span><span class=\"nl\">parserName:</span> <span class=\"s1\">'JavaDoc Tool'</span><span class=\"o\">]</span>\n                        <span class=\"o\">],</span>\n                        <span class=\"nl\">canComputeNew:</span> <span class=\"kc\">false</span><span class=\"o\">,</span>\n                        <span class=\"nl\">canResolveRelativesPaths:</span> <span class=\"kc\">false</span><span class=\"o\">,</span>\n                        <span class=\"nl\">usePreviousBuildAsReference:</span> <span class=\"kc\">true</span>\n                    <span class=\"o\">])</span>\n                <span class=\"o\">}</span>\n            <span class=\"o\">}</span>\n        <span class=\"o\">}</span>\n\n\n        <span class=\"n\">stage</span><span class=\"o\">(</span><span class=\"s1\">'テスト'</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n            <span class=\"n\">steps</span> <span class=\"o\">{</span>\n                <span class=\"n\">gradlew</span> <span class=\"s1\">'test jacocoTestReport -x classes -x testClasses'</span>\n\n                <span class=\"n\">junit</span> <span class=\"s2\">\"${testReportDir}/*.xml\"</span>\n                <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"${testReportDir}/*.xml\"</span>\n\n                <span class=\"c1\">// カバレッジレポートを生成（テストクラスを除外）</span>\n                <span class=\"n\">step</span><span class=\"o\">([</span>\n                    <span class=\"n\">$class</span><span class=\"o\">:</span> <span class=\"s1\">'JacocoPublisher'</span><span class=\"o\">,</span>\n                    <span class=\"nl\">execPattern:</span> <span class=\"s2\">\"${jacocoReportDir}/*.exec\"</span><span class=\"o\">,</span>\n                    <span class=\"nl\">exclusionPattern:</span> <span class=\"s1\">'**/*Test.class'</span>\n                <span class=\"o\">])</span>\n            <span class=\"o\">}</span>\n        <span class=\"o\">}</span>\n\n        <span class=\"n\">stage</span><span class=\"o\">(</span><span class=\"s1\">'デプロイ'</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n            <span class=\"c1\">// whenブロックでstageを実行する条件を指定できる</span>\n            <span class=\"n\">when</span> <span class=\"o\">{</span>\n                <span class=\"c1\">// 静的コード解析とテスト失敗時はデプロイしない</span>\n                <span class=\"n\">expression</span> <span class=\"o\">{</span><span class=\"n\">currentBuild</span><span class=\"o\">.</span><span class=\"na\">currentResult</span> <span class=\"o\">==</span> <span class=\"s1\">'SUCCESS'</span><span class=\"o\">}</span>\n            <span class=\"o\">}</span>\n\n            <span class=\"n\">steps</span> <span class=\"o\">{</span>\n                <span class=\"n\">gradlew</span> <span class=\"s1\">'jar'</span>\n                <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"${libsDir}/${appName}-${appVersion}.jar\"</span>\n                <span class=\"n\">gradlew</span> <span class=\"s1\">'war'</span>\n                <span class=\"n\">archiveArtifacts</span> <span class=\"s2\">\"${libsDir}/${appName}-${appVersion}.war\"</span>\n                <span class=\"n\">deploy</span> <span class=\"nl\">warDir:</span> <span class=\"n\">libsDir</span><span class=\"o\">,</span> <span class=\"nl\">appName:</span> <span class=\"n\">appName</span><span class=\"o\">,</span> <span class=\"nl\">appVersion:</span> <span class=\"n\">appVersion</span>\n            <span class=\"o\">}</span>\n        <span class=\"o\">}</span>\n    <span class=\"o\">}</span>\n\n    <span class=\"c1\">// stagesブロックと同じレベルにpostブロックを定義すると</span>\n    <span class=\"c1\">// 全てのstage処理が終わった後の処理の定義が可能    </span>\n    <span class=\"n\">post</span> <span class=\"o\">{</span>\n        <span class=\"n\">always</span> <span class=\"o\">{</span>\n            <span class=\"c1\">// 最後にワークスペースの中身を削除</span>\n            <span class=\"n\">deleteDir</span><span class=\"o\">()</span>\n        <span class=\"o\">}</span>\n        <span class=\"c1\">// 連続で成功しているとき以外は自分宛にメールを送信</span>\n\n        <span class=\"c1\">// 結果が前回と変わった時</span>\n        <span class=\"n\">changed</span> <span class=\"o\">{</span>\n            <span class=\"n\">sendMail</span><span class=\"o\">(</span><span class=\"s2\">\"${currentBuild.previousBuild.result} =&gt; ${currentBuild.currentResult}\"</span><span class=\"o\">)</span>\n        <span class=\"o\">}</span>\n        <span class=\"c1\">// 失敗した時</span>\n        <span class=\"n\">failure</span> <span class=\"o\">{</span>\n            <span class=\"n\">sendMail</span><span class=\"o\">(</span><span class=\"n\">currentBuild</span><span class=\"o\">.</span><span class=\"na\">currentResult</span><span class=\"o\">)</span>\n        <span class=\"o\">}</span>\n        <span class=\"c1\">// 不安定な時（主にテスト失敗時）</span>\n        <span class=\"n\">unstable</span> <span class=\"o\">{</span>\n            <span class=\"n\">sendMail</span><span class=\"o\">(</span><span class=\"n\">currentBuild</span><span class=\"o\">.</span><span class=\"na\">currentResult</span><span class=\"o\">)</span>\n        <span class=\"o\">}</span>\n    <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n\n\n<span class=\"c1\">// Gradlewコマンドを実行する</span>\n<span class=\"kt\">def</span> <span class=\"nf\">gradlew</span><span class=\"o\">(</span><span class=\"n\">command</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n    <span class=\"k\">if</span><span class=\"o\">(</span><span class=\"n\">isUnix</span><span class=\"o\">())</span> <span class=\"o\">{</span>\n        <span class=\"n\">sh</span> <span class=\"s2\">\"./gradlew ${command} --stacktrace\"</span>\n    <span class=\"o\">}</span> <span class=\"k\">else</span> <span class=\"o\">{</span>\n        <span class=\"n\">bat</span> <span class=\"s2\">\"./gradlew.bat ${command} --stacktrace\"</span>\n    <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n\n<span class=\"c1\">// デプロイする</span>\n<span class=\"c1\">// args.warDir warの格納ディレクトリ </span>\n<span class=\"c1\">// args.appName アプリ名</span>\n<span class=\"c1\">// args.appVersion アプリのバージョン</span>\n<span class=\"kt\">def</span> <span class=\"nf\">deploy</span><span class=\"o\">(</span><span class=\"n\">Map</span> <span class=\"n\">args</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n    <span class=\"c1\">// 秘密鍵のパス ※Tomcatサーバにファイル転送するので事前にJenkinsサーバのどこかに秘密鍵を格納しておく必要がある</span>\n    <span class=\"kt\">def</span> <span class=\"n\">keyDir</span> <span class=\"o\">=</span> <span class=\"s1\">'/var/lib/jenkins/.ssh/xxx'</span>\n    <span class=\"c1\">// Tomcatサーバのアドレスとユーザ名</span>\n    <span class=\"kt\">def</span> <span class=\"n\">webServerAddress</span> <span class=\"o\">=</span> <span class=\"s1\">'ecX-XX-XXX-X-X.xx-xxxx-x.xxxxxxxx'</span>\n    <span class=\"kt\">def</span> <span class=\"n\">webServerUser</span> <span class=\"o\">=</span> <span class=\"s1\">'hoge-user'</span>\n    <span class=\"kt\">def</span> <span class=\"n\">webServer</span> <span class=\"o\">=</span> <span class=\"s2\">\"${webServerUser}@${webServerAddress}\"</span>\n\n    <span class=\"kt\">def</span> <span class=\"n\">srcWar</span> <span class=\"o\">=</span> <span class=\"s2\">\"${args.appName}-${args.appVersion}.war\"</span>\n    <span class=\"kt\">def</span> <span class=\"n\">destWar</span> <span class=\"o\">=</span> <span class=\"s2\">\"${args.appName}.war\"</span>\n\n    <span class=\"c1\">// ファイル転送してTomcatのwebappsにwarを配置する</span>\n    <span class=\"n\">sh</span> <span class=\"s2\">\"sudo -S scp -i ${keyDir} ./${args.warDir}/${srcWar} ${webServer}:/home/ec2-user\"</span>\n    <span class=\"n\">sh</span> <span class=\"s2\">\"sudo -S ssh -i ${keyDir} ${webServer} \\\"sudo cp /home/ec2-user/${srcWar} /usr/share/tomcat8/webapps/${destWar}\\\"\"</span>\n<span class=\"o\">}</span>\n\n<span class=\"c1\">// メールをGmailに送信する</span>\n<span class=\"kt\">def</span> <span class=\"nf\">sendMail</span><span class=\"o\">(</span><span class=\"n\">result</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n    <span class=\"n\">mail</span> <span class=\"nl\">to:</span> <span class=\"s2\">\"xxxxxxxx@gmail.com\"</span><span class=\"o\">,</span>\n        <span class=\"nl\">subject:</span> <span class=\"s2\">\"${env.JOB_NAME} #${env.BUILD_NUMBER} [${result}]\"</span><span class=\"o\">,</span>\n        <span class=\"nl\">body:</span> <span class=\"s2\">\"Build URL: ${env.BUILD_URL}.\\n\\n\"</span>\n<span class=\"o\">}</span>\n</pre></div>\n</div>\n\n<h1>\n<span id=\"躓いたこと\" class=\"fragment\"></span><a href=\"#%E8%BA%93%E3%81%84%E3%81%9F%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>躓いたこと</h1>\n\n<ul>\n<li>各プラグインともChangelogに「パイプライン対応したよ！」とは書いてあるが、\n具体的は書き方は明記していないことが多いので、\n各プラグインのGithubでソースコード（主に「なんちゃらPublisher」クラス）を見ながら、Jenkinsfileを書いた。</li>\n<li>currentBuildオブジェクトの使い方がよくわからなかったが、Jenkinsのパイプラインジョブ &gt; 設定 &gt; Pipeline Syntax &gt; Global Variables Reference に詳しく載っていた。\n<a href=\"https://camo.qiitausercontent.com/dce98ca18e752127b3f57901a65249f540d2193f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f30663631366435302d633537662d323335652d633231342d3863386430643139646139372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/dce98ca18e752127b3f57901a65249f540d2193f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f30663631366435302d633537662d323335652d633231342d3863386430643139646139372e706e67\" alt=\"image\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/0f616d50-c57f-235e-c214-8c8d0d19da97.png\"></a>\n</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/f2249e2915cbfd8a261d64823199f32a147bfe7a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f61386666326463662d396438352d376334312d316565302d6662346638336562336333632e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/f2249e2915cbfd8a261d64823199f32a147bfe7a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f61386666326463662d396438352d376334312d316565302d6662346638336562336333632e706e67\" alt=\"image\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/a8ff2dcf-9d85-7c41-1ee0-fb4f83eb3c3c.png\"></a></p>\n\n<p><a href=\"https://camo.qiitausercontent.com/313541fc7e1ffe9781ad27141ed0b9d59400be18/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f66363362353066352d373639642d386666322d313930392d6630366165636330373130362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/313541fc7e1ffe9781ad27141ed0b9d59400be18/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f66363362353066352d373639642d386666322d313930392d6630366165636330373130362e706e67\" alt=\"image\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/f63b50f5-769d-8ff2-1909-f06aecc07106.png\"></a></p>\n\n<ul>\n<li>カバレッジレポートはbuild.gradleのjacocoTestReportタスクでカバレッジレポート対象外にしていてもJenkinsのほうではうまく除外されなかったので、Jenkinsfileのほうでも対象外設定をした。</li>\n<li>JenkinsからGmailにメールする場合、Jenkins &gt; Jenkinsの管理 &gt; システムの設定 &gt; E-mail通知で下記のような設定が必要だった。</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/a9ab429d39d5959f7d05fe968d1110ccd53738f1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f38356139313162622d303931642d393936622d333663612d6366303336306336353539322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/a9ab429d39d5959f7d05fe968d1110ccd53738f1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f38356139313162622d303931642d393936622d333663612d6366303336306336353539322e706e67\" alt=\"image\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/85a911bb-091d-996b-36ca-cf0360c65592.png\"></a></p>\n\n<ul>\n<li>JenkinsからGmailにメールする場合、<a href=\"https://support.google.com/accounts/answer/6010255?hl=ja\" rel=\"nofollow noopener\" target=\"_blank\">安全性の低いアプリがアカウントにアクセスするのを許可する</a>の手順に従って許可を有効にする必要があった。</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/2758c73a3bb32139599ba67b88c6ac3e77bae419/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f32343738646535352d633338332d396130622d366564622d3934623365383438376666342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/2758c73a3bb32139599ba67b88c6ac3e77bae419/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f32343738646535352d633338332d396130622d366564622d3934623365383438376666342e706e67\" alt=\"image\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/2478de55-c383-9a0b-6edb-94b3e8487ff4.png\"></a></p>\n\n<h1>\n<span id=\"buildgradle\" class=\"fragment\"></span><a href=\"#buildgradle\"><i class=\"fa fa-link\"></i></a>build.gradle</h1>\n\n<p>Jenkins自体は、Gradleのコマンドを実行して出力結果をもとにレポートを生成するだけなので、<br>\nGradleのJavaアプリのbuild.gradleで下記処理が実行できるようになっている必要があります。<br>\nまたJenkinsでGradleをインストールしなくていいようにGradleラッパーを作成しておきます。</p>\n\n<ul>\n<li>checkstyle</li>\n<li>findbugs</li>\n<li>pmd</li>\n<li>cpd(重複コードチェック)</li>\n<li>test</li>\n<li>jacocoReport</li>\n<li>jar</li>\n<li>war</li>\n</ul>\n\n<p>例えばこんな</p>\n\n<div class=\"code-frame\" data-lang=\"groovy\">\n<div class=\"code-lang\"><span class=\"bold\">build.gradle</span></div>\n<div class=\"highlight\"><pre><span class=\"n\">apply</span> <span class=\"nl\">plugin:</span> <span class=\"s1\">'java'</span>\n<span class=\"n\">apply</span> <span class=\"nl\">plugin:</span> <span class=\"s1\">'war'</span>\n<span class=\"n\">apply</span> <span class=\"nl\">plugin:</span> <span class=\"s1\">'checkstyle'</span>\n<span class=\"n\">apply</span> <span class=\"nl\">plugin:</span> <span class=\"s1\">'findbugs'</span>\n<span class=\"n\">apply</span> <span class=\"nl\">plugin:</span> <span class=\"s1\">'pmd'</span>\n<span class=\"n\">apply</span> <span class=\"nl\">plugin:</span> <span class=\"s1\">'jacoco'</span>\n\n<span class=\"n\">ext</span> <span class=\"o\">{</span>\n    <span class=\"n\">appVersion</span> <span class=\"o\">=</span> <span class=\"s1\">'1.0.0'</span>\n    <span class=\"n\">appName</span> <span class=\"o\">=</span> <span class=\"s1\">'SampleApp'</span>\n    <span class=\"n\">javaVersion</span> <span class=\"o\">=</span> <span class=\"mf\">1.8</span>\n    <span class=\"n\">defaultEncoding</span> <span class=\"o\">=</span> <span class=\"s1\">'UTF-8'</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">sourceCompatibility</span> <span class=\"o\">=</span> <span class=\"n\">javaVersion</span>\n<span class=\"n\">targetCompatibility</span>  <span class=\"o\">=</span> <span class=\"n\">javaVersion</span>\n<span class=\"n\">tasks</span><span class=\"o\">.</span><span class=\"na\">withType</span><span class=\"o\">(</span><span class=\"n\">AbstractCompile</span><span class=\"o\">)*.</span><span class=\"na\">options</span><span class=\"o\">*.</span><span class=\"na\">encoding</span> <span class=\"o\">=</span> <span class=\"n\">defaultEncoding</span>\n<span class=\"n\">tasks</span><span class=\"o\">.</span><span class=\"na\">withType</span><span class=\"o\">(</span><span class=\"n\">GroovyCompile</span><span class=\"o\">)*.</span><span class=\"na\">groovyOptions</span><span class=\"o\">*.</span><span class=\"na\">encoding</span> <span class=\"o\">=</span> <span class=\"n\">defaultEncoding</span>\n<span class=\"n\">mainClassName</span> <span class=\"o\">=</span> <span class=\"s1\">'jp.takumon.sapmleapp.App'</span>\n\n<span class=\"n\">repositories</span> <span class=\"o\">{</span>\n    <span class=\"n\">mavenCentral</span><span class=\"o\">()</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">dependencies</span> <span class=\"o\">{</span>\n    <span class=\"c1\">// 依存ライブラリを記載 </span>\n\n    <span class=\"n\">compile</span> <span class=\"nl\">group:</span> <span class=\"s1\">'junit'</span><span class=\"o\">,</span> <span class=\"nl\">name:</span> <span class=\"s1\">'junit'</span><span class=\"o\">,</span> <span class=\"nl\">version:</span> <span class=\"s1\">'4.12'</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">jar</span> <span class=\"o\">{</span>\n    <span class=\"n\">baseName</span> <span class=\"o\">=</span> <span class=\"n\">appName</span>\n    <span class=\"n\">version</span> <span class=\"o\">=</span>  <span class=\"n\">appVersion</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">war</span> <span class=\"o\">{</span>\n    <span class=\"n\">baseName</span> <span class=\"o\">=</span> <span class=\"n\">appName</span>\n    <span class=\"n\">version</span> <span class=\"o\">=</span>  <span class=\"n\">appVersion</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">checkstyle</span> <span class=\"o\">{</span>\n    <span class=\"c1\">// 失敗しても後続の処理を継続させる</span>\n    <span class=\"n\">ignoreFailures</span> <span class=\"o\">=</span> <span class=\"kc\">true</span>\n    <span class=\"n\">sourceSets</span> <span class=\"o\">=</span> <span class=\"o\">[</span><span class=\"n\">sourceSets</span><span class=\"o\">.</span><span class=\"na\">main</span><span class=\"o\">]</span>\n    <span class=\"n\">toolVersion</span> <span class=\"o\">=</span> <span class=\"s1\">'7.6.1'</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">findbugs</span> <span class=\"o\">{</span>\n    <span class=\"c1\">// 失敗しても後続の処理を継続させる</span>\n    <span class=\"n\">ignoreFailures</span> <span class=\"o\">=</span> <span class=\"kc\">true</span>\n    <span class=\"n\">sourceSets</span> <span class=\"o\">=</span> <span class=\"o\">[</span><span class=\"n\">sourceSets</span><span class=\"o\">.</span><span class=\"na\">main</span><span class=\"o\">]</span>\n    <span class=\"n\">toolVersion</span> <span class=\"o\">=</span> <span class=\"s2\">\"3.0.1\"</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">pmd</span> <span class=\"o\">{</span>\n    <span class=\"c1\">// 失敗しても後続の処理を継続させる</span>\n    <span class=\"n\">ignoreFailures</span> <span class=\"o\">=</span> <span class=\"kc\">true</span>\n    <span class=\"n\">sourceSets</span> <span class=\"o\">=</span> <span class=\"o\">[</span><span class=\"n\">sourceSets</span><span class=\"o\">.</span><span class=\"na\">main</span><span class=\"o\">]</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">tasks</span><span class=\"o\">.</span><span class=\"na\">withType</span><span class=\"o\">(</span><span class=\"n\">Pmd</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n    <span class=\"n\">reports</span> <span class=\"o\">{</span>\n      <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"na\">enabled</span> <span class=\"o\">=</span> <span class=\"kc\">true</span>\n    <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n\n<span class=\"c1\">// CPD（重複コードチェック処理）をCheckタスクに追加</span>\n<span class=\"n\">check</span><span class=\"o\">.</span><span class=\"na\">doLast</span> <span class=\"o\">{</span>\n    <span class=\"n\">File</span> <span class=\"n\">outputDir</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"n\">File</span><span class=\"o\">(</span><span class=\"s2\">\"$reportsDir/cpd/\"</span><span class=\"o\">)</span>\n    <span class=\"n\">outputDir</span><span class=\"o\">.</span><span class=\"na\">mkdirs</span><span class=\"o\">()</span>\n\n    <span class=\"n\">ant</span><span class=\"o\">.</span><span class=\"na\">taskdef</span><span class=\"o\">(</span>\n        <span class=\"nl\">name:</span> <span class=\"s1\">'cpd'</span><span class=\"o\">,</span> \n        <span class=\"nl\">classname:</span> <span class=\"s1\">'net.sourceforge.pmd.cpd.CPDTask'</span><span class=\"o\">,</span>\n        <span class=\"nl\">classpath:</span> <span class=\"n\">configurations</span><span class=\"o\">.</span><span class=\"na\">pmd</span><span class=\"o\">.</span><span class=\"na\">asPath</span><span class=\"o\">)</span>\n\n    <span class=\"n\">ant</span><span class=\"o\">.</span><span class=\"na\">cpd</span><span class=\"o\">(</span>\n        <span class=\"nl\">minimumTokenCount:</span> <span class=\"s1\">'100'</span><span class=\"o\">,</span>\n        <span class=\"nl\">format:</span> <span class=\"s1\">'xml'</span><span class=\"o\">,</span>\n        <span class=\"nl\">encoding:</span> <span class=\"n\">defaultEncoding</span><span class=\"o\">,</span>\n        <span class=\"nl\">outputFile:</span> <span class=\"k\">new</span> <span class=\"n\">File</span><span class=\"o\">(</span><span class=\"n\">outputDir</span><span class=\"o\">,</span> <span class=\"s1\">'cpd.xml'</span><span class=\"o\">)</span>\n    <span class=\"o\">)</span> <span class=\"o\">{</span>\n        <span class=\"n\">fileset</span><span class=\"o\">(</span><span class=\"nl\">dir:</span> <span class=\"s2\">\"src/main/java\"</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n            <span class=\"n\">include</span><span class=\"o\">(</span><span class=\"nl\">name:</span> <span class=\"s1\">'**/*.java'</span><span class=\"o\">)</span>\n        <span class=\"o\">}</span>\n    <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">javadoc</span> <span class=\"o\">{</span>\n    <span class=\"n\">failOnError</span> <span class=\"o\">=</span> <span class=\"kc\">false</span>\n    <span class=\"c1\">// 好みのレベルで</span>\n    <span class=\"n\">options</span><span class=\"o\">.</span><span class=\"na\">memberLevel</span> <span class=\"o\">=</span> <span class=\"n\">JavadocMemberLevel</span><span class=\"o\">.</span><span class=\"na\">PRIVATE</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">test</span> <span class=\"o\">{</span>\n    <span class=\"c1\">// 失敗しても後続の処理を継続させる</span>\n    <span class=\"n\">ignoreFailures</span> <span class=\"o\">=</span> <span class=\"kc\">true</span>\n    <span class=\"n\">reports</span> <span class=\"o\">{</span>\n        <span class=\"n\">junitXml</span><span class=\"o\">.</span><span class=\"na\">enabled</span> <span class=\"o\">=</span> <span class=\"kc\">true</span>\n    <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">jacoco</span> <span class=\"o\">{</span>\n    <span class=\"n\">toolVersion</span> <span class=\"o\">=</span> <span class=\"s1\">'0.7.5.201505241946'</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">jacocoTestReport</span> <span class=\"o\">{</span>\n    <span class=\"n\">reports</span> <span class=\"o\">{</span>\n      <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"na\">enabled</span> <span class=\"o\">=</span> <span class=\"kc\">true</span>\n    <span class=\"o\">}</span>\n\n    <span class=\"c1\">// カバレッジレポートからテストクラスを除外</span>\n    <span class=\"n\">afterEvaluate</span> <span class=\"o\">{</span> \n        <span class=\"n\">classDirectories</span> <span class=\"o\">=</span> <span class=\"n\">files</span><span class=\"o\">(</span><span class=\"n\">classDirectories</span><span class=\"o\">.</span><span class=\"na\">files</span><span class=\"o\">.</span><span class=\"na\">collect</span> <span class=\"o\">{</span>\n            <span class=\"n\">fileTree</span><span class=\"o\">(</span><span class=\"nl\">dir:</span> <span class=\"n\">it</span><span class=\"o\">,</span> <span class=\"nl\">exclude:</span> <span class=\"o\">[</span><span class=\"s1\">'**/*Test.class'</span><span class=\"o\">])</span> \n        <span class=\"o\">})</span>\n    <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">task</span> <span class=\"nf\">wrapper</span> <span class=\"o\">(</span><span class=\"nl\">type:</span> <span class=\"n\">Wrapper</span><span class=\"o\">)</span> <span class=\"o\">{</span>\n    <span class=\"n\">gradleVersion</span> <span class=\"o\">=</span> <span class=\"s1\">'3.4.1'</span>\n<span class=\"o\">}</span>\n</pre></div>\n</div>\n\n<p>以上。</p>\n","body":"GradleのJavaアプリをJenkinsで１人CIするためのJenkinsfileを書いてみた。\nGithubにプッシュ時に、AWS上のJenkinsのパイプラインジョブが動いて、テストが成功したら同じくAWS上のTomcatにデプロイするみたいな感じで使ってます。\n\n# Declarative Pipeline\nいままではJenkinsfileを\n\n```\nnode {\n  ....\n}\n```\n\nのように書いてましたが、[Jenkinsの公式サイト](https://jenkins.io/doc/book/pipeline/syntax/)を見ると\nこれはScripted Pipelinesの記法であり、\nPipeline Pluginのバージョン2.5移行からは\n\n```\npipeline {\n  ....  \n}\n```\nのように書くDeclarative Pipelineという記法が導入されて、\nそっちのほうがシンプルでわかりやすく書けるよ!ということだったので書き直してみました。\n確かにすっきりしたし（特に最後のメールおくるとことか、デプロイするとことか）、\nいざとなったら従来のScripted Pipelinesもミックスできるのでいい感じです。\n\n# 追加したプラグイン\nJenkins初期設定時のSuggested Pluginに入っていないもの\n\n* [Checkstyle Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Checkstyle+Plugin;jsessionid=E9D4FA5064ACAE1CED7B19928DE0788F)（v3.47） - Checkstyeの結果収集用\n* [FindBugs Plugin](https://wiki.jenkins-ci.org/display/JENKINS/FindBugs+Plugin)（v4.69） - Findbugsのレポート生成用 \n* [PMD Plugin](https://wiki.jenkins-ci.org/display/JENKINS/PMD+Plugin)（v3.46） - PMDのレポート生成用\n* [DRY Plugin](https://wiki.jenkins-ci.org/display/JENKINS/DRY+Plugin)（v2.46） - CPD(重複コードチェック)のレポート生成用\n* [Step Counter Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Step+Counter+Plugin)（v2.0.0） - ソースコードのステップ数を集計してくれる\n* [Task Scanner Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Task+Scanner+Plugin)（v4.50） - ソースコード中のTODOとかを一覧化してくれる\n* [Javadoc Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Javadoc+Plugin)（v1.4） - JavaDoc生成用\n* [Warnings Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Warnings+Plugin)（v4.60） - ジョブ実行時の警告メッセージを収集してくれる\n* [JaCoCo Plugin](https://wiki.jenkins-ci.org/display/JENKINS/JaCoCo+Plugin)（v2.2.0） - テストカバレッジのレポート生成用\n\n\n\n# Jenkinsfile\nGithubからWebhookでJenkinsのパイプラインジョブを実行する。\nパイプラインジョブではGithubのJenkinsfileを使う。\nジョブの流れは下記。デプロイは静的コード解析とテストが成功したときだけ実行する。\n![image](https://qiita-image-store.s3.amazonaws.com/0/49915/56c8e12d-267b-a637-224e-fc8cb3474dfa.png)\n\n\n```groovy:Jenkinsfile\npipeline {\n    agent any\n    // 定数や変数を定義する\n    environment {\n        reportDir = 'build/reports'\n        javaDir = 'src/main/java'\n        resourcesDir = 'src/main/resources'\n        testReportDir = 'build/test-results/test'\n        jacocoReportDir = 'build/jacoco' \n        javadocDir = 'build/docs/javadoc'\n        libsDir = 'build/libs'\n        appName = 'SampleApp'\n        appVersion = '1.0.0'\n    }\n    \n    // stagesブロック中に一つ以上のstageを定義する\n    stages {\n        stage('事前準備') {\n            // 実際の処理はstepsブロック中に定義する\n            steps {\n                deleteDir()\n\n                // このJobをトリガーしてきたGithubのプロジェクトをチェックアウト\n                checkout scm\n\n                // ジョブ失敗の原因調査用にJenkinsfileとbuild.gradleは最初に保存する\n                archiveArtifacts \"Jenkinsfile\"\n                archiveArtifacts \"build.gradle\"\n\n                // scriptブロックを使うと従来のScripted Pipelinesの記法も使える\n                script {\n                    // Permission deniedで怒られないために実行権限を付与する\n                    if(isUnix()) {\n                        sh 'chmod +x gradlew'\n                    }\n                }\n                gradlew 'clean'\n            }\n        }\n        \n        stage('コンパイル') {\n            steps {\n                gradlew 'classes testClasses'\n            }\n            \n            // postブロックでstepsブロックの後に実行される処理が定義できる\n            post {\n                // alwaysブロックはstepsブロックの処理が失敗しても成功しても必ず実行される\n                always {\n\n                    // JavaDoc生成時に実行するとJavaDocの警告も含まれてしまうので\n                    // Javaコンパイル時の警告はコンパイル直後に収集する\n                    step([\n\n                        // プラグインを実行するときのクラス指定は完全修飾名でなくてもOK\n                        $class: 'WarningsPublisher',\n\n                        // Job実行時のコンソールから警告を収集する場合はconsoleParsers、\n                        // pmd.xmlなどのファイルから収集する場合はparserConfigurationsを指定する。\n                        // なおparserConfigurationsの場合はparserNameのほかにpattern(集計対象ファイルのパス)も指定が必要\n                        // パーサ名は下記プロパティファイルに定義されているものを使う\n                        // https://github.com/jenkinsci/warnings-plugin/blob/master/src/main/resources/hudson/plugins/warnings/parser/Messages.properties\n                        consoleParsers: [\n                            [parserName: 'Java Compiler (javac)'],\n                        ],\n                        canComputeNew: false,\n                        canResolveRelativesPaths: false,\n                        usePreviousBuildAsReference: true\n                    ])\n                }\n            }\n        }\n        \n        stage('静的コード解析') {\n            steps {\n                // 並列処理の場合はparallelメソッドを使う\n                parallel(\n                    '静的コード解析' : {\n                        gradlew 'check -x test'\n\n                        // dirメソッドでカレントディレクトリを指定できる\n                        dir(reportDir) {\n                            step([\n                                $class: 'CheckStylePublisher',\n                                pattern: \"checkstyle/*.xml\"\n                            ])\n                            step([\n                                $class: 'FindBugsPublisher',\n                                pattern: \"findbugs/*.xml\"\n                            ])\n                            step([\n                                $class: 'PmdPublisher',\n                                pattern: \"pmd/*.xml\"\n                            ])\n                            step([\n                                $class: 'DryPublisher',\n                                pattern: \"cpd/*.xml\"\n                            ])\n                \n                            archiveArtifacts \"checkstyle/*.xml\"\n                            archiveArtifacts \"findbugs/*.xml\"\n                            archiveArtifacts \"pmd/*.xml\"\n                            archiveArtifacts \"cpd/*.xml\"\n                        }\n                    },\n                    'ステップカウント': {\n                        // レポート作成\n                        // outputFileとoutputFormatを指定するとエクセルファイルも作成してくれる\n                        stepcounter outputFile: 'stepcount.xls', outputFormat: 'excel', settings: [\n                            [key:'Java', filePattern: \"${javaDir}/**/*.java\"],\n                            [key:'SQL', filePattern: \"${resourcesDir}/**/*.sql\"],\n                            [key:'HTML', filePattern: \"${resourcesDir}/**/*.html\"],\n                            [key:'JS', filePattern: \"${resourcesDir}/**/*.js\"],\n                            [key:'CSS', filePattern: \"${resourcesDir}/**/*.css\"]\n                        ]\n                        // 一応エクセルファイルも成果物として保存する\n                        archiveArtifacts \"stepcount.xls\"\n                    },\n                    'タスクスキャン': {\n                        step([\n                            $class: 'TasksPublisher',\n                            pattern: './**',\n                            // 集計対象を検索するときに大文字小文字を区別するか\n                            ignoreCase: true,\n                            // 優先度別に集計対象の文字列を指定できる\n                            // 複数指定する場合はカンマ区切りの文字列を指定する\n                            high: 'System.out.System.err',\n                            normal: 'TODO,FIXME,XXX',\n                        ])\n                    },\n                    'JavaDoc': {\n                        gradlew 'javadoc -x classes'\n                        step([\n                            $class: 'JavadocArchiver',\n                            // Javadocのindex.htmlがあるフォルダのパスを指定する\n                            javadocDir: \"${javadocDir}\",\n                            keepAll: true\n                        ])\n                    }\n                )\n            }\n            \n            post {\n                always {\n                   // JavaDocの警告を収集\n                    step([\n                        $class: 'WarningsPublisher',\n                        consoleParsers: [\n                            [parserName: 'JavaDoc Tool']\n                        ],\n                        canComputeNew: false,\n                        canResolveRelativesPaths: false,\n                        usePreviousBuildAsReference: true\n                    ])\n                }\n            }\n        }\n        \n\n        stage('テスト') {\n            steps {\n                gradlew 'test jacocoTestReport -x classes -x testClasses'\n                \n                junit \"${testReportDir}/*.xml\"\n                archiveArtifacts \"${testReportDir}/*.xml\"\n\n                // カバレッジレポートを生成（テストクラスを除外）\n                step([\n                    $class: 'JacocoPublisher',\n                    execPattern: \"${jacocoReportDir}/*.exec\",\n                    exclusionPattern: '**/*Test.class'\n                ])\n            }\n        }\n        \n        stage('デプロイ') {\n            // whenブロックでstageを実行する条件を指定できる\n            when {\n                // 静的コード解析とテスト失敗時はデプロイしない\n                expression {currentBuild.currentResult == 'SUCCESS'}\n            }\n            \n            steps {\n                gradlew 'jar'\n                archiveArtifacts \"${libsDir}/${appName}-${appVersion}.jar\"\n                gradlew 'war'\n                archiveArtifacts \"${libsDir}/${appName}-${appVersion}.war\"\n                deploy warDir: libsDir, appName: appName, appVersion: appVersion\n            }\n        }\n    }\n    \n    // stagesブロックと同じレベルにpostブロックを定義すると\n    // 全てのstage処理が終わった後の処理の定義が可能    \n    post {\n        always {\n            // 最後にワークスペースの中身を削除\n            deleteDir()\n        }\n        // 連続で成功しているとき以外は自分宛にメールを送信\n\n        // 結果が前回と変わった時\n        changed {\n            sendMail(\"${currentBuild.previousBuild.result} => ${currentBuild.currentResult}\")\n        }\n        // 失敗した時\n        failure {\n            sendMail(currentBuild.currentResult)\n        }\n        // 不安定な時（主にテスト失敗時）\n        unstable {\n            sendMail(currentBuild.currentResult)\n        }\n    }\n}\n\n\n// Gradlewコマンドを実行する\ndef gradlew(command) {\n    if(isUnix()) {\n        sh \"./gradlew ${command} --stacktrace\"\n    } else {\n        bat \"./gradlew.bat ${command} --stacktrace\"\n    }\n}\n\n// デプロイする\n// args.warDir warの格納ディレクトリ \n// args.appName アプリ名\n// args.appVersion アプリのバージョン\ndef deploy(Map args) {\n    // 秘密鍵のパス ※Tomcatサーバにファイル転送するので事前にJenkinsサーバのどこかに秘密鍵を格納しておく必要がある\n    def keyDir = '/var/lib/jenkins/.ssh/xxx'\n    // Tomcatサーバのアドレスとユーザ名\n    def webServerAddress = 'ecX-XX-XXX-X-X.xx-xxxx-x.xxxxxxxx'\n    def webServerUser = 'hoge-user'\n    def webServer = \"${webServerUser}@${webServerAddress}\"\n    \n    def srcWar = \"${args.appName}-${args.appVersion}.war\"\n    def destWar = \"${args.appName}.war\"\n    \n    // ファイル転送してTomcatのwebappsにwarを配置する\n    sh \"sudo -S scp -i ${keyDir} ./${args.warDir}/${srcWar} ${webServer}:/home/ec2-user\"\n    sh \"sudo -S ssh -i ${keyDir} ${webServer} \\\"sudo cp /home/ec2-user/${srcWar} /usr/share/tomcat8/webapps/${destWar}\\\"\"\n}\n\n// メールをGmailに送信する\ndef sendMail(result) {\n    mail to: \"xxxxxxxx@gmail.com\",\n        subject: \"${env.JOB_NAME} #${env.BUILD_NUMBER} [${result}]\",\n        body: \"Build URL: ${env.BUILD_URL}.\\n\\n\"\n}\n```\n\n# 躓いたこと\n* 各プラグインともChangelogに「パイプライン対応したよ！」とは書いてあるが、\n具体的は書き方は明記していないことが多いので、\n各プラグインのGithubでソースコード（主に「なんちゃらPublisher」クラス）を見ながら、Jenkinsfileを書いた。\n* currentBuildオブジェクトの使い方がよくわからなかったが、Jenkinsのパイプラインジョブ > 設定 > Pipeline Syntax > Global Variables Reference に詳しく載っていた。\n![image](https://qiita-image-store.s3.amazonaws.com/0/49915/0f616d50-c57f-235e-c214-8c8d0d19da97.png)\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/49915/a8ff2dcf-9d85-7c41-1ee0-fb4f83eb3c3c.png)\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/49915/f63b50f5-769d-8ff2-1909-f06aecc07106.png)\n \n* カバレッジレポートはbuild.gradleのjacocoTestReportタスクでカバレッジレポート対象外にしていてもJenkinsのほうではうまく除外されなかったので、Jenkinsfileのほうでも対象外設定をした。\n* JenkinsからGmailにメールする場合、Jenkins > Jenkinsの管理 > システムの設定 > E-mail通知で下記のような設定が必要だった。\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/49915/85a911bb-091d-996b-36ca-cf0360c65592.png)\n\n* JenkinsからGmailにメールする場合、[安全性の低いアプリがアカウントにアクセスするのを許可する](https://support.google.com/accounts/answer/6010255?hl=ja)の手順に従って許可を有効にする必要があった。\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/49915/2478de55-c383-9a0b-6edb-94b3e8487ff4.png)\n\n# build.gradle\nJenkins自体は、Gradleのコマンドを実行して出力結果をもとにレポートを生成するだけなので、\nGradleのJavaアプリのbuild.gradleで下記処理が実行できるようになっている必要があります。\nまたJenkinsでGradleをインストールしなくていいようにGradleラッパーを作成しておきます。\n\n * checkstyle\n * findbugs\n * pmd\n * cpd(重複コードチェック)\n * test\n * jacocoReport\n * jar\n * war\n\n例えばこんな\n\n```groovy:build.gradle\napply plugin: 'java'\napply plugin: 'war'\napply plugin: 'checkstyle'\napply plugin: 'findbugs'\napply plugin: 'pmd'\napply plugin: 'jacoco'\n\next {\n    appVersion = '1.0.0'\n    appName = 'SampleApp'\n    javaVersion = 1.8\n    defaultEncoding = 'UTF-8'\n}\n\nsourceCompatibility = javaVersion\ntargetCompatibility  = javaVersion\ntasks.withType(AbstractCompile)*.options*.encoding = defaultEncoding\ntasks.withType(GroovyCompile)*.groovyOptions*.encoding = defaultEncoding\nmainClassName = 'jp.takumon.sapmleapp.App'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    // 依存ライブラリを記載 \n\n    compile group: 'junit', name: 'junit', version: '4.12'\n}\n\njar {\n    baseName = appName\n    version =  appVersion\n}\n\nwar {\n    baseName = appName\n    version =  appVersion\n}\n\ncheckstyle {\n    // 失敗しても後続の処理を継続させる\n    ignoreFailures = true\n    sourceSets = [sourceSets.main]\n    toolVersion = '7.6.1'\n}\n\nfindbugs {\n    // 失敗しても後続の処理を継続させる\n    ignoreFailures = true\n    sourceSets = [sourceSets.main]\n    toolVersion = \"3.0.1\"\n}\n\npmd {\n    // 失敗しても後続の処理を継続させる\n    ignoreFailures = true\n    sourceSets = [sourceSets.main]\n}\n\ntasks.withType(Pmd) {\n    reports {\n      xml.enabled = true\n    }\n}\n\n// CPD（重複コードチェック処理）をCheckタスクに追加\ncheck.doLast {\n    File outputDir = new File(\"$reportsDir/cpd/\")\n    outputDir.mkdirs()\n  \n    ant.taskdef(\n        name: 'cpd', \n        classname: 'net.sourceforge.pmd.cpd.CPDTask',\n        classpath: configurations.pmd.asPath)\n  \n    ant.cpd(\n        minimumTokenCount: '100',\n        format: 'xml',\n        encoding: defaultEncoding,\n        outputFile: new File(outputDir, 'cpd.xml')\n    ) {\n        fileset(dir: \"src/main/java\") {\n            include(name: '**/*.java')\n        }\n    }\n}\n\njavadoc {\n    failOnError = false\n    // 好みのレベルで\n    options.memberLevel = JavadocMemberLevel.PRIVATE\n}\n\ntest {\n    // 失敗しても後続の処理を継続させる\n    ignoreFailures = true\n    reports {\n        junitXml.enabled = true\n    }\n}\n\njacoco {\n    toolVersion = '0.7.5.201505241946'\n}\n\njacocoTestReport {\n    reports {\n      xml.enabled = true\n    }\n    \n    // カバレッジレポートからテストクラスを除外\n    afterEvaluate { \n        classDirectories = files(classDirectories.files.collect {\n            fileTree(dir: it, exclude: ['**/*Test.class']) \n        })\n    }\n}\n\ntask wrapper (type: Wrapper) {\n    gradleVersion = '3.4.1'\n}\n```\n\n\n以上。\n","comments_count":0,"created_at":"2017-04-07T02:38:55+09:00","likes_count":57,"reactions_count":0},{"fields":{"slug":"/e6e81f10-e1df-58fa-ad49-6da5d018abc4/","title":"Java SE8 Gold取りました。","date":"2017-03-12T17:52:21+09:00","excerpt":"先日Java SE 8 Programmer II(Java SE8 Gold)に合格しました。そのために自分がやったことと受験した感想をメモします。▼試験結果勉強期間　：3カ月得点率　　： 73％（ボーダー65％）　結構ギリギリ(&gt;...","tags":["Java","java8","資格","Qiita"],"keywords":["Java"],"thumbnail":""},"id":"e6e81f10-e1df-58fa-ad49-6da5d018abc4","title":"Java SE8 Gold取りました。","rendered_body":"<p>先日<a href=\"http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&amp;get_params=p_exam_id:1Z0-809&amp;p_org_id=70\" rel=\"nofollow noopener\" target=\"_blank\">Java SE 8 Programmer II(Java SE8 Gold)</a>に合格しました。<br>\nそのために自分がやったことと受験した感想をメモします。</p>\n\n<p>▼試験結果<br>\n勉強期間　：3カ月<br>\n得点率　　： 73％（ボーダー65％）　結構ギリギリ(&gt;o&lt;)!</p>\n\n<h2>\n<span id=\"自分とjavaの関係\" class=\"fragment\"></span><a href=\"#%E8%87%AA%E5%88%86%E3%81%A8java%E3%81%AE%E9%96%A2%E4%BF%82\"><i class=\"fa fa-link\"></i></a>自分とJavaの関係</h2>\n\n<ul>\n<li>仕事でJava開発は5年</li>\n<li>保有資格は<a href=\"https://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&amp;get_params=p_exam_id:1Z0-808&amp;p_org_id=70&amp;lang=JA\" rel=\"nofollow noopener\" target=\"_blank\">Java SE 8 Silver</a>と <a href=\"http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=458&amp;p_org_id=70&amp;lang=JA&amp;get_params=p_track_id:JEE5WCD\" rel=\"nofollow noopener\" target=\"_blank\">WebコンポーネントデベロッパEE 5</a>と <a href=\"http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&amp;get_params=p_exam_id:1Z0-851&amp;p_org_id=70&amp;lang=JA\" rel=\"nofollow noopener\" target=\"_blank\">JavaプログラマSE 6</a>\n</li>\n</ul>\n\n<h2>\n<span id=\"きっかけ\" class=\"fragment\"></span><a href=\"#%E3%81%8D%E3%81%A3%E3%81%8B%E3%81%91\"><i class=\"fa fa-link\"></i></a>きっかけ</h2>\n\n<p>Java8で新機能が多く追加されたので、それらを習得するために受験しました。　<br>\n最初は<a href=\"http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&amp;get_params=p_exam_id:1Z0-813&amp;p_org_id=70&amp;lang=JA\" rel=\"nofollow noopener\" target=\"_blank\">Upgrade to Java SE 8 OCP</a>の受験を考えていましたが、<br>\n参考書がないのと情報量が少なかったので、こちらを受けることにしました。</p>\n\n<h2>\n<span id=\"買った参考書と感想\" class=\"fragment\"></span><a href=\"#%E8%B2%B7%E3%81%A3%E3%81%9F%E5%8F%82%E8%80%83%E6%9B%B8%E3%81%A8%E6%84%9F%E6%83%B3\"><i class=\"fa fa-link\"></i></a>買った参考書と感想</h2>\n\n<p></p><dl>\n<dt>\n<a href=\"https://www.amazon.co.jp/%E5%BE%B9%E5%BA%95%E6%94%BB%E7%95%A5Java-SE-8-Gold%E5%95%8F%E9%A1%8C%E9%9B%86%EF%BC%BB1Z0-809%EF%BC%BD%E5%AF%BE%E5%BF%9C-%E5%BE%B9%E5%BA%95%E6%94%BB%E7%95%A5%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA-ebook/dp/B01LXSG1G9/ref=pd_sim_351_1?_encoding=UTF8&amp;psc=1&amp;refRID=PC6MK9AHZB6JSXW5VM6F\" rel=\"nofollow noopener\" target=\"_blank\">徹底攻略Java SE 8 Gold問題集［1Z0-809］対応 徹底攻略シリーズ</a>（以後、黒本と記述）</dt>\n<br>\n<dd>定番の問題集なので購入しましたが、全体的に難易度が低めの門題が多いです。ただ本の最後の総仕上げ問題は本番試験と難易度が近く、本番でも同じ問題が多数出題されました。</dd>\n<br>\n<dt>\n<a href=\"https://www.amazon.co.jp/dp/B0191U2H8C/ref=dp-kindle-redirect?_encoding=UTF8&amp;btkr=1\" rel=\"nofollow noopener\" target=\"_blank\">OCP: Oracle Certified Professional Java SE 8 Programmer II Study Guide: Exam 1Z0-809</a>（以後、 Study Guideと記述）</dt>\n<br>\n<dd>上記の黒本だけでは不安になり購入しました。<a href=\"https://www.amazon.co.jp/dp/B01J1LPKJY/ref=dp-kindle-redirect?_encoding=UTF8&amp;btkr=1\" rel=\"nofollow noopener\" target=\"_blank\">紫本</a>と同じような構成で、参考書と問題集が１つになっています。紫本ではなくStudy Guideにしたのは英語力を身につけたかったからです。本の説明に「Complete, trusted preparation for the Java Programmer II exam」とある通り問題数も多くかなり充実した内容でした。難易度は本番よりも高めです。この本を２周して問題の正答率が90%に達していれば絶対合格できます。ただ量が多いので２周するのはかなり根気が必要です（自分は1周で断念しました）。<br>あと本がでかくて、電車の中では絶対読めません。Kindleで購入したほうがいいです。</dd>\n\n<h2>\n<span id=\"試験本番\" class=\"fragment\"></span><a href=\"#%E8%A9%A6%E9%A8%93%E6%9C%AC%E7%95%AA\"><i class=\"fa fa-link\"></i></a>試験本番</h2>\n\n<p>問題数は85問、試験時間は150分でしたが、時間が足りないということはなく、120分ほどで解き終わりました。<br>\n難易度は黒本の総仕上げ問題よりも少し高めです。<br>\nJavaプログラマSE 6の時のような重箱の隅をつつくような問題は少なく、<br>\nJava8の新規機能がメインで、ストリームAIP、ラムダ式、メソッド参照に関しては単体での出題 or 他と絡めての出題で１／４を占めていました。Study Guideではパラレルストリームの難しめの問題が多かったのですが、本番は簡単な問題が２問程度でした。OptionalとDateTimeAPIについては意外と少なく、１、２問程度でした。<br>\nJDBCは例外処理と絡めた問題もあり５～７問と意外と多めでした。<br>\nNew IOについては絶対パスと相対パスでの挙動の違いをしっかり理解する必要があります。</p>\n\n<h2>\n<span id=\"感想\" class=\"fragment\"></span><a href=\"#%E6%84%9F%E6%83%B3\"><i class=\"fa fa-link\"></i></a>感想</h2>\n\n<p>点数的にはギリギリ合格でした。。。<br>\n問題集に取り組むときに、正解を導き出せるだけでなく、一つ一つの選択肢に対して背景を理解する必要があったと感じています。しかしながらJava8の主要新な機能について一通り整理できました、業務で使う分には十分な理解だと思います。<br>\n試験対策は問題集のみでしたが、試験後に<a href=\"http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&amp;get_params=p_exam_id:1Z0-809&amp;p_org_id=70&amp;lang=JA\" rel=\"nofollow noopener\" target=\"_blank\">オラクルの公式サイト</a>を見てみると、試験内容＞チェックリスト＞【トピック】の１つ１つに対して漏れなく問題が出題されてたことが分かったので、試験前に見とけばよかったなぁと感じています。あと英語の勉強もかねて黒本とStudy Guideを選びましたが、他の方のブログを見た感じだと、黒本と紫本を買ってそれぞれ２周すれば合格できるような気がしました。</p>\n</dl>","body":"先日[Java SE 8 Programmer II(Java SE8 Gold)](http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&get_params=p_exam_id:1Z0-809&p_org_id=70)に合格しました。\nそのために自分がやったことと受験した感想をメモします。\n\n▼試験結果\n勉強期間　：3カ月\n得点率　　： 73％（ボーダー65％）　結構ギリギリ(>o<)!\n\n## 自分とJavaの関係\n* 仕事でJava開発は5年\n* 保有資格は[Java SE 8 Silver](https://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&get_params=p_exam_id:1Z0-808&p_org_id=70&lang=JA)と [WebコンポーネントデベロッパEE 5](http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=458&p_org_id=70&lang=JA&get_params=p_track_id:JEE5WCD)と [JavaプログラマSE 6](http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&get_params=p_exam_id:1Z0-851&p_org_id=70&lang=JA)\n\n## きっかけ\nJava8で新機能が多く追加されたので、それらを習得するために受験しました。　\n最初は[Upgrade to Java SE 8 OCP](http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&get_params=p_exam_id:1Z0-813&p_org_id=70&lang=JA)の受験を考えていましたが、\n参考書がないのと情報量が少なかったので、こちらを受けることにしました。\n\n## 買った参考書と感想\n<dl><dt>[徹底攻略Java SE 8 Gold問題集［1Z0-809］対応 徹底攻略シリーズ](https://www.amazon.co.jp/%E5%BE%B9%E5%BA%95%E6%94%BB%E7%95%A5Java-SE-8-Gold%E5%95%8F%E9%A1%8C%E9%9B%86%EF%BC%BB1Z0-809%EF%BC%BD%E5%AF%BE%E5%BF%9C-%E5%BE%B9%E5%BA%95%E6%94%BB%E7%95%A5%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA-ebook/dp/B01LXSG1G9/ref=pd_sim_351_1?_encoding=UTF8&psc=1&refRID=PC6MK9AHZB6JSXW5VM6F)（以後、黒本と記述）</dt>\n<dd>定番の問題集なので購入しましたが、全体的に難易度が低めの門題が多いです。ただ本の最後の総仕上げ問題は本番試験と難易度が近く、本番でも同じ問題が多数出題されました。</dd>\n<dt>[OCP: Oracle Certified Professional Java SE 8 Programmer II Study Guide: Exam 1Z0-809](https://www.amazon.co.jp/dp/B0191U2H8C/ref=dp-kindle-redirect?_encoding=UTF8&btkr=1)（以後、 Study Guideと記述）</dt>\n<dd>上記の黒本だけでは不安になり購入しました。[紫本](https://www.amazon.co.jp/dp/B01J1LPKJY/ref=dp-kindle-redirect?_encoding=UTF8&btkr=1)と同じような構成で、参考書と問題集が１つになっています。紫本ではなくStudy Guideにしたのは英語力を身につけたかったからです。本の説明に「Complete, trusted preparation for the Java Programmer II exam」とある通り問題数も多くかなり充実した内容でした。難易度は本番よりも高めです。この本を２周して問題の正答率が90%に達していれば絶対合格できます。ただ量が多いので２周するのはかなり根気が必要です（自分は1周で断念しました）。<br>あと本がでかくて、電車の中では絶対読めません。Kindleで購入したほうがいいです。</dd>\n\n## 試験本番\n問題数は85問、試験時間は150分でしたが、時間が足りないということはなく、120分ほどで解き終わりました。\n難易度は黒本の総仕上げ問題よりも少し高めです。\nJavaプログラマSE 6の時のような重箱の隅をつつくような問題は少なく、\nJava8の新規機能がメインで、ストリームAIP、ラムダ式、メソッド参照に関しては単体での出題 or 他と絡めての出題で１／４を占めていました。Study Guideではパラレルストリームの難しめの問題が多かったのですが、本番は簡単な問題が２問程度でした。OptionalとDateTimeAPIについては意外と少なく、１、２問程度でした。\nJDBCは例外処理と絡めた問題もあり５～７問と意外と多めでした。\nNew IOについては絶対パスと相対パスでの挙動の違いをしっかり理解する必要があります。\n\n## 感想\n点数的にはギリギリ合格でした。。。\n問題集に取り組むときに、正解を導き出せるだけでなく、一つ一つの選択肢に対して背景を理解する必要があったと感じています。しかしながらJava8の主要新な機能について一通り整理できました、業務で使う分には十分な理解だと思います。\n試験対策は問題集のみでしたが、試験後に[オラクルの公式サイト](http://education.oracle.com/pls/web_prod-plq-dad/db_pages.getpage?page_id=5001&get_params=p_exam_id:1Z0-809&p_org_id=70&lang=JA)を見てみると、試験内容＞チェックリスト＞【トピック】の１つ１つに対して漏れなく問題が出題されてたことが分かったので、試験前に見とけばよかったなぁと感じています。あと英語の勉強もかねて黒本とStudy Guideを選びましたが、他の方のブログを見た感じだと、黒本と紫本を買ってそれぞれ２周すれば合格できるような気がしました。\n","comments_count":0,"created_at":"2017-03-12T17:52:21+09:00","likes_count":17,"reactions_count":0}],"latestPosts":[{"fields":{"slug":"how-to-get-user-custom-attributes-in-resolver-with-amplify-appsync-cognito","title":"Amplify + Cognito + AppSyncにおいてリゾルバーでユーザのカスタム属性を取得する方法","date":"2019-04-13T07:14:40.000+09:00","excerpt":"なにこれAppSync + Cognitoにおける認可制御について以前の記事で説明しました。今回は、ユーザーのカスタム属性を使った認可制御（AppSyncのリゾルバーでカスタム属性を取得する方法）についてご紹介します。TL;DRAppSyn...","tags":["Amplify","AppSync","AWS","Cognito"],"keywords":["AWS"],"thumbnail":"/thumbnail/2019/04/how-to-get-user-custom-attributes-in-resolver-with-amplify-appsync-cognito.png"}},{"fields":{"slug":"/vee-validate-custom-validation-locale-message","title":"Vuetify + VeeValidate + VueI18nでカスタムバリデーション作成時にロケールごとのエラーメッセージを設定する方法","date":"2019-04-07T14:10:00.000+09:00","excerpt":"なにこれVuetify + VeeValidateで入力チェックする際に、VueI18nを使ってエラーメッセージを多言語対応・共通化する場合に、カスタムバリデーションのエラーメッセージをロケールごとに設定する方法について紹介します。実装方法...","tags":["Vue.js","Vuetify","VeeValidate","VueI18n"],"keywords":["Vue.js"],"thumbnail":"/thumbnail/2019/04/vee-validate-custom-validation-locale-message.png"}},{"fields":{"slug":"/vuetify-select-tag","title":"VuetifyでSelectタグを使う時の注意点","date":"2019-03-24T23:55:00.000+09:00","excerpt":"なにこれ最近Vue.jsのマテリアルデザインのUIフレームワーク「Vuetify」を使っています。とても便利で、管理アプリのようにデザインにこだわる必要がなければ、CSSをほとんど書かずに済むくらいコンポーネントが充実しています。ただSel...","tags":["Vue.js","Vuetify"],"keywords":["Vue.js"],"thumbnail":"/thumbnail/2019/03/vuetify-select-tag.png"}},{"fields":{"slug":"/aws-appsync-auth-with-cognito","title":"AppSync + Cognitoによる認可制御","date":"2019-03-17T17:45:00.000+09:00","excerpt":"なにこれAppSyncはCognitoと連携して認可制御ができます。今回はそのやり方についてご紹介します。ざっくりいうと以下のようなことが実現可能です。✨スキーマ定義におけるQueryやMutationごとの認可制御（ユーザーグループ）💎...","tags":["AppSync","AWS","Cognito"],"keywords":["AWS"],"thumbnail":"/thumbnail/2019/03/aws-appsync-auth-with-cognito.png"}},{"fields":{"slug":"/aws-appsync-and-serverless-framework","title":"AppSync + Serverless Frameworkによるソースコードの構成管理","date":"2019-03-04T07:50:00.000+09:00","excerpt":"なにこれAWSのGraphQLマネージドサービス「AppSync」はGUIで簡単に設定ができて便利ですが、本格的に開発を進めていくとGUIポチポチでソースコードを管理するのはつらくなってきます。Serverless Frameworkという...","tags":["AppSync","serverless","AWS","GraphQL"],"keywords":["AppSync"],"thumbnail":"/thumbnail/2019/03/aws-appsync-and-serverless-framework.png"}}],"previous":{"fields":{"slug":"/38a98fba-b86d-5919-9db1-9defd84588e1/","title":"Reactコンポーネントをnpmで公開する（GitHub Pages付き、Babel7、webpack4）","date":"2018-12-12T00:56:33+09:00","excerpt":"なにこれTIS Advent Calendar 2018の13日目の記事です。よろしくお願いします！最近Reactコンポーネントをnpm公開してみました（参考記事：CSSのclip-pathでSlit Animationを実現する）。そこで...","tags":["npm","github-pages","webpack","React","babel","Qiita"],"keywords":["npm"],"thumbnail":""},"id":"38a98fba-b86d-5919-9db1-9defd84588e1","title":"Reactコンポーネントをnpmで公開する（GitHub Pages付き、Babel7、webpack4）","rendered_body":"\n<h2>\n<span id=\"なにこれ\" class=\"fragment\"></span><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\"><i class=\"fa fa-link\"></i></a>なにこれ</h2>\n\n<p><a href=\"https://qiita.com/advent-calendar/2018/tis\">TIS Advent Calendar 2018</a>の13日目の記事です。よろしくお願いします！</p>\n\n<p>最近Reactコンポーネントをnpm公開してみました（参考記事：<a href=\"https://takumon.com/2018/12/02/\" rel=\"nofollow noopener\" target=\"_blank\">CSSのclip-pathでSlit Animationを実現する</a>）。そこで今回は<strong>簡単なReactコンポーネントを作って、npm公開する方法を紹介します。</strong><br>\n「React始めたんだけど...npmアカウント作ったんだけど...」という方でも30分くらいで公開できるので、とりあえず手を動かしたい人向けのチュートリアルです。<br>\n下記のような手順でnpm公開するまでの方法を見ていきましょう。</p>\n\n<ol>\n<li><a href=\"#1-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">コンポーネントを作成する</a></li>\n<li><a href=\"#2-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">デモページを作成する</a></li>\n<li><a href=\"#3-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92github-pages%E3%81%A7%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\">デモページをGitHub Pagesで公開する</a></li>\n<li><a href=\"#4-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92npm%E3%81%AB%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\">コンポーネントをnpmに公開する</a></li>\n</ol>\n\n<p>※ 完成品はGitHubに公開しています =&gt; <a href=\"https://github.com/Takumon/react-component-sample/tree/step4\" rel=\"nofollow noopener\" target=\"_blank\">Takumon/react-component-sample</a><br>\n※ 完成品は下記のようなプロジェクト構成になります。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>プロジェクトルート\n├─dist              ・・・ コンポーネントビルド資産出力場所\n├─src               ・・・ コンポーネント資産\n│   ├─index.js\n│   └─styles.css\n├─examples          ・・・ デモページ用資産\n│  ├─dist           ・・・ デモページビルド資産出力場所\n│  └─src\n│     ├─index.html\n│     └─index.js\n├─node_modules\n├─.babelrc          ・・・トランスコンパイル用設定ファイル\n├─webpack.config.js ・・・ビルド用設定ファイル\n├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n├─.npmignore        ・・・npm登録除外対処定義ファイル\n└─.gitignore\n</pre></div></div>\n\n<h2>\n<span id=\"1-コンポーネントを作成する\" class=\"fragment\"></span><a href=\"#1-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>1. コンポーネントを作成する</h2>\n\n<p>まずはコンポーネントを作ってトランスパイルするところまで完成させましょう。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step1\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n<span class=\"gi\">+ ├─dist          ・・・ コンポーネントビルド資産出力場所\n+ ├─src           ・・・ コンポーネント資産\n+ │   ├─index.js\n+ │   └─styles.css\n+ ├─node_modules\n+ ├─.babelrc      ・・・トランスコンパイル用設定ファイル\n+ └─package.json  ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n</span></pre></div></div>\n\n<ul>\n<li>最初にプロジェクトの雛形を作ります。<code>npm init</code>で色々聞かれますが全てデフォルトで構いません。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><span class=\"nb\">mkdir </span>react-component-sample\n<span class=\"nb\">cd </span>react-component-sample\nnpm init\n</pre></div></div>\n\n<ul>\n<li>最低限のReact系ライブラリをインストールします。開発用ライブラリとしてインストールするので<code>-D</code>オプションを付けてください。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm i <span class=\"nt\">-D</span> react react-dom\n</pre></div></div>\n\n<ul>\n<li>BabelでReactをトランスコンパイルするためのライブラリをインストールします。こちらも開発用ライブラリなので<code>-D</code>オプションを付けましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>npm i -D @babel/cli @babel/cli @babel/core @babel/preset-env @babel/preset-react babel-loader\n</pre></div></div>\n\n<ul>\n<li>\n<code>.babelrc</code>を作成し、Reactをトランスコンパイルするための定義を記載します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"javascript\">\n<div class=\"code-lang\"><span class=\"bold\">.babelrc</span></div>\n<div class=\"highlight\"><pre><span class=\"p\">{</span>\n    <span class=\"s2\">\"presets\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s2\">\"@babel/preset-env\"</span><span class=\"p\">,</span>\n        <span class=\"s2\">\"@babel/react\"</span>\n    <span class=\"p\">]</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n\n<ul>\n<li>コンポーネントを作ります。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"jsx\">\n<div class=\"code-lang\"><span class=\"bold\">src/index.js</span></div>\n<div class=\"highlight\"><pre><span class=\"k\">import</span> <span class=\"nx\">React</span> <span class=\"k\">from</span> <span class=\"s1\">'react'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"s1\">'./styles.css'</span><span class=\"p\">;</span>\n<span class=\"kd\">const</span> <span class=\"nx\">MyComponent</span> <span class=\"o\">=</span> <span class=\"p\">()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">(</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">h1</span><span class=\"p\">&gt;</span>Hello from My Component<span class=\"p\">&lt;/</span><span class=\"nt\">h1</span><span class=\"p\">&gt;</span>\n<span class=\"p\">);</span>\n<span class=\"k\">export</span> <span class=\"k\">default</span> <span class=\"nx\">MyComponent</span><span class=\"p\">;</span>\n</pre></div>\n</div>\n\n<ul>\n<li>コンポーネントで読み込むCSSを作ります。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"css\">\n<div class=\"code-lang\"><span class=\"bold\">src/styles.css</span></div>\n<div class=\"highlight\"><pre><span class=\"nt\">h1</span> <span class=\"p\">{</span>\n    <span class=\"nl\">color</span><span class=\"p\">:</span> <span class=\"no\">red</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n\n<ul>\n<li>トランスパイル用スクリプトをpackage.jsonに追加します。具体的にはJSファイルをトランスパイルしdistフォルダに出力、それ以外のファイル(CSS)をdistファイルにコピーするスクリプトです。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"transpile\": \"babel src -d dist --copy-files\"\n</span>    },\n</pre></div>\n</div>\n\n<h3>\n<span id=\"確認\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>準備が整ったので、トランスパイルしてみましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm run transpile\n</pre></div></div>\n\n<ul>\n<li>下記のようにdistフォルダ配下にindex.jsとstyles.cssが生成されればトランスパイル成功です。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"\">\n<div class=\"code-lang\"><span class=\"bold\">トランスパイル後の資産</span></div>\n<div class=\"highlight\"><pre>プロジェクトルート\n├─dist           ・・・ コンポーネントビルド資産出力場所\n│   ├─index.js\n│   └─styles.css\n</pre></div>\n</div>\n\n<h2>\n<span id=\"2-デモページを作成する\" class=\"fragment\"></span><a href=\"#2-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>2. デモページを作成する</h2>\n\n<p>実際にコンポーネントを使用したデモページもあわせて用意しておきましょう。コンポーネントの使い方をユーザーにわかりやすく示すことができます。<br>\nここではローカルでデモページが見れるところまでを作成します。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step2\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n  ├─dist\n  ├─src\n  │   ├─index.js\n  │   └─styles.css\n  ├─node_modules\n  ├─.babelrc\n<span class=\"gi\">+ ├─examples          ・・・ デモページ用資産\n+ │  ├─dist           ・・・ デモページビルド資産出力場所\n+ │  └─src\n+ │     ├─index.html\n+ │     └─index.js\n+ ├─webpack.config.js ・・・ビルド用設定ファイル\n+ └─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n</span></pre></div></div>\n\n<ul>\n<li>デモページはwebpackでビルドするので必要なライブラリをインストールします。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>npm i -D html-webpack-plugin webpack webpack-cli webpack-dev-server css-loader style-loader\n</pre></div></div>\n\n<ul>\n<li>デモページのHTMLを作成します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"html\">\n<div class=\"code-lang\"><span class=\"bold\">examples/src/index.html</span></div>\n<div class=\"highlight\"><pre><span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;head&gt;</span>\n    <span class=\"nt\">&lt;title&gt;</span>My Component Demo<span class=\"nt\">&lt;/title&gt;</span>\n    <span class=\"nt\">&lt;meta</span> <span class=\"na\">charset=</span><span class=\"s\">\"utf-8\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;meta</span> <span class=\"na\">name=</span><span class=\"s\">\"viewport\"</span> <span class=\"na\">content=</span><span class=\"s\">\"width=device-width, initial-scale=1, shrink-to-fit=no\"</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;/head&gt;</span>\n<span class=\"nt\">&lt;body&gt;</span>\n    <span class=\"nt\">&lt;noscript&gt;</span>\n        You need to enable JavaScript to run this app.\n    <span class=\"nt\">&lt;/noscript&gt;</span>\n    <span class=\"nt\">&lt;div</span> <span class=\"na\">id=</span><span class=\"s\">\"root\"</span><span class=\"nt\">&gt;&lt;/div&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</pre></div>\n</div>\n\n<ul>\n<li>デモページの起点となるコンポーネントを作成します。この時、<a href=\"#1-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">1. コンポーネントを作成する</a>で作成したコンポーネントを使います。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"jsx\">\n<div class=\"code-lang\"><span class=\"bold\">examples/src/index.js</span></div>\n<div class=\"highlight\"><pre><span class=\"k\">import</span> <span class=\"nx\">React</span> <span class=\"k\">from</span> <span class=\"s1\">'react'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">render</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"s1\">'react-dom'</span>\n<span class=\"k\">import</span> <span class=\"nx\">MyComponent</span> <span class=\"k\">from</span> <span class=\"s1\">'../../src'</span>\n\n<span class=\"kd\">const</span> <span class=\"nx\">App</span> <span class=\"o\">=</span> <span class=\"p\">()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">&lt;</span><span class=\"nc\">MyComponent</span><span class=\"p\">/&gt;;</span>\n<span class=\"nx\">render</span><span class=\"p\">(&lt;</span><span class=\"nc\">App</span> <span class=\"p\">/&gt;,</span> <span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">getElementById</span><span class=\"p\">(</span><span class=\"s1\">'root'</span><span class=\"p\">));</span>\n</pre></div>\n</div>\n\n<ul>\n<li>デモページのビルド設定ファイル（webpack.config.js）を作りましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"javascript\">\n<div class=\"code-lang\"><span class=\"bold\">webpack.config.js</span></div>\n<div class=\"highlight\"><pre><span class=\"kd\">const</span> <span class=\"nx\">path</span> <span class=\"o\">=</span> <span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s1\">'path'</span><span class=\"p\">);</span>\n<span class=\"kd\">const</span> <span class=\"nx\">HtmlWebpackPlugin</span> <span class=\"o\">=</span> <span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s1\">'html-webpack-plugin'</span><span class=\"p\">);</span>\n<span class=\"c1\">// HTMLファイルのビルド設定</span>\n<span class=\"kd\">const</span> <span class=\"nx\">htmlWebpackPlugin</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nx\">HtmlWebpackPlugin</span><span class=\"p\">({</span>\n    <span class=\"na\">template</span><span class=\"p\">:</span> <span class=\"nx\">path</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"nx\">__dirname</span><span class=\"p\">,</span> <span class=\"s1\">'examples/src/index.html'</span><span class=\"p\">),</span>\n    <span class=\"na\">filename</span><span class=\"p\">:</span> <span class=\"s1\">'./index.html'</span>\n<span class=\"p\">});</span>\n<span class=\"nx\">module</span><span class=\"p\">.</span><span class=\"nx\">exports</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"c1\">// 依存関係解決の起点となる資産を指定します。</span>\n    <span class=\"na\">entry</span><span class=\"p\">:</span> <span class=\"nx\">path</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"nx\">__dirname</span><span class=\"p\">,</span> <span class=\"s1\">'examples/src/index.js'</span><span class=\"p\">),</span>\n    <span class=\"c1\">// Babelのトランスパイル対象資産を指定します。</span>\n    <span class=\"na\">module</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"na\">rules</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n            <span class=\"p\">{</span>\n                <span class=\"na\">test</span><span class=\"p\">:</span> <span class=\"sr\">/</span><span class=\"se\">\\.(</span><span class=\"sr\">js|jsx</span><span class=\"se\">)</span><span class=\"sr\">/</span><span class=\"p\">,</span>\n                <span class=\"na\">use</span><span class=\"p\">:</span> <span class=\"s1\">'babel-loader'</span><span class=\"p\">,</span>\n                <span class=\"na\">exclude</span><span class=\"p\">:</span> <span class=\"sr\">/node_modules/</span>\n            <span class=\"p\">},</span>\n            <span class=\"p\">{</span>\n                <span class=\"na\">test</span><span class=\"p\">:</span> <span class=\"sr\">/</span><span class=\"se\">\\.</span><span class=\"sr\">css$/</span><span class=\"p\">,</span>\n                <span class=\"na\">use</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">\"style-loader\"</span><span class=\"p\">,</span> <span class=\"s2\">\"css-loader\"</span><span class=\"p\">]</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"na\">plugins</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"nx\">htmlWebpackPlugin</span><span class=\"p\">],</span>\n    <span class=\"na\">resolve</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"na\">extensions</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">'.js'</span><span class=\"p\">,</span> <span class=\"s1\">'.jsx'</span><span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"c1\">// 開発用Webサーバのポートを指定します。</span>\n    <span class=\"na\">devServer</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"na\">port</span><span class=\"p\">:</span> <span class=\"mi\">3001</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n\n<ul>\n<li>デモページ起動用スクリプトをpackage.jsonに追記します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.jsonの一部</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"start\": \"webpack-dev-server --mode development\"\n</span>    },\n</pre></div>\n</div>\n\n<h3>\n<span id=\"確認-1\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D-1\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>準備が整ったのでデモページを起動しましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm start\n</pre></div></div>\n\n<ul>\n<li>ブラウザで<code>http://localhost:3001</code>にアクセスしてコンポーネントが表示されればOKです。</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/a12b4f44783c0003093566184a9ea5badc8efc4d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f64363538373137352d323164372d613135622d343865392d3363366563333165643130352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/a12b4f44783c0003093566184a9ea5badc8efc4d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f64363538373137352d323164372d613135622d343865392d3363366563333165643130352e706e67\" alt=\"図1.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/d6587175-21d7-a15b-48e9-3c6ec31ed105.png\"></a></p>\n\n<h2>\n<span id=\"3-デモページをgithub-pagesで公開する\" class=\"fragment\"></span><a href=\"#3-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92github-pages%E3%81%A7%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>3. デモページをGitHub Pagesで公開する</h2>\n\n<p>デモページをローカルで見れるようになったら、次はGitHubに資産を登録し、GitHub Pagesで公開しましょう。プラグインで簡単に公開できます。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step3\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n<span class=\"gi\">+ ├─webpack.config.js ・・・ビルド用設定ファイル（追記）\n+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n+ └─.gitignore\n</span></pre></div></div>\n\n<ul>\n<li>github-pagesというGitHub公開用プラグインをインストールします。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm i <span class=\"nt\">-D</span> gh-pages\n</pre></div></div>\n\n<ul>\n<li>package.jsonにGitHubPages公開用スクリプトを３個追加します。\n\n<ul>\n<li>\n<code>publish-demo</code>はビルドとデプロイをいっぺんにやるスクリプトです。デプロイ前に大抵の場合ビルドするので、1つにまとめておくと便利です。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"build\": \"webpack --mode production\",\n+     \"deploy\": \"gh-pages -d examples/dist\",\n+     \"publish-demo\": \"npm run build &amp;&amp; npm run deploy\"\n</span>    },\n</pre></div>\n</div>\n\n<ul>\n<li>webpack.config.jsに出力先を指定します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">webpack.config.jsの一部</span></div>\n<div class=\"highlight\"><pre>  module.exports = {\n<span class=\"gi\">+     output: {\n+        path: path.join(__dirname, \"examples/dist\"),\n+        filename: \"bundle.js\"\n+    },\n</span>  }\n</pre></div>\n</div>\n\n<ul>\n<li>ではビルドしてみましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm run build\n</pre></div></div>\n\n<ul>\n<li><p>ビルドされて最小化された資産が<code>examples/dist</code>配下に出力されたのが確認できればOKです。</p></li>\n<li><p>Gitにあげる準備として<code>.gitignore</code>を作りましょう。</p></li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"txt\">\n<div class=\"code-lang\"><span class=\"bold\">.gitignore</span></div>\n<div class=\"highlight\"><pre>node_modules\ndist\n</pre></div>\n</div>\n\n<ul>\n<li>GitHubでリポジトリを新規作成して資産を登録しましょう。新規作成後の「...or create a new respository on the command line」の説明に従ってください。</li>\n</ul>\n\n<h3>\n<span id=\"確認-2\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D-2\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>下記を実行してGitHub Pagesに登録しましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm run publish-demo\n</pre></div></div>\n\n<ul>\n<li>2～3分後にGitHub PagesでWeb公開されていれば成功です。\n\n<ul>\n<li>例 =&gt; 　<a href=\"https://takumon.github.io/react-component-sample/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://takumon.github.io/react-component-sample/</a>\n</li>\n</ul>\n</li>\n</ul>\n\n<h3>\n<span id=\"補足画像ファイルを扱う場合\" class=\"fragment\"></span><a href=\"#%E8%A3%9C%E8%B6%B3%E7%94%BB%E5%83%8F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%89%B1%E3%81%86%E5%A0%B4%E5%90%88\"><i class=\"fa fa-link\"></i></a>(補足)画像ファイルを扱う場合</h3>\n\n<p>もしデモページで画像を読み込む場合は<code>file-loader</code>と<code>url-loader</code>を開発用依存ライブラリに追加してください。ビルド設定も下記のように修正が必要です。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>npm i -D file-loader url-loader\n</pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">webpack.config.jsの一部</span></div>\n<div class=\"highlight\"><pre>  module.exports = {\n    module: {\n<span class=\"gi\">+     {\n+       test: /\\.(jpg|png|ico)$/,\n+       use: 'url-loader'\n+     },\n</span>    },\n  }\n</pre></div>\n</div>\n\n<p><br><br>\nこれであとは最終手順のnpm公開を残すのみです！<br>\n<br></p>\n\n<h2>\n<span id=\"4-コンポーネントをnpmに公開する\" class=\"fragment\"></span><a href=\"#4-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92npm%E3%81%AB%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>4. コンポーネントをnpmに公開する</h2>\n\n<p>デモページも準備できたので、いよいよコンポーネントをnpmに公開しましょう。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step4\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n  ├─webpack.config.js ・・・ビルド用設定ファイル\n<span class=\"gi\">+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル(追記)\n+ ├─.npmignore        ・・・npm登録除外対処定義ファイル\n</span>  └─.gitignore\n</pre></div></div>\n\n<ul>\n<li>トランスパイル後に生成されるdist/index.jsを、npm公開資産のメインファイルに指定します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json</span></div>\n<div class=\"highlight\"><pre><span class=\"gi\">+   \"main\": \"dist/index.js\",\n</span></pre></div>\n</div>\n\n<ul>\n<li>次にnpm公開時に自動で走るスクリプト<code>prepublishOnly</code>を追加します。これによりnpm公開時にビルドし忘れるということを防ぎます。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.jsonの一部</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"prepublishOnly\": \"npm run transpile\"\n</span>    }\n</pre></div>\n</div>\n\n<ul>\n<li>このコンポーネントを使う側には、Reactがインストール済という想定ですのでpeerDependenciesを指定します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.jsonの一部</span></div>\n<div class=\"highlight\"><pre><span class=\"gi\">+   \"peerDependencies\": {\n+     \"react\": \"^16.3.0\",\n+     \"react-dom\": \"^16.3.0\"\n+   },\n</span></pre></div>\n</div>\n\n<ul>\n<li>\n<code>.npmignore</code>を作成して、npm公開資産として不用な資産（トランスパイル前のjsファイルなど）は公開対象外としましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"txt\">\n<div class=\"code-lang\"><span class=\"bold\">.npmignore</span></div>\n<div class=\"highlight\"><pre>src\nexamples\n.babelrc\n.gitignore\nwebpack.config.js\n</pre></div>\n</div>\n\n<ul>\n<li>最後にパッケージ名(package.jsonのname)を決めます。現段階では<code>react-component-sample</code>となっていて、お試しで作るコンポーネントとしては少し汎用的すぎる名前なので、<code>@自分のnpmアカウント名/raect-component-sample</code>のようにしましょう。例えば下記のように修正します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json修正例</span></div>\n<div class=\"highlight\"><pre><span class=\"gd\">-   \"name\": \"react-component-sample\",\n</span><span class=\"gi\">+   \"name\": \"@takumon/react-component-sample\",\n</span></pre></div>\n</div>\n\n<h3>\n<span id=\"確認-3\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D-3\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>ではnpm公開してみましょう。\n\n<ul>\n<li>\n<code>@takumon/react-component-sample</code>のようなパッケージ名は、<a href=\"https://docs.npmjs.com/about-scopes\" rel=\"nofollow noopener\" target=\"_blank\">Scoped Packag</a>(npmのプライベートなパッケージの命名規約)に沿っているのでデフォルトでプライベート公開になってしまいます。npmで有料契約をせずにプライベート公開しようとすると402エラーになります。そのため、ここでは<code>--access=public</code>をつけて一般公開するようにしています。（参考：<a href=\"https://stackoverflow.com/questions/45820881/npm-publish-failed-put-402\" rel=\"nofollow noopener\" target=\"_blank\">stachoverflow</a>)</li>\n<li>\n<code>Failed PUT 403</code>になる場合は、npmの認証エラーです。<code>npm login</code>しましょう。\nそれか<code>package.json</code>の<code>version</code>が古いのが原因です。いったん公開したバージョンで再公開はできません。バージョンをインクリメントしましょう。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm publish <span class=\"nt\">--access</span><span class=\"o\">=</span>public\n</pre></div></div>\n\n<ul>\n<li>これで、npm公式サイトを確認しパッケージが追加されていれば、公開完了です！</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/1c02995625c7b4d57870910d6302e8e5b7d1fdfa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f32393534363963312d623664302d626563382d303036642d6437306230393564393830362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/1c02995625c7b4d57870910d6302e8e5b7d1fdfa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f32393534363963312d623664302d626563382d303036642d6437306230393564393830362e706e67\" alt=\"図4.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/295469c1-b6d0-bec8-006d-d70b095d9806.png\"></a></p>\n\n<h2>\n<span id=\"おわりに\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>おわりに</h2>\n\n<p>今回紹介したように、わりと簡単にnpm公開できるので、普段使いまわしているようなコンポーネントがあれば公開してみるのもいいかもしれません。</p>\n\n<h2>\n<span id=\"参考\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83\"><i class=\"fa fa-link\"></i></a>参考</h2>\n\n<ul>\n<li><a href=\"https://medium.com/dailyjs/building-a-react-component-with-webpack-publish-to-npm-deploy-to-github-guide-6927f60b3220\" rel=\"nofollow noopener\" target=\"_blank\">A guide to building a React component with webpack 4, publishing to npm, and deploying the demo to GitHub Pages | Medium</a></li>\n<li><a href=\"https://hackernoon.com/creating-a-library-of-react-components-using-create-react-app-without-ejecting-d182df690c6b\" rel=\"nofollow noopener\" target=\"_blank\">Creating a library of React components using Create React App | Medium</a></li>\n</ul>\n","body":"## なにこれ\n\n[TIS Advent Calendar 2018](https://qiita.com/advent-calendar/2018/tis)の13日目の記事です。よろしくお願いします！\n\n最近Reactコンポーネントをnpm公開してみました（参考記事：[CSSのclip-pathでSlit Animationを実現する](https://takumon.com/2018/12/02/)）。そこで今回は**簡単なReactコンポーネントを作って、npm公開する方法を紹介します。**\n「React始めたんだけど...npmアカウント作ったんだけど...」という方でも30分くらいで公開できるので、とりあえず手を動かしたい人向けのチュートリアルです。\n下記のような手順でnpm公開するまでの方法を見ていきましょう。\n\n1. [コンポーネントを作成する](#1-コンポーネントを作成する)\n2. [デモページを作成する](#2-デモページを作成する)\n3. [デモページをGitHub Pagesで公開する](#3-デモページをgithub-pagesで公開する)\n4. [コンポーネントをnpmに公開する](#4-コンポーネントをnpmに公開する)\n\n\n※ 完成品はGitHubに公開しています => [Takumon/react-component-sample](https://github.com/Takumon/react-component-sample/tree/step4)\n※ 完成品は下記のようなプロジェクト構成になります。\n\n```\nプロジェクトルート\n├─dist              ・・・ コンポーネントビルド資産出力場所\n├─src               ・・・ コンポーネント資産\n│   ├─index.js\n│   └─styles.css\n├─examples          ・・・ デモページ用資産\n│  ├─dist           ・・・ デモページビルド資産出力場所\n│  └─src\n│     ├─index.html\n│     └─index.js\n├─node_modules\n├─.babelrc          ・・・トランスコンパイル用設定ファイル\n├─webpack.config.js ・・・ビルド用設定ファイル\n├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n├─.npmignore        ・・・npm登録除外対処定義ファイル\n└─.gitignore\n```\n\n\n## 1. コンポーネントを作成する\n\nまずはコンポーネントを作ってトランスパイルするところまで完成させましょう。\n\n<small>※ 本手順完了時のソースコードは**[こちら](https://github.com/Takumon/react-component-sample/tree/step1)**</small>\n<small>※ 本手順完了時のプロジェクト構成 ↓</small>\n\n```diff\nプロジェクトルート\n+ ├─dist          ・・・ コンポーネントビルド資産出力場所\n+ ├─src           ・・・ コンポーネント資産\n+ │   ├─index.js\n+ │   └─styles.css\n+ ├─node_modules\n+ ├─.babelrc      ・・・トランスコンパイル用設定ファイル\n+ └─package.json  ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n```\n\n\n\n* 最初にプロジェクトの雛形を作ります。`npm init`で色々聞かれますが全てデフォルトで構いません。\n\n```bash\nmkdir react-component-sample\ncd react-component-sample\nnpm init\n```\n\n\n* 最低限のReact系ライブラリをインストールします。開発用ライブラリとしてインストールするので`-D`オプションを付けてください。\n\n```bash\nnpm i -D react react-dom\n```\n\n\n* BabelでReactをトランスコンパイルするためのライブラリをインストールします。こちらも開発用ライブラリなので`-D`オプションを付けましょう。\n\n```\nnpm i -D @babel/cli @babel/cli @babel/core @babel/preset-env @babel/preset-react babel-loader\n```\n\n\n* `.babelrc`を作成し、Reactをトランスコンパイルするための定義を記載します。\n\n```javascript:.babelrc\n{\n    \"presets\": [\n        \"@babel/preset-env\",\n        \"@babel/react\"\n    ]\n}\n```\n\n\n* コンポーネントを作ります。\n\n```jsx:src/index.js\nimport React from 'react';\nimport './styles.css';\nconst MyComponent = () => (\n    <h1>Hello from My Component</h1>\n);\nexport default MyComponent;\n```\n\n\n* コンポーネントで読み込むCSSを作ります。\n\n```css:src/styles.css\nh1 {\n    color: red;\n}\n```\n\n\n* トランスパイル用スクリプトをpackage.jsonに追加します。具体的にはJSファイルをトランスパイルしdistフォルダに出力、それ以外のファイル(CSS)をdistファイルにコピーするスクリプトです。\n\n```diff:package.json\n    \"scripts\": {\n+     \"transpile\": \"babel src -d dist --copy-files\"\n    },\n```\n\n### 確認\n\n* 準備が整ったので、トランスパイルしてみましょう。\n\n```bash\nnpm run transpile\n```\n\n\n* 下記のようにdistフォルダ配下にindex.jsとstyles.cssが生成されればトランスパイル成功です。\n\n```:トランスパイル後の資産\nプロジェクトルート\n├─dist           ・・・ コンポーネントビルド資産出力場所\n│   ├─index.js\n│   └─styles.css\n```\n\n\n\n## 2. デモページを作成する\n\n実際にコンポーネントを使用したデモページもあわせて用意しておきましょう。コンポーネントの使い方をユーザーにわかりやすく示すことができます。\nここではローカルでデモページが見れるところまでを作成します。\n\n<small>※ 本手順完了時のソースコードは**[こちら](https://github.com/Takumon/react-component-sample/tree/step2)**</small>\n<small>※ 本手順完了時のプロジェクト構成 ↓</small>\n\n```diff\nプロジェクトルート\n  ├─dist\n  ├─src\n  │   ├─index.js\n  │   └─styles.css\n  ├─node_modules\n  ├─.babelrc\n+ ├─examples          ・・・ デモページ用資産\n+ │  ├─dist           ・・・ デモページビルド資産出力場所\n+ │  └─src\n+ │     ├─index.html\n+ │     └─index.js\n+ ├─webpack.config.js ・・・ビルド用設定ファイル\n+ └─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n```\n\n\n\n* デモページはwebpackでビルドするので必要なライブラリをインストールします。\n\n```\nnpm i -D html-webpack-plugin webpack webpack-cli webpack-dev-server css-loader style-loader\n```\n\n\n* デモページのHTMLを作成します。\n\n```html:examples/src/index.html\n<html>\n<head>\n    <title>My Component Demo</title>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n</head>\n<body>\n    <noscript>\n        You need to enable JavaScript to run this app.\n    </noscript>\n    <div id=\"root\"></div>\n</body>\n</html>\n```\n\n\n* デモページの起点となるコンポーネントを作成します。この時、[1. コンポーネントを作成する](#1-コンポーネントを作成する)で作成したコンポーネントを使います。\n\n```jsx:examples/src/index.js\nimport React from 'react';\nimport { render } from 'react-dom'\nimport MyComponent from '../../src'\n\nconst App = () => <MyComponent/>;\nrender(<App />, document.getElementById('root'));\n```\n\n\n* デモページのビルド設定ファイル（webpack.config.js）を作りましょう。\n\n```javascript:webpack.config.js\nconst path = require('path');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\n// HTMLファイルのビルド設定\nconst htmlWebpackPlugin = new HtmlWebpackPlugin({\n    template: path.join(__dirname, 'examples/src/index.html'),\n    filename: './index.html'\n});\nmodule.exports = {\n    // 依存関係解決の起点となる資産を指定します。\n    entry: path.join(__dirname, 'examples/src/index.js'),\n    // Babelのトランスパイル対象資産を指定します。\n    module: {\n        rules: [\n            {\n                test: /\\.(js|jsx)/,\n                use: 'babel-loader',\n                exclude: /node_modules/\n            },\n            {\n                test: /\\.css$/,\n                use: [\"style-loader\", \"css-loader\"]\n            }\n        ]\n    },\n    plugins: [htmlWebpackPlugin],\n    resolve: {\n        extensions: ['.js', '.jsx']\n    },\n    // 開発用Webサーバのポートを指定します。\n    devServer: {\n        port: 3001\n    }\n}\n```\n\n\n* デモページ起動用スクリプトをpackage.jsonに追記します。\n\n```diff:package.jsonの一部\n    \"scripts\": {\n+     \"start\": \"webpack-dev-server --mode development\"\n    },\n```\n\n### 確認\n\n* 準備が整ったのでデモページを起動しましょう。\n\n```bash\nnpm start\n```\n\n\n* ブラウザで`http://localhost:3001`にアクセスしてコンポーネントが表示されればOKです。\n\n\n![図1.png](https://qiita-image-store.s3.amazonaws.com/0/49915/d6587175-21d7-a15b-48e9-3c6ec31ed105.png)\n\n\n\n## 3. デモページをGitHub Pagesで公開する\n\nデモページをローカルで見れるようになったら、次はGitHubに資産を登録し、GitHub Pagesで公開しましょう。プラグインで簡単に公開できます。\n\n\n<small>※ 本手順完了時のソースコードは**[こちら](https://github.com/Takumon/react-component-sample/tree/step3)**</small>\n<small>※ 本手順完了時のプロジェクト構成 ↓</small>\n\n```diff\nプロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n+ ├─webpack.config.js ・・・ビルド用設定ファイル（追記）\n+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n+ └─.gitignore\n```\n\n\n\n* github-pagesというGitHub公開用プラグインをインストールします。\n\n```bash\nnpm i -D gh-pages\n```\n\n\n* package.jsonにGitHubPages公開用スクリプトを３個追加します。\n  * `publish-demo`はビルドとデプロイをいっぺんにやるスクリプトです。デプロイ前に大抵の場合ビルドするので、1つにまとめておくと便利です。\n\n```diff:package.json\n    \"scripts\": {\n+     \"build\": \"webpack --mode production\",\n+     \"deploy\": \"gh-pages -d examples/dist\",\n+     \"publish-demo\": \"npm run build && npm run deploy\"\n    },\n```\n\n* webpack.config.jsに出力先を指定します。\n\n```diff:webpack.config.jsの一部\n  module.exports = {\n+     output: {\n+        path: path.join(__dirname, \"examples/dist\"),\n+        filename: \"bundle.js\"\n+    },\n  }\n```\n\n* ではビルドしてみましょう。\n\n```bash\nnpm run build\n```\n\n* ビルドされて最小化された資産が`examples/dist`配下に出力されたのが確認できればOKです。\n\n\n* Gitにあげる準備として`.gitignore`を作りましょう。\n\n```txt:.gitignore\nnode_modules\ndist\n```\n\n\n* GitHubでリポジトリを新規作成して資産を登録しましょう。新規作成後の「...or create a new respository on the command line」の説明に従ってください。\n\n### 確認\n* 下記を実行してGitHub Pagesに登録しましょう。\n\n```bash\nnpm run publish-demo\n```\n\n* 2～3分後にGitHub PagesでWeb公開されていれば成功です。\n    * 例 => 　https://takumon.github.io/react-component-sample/\n\n\n\n### (補足)画像ファイルを扱う場合\n\nもしデモページで画像を読み込む場合は`file-loader`と`url-loader`を開発用依存ライブラリに追加してください。ビルド設定も下記のように修正が必要です。\n\n```\nnpm i -D file-loader url-loader\n```\n\n```diff:webpack.config.jsの一部\n  module.exports = {\n    module: {\n+     {\n+       test: /\\.(jpg|png|ico)$/,\n+       use: 'url-loader'\n+     },\n    },\n  }\n```\n\n\n\n<br />\nこれであとは最終手順のnpm公開を残すのみです！\n<br />\n\n\n\n\n## 4. コンポーネントをnpmに公開する\n\nデモページも準備できたので、いよいよコンポーネントをnpmに公開しましょう。\n\n<small>※ 本手順完了時のソースコードは**[こちら](https://github.com/Takumon/react-component-sample/tree/step4)**</small>\n<small>※ 本手順完了時のプロジェクト構成 ↓</small>\n\n```diff\nプロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n  ├─webpack.config.js ・・・ビルド用設定ファイル\n+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル(追記)\n+ ├─.npmignore        ・・・npm登録除外対処定義ファイル\n  └─.gitignore\n```\n\n\n\n* トランスパイル後に生成されるdist/index.jsを、npm公開資産のメインファイルに指定します。\n\n```diff:package.json\n+   \"main\": \"dist/index.js\",\n```\n\n\n* 次にnpm公開時に自動で走るスクリプト`prepublishOnly`を追加します。これによりnpm公開時にビルドし忘れるということを防ぎます。\n\n\n```diff:package.jsonの一部\n    \"scripts\": {\n+     \"prepublishOnly\": \"npm run transpile\"\n    }\n```\n\n\n* このコンポーネントを使う側には、Reactがインストール済という想定ですのでpeerDependenciesを指定します。\n\n```diff:package.jsonの一部\n+   \"peerDependencies\": {\n+     \"react\": \"^16.3.0\",\n+     \"react-dom\": \"^16.3.0\"\n+   },\n```\n\n\n* `.npmignore`を作成して、npm公開資産として不用な資産（トランスパイル前のjsファイルなど）は公開対象外としましょう。\n\n```txt:.npmignore\nsrc\nexamples\n.babelrc\n.gitignore\nwebpack.config.js\n```\n\n* 最後にパッケージ名(package.jsonのname)を決めます。現段階では`react-component-sample`となっていて、お試しで作るコンポーネントとしては少し汎用的すぎる名前なので、`@自分のnpmアカウント名/raect-component-sample`のようにしましょう。例えば下記のように修正します。\n\n```diff:package.json修正例\n-   \"name\": \"react-component-sample\",\n+   \"name\": \"@takumon/react-component-sample\",\n```\n\n\n### 確認\n\n* ではnpm公開してみましょう。\n  * `@takumon/react-component-sample`のようなパッケージ名は、[Scoped Packag](https://docs.npmjs.com/about-scopes)(npmのプライベートなパッケージの命名規約)に沿っているのでデフォルトでプライベート公開になってしまいます。npmで有料契約をせずにプライベート公開しようとすると402エラーになります。そのため、ここでは`--access=public`をつけて一般公開するようにしています。（参考：[stachoverflow](https://stackoverflow.com/questions/45820881/npm-publish-failed-put-402))\n  * `Failed PUT 403`になる場合は、npmの認証エラーです。`npm login`しましょう。\nそれか`package.json`の`version`が古いのが原因です。いったん公開したバージョンで再公開はできません。バージョンをインクリメントしましょう。\n\n```bash\nnpm publish --access=public\n```\n\n\n* これで、npm公式サイトを確認しパッケージが追加されていれば、公開完了です！\n\n![図4.png](https://qiita-image-store.s3.amazonaws.com/0/49915/295469c1-b6d0-bec8-006d-d70b095d9806.png)\n\n\n\n\n\n## おわりに\n\n今回紹介したように、わりと簡単にnpm公開できるので、普段使いまわしているようなコンポーネントがあれば公開してみるのもいいかもしれません。\n\n\n\n## 参考\n* [A guide to building a React component with webpack 4, publishing to npm, and deploying the demo to GitHub Pages | Medium](https://medium.com/dailyjs/building-a-react-component-with-webpack-publish-to-npm-deploy-to-github-guide-6927f60b3220)\n* [Creating a library of React components using Create React App | Medium](https://hackernoon.com/creating-a-library-of-react-components-using-create-react-app-without-ejecting-d182df690c6b)\n\n","comments_count":0,"created_at":"2018-12-12T00:56:33+09:00","likes_count":21,"reactions_count":0},"next":{"fields":{"slug":"/2018/12/23/","title":"mdx-deckとcode-surferでスライドを作ろう！","date":"2018-12-23T23:50:00.000+09:00","excerpt":"なにこれmdx-deckとcode-surferを使って、mdxファイルで簡単にリッチなスライドが作れるので試してみました。作ったスライドは下記、またはGitHub Pagesをご覧ください。スマホだと小っちゃいのでPCで見てください:di...","tags":["mdx-deck","mdx","code-surfer","markdown","プレゼン","スライド"],"keywords":["mdx-deck"],"thumbnail":""}}}}