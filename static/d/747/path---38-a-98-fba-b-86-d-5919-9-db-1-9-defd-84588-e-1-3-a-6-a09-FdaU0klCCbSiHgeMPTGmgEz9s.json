{"data":{"site":{"siteMetadata":{"title":"Takumon Blog","author":"Takuto Inoue"}},"qiitaPost":{"rendered_body":"\n<h2>\n<span id=\"なにこれ\" class=\"fragment\"></span><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\"><i class=\"fa fa-link\"></i></a>なにこれ</h2>\n\n<p><a href=\"https://qiita.com/advent-calendar/2018/tis\">TIS Advent Calendar 2018</a>の13日目の記事です。よろしくお願いします！</p>\n\n<p>最近Reactコンポーネントをnpm公開してみました（参考記事：<a href=\"https://takumon.com/2018/12/02/\" rel=\"nofollow noopener\" target=\"_blank\">CSSのclip-pathでSlit Animationを実現する</a>）。そこで今回は<strong>簡単なReactコンポーネントを作って、npm公開する方法を紹介します。</strong><br>\n「React始めたんだけど...npmアカウント作ったんだけど...」という方でも30分くらいで公開できるので、とりあえず手を動かしたい人向けのチュートリアルです。<br>\n下記のような手順でnpm公開するまでの方法を見ていきましょう。</p>\n\n<ol>\n<li><a href=\"#1-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">コンポーネントを作成する</a></li>\n<li><a href=\"#2-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">デモページを作成する</a></li>\n<li><a href=\"#3-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92github-pages%E3%81%A7%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\">デモページをGitHub Pagesで公開する</a></li>\n<li><a href=\"#4-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92npm%E3%81%AB%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\">コンポーネントをnpmに公開する</a></li>\n</ol>\n\n<p>※ 完成品はGitHubに公開しています =&gt; <a href=\"https://github.com/Takumon/react-component-sample/tree/step4\" rel=\"nofollow noopener\" target=\"_blank\">Takumon/react-component-sample</a><br>\n※ 完成品は下記のようなプロジェクト構成になります。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>プロジェクトルート\n├─dist              ・・・ コンポーネントビルド資産出力場所\n├─src               ・・・ コンポーネント資産\n│   ├─index.js\n│   └─styles.css\n├─examples          ・・・ デモページ用資産\n│  ├─dist           ・・・ デモページビルド資産出力場所\n│  └─src\n│     ├─index.html\n│     └─index.js\n├─node_modules\n├─.babelrc          ・・・トランスコンパイル用設定ファイル\n├─webpack.config.js ・・・ビルド用設定ファイル\n├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n├─.npmignore        ・・・npm登録除外対処定義ファイル\n└─.gitignore\n</pre></div></div>\n\n<h2>\n<span id=\"1-コンポーネントを作成する\" class=\"fragment\"></span><a href=\"#1-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>1. コンポーネントを作成する</h2>\n\n<p>まずはコンポーネントを作ってトランスパイルするところまで完成させましょう。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step1\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n<span class=\"gi\">+ ├─dist          ・・・ コンポーネントビルド資産出力場所\n+ ├─src           ・・・ コンポーネント資産\n+ │   ├─index.js\n+ │   └─styles.css\n+ ├─node_modules\n+ ├─.babelrc      ・・・トランスコンパイル用設定ファイル\n+ └─package.json  ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n</span></pre></div></div>\n\n<ul>\n<li>最初にプロジェクトの雛形を作ります。<code>npm init</code>で色々聞かれますが全てデフォルトで構いません。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><span class=\"nb\">mkdir </span>react-component-sample\n<span class=\"nb\">cd </span>react-component-sample\nnpm init\n</pre></div></div>\n\n<ul>\n<li>最低限のReact系ライブラリをインストールします。開発用ライブラリとしてインストールするので<code>-D</code>オプションを付けてください。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm i <span class=\"nt\">-D</span> react react-dom\n</pre></div></div>\n\n<ul>\n<li>BabelでReactをトランスコンパイルするためのライブラリをインストールします。こちらも開発用ライブラリなので<code>-D</code>オプションを付けましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>npm i -D @babel/cli @babel/cli @babel/core @babel/preset-env @babel/preset-react babel-loader\n</pre></div></div>\n\n<ul>\n<li>\n<code>.babelrc</code>を作成し、Reactをトランスコンパイルするための定義を記載します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"javascript\">\n<div class=\"code-lang\"><span class=\"bold\">.babelrc</span></div>\n<div class=\"highlight\"><pre><span class=\"p\">{</span>\n    <span class=\"s2\">\"presets\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n        <span class=\"s2\">\"@babel/preset-env\"</span><span class=\"p\">,</span>\n        <span class=\"s2\">\"@babel/react\"</span>\n    <span class=\"p\">]</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n\n<ul>\n<li>コンポーネントを作ります。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"jsx\">\n<div class=\"code-lang\"><span class=\"bold\">src/index.js</span></div>\n<div class=\"highlight\"><pre><span class=\"k\">import</span> <span class=\"nx\">React</span> <span class=\"k\">from</span> <span class=\"s1\">'react'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"s1\">'./styles.css'</span><span class=\"p\">;</span>\n<span class=\"kd\">const</span> <span class=\"nx\">MyComponent</span> <span class=\"o\">=</span> <span class=\"p\">()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">(</span>\n    <span class=\"p\">&lt;</span><span class=\"nt\">h1</span><span class=\"p\">&gt;</span>Hello from My Component<span class=\"p\">&lt;/</span><span class=\"nt\">h1</span><span class=\"p\">&gt;</span>\n<span class=\"p\">);</span>\n<span class=\"k\">export</span> <span class=\"k\">default</span> <span class=\"nx\">MyComponent</span><span class=\"p\">;</span>\n</pre></div>\n</div>\n\n<ul>\n<li>コンポーネントで読み込むCSSを作ります。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"css\">\n<div class=\"code-lang\"><span class=\"bold\">src/styles.css</span></div>\n<div class=\"highlight\"><pre><span class=\"nt\">h1</span> <span class=\"p\">{</span>\n    <span class=\"nl\">color</span><span class=\"p\">:</span> <span class=\"no\">red</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n\n<ul>\n<li>トランスパイル用スクリプトをpackage.jsonに追加します。具体的にはJSファイルをトランスパイルしdistフォルダに出力、それ以外のファイル(CSS)をdistファイルにコピーするスクリプトです。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"transpile\": \"babel src -d dist --copy-files\"\n</span>    },\n</pre></div>\n</div>\n\n<h3>\n<span id=\"確認\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>準備が整ったので、トランスパイルしてみましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm run transpile\n</pre></div></div>\n\n<ul>\n<li>下記のようにdistフォルダ配下にindex.jsとstyles.cssが生成されればトランスパイル成功です。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"\">\n<div class=\"code-lang\"><span class=\"bold\">トランスパイル後の資産</span></div>\n<div class=\"highlight\"><pre>プロジェクトルート\n├─dist           ・・・ コンポーネントビルド資産出力場所\n│   ├─index.js\n│   └─styles.css\n</pre></div>\n</div>\n\n<h2>\n<span id=\"2-デモページを作成する\" class=\"fragment\"></span><a href=\"#2-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>2. デモページを作成する</h2>\n\n<p>実際にコンポーネントを使用したデモページもあわせて用意しておきましょう。コンポーネントの使い方をユーザーにわかりやすく示すことができます。<br>\nここではローカルでデモページが見れるところまでを作成します。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step2\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n  ├─dist\n  ├─src\n  │   ├─index.js\n  │   └─styles.css\n  ├─node_modules\n  ├─.babelrc\n<span class=\"gi\">+ ├─examples          ・・・ デモページ用資産\n+ │  ├─dist           ・・・ デモページビルド資産出力場所\n+ │  └─src\n+ │     ├─index.html\n+ │     └─index.js\n+ ├─webpack.config.js ・・・ビルド用設定ファイル\n+ └─package.json      ・・・依存ライブラリ・スクリプト定義ファイル\n</span></pre></div></div>\n\n<ul>\n<li>デモページはwebpackでビルドするので必要なライブラリをインストールします。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>npm i -D html-webpack-plugin webpack webpack-cli webpack-dev-server css-loader style-loader\n</pre></div></div>\n\n<ul>\n<li>デモページのHTMLを作成します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"html\">\n<div class=\"code-lang\"><span class=\"bold\">examples/src/index.html</span></div>\n<div class=\"highlight\"><pre><span class=\"nt\">&lt;html&gt;</span>\n<span class=\"nt\">&lt;head&gt;</span>\n    <span class=\"nt\">&lt;title&gt;</span>My Component Demo<span class=\"nt\">&lt;/title&gt;</span>\n    <span class=\"nt\">&lt;meta</span> <span class=\"na\">charset=</span><span class=\"s\">\"utf-8\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;meta</span> <span class=\"na\">name=</span><span class=\"s\">\"viewport\"</span> <span class=\"na\">content=</span><span class=\"s\">\"width=device-width, initial-scale=1, shrink-to-fit=no\"</span><span class=\"nt\">&gt;</span>\n<span class=\"nt\">&lt;/head&gt;</span>\n<span class=\"nt\">&lt;body&gt;</span>\n    <span class=\"nt\">&lt;noscript&gt;</span>\n        You need to enable JavaScript to run this app.\n    <span class=\"nt\">&lt;/noscript&gt;</span>\n    <span class=\"nt\">&lt;div</span> <span class=\"na\">id=</span><span class=\"s\">\"root\"</span><span class=\"nt\">&gt;&lt;/div&gt;</span>\n<span class=\"nt\">&lt;/body&gt;</span>\n<span class=\"nt\">&lt;/html&gt;</span>\n</pre></div>\n</div>\n\n<ul>\n<li>デモページの起点となるコンポーネントを作成します。この時、<a href=\"#1-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">1. コンポーネントを作成する</a>で作成したコンポーネントを使います。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"jsx\">\n<div class=\"code-lang\"><span class=\"bold\">examples/src/index.js</span></div>\n<div class=\"highlight\"><pre><span class=\"k\">import</span> <span class=\"nx\">React</span> <span class=\"k\">from</span> <span class=\"s1\">'react'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">render</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"s1\">'react-dom'</span>\n<span class=\"k\">import</span> <span class=\"nx\">MyComponent</span> <span class=\"k\">from</span> <span class=\"s1\">'../../src'</span>\n\n<span class=\"kd\">const</span> <span class=\"nx\">App</span> <span class=\"o\">=</span> <span class=\"p\">()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">&lt;</span><span class=\"nc\">MyComponent</span><span class=\"p\">/&gt;;</span>\n<span class=\"nx\">render</span><span class=\"p\">(&lt;</span><span class=\"nc\">App</span> <span class=\"p\">/&gt;,</span> <span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">getElementById</span><span class=\"p\">(</span><span class=\"s1\">'root'</span><span class=\"p\">));</span>\n</pre></div>\n</div>\n\n<ul>\n<li>デモページのビルド設定ファイル（webpack.config.js）を作りましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"javascript\">\n<div class=\"code-lang\"><span class=\"bold\">webpack.config.js</span></div>\n<div class=\"highlight\"><pre><span class=\"kd\">const</span> <span class=\"nx\">path</span> <span class=\"o\">=</span> <span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s1\">'path'</span><span class=\"p\">);</span>\n<span class=\"kd\">const</span> <span class=\"nx\">HtmlWebpackPlugin</span> <span class=\"o\">=</span> <span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s1\">'html-webpack-plugin'</span><span class=\"p\">);</span>\n<span class=\"c1\">// HTMLファイルのビルド設定</span>\n<span class=\"kd\">const</span> <span class=\"nx\">htmlWebpackPlugin</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nx\">HtmlWebpackPlugin</span><span class=\"p\">({</span>\n    <span class=\"na\">template</span><span class=\"p\">:</span> <span class=\"nx\">path</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"nx\">__dirname</span><span class=\"p\">,</span> <span class=\"s1\">'examples/src/index.html'</span><span class=\"p\">),</span>\n    <span class=\"na\">filename</span><span class=\"p\">:</span> <span class=\"s1\">'./index.html'</span>\n<span class=\"p\">});</span>\n<span class=\"nx\">module</span><span class=\"p\">.</span><span class=\"nx\">exports</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"c1\">// 依存関係解決の起点となる資産を指定します。</span>\n    <span class=\"na\">entry</span><span class=\"p\">:</span> <span class=\"nx\">path</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"nx\">__dirname</span><span class=\"p\">,</span> <span class=\"s1\">'examples/src/index.js'</span><span class=\"p\">),</span>\n    <span class=\"c1\">// Babelのトランスパイル対象資産を指定します。</span>\n    <span class=\"na\">module</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"na\">rules</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n            <span class=\"p\">{</span>\n                <span class=\"na\">test</span><span class=\"p\">:</span> <span class=\"sr\">/</span><span class=\"se\">\\.(</span><span class=\"sr\">js|jsx</span><span class=\"se\">)</span><span class=\"sr\">/</span><span class=\"p\">,</span>\n                <span class=\"na\">use</span><span class=\"p\">:</span> <span class=\"s1\">'babel-loader'</span><span class=\"p\">,</span>\n                <span class=\"na\">exclude</span><span class=\"p\">:</span> <span class=\"sr\">/node_modules/</span>\n            <span class=\"p\">},</span>\n            <span class=\"p\">{</span>\n                <span class=\"na\">test</span><span class=\"p\">:</span> <span class=\"sr\">/</span><span class=\"se\">\\.</span><span class=\"sr\">css$/</span><span class=\"p\">,</span>\n                <span class=\"na\">use</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">\"style-loader\"</span><span class=\"p\">,</span> <span class=\"s2\">\"css-loader\"</span><span class=\"p\">]</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"na\">plugins</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"nx\">htmlWebpackPlugin</span><span class=\"p\">],</span>\n    <span class=\"na\">resolve</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"na\">extensions</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">'.js'</span><span class=\"p\">,</span> <span class=\"s1\">'.jsx'</span><span class=\"p\">]</span>\n    <span class=\"p\">},</span>\n    <span class=\"c1\">// 開発用Webサーバのポートを指定します。</span>\n    <span class=\"na\">devServer</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"na\">port</span><span class=\"p\">:</span> <span class=\"mi\">3001</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n\n<ul>\n<li>デモページ起動用スクリプトをpackage.jsonに追記します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.jsonの一部</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"start\": \"webpack-dev-server --mode development\"\n</span>    },\n</pre></div>\n</div>\n\n<h3>\n<span id=\"確認-1\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D-1\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>準備が整ったのでデモページを起動しましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm start\n</pre></div></div>\n\n<ul>\n<li>ブラウザで<code>http://localhost:3001</code>にアクセスしてコンポーネントが表示されればOKです。</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/a12b4f44783c0003093566184a9ea5badc8efc4d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f64363538373137352d323164372d613135622d343865392d3363366563333165643130352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/a12b4f44783c0003093566184a9ea5badc8efc4d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f64363538373137352d323164372d613135622d343865392d3363366563333165643130352e706e67\" alt=\"図1.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/d6587175-21d7-a15b-48e9-3c6ec31ed105.png\"></a></p>\n\n<h2>\n<span id=\"3-デモページをgithub-pagesで公開する\" class=\"fragment\"></span><a href=\"#3-%E3%83%87%E3%83%A2%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92github-pages%E3%81%A7%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>3. デモページをGitHub Pagesで公開する</h2>\n\n<p>デモページをローカルで見れるようになったら、次はGitHubに資産を登録し、GitHub Pagesで公開しましょう。プラグインで簡単に公開できます。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step3\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n<span class=\"gi\">+ ├─webpack.config.js ・・・ビルド用設定ファイル（追記）\n+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル（追記）\n+ └─.gitignore\n</span></pre></div></div>\n\n<ul>\n<li>github-pagesというGitHub公開用プラグインをインストールします。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm i <span class=\"nt\">-D</span> gh-pages\n</pre></div></div>\n\n<ul>\n<li>package.jsonにGitHubPages公開用スクリプトを３個追加します。\n\n<ul>\n<li>\n<code>publish-demo</code>はビルドとデプロイをいっぺんにやるスクリプトです。デプロイ前に大抵の場合ビルドするので、1つにまとめておくと便利です。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"build\": \"webpack --mode production\",\n+     \"deploy\": \"gh-pages -d examples/dist\",\n+     \"publish-demo\": \"npm run build &amp;&amp; npm run deploy\"\n</span>    },\n</pre></div>\n</div>\n\n<ul>\n<li>webpack.config.jsに出力先を指定します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">webpack.config.jsの一部</span></div>\n<div class=\"highlight\"><pre>  module.exports = {\n<span class=\"gi\">+     output: {\n+        path: path.join(__dirname, \"examples/dist\"),\n+        filename: \"bundle.js\"\n+    },\n</span>  }\n</pre></div>\n</div>\n\n<ul>\n<li>ではビルドしてみましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm run build\n</pre></div></div>\n\n<ul>\n<li><p>ビルドされて最小化された資産が<code>examples/dist</code>配下に出力されたのが確認できればOKです。</p></li>\n<li><p>Gitにあげる準備として<code>.gitignore</code>を作りましょう。</p></li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"txt\">\n<div class=\"code-lang\"><span class=\"bold\">.gitignore</span></div>\n<div class=\"highlight\"><pre>node_modules\ndist\n</pre></div>\n</div>\n\n<ul>\n<li>GitHubでリポジトリを新規作成して資産を登録しましょう。新規作成後の「...or create a new respository on the command line」の説明に従ってください。</li>\n</ul>\n\n<h3>\n<span id=\"確認-2\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D-2\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>下記を実行してGitHub Pagesに登録しましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm run publish-demo\n</pre></div></div>\n\n<ul>\n<li>2～3分後にGitHub PagesでWeb公開されていれば成功です。\n\n<ul>\n<li>例 =&gt; 　<a href=\"https://takumon.github.io/react-component-sample/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://takumon.github.io/react-component-sample/</a>\n</li>\n</ul>\n</li>\n</ul>\n\n<h3>\n<span id=\"補足画像ファイルを扱う場合\" class=\"fragment\"></span><a href=\"#%E8%A3%9C%E8%B6%B3%E7%94%BB%E5%83%8F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%89%B1%E3%81%86%E5%A0%B4%E5%90%88\"><i class=\"fa fa-link\"></i></a>(補足)画像ファイルを扱う場合</h3>\n\n<p>もしデモページで画像を読み込む場合は<code>file-loader</code>と<code>url-loader</code>を開発用依存ライブラリに追加してください。ビルド設定も下記のように修正が必要です。</p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre>npm i -D file-loader url-loader\n</pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">webpack.config.jsの一部</span></div>\n<div class=\"highlight\"><pre>  module.exports = {\n    module: {\n<span class=\"gi\">+     {\n+       test: /\\.(jpg|png|ico)$/,\n+       use: 'url-loader'\n+     },\n</span>    },\n  }\n</pre></div>\n</div>\n\n<p><br><br>\nこれであとは最終手順のnpm公開を残すのみです！<br>\n<br></p>\n\n<h2>\n<span id=\"4-コンポーネントをnpmに公開する\" class=\"fragment\"></span><a href=\"#4-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92npm%E3%81%AB%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>4. コンポーネントをnpmに公開する</h2>\n\n<p>デモページも準備できたので、いよいよコンポーネントをnpmに公開しましょう。</p>\n\n<p>※ 本手順完了時のソースコードは<strong><a href=\"https://github.com/Takumon/react-component-sample/tree/step4\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a></strong><br>\n※ 本手順完了時のプロジェクト構成 ↓</p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre>プロジェクトルート\n  ├─dist              ・・・ コンポーネントビルド資産出力場所\n  ├─src               ・・・ コンポーネント資産\n  │   ├─index.js\n  │   └─styles.css\n  ├─examples          ・・・ デモページ用資産\n  │  ├─dist           ・・・ デモページビルド資産出力場所\n  │  └─src\n  │     ├─index.html\n  │     └─index.js\n  ├─node_modules\n  ├─.babelrc          ・・・トランスコンパイル用設定ファイル\n  ├─webpack.config.js ・・・ビルド用設定ファイル\n<span class=\"gi\">+ ├─package.json      ・・・依存ライブラリ・スクリプト定義ファイル(追記)\n+ ├─.npmignore        ・・・npm登録除外対処定義ファイル\n</span>  └─.gitignore\n</pre></div></div>\n\n<ul>\n<li>トランスパイル後に生成されるdist/index.jsを、npm公開資産のメインファイルに指定します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json</span></div>\n<div class=\"highlight\"><pre><span class=\"gi\">+   \"main\": \"dist/index.js\",\n</span></pre></div>\n</div>\n\n<ul>\n<li>次にnpm公開時に自動で走るスクリプト<code>prepublishOnly</code>を追加します。これによりnpm公開時にビルドし忘れるということを防ぎます。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.jsonの一部</span></div>\n<div class=\"highlight\"><pre>    \"scripts\": {\n<span class=\"gi\">+     \"prepublishOnly\": \"npm run transpile\"\n</span>    }\n</pre></div>\n</div>\n\n<ul>\n<li>このコンポーネントを使う側には、Reactがインストール済という想定ですのでpeerDependenciesを指定します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.jsonの一部</span></div>\n<div class=\"highlight\"><pre><span class=\"gi\">+   \"peerDependencies\": {\n+     \"react\": \"^16.3.0\",\n+     \"react-dom\": \"^16.3.0\"\n+   },\n</span></pre></div>\n</div>\n\n<ul>\n<li>\n<code>.npmignore</code>を作成して、npm公開資産として不用な資産（トランスパイル前のjsファイルなど）は公開対象外としましょう。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"txt\">\n<div class=\"code-lang\"><span class=\"bold\">.npmignore</span></div>\n<div class=\"highlight\"><pre>src\nexamples\n.babelrc\n.gitignore\nwebpack.config.js\n</pre></div>\n</div>\n\n<ul>\n<li>最後にパッケージ名(package.jsonのname)を決めます。現段階では<code>react-component-sample</code>となっていて、お試しで作るコンポーネントとしては少し汎用的すぎる名前なので、<code>@自分のnpmアカウント名/raect-component-sample</code>のようにしましょう。例えば下記のように修正します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">package.json修正例</span></div>\n<div class=\"highlight\"><pre><span class=\"gd\">-   \"name\": \"react-component-sample\",\n</span><span class=\"gi\">+   \"name\": \"@takumon/react-component-sample\",\n</span></pre></div>\n</div>\n\n<h3>\n<span id=\"確認-3\" class=\"fragment\"></span><a href=\"#%E7%A2%BA%E8%AA%8D-3\"><i class=\"fa fa-link\"></i></a>確認</h3>\n\n<ul>\n<li>ではnpm公開してみましょう。\n\n<ul>\n<li>\n<code>@takumon/react-component-sample</code>のようなパッケージ名は、<a href=\"https://docs.npmjs.com/about-scopes\" rel=\"nofollow noopener\" target=\"_blank\">Scoped Packag</a>(npmのプライベートなパッケージの命名規約)に沿っているのでデフォルトでプライベート公開になってしまいます。npmで有料契約をせずにプライベート公開しようとすると402エラーになります。そのため、ここでは<code>--access=public</code>をつけて一般公開するようにしています。（参考：<a href=\"https://stackoverflow.com/questions/45820881/npm-publish-failed-put-402\" rel=\"nofollow noopener\" target=\"_blank\">stachoverflow</a>)</li>\n<li>\n<code>Failed PUT 403</code>になる場合は、npmの認証エラーです。<code>npm login</code>しましょう。\nそれか<code>package.json</code>の<code>version</code>が古いのが原因です。いったん公開したバージョンで再公開はできません。バージョンをインクリメントしましょう。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre>npm publish <span class=\"nt\">--access</span><span class=\"o\">=</span>public\n</pre></div></div>\n\n<ul>\n<li>これで、npm公式サイトを確認しパッケージが追加されていれば、公開完了です！</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/1c02995625c7b4d57870910d6302e8e5b7d1fdfa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f32393534363963312d623664302d626563382d303036642d6437306230393564393830362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://camo.qiitausercontent.com/1c02995625c7b4d57870910d6302e8e5b7d1fdfa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f34393931352f32393534363963312d623664302d626563382d303036642d6437306230393564393830362e706e67\" alt=\"図4.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/295469c1-b6d0-bec8-006d-d70b095d9806.png\"></a></p>\n\n<h2>\n<span id=\"おわりに\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>おわりに</h2>\n\n<p>今回紹介したように、わりと簡単にnpm公開できるので、普段使いまわしているようなコンポーネントがあれば公開してみるのもいいかもしれません。</p>\n\n<h2>\n<span id=\"参考\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83\"><i class=\"fa fa-link\"></i></a>参考</h2>\n\n<ul>\n<li><a href=\"https://medium.com/dailyjs/building-a-react-component-with-webpack-publish-to-npm-deploy-to-github-guide-6927f60b3220\" rel=\"nofollow noopener\" target=\"_blank\">A guide to building a React component with webpack 4, publishing to npm, and deploying the demo to GitHub Pages | Medium</a></li>\n<li><a href=\"https://hackernoon.com/creating-a-library-of-react-components-using-create-react-app-without-ejecting-d182df690c6b\" rel=\"nofollow noopener\" target=\"_blank\">Creating a library of React components using Create React App | Medium</a></li>\n</ul>\n","headings":[{"id":"なにこれ","value":"なにこれ","depth":2,"parents":[]},{"id":"1-コンポーネントを作成する","value":"1. コンポーネントを作成する","depth":2,"parents":[]},{"id":"確認","value":"確認","depth":3,"parents":[{"id":"1-コンポーネントを作成する","value":"1. コンポーネントを作成する","depth":2}]},{"id":"2-デモページを作成する","value":"2. デモページを作成する","depth":2,"parents":[]},{"id":"確認-1","value":"確認","depth":3,"parents":[{"id":"2-デモページを作成する","value":"2. デモページを作成する","depth":2}]},{"id":"3-デモページをgithub-pagesで公開する","value":"3. デモページをGitHub Pagesで公開する","depth":2,"parents":[]},{"id":"確認-2","value":"確認","depth":3,"parents":[{"id":"3-デモページをgithub-pagesで公開する","value":"3. デモページをGitHub Pagesで公開する","depth":2}]},{"id":"補足画像ファイルを扱う場合","value":"(補足)画像ファイルを扱う場合","depth":3,"parents":[{"id":"3-デモページをgithub-pagesで公開する","value":"3. デモページをGitHub Pagesで公開する","depth":2}]},{"id":"4-コンポーネントをnpmに公開する","value":"4. コンポーネントをnpmに公開する","depth":2,"parents":[]},{"id":"確認-3","value":"確認","depth":3,"parents":[{"id":"4-コンポーネントをnpmに公開する","value":"4. コンポーネントをnpmに公開する","depth":2}]},{"id":"おわりに","value":"おわりに","depth":2,"parents":[]},{"id":"参考","value":"参考","depth":2,"parents":[]}],"fields":{"title":"Reactコンポーネントをnpmで公開する（GitHub Pages付き、Babel7、webpack4）","excerpt":"なにこれTIS Advent Calendar 2018の13日目の記事です。よろしくお願いします！最近Reactコンポーネントをnpm公開してみました（参考記事：CSSのclip-pathでSlit Animationを実現する）。そこで...","date":"2018-12-12T00:56:33+09:00","tags":["npm","github-pages","webpack","React","babel","Qiita"]},"user":{"id":"Takumon","profile_image_url":"https://qiita-image-store.s3.amazonaws.com/0/49915/profile-images/1488080194","description":"JavaのSIer. 趣味はJavaScript. \r\n週1でブログ更新してます. https://takumon.com/\r\n最近はGatsbyJS,Nuxt.js,GraphQLなどなど."}}},"pageContext":{"slug":"/38a98fba-b86d-5919-9db1-9defd84588e1/","relatedPosts":[],"latestPosts":[{"fields":{"slug":"/nuxt-apollo-with-graphpack","title":"Nuxt.js＋Apollo ClientでCRUD操作 / ユーザー管理画面でQuery, Mutation, Subscriptionを実装","date":"2019-02-12T07:00:00.000+09:00","excerpt":"なにこれ以前の記事設定いらずのNode製GraphQLサーバー「Graphpack」の使い方でGrapQLのサーバー側を実装を紹介しました。Graphpackは備え付けのGraphQL Playground IDEで動作確認できますが、せっ...","tags":["GraphQL","Nuxt.js","Apollo Client","Vue.js"],"keywords":["GraphQL"],"thumbnail":"/thumbnail/2019/02/nuxt-apollo-with-graphpack.png"}},{"fields":{"slug":"/gatsby-related-posts-like-hugo","title":"GatsbyでRelated Content(関連記事)を表示する / Hugoの関連記事機能をGatsbyに移植した","date":"2019-02-09T17:00:00.000+09:00","excerpt":"なにこれブログでよく見かけるUIのひとつに関連記事リンクあります。記事下部に関連記事リンクを設けておくと、記事を読み終えたユーザーが、また別の記事を見てくれる可能性が上がるので、回遊率向上という観点で非常に効果的なUIです。そんな関連記事リ...","tags":["Gatsby","Hugo","golang"],"keywords":["Gatsby"],"thumbnail":"/thumbnail/2019/02/gatsby-related-posts-like-hugo.png"}},{"fields":{"slug":"/mdx-deck-and-code-surfer","title":"WEBエンジニア勉強会 初LT感想と参加レポート / 「MDX-DeckとCode Surferでスライドを作ろう！」補足情報","date":"2019-02-03T17:15:00.000+09:00","excerpt":"なにこれ2019/2/1(金)、WEBエンジニア勉強会 #11でLTしてきました。本記事では自分のLTスライドと、10分の枠では伝えきれなかった補足情報を紹介します。また他の方のLTの様子や、勉強会の雰囲気なども参加レポートとして書いていま...","tags":["勉強会","LT","mdx-deck","mdx","code-surfer","markdown","プレゼン","スライド"],"keywords":["mdx-deck"],"thumbnail":"/thumbnail/2019/02/mdx-deck-and-code-surfer.png"}},{"fields":{"slug":"/graphpack-graphql-zero-config-server","title":"設定いらずのNode製GraphQLサーバー「Graphpack」の使い方 / Query, Mutation, Subscriptionを試す","date":"2019-01-23T19:50:00.000+09:00","excerpt":"なにこれ「とりあえずクライアント側と同じJavaScriptで手っ取り早くGraphQLサーバー立てたい！」このようなユースケースにGraphpackはピッタリです。設定いらずのNode製GraphQLサーバーで 「GraphQLのスキーマ...","tags":["GraphQL","Graphpack"],"keywords":["GraphQL"],"thumbnail":"/thumbnail/2019/01/graphpack-graphql-zero-config-server.png"}},{"fields":{"slug":"/impression-of-cherrypick-js-20190119","title":"懇親会で飛び込みLTに参加した / 「JavaScriptつまみ食い LT 会 ～ つまみ食い LT 大会！」の感想","date":"2019-01-21T03:30:00.000+09:00","excerpt":"なにこれ2019/1/19(土)、JavaScriptつまみ食い LT 会 #4 ～ つまみ食い LT 大会！で懇親会にて飛び込みLTに参加しました。勉強会の様子も含めLTの感想を書きます。どんな勉強会だったか今回で開催5回目となり、4回目...","tags":["JavaScript","mdx-deck","勉強会","LT"],"keywords":["勉強会"],"thumbnail":"/thumbnail/2019/01/impression-of-cherrypick-js-20190119.png"}}],"previous":{"fields":{"slug":"/2018/12/09/","title":"Vimを始める時に取り組んだ４つのこと","date":"2018-12-09T21:00:00.000+09:00","excerpt":"なにこれ最近DockerまわりをやっていてLinux上でDockerfileなどを編集するのがつらいので、ちゃんとVimを覚えようと思い立ち、とっかかりとして下記４点取り組みました。整理もかねて本記事にまとめます。vimtutor実施Vim...","tags":["Vim","Vimium"],"keywords":["Vim"],"thumbnail":""}},"next":{"fields":{"slug":"/2018/12/16/","title":"JJUG CCC 2018 Fallに行ってきました","date":"2018-12-16T21:50:00.000+09:00","excerpt":"なにこれJava CCC 2018 Fallに参加してきました。見てきたセッションは以下の通りです。【JJUG基調講演】Javaの未来を考えよう セッション概要#ccc_e1マネーフォワードのアカウントアグリゲーションの現状と課題点について...","tags":["Java","Kotlin","JJUG CCC","イベントレポート"],"keywords":["Java"],"thumbnail":""}}}}