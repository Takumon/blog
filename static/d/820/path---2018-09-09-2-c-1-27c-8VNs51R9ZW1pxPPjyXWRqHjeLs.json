{"data":{"site":{"siteMetadata":{"title":"Takumon Blog","author":"Takuto Inoue"}},"markdownRemark":{"html":"<h2 id=\"ブログをやろうと思った理由\"><a href=\"#%E3%83%96%E3%83%AD%E3%82%B0%E3%82%92%E3%82%84%E3%82%8D%E3%81%86%E3%81%A8%E6%80%9D%E3%81%A3%E3%81%9F%E7%90%86%E7%94%B1\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブログをやろうと思った理由</h2>\n<p><a href=\"https://qiita.com/\">Qiita</a>は、誰得な作業メモは載せられないし\n<a href=\"http://hatenablog.com/\">はてなブログ</a>は、見た目が好きじゃない...\n一時期、<a href=\"https://nippo.wikihub.io/\">WikiHub日報</a>とかもやっていたんですが、なかなか続かず...\nそのせいか、やったことを3ヶ月後には忘れてしまう状況がココ半年ほど続きまして、\nコリャなんとかせねばということでオリジナルのブログ始めた次第です。</p>\n<h2 id=\"gatsbyを使い始めた理由\"><a href=\"#gatsby%E3%82%92%E4%BD%BF%E3%81%84%E5%A7%8B%E3%82%81%E3%81%9F%E7%90%86%E7%94%B1\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gatsbyを使い始めた理由</h2>\n<p>独自でブログを始めるなら<code class=\"language-text\">簡単</code>、<code class=\"language-text\">便利</code>、<code class=\"language-text\">格好いい</code>、の3つがそろった静的サイトジェネレーターを使おうと考えていました。\nすこし調べただけでも、有名どころでは<a href=\"https://jekyllrb-ja.github.io/\">jekyll</a>、<a href=\"https://gohugo.io/\">Hugo</a>、<a href=\"https://hexo.io/\">Hexo</a>、<a href=\"https://www.gatsbyjs.org/\">Gatsby</a>\nなどがあり、どれも3つの要素を満たせそうではありましたが、\nその中でも、React、PWA、GraphQLなどのフロントエンドよりの技術構成になっているGastbyに興味を引かれたので採用しました。\n読み方はギャッツビーです（ガッツバイではないし、ヘアワックスでもない）。\nちょうどいまReactをやり始めたところなので勉強も兼ねてGatsbyのブログを育てていきたいと思っています。</p>\n<h2 id=\"ブログを作ってみた感想\"><a href=\"#%E3%83%96%E3%83%AD%E3%82%B0%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9F%E6%84%9F%E6%83%B3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブログを作ってみた感想</h2>\n<p>Gatsbyってなに？って状態から30分程度でブログを開設できました。\nデフォルトで既に格好いいブログができあがっています。\n他の静的サイトジェネレーターと比較はしていませんが、記事の表示がとにかく爆速です。\nソースコードのシンタックスハイライトに<a href=\"https://prismjs.com/\">Prism</a>というライブラリを使っており、見た目がきれいな上に指定行をハイライトしたりもできます。またレスポンシブ対応しておりスマホからも見やすいのがうれしいポイントでした🍅</p>\n<h2 id=\"参考\"><a href=\"#%E5%8F%82%E8%80%83\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li>\n<p><a href=\"https://www.gatsbyjs.org/\">Gatsby公式サイト</a></p>\n<ul>\n<li>英語ですが、、、結構充実しています。</li>\n</ul>\n</li>\n<li>\n<p>Gatsby製ブログ(ググるといくつかヒットします。どれも見た目が格好いいので参考にしたいです。)</p>\n<ul>\n<li><a href=\"https://blog.mismithportfolio.com/\">写真やWeb制作についてのブログ</a></li>\n<li><a href=\"https://dvg.179.jp/\">dvg.179</a></li>\n<li><a href=\"https://tmnm.tech/\">tmnm.tech</a></li>\n</ul>\n</li>\n</ul>","headingsDetail":[{"id":"ブログをやろうと思った理由","value":"ブログをやろうと思った理由","depth":2,"parents":[]},{"id":"gatsbyを使い始めた理由","value":"Gatsbyを使い始めた理由","depth":2,"parents":[]},{"id":"ブログを作ってみた感想","value":"ブログを作ってみた感想","depth":2,"parents":[]},{"id":"参考","value":"参考","depth":2,"parents":[]}],"fields":{"title":"Gatsbyでブログ始めました。","excerpt":"ブログをやろうと思った理由Qiitaは、誰得な作業メモは載せられないしはてなブログは、見た目が好きじゃない...一時期、WikiHub日報とかもやっていたんですが、なかなか続かず...そのせいか、やったことを3ヶ月後には忘れてしまう状況がコ...","date":"2018-09-09T22:00:00.000Z","tags":["Gatsby","ブログ"],"thumbnail":"thumbnail/2018/beginning-of-blog.png"}}},"pageContext":{"slug":"/2018/09/09/","relatedPosts":[{"html":"<h2 id=\"ブログ開設手順\"><a href=\"#%E3%83%96%E3%83%AD%E3%82%B0%E9%96%8B%E8%A8%AD%E6%89%8B%E9%A0%86\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブログ開設手順</h2>\n<p>Gatsbyってなにって状態から30分程度でブログを開設できました。\n下記にそのときの手順をメモしておきます。</p>\n<h2 id=\"0-前提条件\"><a href=\"#0-%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 前提条件</h2>\n<p>Git、Node、npmは事前にインストールしておいてください。</p>\n<h2 id=\"1-ブログのスターターキットを起動\"><a href=\"#1-%E3%83%96%E3%83%AD%E3%82%B0%E3%81%AE%E3%82%B9%E3%82%BF%E3%83%BC%E3%82%BF%E3%83%BC%E3%82%AD%E3%83%83%E3%83%88%E3%82%92%E8%B5%B7%E5%8B%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ブログのスターターキットを起動</h2>\n<p>Gatsbyはブログをすぐ始められるようにスターターキット(スキャフォールド)を用意しています。\nまずはそれを使ってローカルでブログを起動してみます。</p>\n<h3 id=\"1-1-gatsbyインストール\"><a href=\"#1-1-gatsby%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-1. Gatsbyインストール</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> -g gatsby</code></pre></div>\n<h3 id=\"1-2-プロジェクト生成\"><a href=\"#1-2-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E7%94%9F%E6%88%90\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-2. プロジェクト生成</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">gatsby new blog https://github.com/gatsbyjs/gatsby-starter-blog</code></pre></div>\n<h3 id=\"1-3-ローカルで起動\"><a href=\"#1-3-%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A7%E8%B5%B7%E5%8B%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-3. ローカルで起動</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cd</span> blog\n<span class=\"token function\">npm</span> run dev</code></pre></div>\n<p><a href=\"http://localhost:8000/\">http://localhost:8000</a>にアクセスするとブログが表示されます。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7e3132994c4eb6ab77004896a109d06d/11526/blog_image_1_main.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 784px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 101.7857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADAklEQVQ4y5WUy07bQBSG81iVuqoULquCxLP0BUgKYlfYgJBAiG4qKnWDBM0CtVIXEIcIVJTSQBIUEt9jO4mN787fM5MLOEIVWPr1j489n2fOOZ7Mwts3H94vvvuVX109yudyhXz+Y2Fzc7OwsrJSWFpaKmSz2cLc3BzX7Ows1/ieaX5+nr1zPJOd+bGwsJjPfDs4+FouC/h9dYV6rYZWqwXTtNDpdNBoNFCv17nX6NnYb25uUK1Wudi4XC5DEAQQ6mfGdpx9DK/A6lqxYRgxwWJZlmPf92PTNHnMdV0+fnh4iJMkien9pwoZ4OLi8ihjWdbnETA6OTnB+vo6dnd3kcvlsL29jZ2dHSwvL2NrawsbGxvc6QN8AoExGAzIBwyKUqn0PQU8PDzE2toa9vb2UKlUYNv2ZFIURfylOOZzeeyJHoHdbncCvKX8CKUSGPj6+hovuf4LlJp3uKeiuK4HXdN4QdqiBFnrDKXqUMkVkk5FC8NwDB0CBSENvG/U0KxVYVCVNU2HQZOMrg21F0DpeuQ+9L7PPYwYY2rLQvERSImN8JrruRwWz9IrVPsBapqLRsfHreah7ycvzePzwKak47J6jxvRxN+2Ac2y4bkuHMfh7o5Evcg7gMVpZxNg8WwK2O9S7mQRhqbA1BWossT/HFEUIbbb3CVJ4n3IYMO2egJMr3AQ+WEM2wvhkJgHYcT7jon14XjM8vbcloViMb3Cumrj/M7CH9XDleyh94Icpqs8tWXWJmK7BU1VoJMs06S+03kL6XqH4io/NFRydoD0er0UsHx+mgY6/T4sg/pPU6EqCjoMwmFDqCTJfKwoKi8OS8NT4HlpCqjYMRpmhNtOiIfoNS05zuEpPxwmx5ekW0mtpSaS6SSOFyRRGCZBECZ0jJEHQ9HY9wMeYyIYKYlGVT7OUB6+jL9k93vUKjLPH9syaxOdtipTq8iyQi7ze/oIwiAgD1IrFYSzk4yua5/oJzfpYYPU9Jl8v+l5PncmFg9GceaUuya1D9cofkcxtVK52v8HdAO2pf8ZX28AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"ブログ初期イメージ\"\n        title=\"\"\n        src=\"/static/7e3132994c4eb6ab77004896a109d06d/11526/blog_image_1_main.png\"\n        srcset=\"/static/7e3132994c4eb6ab77004896a109d06d/6b0e3/blog_image_1_main.png 200w,\n/static/7e3132994c4eb6ab77004896a109d06d/d1d7f/blog_image_1_main.png 400w,\n/static/7e3132994c4eb6ab77004896a109d06d/11526/blog_image_1_main.png 784w\"\n        sizes=\"(max-width: 784px) 100vw, 784px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h2 id=\"2-ブログの記事などを自分仕様にカスタマイズ\"><a href=\"#2-%E3%83%96%E3%83%AD%E3%82%B0%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AA%E3%81%A9%E3%82%92%E8%87%AA%E5%88%86%E4%BB%95%E6%A7%98%E3%81%AB%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ブログの記事などを自分仕様にカスタマイズ</h2>\n<p>現状だと、ブロガーがKyle Mathews氏(Gatsbyの作者)になっていたり、仮の記事が3つある状態なので、\n自分仕様にカスタマイズします。\n<small>ここでは僕の例を示します。</small></p>\n<h3 id=\"2-1-ブラウザタブのタイトル修正\"><a href=\"#2-1-%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%82%BF%E3%83%96%E3%81%AE%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-1. ブラウザタブのタイトル修正</h3>\n<p><code class=\"language-text\">gatsby-config.js</code>の<code class=\"language-text\">siteMetadata</code>を下記のように修正します。\nなお<code class=\"language-text\">siteUrl</code>はGitHub Pagesでの公開を想定したものです。</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  siteMetadata<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    title<span class=\"token punctuation\">:</span> <span class=\"token string\">'Takumon Blog'</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    author<span class=\"token punctuation\">:</span> <span class=\"token string\">'Takuto Inoue'</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    description<span class=\"token punctuation\">:</span> <span class=\"token string\">'日々の作業をつづっていきます。'</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    siteUrl<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://takumon.github.io/blog'</span><span class=\"token punctuation\">,</span>\n</span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  ・・・\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"2-2-画面タイトル修正\"><a href=\"#2-2-%E7%94%BB%E9%9D%A2%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-2. 画面タイトル修正</h3>\n<p><code class=\"language-text\">src/layouts/index.js</code>を修正します。\n<code class=\"language-text\">Gatsby Starter Blog</code>となっている部分が2カ所あるので、自分のブログ名に修正します。\n僕は<code class=\"language-text\">Takumon Blog</code>にしました。</p>\n<h3 id=\"2-3-プロフィール修正\"><a href=\"#2-3-%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-3. プロフィール修正</h3>\n<p><code class=\"language-text\">src/components/Bio.js</code>のアバター(imgタグ)と自己紹介文(pタグ)を修正します。</p>\n<div class=\"gatsby-code-title\">src/components/Bio.js</div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">&lt;img\n<span class=\"gatsby-highlight-code-line\">  src=\"https://s.gravatar.com/avatar/37d27f624f8c9c8db6fe6b6581b256f1?s=80\"\n</span><span class=\"gatsby-highlight-code-line\">  alt={`Takuto Inoue`}\n</span><span class=\"gatsby-highlight-code-line\">  style={{\n</span><span class=\"gatsby-highlight-code-line\">    marginRight: rhythm(1 / 2),\n</span><span class=\"gatsby-highlight-code-line\">    marginBottom: 0,\n</span><span class=\"gatsby-highlight-code-line\">    width: rhythm(2),\n</span><span class=\"gatsby-highlight-code-line\">    height: rhythm(2),\n</span><span class=\"gatsby-highlight-code-line\">    borderRadius: rhythm(1),\n</span>  }}\n/>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n<span class=\"gatsby-highlight-code-line\">  Written by <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>Takuto Inoue<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span> who lives and works in Tokyo building useful things.\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h3 id=\"2-4-余計な記事を削除\"><a href=\"#2-4-%E4%BD%99%E8%A8%88%E3%81%AA%E8%A8%98%E4%BA%8B%E3%82%92%E5%89%8A%E9%99%A4\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-4. 余計な記事を削除</h3>\n<p>記事は<code class=\"language-text\">src/page</code>配下にフォルダ分けされて存在します。\n1つ目以外の記事は不要なのでフォルダごと削除します。\nあと1つ目の記事て使っている画像も削除します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">src/\n├── pages\n│   ├── hello-world\n│   │   ├── index.md\n<span class=\"gatsby-highlight-code-line\">│   │   └── salty_egg.jpg ・・・削除対象\n</span><span class=\"gatsby-highlight-code-line\">│   ├── hi-folks          ・・・削除対象\n</span><span class=\"gatsby-highlight-code-line\">│   │   └── index.md\n</span><span class=\"gatsby-highlight-code-line\">│   └── my-second-post    ・・・削除対象\n</span><span class=\"gatsby-highlight-code-line\">│       └── index.md\n</span></code></pre></div>\n<h3 id=\"2-5-記事を編集\"><a href=\"#2-5-%E8%A8%98%E4%BA%8B%E3%82%92%E7%B7%A8%E9%9B%86\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-5. 記事を編集</h3>\n<p>1つめの記事<code class=\"language-text\">src/pages/hello-world/index.md</code>を編集します。\nマークダウンファイル上部にメタ情報としてタイトルと作成日時を、その下に本文を記載しましょう。</p>\n<div class=\"gatsby-code-title\">src/pages/hello-world/index.md</div>\n<div class=\"gatsby-highlight\" data-language=\"markup\"><pre class=\"language-markup\"><code class=\"language-markup\">---\n<span class=\"gatsby-highlight-code-line\">title: Hello World\n</span><span class=\"gatsby-highlight-code-line\">date: \"2018-09-10T12:00:00.000Z\"\n</span>---\n\n<span class=\"gatsby-highlight-code-line\">Gatsbyでブログ始めました！\n</span></code></pre></div>\n<h3 id=\"2-6-ローカルで起動\"><a href=\"#2-6-%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A7%E8%B5%B7%E5%8B%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-6. ローカルで起動</h3>\n<p>この状態で<code class=\"language-text\">npm run dev</code>して<a href=\"http://localhost:8000\">http://localhost:8000</a>を見てみると下記のようになっています。</p>\n<p>記事一覧\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7da4ae8b009b5d5c1bd9f97e99c153a7/916a4/blog_image_2_main.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 100.86100861008612%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACGklEQVQ4y92Uz2saQRTH9w+yioSEEi+Fpuf+F4UmXhKop6wElRSSHsSCRysFW3LoRfDnxWvxYrri7noQgjEUrK7bXdfsGve9vv0Ru0ZsNfTUL3zZ2Zl5n3nzZneYl0+3t/aePYm92n99HHkTYSORCBuLxdhwOMyGdkOsz+djA4EA6/f7bVttr4PBoOXj3VAo/nzvxRaTODk5+vzpI1aqVazX69hoXGKn00GB57FWq2GxWMRKpYJVGreepVIJy6Wy8yyXMZ/PY/ZDFr9cXODp6dsjRhDFfSSZpqlrmjZVVfXOEnUt2DCMpT6PdYvBcdwBI4piGB3Nut0uJOIJOH93DplMBlKpFKTTacjlchCNRiGZTNrvuq4DzQdKAixZsS4wzAiC4AABZjQC8q2K0lBCSZKw3+/bHo1G+FNRcDgYYqvVwslkgpSxtSsERx4gz88z/NH4Cq3sexxKMvauezgggEKg8Vglj23ruoGyLNsLTu3K4GKG4n2G1GmqCsy+31BjRoG3uI6Wt+yp4RQQNBrWDBPvTGdxa/5f/ADIt+bAgaLDtysJL7sjHIyn9xlsBhSF3zWkWsFN75qKP7APwiq8F7rWlsV2ew4ET5R7gpsDec+huJ/AQvAq0OoMPYfiBXrBf4IuAdsrtryu/gPgY/QQeOACDfcn38hujDG/vgh4iP9IzWbzkKFbd4fjmmdEj5MTjzGB4uSzQqGw8wtf9qFNOS60nQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"ブログ修正後イメージ_記事一覧\"\n        title=\"\"\n        src=\"/static/7da4ae8b009b5d5c1bd9f97e99c153a7/42603/blog_image_2_main.png\"\n        srcset=\"/static/7da4ae8b009b5d5c1bd9f97e99c153a7/f931c/blog_image_2_main.png 200w,\n/static/7da4ae8b009b5d5c1bd9f97e99c153a7/e8031/blog_image_2_main.png 400w,\n/static/7da4ae8b009b5d5c1bd9f97e99c153a7/42603/blog_image_2_main.png 800w,\n/static/7da4ae8b009b5d5c1bd9f97e99c153a7/916a4/blog_image_2_main.png 813w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>記事詳細\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ddf78c319bfb9bdb52617201c72de7df/97b7b/blog_image_2_detail.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 101.10974106041924%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAB60lEQVQ4y+WUTWsTURSG5xdpM6FdaBQt7vwdVugHlrTqwsxm/AG60k0QxA/QVdpmkGYRyGqmxEjoJIj5cFFboQkxM8lkMs1M7uu5kzFNoKlp6K4vvFy4l/eZc+ZcrnB/XgzfWxTlpeXl2JPHT6VH6+tSdGNTerD0ULpxMyJduz4nhURRmgudOjRiMRyW5hcWYpFbt5/fubsYFuTYs+j7d2/wZXcXe9oestkscrkc9nUd6XQa2zs7UBQFyaQyWJXxNZFIIB6P4/OHj5BleVP4USqtgOS6rtPpdHqGYbimafrm21Pa4Qxd11eFaqWyioG8er3OVFVl+XyeaZrGjo9rrNvtMq5+v3+muQIoCoXCmlAul4fAg18HbHtrC6qqIZPJIEntlkpl/5DC4NkzzOUFFa4JlZEKu7bN6rUaqF1QZRh8HJNAQyDPDiscBfaoBbvn4sRxYFkWPNfD/3Qu0Kodst/fv8Jqd0DDQaPxB81mE61WC+1W219Nk2yYtG/wQfrMiUBj/xv7+ektGhQ4OjzyAbx1hyoeNd+zbRue500GBj+W4YI6t+XgfkwziOmGElyBscA/+MwVXnrLVxA4i8aA9DisBMATOnP5fbyoefb0+apWo7gkFYvFDYGeqQhBX5FfkF/OaJ59nUqlIn8BqESsK9UQHY4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"ブログ修正後イメージ_記事詳細\"\n        title=\"\"\n        src=\"/static/ddf78c319bfb9bdb52617201c72de7df/42603/blog_image_2_detail.png\"\n        srcset=\"/static/ddf78c319bfb9bdb52617201c72de7df/f931c/blog_image_2_detail.png 200w,\n/static/ddf78c319bfb9bdb52617201c72de7df/e8031/blog_image_2_detail.png 400w,\n/static/ddf78c319bfb9bdb52617201c72de7df/42603/blog_image_2_detail.png 800w,\n/static/ddf78c319bfb9bdb52617201c72de7df/97b7b/blog_image_2_detail.png 811w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>ここまでで一通り自分のブログをローカルで作ることができました。</p>\n<h2 id=\"3-github-pagesにブログを公開\"><a href=\"#3-github-pages%E3%81%AB%E3%83%96%E3%83%AD%E3%82%B0%E3%82%92%E5%85%AC%E9%96%8B\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. GitHub Pagesにブログを公開</h2>\n<p>Gatsbyを使うとnpmスクリプト一発でGitHub Pageに公開ができます。\nここではGitHubでのリポジトリ作成などの事前準備も含めて手順を示します。</p>\n<h3 id=\"3-1-githubにリポジトリ作成\"><a href=\"#3-1-github%E3%81%AB%E3%83%AA%E3%83%9D%E3%82%B8%E3%83%88%E3%83%AA%E4%BD%9C%E6%88%90\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-1. GitHubにリポジトリ作成</h3>\n<p>GitHubにリポジトリを作り、手順2で作成した資産をプッシュしてください。</p>\n<h3 id=\"3-2-github-pagesの設定\"><a href=\"#3-2-github-pages%E3%81%AE%E8%A8%AD%E5%AE%9A\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-2. GitHub Pagesの設定</h3>\n<p>GitHubのリポジトリ > settings > GitHub Pages > Source で<code class=\"language-text\">gh-pages branch</code>を選択します。</p>\n<h3 id=\"3-3-メタ情報の修正\"><a href=\"#3-3-%E3%83%A1%E3%82%BF%E6%83%85%E5%A0%B1%E3%81%AE%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-3. メタ情報の修正</h3>\n<p>手順2によりローカルでブログを起動できるようになりましたが、GitHub Pagesに公開するには、まだ少し修正が必要です。</p>\n<h4 id=\"gatsby-configjsのpathprefixの修正\"><a href=\"#gatsby-configjs%E3%81%AEpathprefix%E3%81%AE%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>gatsby-config.jsのpathPrefixの修正</h4>\n<p>ブログのコンテキストURLは、現状だとスターターキットの値なので修正します。\nこれを指定するとブログのURLが<code class=\"language-text\">https://[オーナー名].github.io/[pathPrefixの値]/</code>のようになります。\n僕の場合は<code class=\"language-text\">https://takumon.github.io/blog</code>のようになります。</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  ・・・\n<span class=\"gatsby-highlight-code-line\">  pathPrefix<span class=\"token punctuation\">:</span> <span class=\"token string\">'/blog'</span><span class=\"token punctuation\">,</span>\n</span>  ・・・\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"packagejson、pacakge-lockjson、readmemdのメタ情報修正\"><a href=\"#packagejson%E3%80%81pacakge-lockjson%E3%80%81readmemd%E3%81%AE%E3%83%A1%E3%82%BF%E6%83%85%E5%A0%B1%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>package.json、pacakge-lock.json、README.mdのメタ情報修正</h4>\n<p>上記3ファイルにおいて、プロジェクト名や、管理者、ブログのURLなどが、すべてスターターキットの状態になっているので\n自分仕様に修正します。</p>\n<h3 id=\"3-4-資産をgh-pagesブランチにプッシュ\"><a href=\"#3-4-%E8%B3%87%E7%94%A3%E3%82%92gh-pages%E3%83%96%E3%83%A9%E3%83%B3%E3%83%81%E3%81%AB%E3%83%97%E3%83%83%E3%82%B7%E3%83%A5\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-4. 資産をgh-pagesブランチにプッシュ</h3>\n<p><code class=\"language-text\">git push origin master</code>でマスターに最新資産をプッシュします。</p>\n<p><code class=\"language-text\">npm run deploy</code>を実行します。実態は<code class=\"language-text\">gatsby build &amp;&amp; gh-pages -d public</code>というコマンドです。これを実行するとgatbyコマンドによりビルド資産をgh-pagesブランチにプッシュしてくれます。</p>\n<h3 id=\"3-5-公開できたことを確認\"><a href=\"#3-5-%E5%85%AC%E9%96%8B%E3%81%A7%E3%81%8D%E3%81%9F%E3%81%93%E3%81%A8%E3%82%92%E7%A2%BA%E8%AA%8D\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-5. 公開できたことを確認</h3>\n<p>GitHub Pagesの公開URLをブラウザでたたき、自分のブログが公開されていることを確認します。</p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>以上でブログの公開手順は終了です。\nGatsbyを使えばとても簡単にブログを始められます。\nみなさんもGatsbyでブログ始めてみてはいかがでしょうか🍅</p>\n<h2 id=\"参考記事\"><a href=\"#%E5%8F%82%E8%80%83%E8%A8%98%E4%BA%8B\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考記事</h2>\n<ul>\n<li>\n<p><a href=\"https://qiita.com/jaxx2104/items/5f28915355a85d36e38a\">React.js製の静的サイトジェネレーターGatsbyに移行した</a></p>\n<ul>\n<li>Gatsbyを始めるきっかけとなった記事です。この記事のおかげで簡単にGatsby製ブログを開設できました。</li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/2018/09/10/","title":"Gatsby製ブログ開設手順","date":"2018-09-10T19:00:00.000Z","excerpt":"ブログ開設手順Gatsbyってなにって状態から30分程度でブログを開設できました。下記にそのときの手順をメモしておきます。0. 前提条件Git、Node、npmは事前にインストールしておいてください。1. ブログのスターターキットを起動Ga...","tags":["Gatsby","ブログ"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2018/how-to-start-a-blog-with-gatsby.png"}},{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>GatsbyでWebサイトを作るときに、ブログや職種紹介など2種類以上のマークダウンファイルを管理する場合があると思います。通常だとMarkdownRemarkNodeの<code class=\"language-text\">fileAbsolutePath</code>でしか両者のマークダウンファイルを見分ける術がありませんが、ここではもっとスマートなやり方を紹介します。簡単に言うとFileNodeの<code class=\"language-text\">sourceInstanceName</code>をMarkdownRemarkNodeに引き継ぐことにより、GraphQLのfilterで簡単に区別できるという方法です。</p>\n<h2 id=\"実装方法\"><a href=\"#%E5%AE%9F%E8%A3%85%E6%96%B9%E6%B3%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装方法</h2>\n<h3 id=\"step1-マークダウンファイルのflenodeでsourceinstancenameを定義\"><a href=\"#step1-%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%80%E3%82%A6%E3%83%B3%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AEflenode%E3%81%A7sourceinstancename%E3%82%92%E5%AE%9A%E7%BE%A9\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step1. マークダウンファイルのFleNodeでsourceInstanceNameを定義</h3>\n<p>マークダウンファイルの読み込み設定はgatsby-config.jsで以下のようにします。\n<code class=\"language-text\">name</code>を付けることでマークダウンファイルのFileNodeにおいて<code class=\"language-text\">sourceInstanceName</code>が設定できます。</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* (中略) */</span>\n\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">/* (中略) */</span>\n\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token punctuation\">:</span> <span class=\"token string\">'gatsby-source-filesystem'</span><span class=\"token punctuation\">,</span>\n      options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token comment\">// オプションでname(FileNodeにおけるsourceInstanceName)を指定</span>\n</span><span class=\"gatsby-highlight-code-line\">        name<span class=\"token punctuation\">:</span> <span class=\"token string\">'posts'</span><span class=\"token punctuation\">,</span>\n</span>        path<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/content/posts`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token punctuation\">:</span> <span class=\"token string\">'gatsby-source-filesystem'</span><span class=\"token punctuation\">,</span>\n      options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token comment\">// オプションでname(FileNodeにおけるsourceInstanceName)を指定</span>\n</span><span class=\"gatsby-highlight-code-line\">        name<span class=\"token punctuation\">:</span> <span class=\"token string\">'jobs'</span><span class=\"token punctuation\">,</span>\n</span>        path<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/content/jobs`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'gatsby-transformer-remark'</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token comment\">/* (中略) */</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">/* (中略) */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<h3 id=\"step2-filenodeのnameをmarkdownfilenodeに引継ぐ\"><a href=\"#step2-filenode%E3%81%AEname%E3%82%92markdownfilenode%E3%81%AB%E5%BC%95%E7%B6%99%E3%81%90\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step2. FileNodeのnameをMarkdownFileNodeに引継ぐ</h3>\n<p>何もしないとFileNodeの<code class=\"language-text\">sourceInstanceName</code>はMarkdownRemarkNodeに引き継がれません。\nそのため<code class=\"language-text\">gatsby-node.js</code>で引継ぎ処理を実装します。</p>\n<div class=\"gatsby-code-title\">gatsby-node.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onCreateNode</span>  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">,</span> boundActionCreators<span class=\"token punctuation\">,</span> getNode <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createNodeField <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> boundActionCreators\n\n  <span class=\"token comment\">// MarkdownRemarkNodeの場合のみ処処</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node <span class=\"token operator\">&amp;&amp;</span> node<span class=\"token punctuation\">.</span>internal <span class=\"token operator\">&amp;&amp;</span> node<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'MarkdownRemark'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// 親のFileNodeを取得して</span>\n    <span class=\"token keyword\">const</span> parent <span class=\"token operator\">=</span> <span class=\"token function\">getNode</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// gatsby-config.jsで設定したFileNodeのsourceInstanceNameを</span>\n    <span class=\"token comment\">// MarkdownRemarkのフィールドに引き継ぐ</span>\n    <span class=\"token comment\">// 名前はMarkdownRemarkの他プロパティとかぶらないようにcollectionとしている</span>\n    <span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'collection'</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> parent<span class=\"token punctuation\">.</span>sourceInstanceName<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<h3 id=\"step3-graphqlでnameをもとにマークダウンを区別\"><a href=\"#step3-graphql%E3%81%A7name%E3%82%92%E3%82%82%E3%81%A8%E3%81%AB%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%80%E3%82%A6%E3%83%B3%E3%82%92%E5%8C%BA%E5%88%A5\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step3. GraphQLでnameをもとにマークダウンを区別</h3>\n<p>GraphQLではcollectionフィールドで、それぞれを区別します。</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> <span class=\"token punctuation\">{</span>\n  allMarkdownRemark<span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\"># collectionにて記事のNodeのみ抽出</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token attr-name\">filter</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">fields</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">collection</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">eq</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"posts\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n</span>  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    edges <span class=\"token punctuation\">{</span>\n      node <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\"># (中略)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>簡単ですがGatsbyで良く困る事例の1つを紹介しました。\nGatsbyは多くのフックポイントを設けているので、今回のよう、やろうと思えば結構いろんなことができます🍅</p>\n<h2 id=\"参考\"><a href=\"#%E5%8F%82%E8%80%83\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://github.com/gatsbyjs/gatsby/issues/1634\">Question: How do I query based on gatsby-source-filesystem name? · Issue #1634 · gatsbyjs/gatsby</a></li>\n</ul>","fields":{"slug":"/how-to-distinct-2-kinds-of-markdown-in-gatsby","title":"Gatsbyで2種類のマークダウンファイルの区別する方法","date":"2019-06-01T21:00:00.000-07:00","excerpt":"なにこれGatsbyでWebサイトを作るときに、ブログや職種紹介など2種類以上のマークダウンファイルを管理する場合があると思います。通常だとMarkdownRemarkNodeのfileAbsolutePathでしか両者のマークダウンファイ...","tags":["Gatsby"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2019/06/how-to-distinct-2-kinds-of-markdown-in-gatsby.png"}},{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>Gatsbyでは、gatsby-node.jsのcreatePagesで以下のようにページを作成できます。\nただルートページ（index.jsのページ）はGatsby側で生成されるので通常はContextが設定できません。\nしかし場合によってはルートページにContextを設定したい時もあるでしょう。\nそこで今回は、ルートページにContextを設定する方法をご紹介します。</p>\n<div class=\"gatsby-code-title\">gatsby-node.jsでページにContextを設定する方法（ルートページでは使えない）</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> actions <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* (中略) */</span>\n\n  actions<span class=\"token punctuation\">.</span><span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    path<span class=\"token punctuation\">:</span> node<span class=\"token punctuation\">.</span>fields<span class=\"token punctuation\">.</span>slug<span class=\"token punctuation\">,</span>\n    component<span class=\"token punctuation\">:</span> qiitaPost<span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">    context<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">      slug<span class=\"token punctuation\">:</span> node<span class=\"token punctuation\">.</span>fields<span class=\"token punctuation\">.</span>slug<span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">      relatedPosts<span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">      latestPosts<span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">...</span><span class=\"token function\">previouseAndNext</span><span class=\"token punctuation\">(</span>posts<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n</span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">/* (中略) */</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"実装方法\"><a href=\"#%E5%AE%9F%E8%A3%85%E6%96%B9%E6%B3%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装方法</h2>\n<p>gatsby-node.jsでは<a href=\"https://www.gatsbyjs.org/docs/node-apis/#onCreatePage\"><code class=\"language-text\">onCreatePage</code></a>というAPIが用意されており、ページ生成時の処理を定義できます。これを使って以下のような処理を実行します。</p>\n<div class=\"gatsby-code-title\">gatsby-node.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onCreatePage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page<span class=\"token punctuation\">,</span> actions <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createPage<span class=\"token punctuation\">,</span> deletePage <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// ルートページの場合のみ処理継続</span>\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">.</span>path <span class=\"token operator\">===</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span>\n</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// いったんルートページを削除</span>\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">deletePage</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">)</span>\n</span>\n  <span class=\"token comment\">// pageオブジェクトをもとにルートページを再生成</span>\n  <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>page<span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">    context<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">...</span>page<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">      house<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`Gryffindor`</span></span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n</span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>やり方は原始的で、ルートページ生成されたときに一度削除して、ルートページを再生成します。\nこの時<code class=\"language-text\">createPage</code>の引数でContextを渡せば追加できます。</p>\n<p>ちなみに、<code class=\"language-text\">onCreatePage</code>で<code class=\"language-text\">craetePage</code>を呼び出すと無限ループになるのでは？と思うかもしれませんが、\n<code class=\"language-text\">onCratePage</code>はGatsby側で生成されたページの場合しか呼び出されないので、その心配はありません。<br/>\n以上です。🍅</p>\n<h2 id=\"参考\"><a href=\"#%E5%8F%82%E8%80%83\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://www.gatsbyjs.org/docs/creating-and-modifying-pages/#pass-context-to-pages\">Creating and Modifying Pages | GatsbyJS</a></li>\n</ul>","fields":{"slug":"/how-to-attach-context-to-root-page-in-gatsby","title":"GatsbyのルートページにContextを設定する方法","date":"2019-05-31T16:10:00.000+09:00","excerpt":"なにこれGatsbyでは、gatsby-node.jsのcreatePagesで以下のようにページを作成できます。ただルートページ（index.jsのページ）はGatsby側で生成されるので通常はContextが設定できません。しかし場合に...","tags":["Gatsby"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2019/05/how-to-attach-context-to-root-page-in-gatsby.png"}},{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>こんな感じで<a href=\"https://www.gatsbyjs.org/packages/gatsby-image/\">gatsby-image</a>の画像を表示したい。そんなコンポーネントの作成方法です。</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> filename <span class=\"token operator\">=</span> <span class=\"token string\">'filepath/to/myimage.png'</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Image</span> <span class=\"token attr-name\">filename</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>filename<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<br/>\n<p>gatsby-imageをちょっと知っている人ならわかると思うのですが、gatsby-imageで画像を表示するには、いちいちStaticQueryタグとGraphQLのクエリを定義する必要があって結構面倒です。そして<a href=\"https://www.gatsbyjs.org/packages/gatsby-image/\">公式ドキュメント</a>には画像のファイルパスをGraphQLのクエリにハードコードする方法しか載っておらず、<strong>Reactコンポーネントで画像ファイルパスを変数として扱う方法</strong>については記載がありません。\n<strong>そこで今回は、画像ファイルパスを渡せばgatsby-imageで画像を最適化して表示してくれるコンポーネントを作りました。</strong></p>\n<p>きっかけは、最近<a href=\"../\">自分のブログの記事一覧</a>のデザインを変えて、サムネイル画像を表示するようにしました。今までは体感速度がそれほど遅くないし、gatsby-imageは使い方が面倒くさそうだったので避けていました。たださすがに、50個以上のサムネイル画像を表示するようになると明らかに遅くなったので、gatsby-imageの導入を決めました。</p>\n<p>実際のソースコードは以下です。手っ取り早く実装方法を見たい方はコチラをご覧ください。</p>\n<p><a href=\"https://github.com/Takumon/blog/blob/master/src/components/image/index.js\">https://github.com/Takumon/blog/blob/master/src/components/image/index.js</a></p>\n<h2 id=\"実装\"><a href=\"#%E5%AE%9F%E8%A3%85\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装</h2>\n<h3 id=\"うまくいかない例\"><a href=\"#%E3%81%86%E3%81%BE%E3%81%8F%E3%81%84%E3%81%8B%E3%81%AA%E3%81%84%E4%BE%8B\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>うまくいかない例</h3>\n<p><a href=\"https://www.gatsbyjs.org/packages/gatsby-image/#how-to-use\">公式ドキュメント > How to use</a>ではGraphQLのクエリに画像ファイルパスをハードコードする方法が紹介されています。\nコレを参考にして、画像ファイルパスを変数として扱うには以下のようにすれば良さそうな気がします。</p>\n<div class=\"gatsby-code-title\">うまくいかない例</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> StaticQuery<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby'</span>\n<span class=\"token keyword\">import</span> Img <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby-image'</span>\n\n\n<span class=\"token comment\">// 画像ファイルパスをプロパティに取るようなコンポーネントを定義</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> filename <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n\n  <span class=\"token comment\">// ページじゃないコンポーネントでもGraphQLが使えるように</span>\n  <span class=\"token comment\">// StaticQueryタグを使う</span>\n  <span class=\"token operator\">&lt;</span>StaticQuery\n\n    <span class=\"token comment\">// GraphQLのクエリ引数にfilenameを指定！</span>\n    query<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>graphql<span class=\"token template-string\"><span class=\"token string\">`\n      query {\n        file(relativePath: { eq: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>filename<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\" }) {\n          childImageSharp {\n            fixed(width: 800) {\n              ...GatsbyImageSharpFixed\n            }\n          }\n        }\n      }\n    `</span></span><span class=\"token punctuation\">}</span>\n\n    render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// GraphQLでgatsby-image用の情報がdataに代入されているはず！</span>\n      <span class=\"token keyword\">const</span> fixed <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>file<span class=\"token punctuation\">.</span>childImageSharp<span class=\"token punctuation\">.</span>fixed\n\n      <span class=\"token comment\">// Imgタグでgatsby-imageで最適化された画像を表示する</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Img</span> <span class=\"token attr-name\">fixed</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>fixed<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<p>ただこれはうまく行きません。\nStaticQueryタグは文字通り「静的」であり、ビルド時に評価されるので、画面表示時に「動的」に変数を指定することはできないのです。またStaticQueryのクエリはテンプレートリテラルとして文字列補完をサポートしておらず、その結果ビルド時に以下のようなエラーになってしまいます。</p>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">Error: BabelPluginRemoveGraphQL: String interpolations are not allowed in graphql fragments.\nIncluded fragments should be referenced as ...</code></pre></div>\n<br/>\n<h3 id=\"うまくいく例\"><a href=\"#%E3%81%86%E3%81%BE%E3%81%8F%E3%81%84%E3%81%8F%E4%BE%8B\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>うまくいく例</h3>\n<p>前述のうまくいかない例では、GraphQLのクエリで画像ファイルを特定しようとしていました。\n今回はコレを<strong>GraphQLのクエリですべての画像を取得して、描画時に画像ファイルを特定する</strong>ようにします。</p>\n<div class=\"gatsby-code-title\">うまくいく例</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> StaticQuery<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby'</span>\n<span class=\"token keyword\">import</span> Img <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby-image'</span>\n\n<span class=\"token comment\">// 画像ファイルパスをプロパティに取るようなコンポーネントを定義</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> filename <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n\n  <span class=\"token comment\">// ページじゃないコンポーネントでもGraphQLが使えるように</span>\n  <span class=\"token comment\">// StaticQueryタグを使う</span>\n  <span class=\"token operator\">&lt;</span>StaticQuery\n\n    <span class=\"token comment\">// GraphQLのクエリ引数には何も指定しない！</span>\n    query<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>graphql<span class=\"token template-string\"><span class=\"token string\">`\n      query {\n        images: allFile {\n          edges {\n            node {\n              relativePath\n              name\n              childImageSharp {\n                sizes(maxWidth: 800) {\n                  ...GatsbyImageSharpSizes\n                }\n              }\n            }\n          }\n        }\n      }\n    `</span></span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 全画像情報がdataに代入されている</span>\n    render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token comment\">// 指定した画像ファイルパス（コンポーネントのプロパティ）と</span>\n      <span class=\"token comment\">// 一致するgatsby-image用の情報を取得</span>\n      <span class=\"token keyword\">const</span> image <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>images<span class=\"token punctuation\">.</span>edges<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>n <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> n<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>relativePath<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>image<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span>\n      \n      <span class=\"token comment\">// Imgタグでgatsby-imageで最適化された画像を表示する</span>\n      <span class=\"token keyword\">const</span> imageSizes <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>childImageSharp<span class=\"token punctuation\">.</span>sizes\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Img</span>　<span class=\"token attr-name\">sizes</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>imageSizes<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<p>これによってめんどくさい処理をコンポーネントに隠蔽できました。使う側は以下のように定義します。</p>\n<div class=\"gatsby-code-title\">コンポーネントの使用イメージ</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> Image <span class=\"token keyword\">from</span> <span class=\"token string\">'上記で作成したコンポーネントのパス'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> filename <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> filename <span class=\"token operator\">=</span> <span class=\"token string\">'filepath/to/myimage.png'</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Image</span> <span class=\"token attr-name\">filename</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>filename<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br/>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>今回はgatsby-imageを楽に使えるコンポーネントの作成方法を紹介しました。GraphQLのクエリですべての画像を取得するので、ビルドがちょっと遅くなります（実際のブラウザの表示には影響はありません）。それでも画像のファイルパスを変数として扱うことができるようになるし、実装が簡潔になるので、利便性は高いと言えるでしょう🍅</p>\n<h2 id=\"参考\"><a href=\"#%E5%8F%82%E8%80%83\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<p>実装は以下を参考にさせていただきました。ありがとうございます。</p>\n<ul>\n<li><a href=\"https://noahgilmore.com/blog/easy-gatsby-image-components/\">Easy Gatsby Image Components</a></li>\n<li><a href=\"https://qiita.com/tkkrr/items/34f384956fb968a30fe5\">Gatsby.jsの画像最適化プラグインgatsby-imageを触ってみてわかったこと。 - Qiita</a></li>\n<li><a href=\"https://github.com/gatsbyjs/gatsby/issues/2293\">Support Dynamic GraphQL Queries · Issue #2293 · gatsbyjs/gatsby</a></li>\n</ul>","fields":{"slug":"/simple-gatsby-image-wrapper","title":"パスを渡せばgatsby-imageで画像を表示してくれるコンポーネントの作成方法","date":"2019-05-13T19:00:00.000+09:00","excerpt":"なにこれこんな感じでgatsby-imageの画像を表示したい。そんなコンポーネントの作成方法です。  const filename = 'filepath/to/myimage.png'  return &#x3C;Image filen...","tags":["Gatsby","gatsy-image"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2019/05/simple-gatsby-image-wrapper.png"}},{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"/wordcloud-with-kuromoji-d3cloud-nodejs\">前回記事</a>ではNode.jsでWordCloudを出力しました。\n今回は、<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">前回のサンプル</a>をベースに自分のブログ（Gatsby製のブログ）にWordCloudを取り入れてみたので、その時の実装方法のメモです。</p>\n<p>※ソースコードは以下です。<br/>\n<a href=\"https://github.com/Takumon/blog/blob/master/gatsby-node.js\">https://github.com/Takumon/blog/blob/master/gatsby-node.js</a></p>\n<h2 id=\"wordcloudどんなかんじ？\"><a href=\"#wordcloud%E3%81%A9%E3%82%93%E3%81%AA%E3%81%8B%E3%82%93%E3%81%98%EF%BC%9F\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WordCloudどんなかんじ？</h2>\n<p>(1)記事全文をインプットにしたものと、(2)記事のタグをインプットにしたものの2つを生成しました。<a href=\"./map\">全記事解析ページ</a>で見れます。</p>\n<h3 id=\"1記事全文をインプットにしたもの\"><a href=\"#1%E8%A8%98%E4%BA%8B%E5%85%A8%E6%96%87%E3%82%92%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E3%81%AB%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(1)記事全文をインプットにしたもの</h3>\n<p>キーワード以外にも、「登録」「実現」「まとめ」のような何回も使う表現がノイズとして混ざるのであまり満足度は高くありません。それでも「Gatsby」「React」が目立って表示されているので、形だけはWordCloudになっています。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/de4be7280c02fcda494c51d41a9db86e/d9807/wordcloud-from-texts.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 52.480000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcRAAAXEQHKJvM/AAACQ0lEQVQozxWSS2/cNhSF5//v8wO6aDYFCnTRJkA3TYHErWOPx/V4NNLoQT1JiSKpx8h208XXmwUhggLOPeeeb3d93Rhnj58mgnf4pce7Qd4Mg+m41h2mbSgGRTOMWFszukBwHVNwhGlkmReuc2C7vrJ7XT3L5HhxI6uzcu/RfUPrRbBqeYtSGvNE3O+p25ReL5R2pGgadJPS2o6xMyzesi0ru//WhS0Yrs4wFyJYlWRNzSlVZFlKXVSk6d+o8o68iriUjkqc38p/VSpsL4J9Id+GdZ2+O1xpp5mqc9iHPdPDX8Sq4v6iqO4/c36856Yt+KwyjkWNKVryPKfSMmjo6Kwm6s4YnYpgYPc2WbHcscmu1n/uMOeYJLMczjX6yz3Nwy2hembMjvjswt3jhcPTmfF4gz9/RdlAYhxdr/Hjd8HR8q2ucGZgH39ijb6gniTeJWLQJ0p1IjvteRSB/JKTHs/YJGFsDrwlN6xFTKVmlraW/Y/s1uuGC4HUaFSb8a9MvT3+wof4N354fMfvya/8fPiJHx/e8zH5kzQe6OsEpQtCpzDlM1pK8UMtkVt203XFeY2Whp1En8qR7vlInP9BlH8lkt095xH78oZPlz2nk+KQtWS1xqlISosJfc3cD0zLzG6TUiY/oSV6PfSUcoK0bJUg0gWqytOpknOTUDeWIIVY1VKOrRiIRajAC0arF/xeBZtvm+M6CjLzzGgHcdpIcxWTYOCsDLEGIw56GRi05sUoZi2sCrdWXG3CqxOO50XAfln4H6dQ3Q7nZ23oAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wordcloud from texts\"\n        title=\"\"\n        src=\"/static/de4be7280c02fcda494c51d41a9db86e/42603/wordcloud-from-texts.png\"\n        srcset=\"/static/de4be7280c02fcda494c51d41a9db86e/f931c/wordcloud-from-texts.png 200w,\n/static/de4be7280c02fcda494c51d41a9db86e/e8031/wordcloud-from-texts.png 400w,\n/static/de4be7280c02fcda494c51d41a9db86e/42603/wordcloud-from-texts.png 800w,\n/static/de4be7280c02fcda494c51d41a9db86e/5b8b9/wordcloud-from-texts.png 1200w,\n/static/de4be7280c02fcda494c51d41a9db86e/c7ea5/wordcloud-from-texts.png 1600w,\n/static/de4be7280c02fcda494c51d41a9db86e/d9807/wordcloud-from-texts.png 1875w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br/></p>\n<h3 id=\"2記事のタグをインプットにしたもの\"><a href=\"#2%E8%A8%98%E4%BA%8B%E3%81%AE%E3%82%BF%E3%82%B0%E3%82%92%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E3%81%AB%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(2)記事のタグをインプットにしたもの</h3>\n<p>上記を作ってみて満足いかなかったので、試しに記事のタグをインプットにしたものを作ってみたら、思いのほかそれっぽくなりました。自分の直感とも一致していているので、「どんなブログ書いてるの？」という質問の答えとして十分使えそうです。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a2d86827695eec6552e7881612d06b66/d9807/wordcloud-from-tags.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 53.17333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABcRAAAXEQHKJvM/AAACY0lEQVQoz2WTW2/TQBCF8/9/Ak/wwFNBogIkWqBCFERRLylpkzSpE8dx7fjutde32PF+bFqEkBjpaLWzqzNn9swO0KGU4t/Yb/eZSXBLHNtQ1fS1oCk7ml3PRpb0Xfd0V6PftSh/AtuCwXabE1g2tczY1iky9hCBS1kWvF0cchU8YMQxNB6NaCnaHb4+y4RAFBW0LeQhLD6h2ppBVW5wjRW+OWM1vsaYXGGNb1lPPQ6mH3hzsWSkC96sHT7+2vB+5HJmRnybebw8M7mYe5h3c/Lh60fFg6TwSBYLiuwW2eqqurJ0a+y5rwmPNYnF4YXJizObZ19Nju483t04vLpac3Bxz9Ek4PnJiM4Z6f53DMqypDBNZHKNHy6xlnN8K2Rx43Pln3O2vuPSvmPo3DNyZjhhzMR2Md2IteGycAS/ZgYsj+n7joFMM/K5QRYPsTcxG9sh8jyClcR9MLiXBsnskvzbF4Ifp8iTE4rvP6hHQ/rTz/jff+K7gtZd0VWVVpikWpkgycfIqiSVEhGV2JOEWqsplxHV2KK+XpOOXRqtJpkPqYIptTUjWT3gODleICnqrTYlSbClwMumjMuK66xgqg/Pb31ths9yJVhaGZEb09sLemuESLXjuaFdjsjSXHckUc2WXg/RoMky5Ra5CrOxCtNEraJcxXamVhupbFFq+MqVkUr9RHWbWMmlpSoRqb6MVVwIta081clMPbJpWwZ7q5s/g7wPUXWkVg7d04Q3maCL1qg0hazRrUbk+t21oez4P/aE4b+o2l1Y502oyUK1z+lVf5GQbvv3jtrn+APFI55yhL8BmF02pml+TKcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wordcloud from tags\"\n        title=\"\"\n        src=\"/static/a2d86827695eec6552e7881612d06b66/42603/wordcloud-from-tags.png\"\n        srcset=\"/static/a2d86827695eec6552e7881612d06b66/f931c/wordcloud-from-tags.png 200w,\n/static/a2d86827695eec6552e7881612d06b66/e8031/wordcloud-from-tags.png 400w,\n/static/a2d86827695eec6552e7881612d06b66/42603/wordcloud-from-tags.png 800w,\n/static/a2d86827695eec6552e7881612d06b66/5b8b9/wordcloud-from-tags.png 1200w,\n/static/a2d86827695eec6552e7881612d06b66/c7ea5/wordcloud-from-tags.png 1600w,\n/static/a2d86827695eec6552e7881612d06b66/d9807/wordcloud-from-tags.png 1875w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<br/></p>\n<h2 id=\"処理概要\"><a href=\"#%E5%87%A6%E7%90%86%E6%A6%82%E8%A6%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理概要</h2>\n<p>Gatsbyを使う場合、画面に必要なデータはビルド時に生成するのがベーシックなやり方です。\nそのためSVG生成は、表示時のReactコンポーネントではなくビルド時の処理（gatsby-node.js）にて行いました。\nビルドはNode.jsの世界ですから、前回記事の<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">Node.jsでWordCloudのSVG画像を出力するサンプル</a>が、ほぼそのまま使えるわけです。サンプルと、Gatsbyビルド処理のお作法（gatsby-node.jsの書き方）を考慮して以下のような手順でSVG画像のデータを生成します。</p>\n<ul>\n<li>\n<p>記事全文のWordCloud生成</p>\n<ul>\n<li>記事全文を取得 ☚Gatsbyビルド処理のお作法</li>\n<li>記事全文をインプットにkuromoji.jsで形態素解析</li>\n<li>解析結果をインプットにD3-Cloudでフォーマット</li>\n<li>解析結果をインプットにd3.jsでSVG文字列生成</li>\n<li>Gatsbyページ生成時にContextのプロパティとして渡す ☚Gatsbyビルド処理のお作法</li>\n</ul>\n</li>\n<li>\n<p>記事全タグのWordCloud生成</p>\n<ul>\n<li>記事全タグを取得 ☚Gatsbyビルド処理のお作法</li>\n<li>記事全タグをインプットにタグ出現回数を算出</li>\n<li>解析結果をインプットにD3-Cloudでフォーマット</li>\n<li>解析結果をインプットにd3.jsでSVG文字列生成</li>\n<li>Gatsbyページ生成時にContextのプロパティとして渡す ☚Gatsbyビルド処理のお作法</li>\n</ul>\n</li>\n</ul>\n<p>そして表示時にコンポーネントでSVGデータを取得し画面に表示します。</p>\n<h2 id=\"処理のチューニングポイント\"><a href=\"#%E5%87%A6%E7%90%86%E3%81%AE%E3%83%81%E3%83%A5%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理のチューニングポイント</h2>\n<p>WordCloudの品質を上げるために以下のようなチューニングを実施しました。</p>\n<ul>\n<li>\n<p>「Gatsby」[gatsby」などは同じ単語とみなしてカウントしています。</p>\n<ul>\n<li>文章中で前後文脈によって大文字小文字の差があるものは、同じ単語としてカウントしています。</li>\n<li>最終的にWordCloudに表示する単語は一番大文字の数が多い単語（「Gatsby」[gatsby」なら「Gatsby」）を採用するようにしました。</li>\n</ul>\n</li>\n<li>\n<p>記事全文は、マークダウンではなくHTMLをインプットにして、HTMLタグを除外、さらにpreタグは中身ごと除外してから形態素解析のインプットとして渡しています。</p>\n<ul>\n<li>マークダウンはリンク、スタイルなどメタ情報が多いため、いったんHTMLに変換したものからHTMLタグを抜くことで純粋な文書だけを抽出しています。</li>\n<li>またソースコードには同じような表現が多く含まれ、WordCloudの対象にするにはノイズが大きく、大事な単語であればソースコード外の文章中に出てくるという前提のもと、ソースコードはすべて除外しています</li>\n<li>「時」「場合」など言い回しとして何度も出てくる単語はWordCloudの情報にしても意味がないので除外しています。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"処理詳細（実装）\"><a href=\"#%E5%87%A6%E7%90%86%E8%A9%B3%E7%B4%B0%EF%BC%88%E5%AE%9F%E8%A3%85%EF%BC%89\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理詳細（実装）</h2>\n<p>ちょっと長いですが、\nソースコード中のコメントにて詳細を説明します。</p>\n<div class=\"gatsby-code-title\">gatsby-node.jsからWordCloud生成処理抜粋</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/** HTML形式の記事本文からHTMLタグを削除するために使う */</span>\n<span class=\"token keyword\">const</span> striptags <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'striptags'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** 仮想DOM d3.js D3-CloudはDOMがある前提なのでNode.js実行時でも正常動作するように仮想Canvasを使う */</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createCanvas <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">/** 仮想DOM d3.js D3-CloudはDOMがある前提なのでNode.js実行時でも正常動作するように仮想DOMを使う */</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">JSDOM</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jsdom'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** 形態素解析のために使う */</span>\n<span class=\"token keyword\">const</span> kuromoji <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'kuromoji'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** WordCloudのSVG文字列作成用 */</span>\n<span class=\"token keyword\">const</span> d3 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** WordCloudのSVG文字列作成用 */</span>\n<span class=\"token keyword\">const</span> cloud <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3-cloud'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** createPageにてWordCloud生成処理を実装する */</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> createPage <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">/** (略)ページコンポーネント呼び出し */</span>\n\n    <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/** (略)記事情報呼び出しクエリ */</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>result <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token comment\">/** (略)もろもろのページ作成 */</span>\n\n\n      <span class=\"token comment\">// WordCloud用データ加工処理</span>\n\n      <span class=\"token comment\">/** (略)resultから記事全文の配列(allPostHtmlTexts)を取得する処理 */</span>\n\n      <span class=\"token comment\">// 記事全文文字列取得</span>\n      <span class=\"token keyword\">const</span> allPostTexts <span class=\"token operator\">=</span> allPostHtmlTexts\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>allHtmlTexts <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// HTML文字列からタグを除外</span>\n          <span class=\"token comment\">// ただしpreタグは、中身をWordCloud解析対象外とするためここではあえて残している</span>\n          <span class=\"token keyword\">const</span> stripedAllText <span class=\"token operator\">=</span> <span class=\"token function\">striptags</span><span class=\"token punctuation\">(</span>allHtmlTexts<span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;pre>'</span><span class=\"token punctuation\">)</span>\n\n          <span class=\"token comment\">// そのためpreタグとその中身を除外する。</span>\n          <span class=\"token comment\">// preタグの中見はソースコード。</span>\n          <span class=\"token comment\">// キーワードはソースコード外の文章中に記述していることを想定して</span>\n          <span class=\"token comment\">// WordCloudの対象から外す。</span>\n          <span class=\"token keyword\">return</span> <span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/&lt;pre[\\s\\S]+?>[\\s\\S]+?&lt;\\/pre>/g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// 改行でつなぐ</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n      \n\n      <span class=\"token comment\">/** (略)resultから記事全タグの配列(allPostTags)を取得する処理 */</span>\n\n      <span class=\"token comment\">// 記事タグ取得</span>\n      <span class=\"token keyword\">const</span> tagDatas <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n      <span class=\"token comment\">// 記事全タグ情報からどのタグが何回出現するか算出</span>\n      allPostTags<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>tags <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        tags<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n          <span class=\"token keyword\">const</span> targetData <span class=\"token operator\">=</span> tagDatas<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">=></span> data<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> t<span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>targetData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            targetData<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> targetData<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            tagDatas<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">:</span> t<span class=\"token punctuation\">,</span>\n              size<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n      <span class=\"token comment\">// タグ出現回数をインプットにWordCloud生成</span>\n      <span class=\"token comment\">// タグ情報の場合形態素解析せずとも単語ごとの出現回数が算出できるので</span>\n      <span class=\"token comment\">// 形態素解析はスキップしている</span>\n      <span class=\"token function\">createWordCloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        words<span class=\"token punctuation\">:</span> tagDatas<span class=\"token punctuation\">,</span>\n        w<span class=\"token punctuation\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span>\n        h<span class=\"token punctuation\">:</span> <span class=\"token number\">630</span><span class=\"token punctuation\">,</span>\n        fontSizePow<span class=\"token punctuation\">:</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">,</span>\n        fontSizeZoom<span class=\"token punctuation\">:</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span>\n        padding<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>tagSvg <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// タグをインプットにしたSVGが出来上がる</span>\n\n        <span class=\"token comment\">// 記事全文文字列をインプットに単語出現回数を算出</span>\n        <span class=\"token function\">createWordCount</span><span class=\"token punctuation\">(</span>alltext<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n            <span class=\"token comment\">// 記事全文の単語出現回数をインプットにWordCloud生成</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">createWordCloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              words<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">,</span>\n              w<span class=\"token punctuation\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span>\n              h<span class=\"token punctuation\">:</span> <span class=\"token number\">630</span><span class=\"token punctuation\">,</span>\n              fontSizePow<span class=\"token punctuation\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span>\n              fontSizeZoom<span class=\"token punctuation\">:</span> <span class=\"token number\">3.1</span><span class=\"token punctuation\">,</span>\n              padding<span class=\"token punctuation\">:</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>textSvg <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 記事全文をインプットにしたSVGが出来上がる</span>\n\n            <span class=\"token comment\">// ページ生成時にSVGをContextのプロパティとして渡す</span>\n            <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              path<span class=\"token punctuation\">:</span> <span class=\"token string\">'/map/'</span><span class=\"token punctuation\">,</span>\n              component<span class=\"token punctuation\">:</span> postRelationMapPage<span class=\"token punctuation\">,</span>\n              context<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                allPostRelations<span class=\"token punctuation\">,</span>\n                wordCloudText <span class=\"token punctuation\">:</span> textSvg<span class=\"token punctuation\">,</span>\n                wordCloudTag<span class=\"token punctuation\">:</span> tagSvg<span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\">// すべてのcreatePageを呼び終わったあとにresolveを呼んで処理終了</span>\n            <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'OK'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * ２つの単語の大文字小文字の違いをカウントする\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">countDiff</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a\n    <span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>charA<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> charA <span class=\"token operator\">===</span> b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">/**\n * 指定した文字列を形態素解析して単語ごとの出現回数を返す\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createWordCount</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// よく出る言い回しでWordCloudから除外したい単語を列挙  </span>\n  <span class=\"token keyword\">const</span> excludeWords <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'指定'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'時'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'追加'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">/** (略)除外したい単語 */</span>\n  <span class=\"token punctuation\">]</span>\n\n\n  <span class=\"token comment\">/** kuromoji.jsにバンドルされている辞書の格納場所 */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'node_modules/kuromoji/dict'</span>\n\n  <span class=\"token comment\">/** WordCloudでカウントする品詞（助詞・助動詞などは省く） */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">TARGET_POS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'名詞'</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token comment\">/** kuromoji.jsで該当プロパティの値が存在しない場合に設定されている値 */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n\n  <span class=\"token comment\">// kuromoji.jsで形態素解析</span>\n  <span class=\"token comment\">// 単語ごとの出現回数を出力</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    kuromoji<span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dicPath<span class=\"token punctuation\">:</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> tokenizer<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// 単語ごとの出現回数を出力</span>\n      <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> <span class=\"token constant\">TARGET_POS</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>basic_form <span class=\"token operator\">===</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">?</span> t<span class=\"token punctuation\">.</span>surface_form <span class=\"token punctuation\">:</span> t<span class=\"token punctuation\">.</span>basic_form<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// 大文字と小文字を区別せず出現回数をカウントする</span>\n          <span class=\"token keyword\">const</span> upperText <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>excludeWords<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>upperText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> data\n          <span class=\"token punctuation\">}</span>\n\n          <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> upperText<span class=\"token punctuation\">)</span>\n\n          <span class=\"token comment\">// 出現回数は大文字小文字を区別しないが、実際の生の単語は後の処理で使うためとっておく</span>\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>target<span class=\"token punctuation\">.</span>rawTexts<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              target<span class=\"token punctuation\">.</span>rawTexts<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">:</span> upperText<span class=\"token punctuation\">,</span>\n              rawTexts<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> text <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n              size<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> data\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n          <span class=\"token comment\">// 上記処理で保持しておいた生の単語をもとに、一番大文字が多い単語をWordCloudの単語として採用する</span>\n          <span class=\"token comment\">// 例えばGatsbyとgatsbyであればGatsbyを採用</span>\n          <span class=\"token keyword\">const</span> almostSameText <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>rawTexts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>text <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n                text<span class=\"token punctuation\">,</span>\n                diff<span class=\"token punctuation\">:</span> <span class=\"token function\">countDiff</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a<span class=\"token punctuation\">.</span>diff <span class=\"token operator\">&lt;=</span> b<span class=\"token punctuation\">.</span>diff <span class=\"token operator\">?</span> a <span class=\"token punctuation\">:</span> b<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 大文字に近いほうを採用する</span>\n            <span class=\"token punctuation\">.</span>text\n          \n          <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n            text<span class=\"token punctuation\">:</span> almostSameText<span class=\"token punctuation\">,</span>\n            size<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * 単語出現回数をもとにWordCloudのSVG文字列を返す\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createWordCloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  words<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 単語出現回数</span>\n  w<span class=\"token punctuation\">,</span> <span class=\"token comment\">// SVGの幅(単位px)</span>\n  h<span class=\"token punctuation\">,</span> <span class=\"token comment\">// SVGの高さ(単位px)</span>\n  fontSizePow<span class=\"token punctuation\">,</span> <span class=\"token comment\">// WordCloudの文字の大きさの比率調整用係数</span>\n  fontSizeZoom<span class=\"token punctuation\">,</span> <span class=\"token comment\">// WordCloudの文字の大きさの係数</span>\n  padding<span class=\"token punctuation\">,</span> <span class=\"token comment\">// WordCloudの文字間の隙間</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">cloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">canvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">words</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>word <span class=\"token operator\">=></span> word<span class=\"token punctuation\">.</span>size <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 出現回数に応じて縦か横向きに表示</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontWeight</span><span class=\"token punctuation\">(</span>word <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> fontSizePow<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> fontSizeZoom<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontSize</span><span class=\"token punctuation\">(</span>word <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> fontSizePow<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> fontSizeZoom<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">font</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">padding</span><span class=\"token punctuation\">(</span>padding<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> wordsForCloud <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// d3.jsによる解析</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>wordsForCloud <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/** 仮想DOM */</span>\n      <span class=\"token keyword\">const</span> document <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSDOM</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`&lt;body>&lt;/body>`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">.</span>document\n\n      d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svg'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ui fluid image'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'viewBox'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token string\">`0 0 </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token string\">`translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-size'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>size<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-family'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> d <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token string\">`translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)rotate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>rotate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fill'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> d3<span class=\"token punctuation\">.</span>schemeCategory10<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text-anchor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>d <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n      \n      <span class=\"token comment\">// 最終的にSVGの文字列を返す</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>自分のブログにWordCloudを導入したいと思い立ち、WordCloudについて3回にわたりブログを書いてきましたが、各種ライブラリのおかげで、すんなりと導入できました。\n人に自分のブログを紹介するときのネタとしてはとても効果的だと思います。<br/>\nなお形態素解析やWordCloud生成は重い処理なので、ビルドに時間がかかるようになってしまいますが、画面表示に関してはパフォーマンスに影響はありません。<br/>\nあと本来であればプラグイン化して配布したいところですが、プラグイン化のためには、まだまだ汎用性を高る必要があって、それは今後の課題です🍅</p>","fields":{"slug":"/wordcloud-in-gatsby-blog","title":"Gatsby製ブログにWordCloudを導入","date":"2019-05-11T17:00:00.000+09:00","excerpt":"なにこれ前回記事ではNode.jsでWordCloudを出力しました。今回は、前回のサンプルをベースに自分のブログ（Gatsby製のブログ）にWordCloudを取り入れてみたので、その時の実装方法のメモです。※ソースコードは以下です。ht...","tags":["Gatsby","kuromoji.js","d3.js","d3Cloud","形態素解析","データ可視化","WordCloud"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2019/05/wordcloud-in-gatsby-blog.png"}}],"latestPosts":[{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>一時期いろんな勉強会に行きましたが、「勉強会に参加すると勉強している気になるだけで実際そうじゃない」ので最近はモクモク会にしか顔を出さなくなりました。\nその中でも<a href=\"https://shinjuku-moku.connpass.com/\">Shinjuku Mokumoku Programming</a>(通称「新宿もくもく」)にはほぼ毎週参加していた覚えがあります。\n僕は2019年6月に転勤で東京を離れてしまって行けなくなりましたが、一番お気に入りの勉強会だったので、この記事で紹介したいと思います。</p>\n<h2 id=\"必ず毎週開催される\"><a href=\"#%E5%BF%85%E3%81%9A%E6%AF%8E%E9%80%B1%E9%96%8B%E5%82%AC%E3%81%95%E3%82%8C%E3%82%8B\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>必ず毎週開催される</h2>\n<p><a href=\"https://shinjuku-moku.connpass.com/\">コンパスイベントページ</a></p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 612px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 122.22222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADyklEQVQ4y41V224iRxTkb5I/QELyu73A7n7g5iFaozxF+YLkD9aOBOZuC3Mzc78yt4Y+qWoYkxVRtCOVeobuOXNOVZ1DYzQa/S64qqqS9+sYiRRr+ZHreDxKWZbm/vX19Y/GZDL5lQ+B7xeOY6uiVMpe9NVq8Jd6XSwUDqn1eq2Wy6XabDbKti2121nqcDgoXlEUqTCMCsbAma+N4Wh0z4eHb9/UcDiUJInF9UJZby2ZTqcynU3Ftm1J01TiOJb9fi9ZlonWuk6SN4o3+HCvMR6PTcAkSRTLriolcRKK59kmUBgGEgEJgqVpYqjR+ihIsIZWqjIBV6tVr/Hy8nJ/5kKRj+NRS1GEkkSW7NNYyiKTOAqkKnMEK8wzUeR7ybOU0FmWngMuew2UZQKCWJXnOFgdJd4MJJz9Ka7riOf7EkaROI6LkhNTMgEOJc9z8X1fY0+dOew1RmcOB/2+Gj49Ga7e3rby8jwX0CHjyZgHxbIs2W63Zt3tdgI9apU1q7vicAk1Pc9DuYUh38aLOIDgbwIlze/M6Dt7/ZcodYZQTvGFWkWCQYhsn1E0g3qfZwnsa6zq7MNe4+/Hx3tmRK8xGyobBAG5MSsRhqHJmgG5EqyG5wENdU0ys9n8IkqBr/DrtI3rurJCuY7jvINBGYQrQUewfDSE9jz/Ypu65MeHB9Xv900WJH6xWAi6SCbTiaBDTMa27WD1jPJU+X85tHY7RfOyL01JsAwDWbYlIcomb6ygLIpTFHTKybdU+XAJ+Pz8/L2xD0fZ5ygrcoyhaeDAdyFMckF2gjF2vtf5v409n89NQHXqdcMLy6YYJxOnJjvuvQNn+PHa2OD22tjz2UwBJghLhWLAzAwH8klTwxZYN7LGPgOzbCSg2WVXokzGY7VCRzBgFMXiwD4MxC6hquT2h4yNLE4l49LYI4dJSh9ahrsUA8J1LDNxotDH1AnJm+HWDIoy12WRX0+bA0ShFVhKlnP2QVnwV5ZsueycCKApHLkuwe0ewoUaI+7CYd3LMLNyYWC2Gpt/sXg1vUyQP3bQdstOsuBT24jCj0NAzan9niGm9NezsaunwUDzAFTTCKRn06lGJ2kEM7+DS41phPmXa30a2TWqM4f3/E/p8SHFCzXLGJgQwmNbmSnNvwXah6VzWl+0OOGgKn0O+BsDfmH6KDWAinFZlHGUuLHn7WLfc2KIELu2ZVYCZr9CFAUBhYIevzRardbP7Xa7dXt727y7uzPotD82u93PwMfmhw/t5qdPn81KtNudZqfTbbY7HaB7An/rdls3Nzc//QP9oeBaZ857xgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"connpass event list\"\n        title=\"\"\n        src=\"/static/d4852b01a57efa0adb0f463d7654684b/15f98/connpass-event-list.png\"\n        srcset=\"/static/d4852b01a57efa0adb0f463d7654684b/e6bc1/connpass-event-list.png 200w,\n/static/d4852b01a57efa0adb0f463d7654684b/f4555/connpass-event-list.png 400w,\n/static/d4852b01a57efa0adb0f463d7654684b/15f98/connpass-event-list.png 612w\"\n        sizes=\"(max-width: 612px) 100vw, 612px\"\n      />\n    </span>\n  </span>\n  を見るとわかりますが、週次で開催されています。\n勉強会のなかには開催が不定期で開催予定日を常にウォッチしておく必要がありますが、\n新宿もくもくはほぼ毎週欠かさず開催されるのでウォッチ不要です。\n自分の生活の一部として週一モクモク会参加を習慣化できます。</p>\n<h2 id=\"1回の時間が長い\"><a href=\"#1%E5%9B%9E%E3%81%AE%E6%99%82%E9%96%93%E3%81%8C%E9%95%B7%E3%81%84\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1回の時間が長い</h2>\n<p>朝11:00から夕方6:00と比較的長めです。\n途中にランチ、最後に成果発表がありますが、実質<strong>5時間</strong>は作業できます。\nせっかく来たならガッツリもくもくしたい！という人にピッタリです。</p>\n<h2 id=\"最初にやること宣言、最後に成果発表\"><a href=\"#%E6%9C%80%E5%88%9D%E3%81%AB%E3%82%84%E3%82%8B%E3%81%93%E3%81%A8%E5%AE%A3%E8%A8%80%E3%80%81%E6%9C%80%E5%BE%8C%E3%81%AB%E6%88%90%E6%9E%9C%E7%99%BA%E8%A1%A8\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>最初にやること宣言、最後に成果発表</h2>\n<p>まず勉強会の最初に、以下リポジトリに本日やることをプッシュして自己紹介を兼ねて各自宣言します。\nそして最後に、成果をプッシュして成果発表をします。\n成果発表では<a href=\"https://gitpitch.com/\">GitPitch</a>を使って2～3分程度みんなの前で発表します。\nこのような仕組みによって自分に適度なプレッシャーを与え、効率的に作業を進められます。</p>\n<div class=\"iframely-embed\"><div class=\"iframely-responsive\" style=\"height: 140px; padding-bottom: 0;\"><a href=\"https://github.com/shinjuku-mokumoku/shinjuku-mokumoku/tree/master/meetups\" data-iframely-url=\"//cdn.iframe.ly/WUoeQH0\"></a></div></div>\n<h2 id=\"ランチのお店がおいしい\"><a href=\"#%E3%83%A9%E3%83%B3%E3%83%81%E3%81%AE%E3%81%8A%E5%BA%97%E3%81%8C%E3%81%8A%E3%81%84%E3%81%97%E3%81%84\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ランチのお店がおいしい</h2>\n<p>午前中に勉強会Slackにて、ランチのお店の候補が提示されるので各自行きたいお店を選んで昼1:00になったらランチに行きます。\n候補は、寿司、和食、パスタ、カレー、中華などいろんなお店があって、どのお店もめっちゃおいしい料理が出てきます。</p>\n<p>午前中2時間もくもくして、おいしいランチを食べて、午後また集中してもくもくするといった流れです。\n立て込んでいる場合はランチに行かずに会場に残って作業することもできます。</p>\n<h2 id=\"おいしいコーヒ\"><a href=\"#%E3%81%8A%E3%81%84%E3%81%97%E3%81%84%E3%82%B3%E3%83%BC%E3%83%92\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>おいしいコーヒ</h2>\n<p>電源、Wifiはもちろん用意されているのですが、ウォーターサーバーとコーヒーサーバーもあります。\nコーヒーサーバーはちょっと高級なものらしく、とてもおいしいコーヒーが飲めます。</p>\n<h2 id=\"会場は代々木駅から徒歩１分、最近できた素敵なフロア\"><a href=\"#%E4%BC%9A%E5%A0%B4%E3%81%AF%E4%BB%A3%E3%80%85%E6%9C%A8%E9%A7%85%E3%81%8B%E3%82%89%E5%BE%92%E6%AD%A9%EF%BC%91%E5%88%86%E3%80%81%E6%9C%80%E8%BF%91%E3%81%A7%E3%81%8D%E3%81%9F%E7%B4%A0%E6%95%B5%E3%81%AA%E3%83%95%E3%83%AD%E3%82%A2\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>会場は代々木駅から徒歩１分、最近できた素敵なフロア</h2>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 63.142857142857146%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJElEQVQozwEZA+b8AIt9b5SGeXxuYo19b31wYmRZTF1QQ3luYXBkWF1PQmteUllPRWBVS25iV2ddUmRbUWtjW3BtanFubW1qaQCVh3eZjX+RhXmjlIihkoeRgXWXiHqEd2twYlZ3aFluX1JhU0hmWU5rYFZoXlRoYFlmX1hsZV9wa2dvbW4Ajn9xiXpqiXxujX9xin9yj4R6loyCjYJ4h351joZ+h393g3pyfXVtd3BneHBod3Brb2pla2Vgc3JycHF0AIp9cIl8boZ3aIl7bYZ6boV5bYh+coZ+c4J6cYJ7c4B7dYF9e35+fHt4dImLj4+TnYeLkIKFiX2Bhnd7gADAvbjIxsOPg3iFdmiXjoWel5GFem+Ee3GOh4B/e3h8foJ+fXx9fHp6dnKDgoOPl6KPl6OIkJp/hYx6f4YA8fHv////sKujin5y29rX9Pb3koqBkYqC7evprLvJib3sh6XEe3l3eHVxe3d1j5eikpyoiZKcgIaNeX+GAODf2e/w67y5sZSNhcnIxfj5+KGemKCdmP/+/MDS4JXR+4uqzIiHhHx5dX99e5Ocp5KeqomSm3+GjXl+hgBcUEhiVk9fU0siHRwUEhRsZF0gHiA9ODZtZ2M0OUFfcoM0PEeNjIuLiISGhIGXoKyUn6yIkZt9hIx3fYQAQTQqPzEoOSwkKSAcKyEcMCQdIxsXKR8aJRsVJBsWLBwSNC4sn56el5WPkpCNn6i0lqO0iJCbe4GIdHp/AEc4L0c5L0AyKkE0LEAzKzktJ0Q2LTktJTwwKEA1KzQoIWNeW6yrp5qWj5eUjqexvp2vyIuWpXqDinF3ewBGNi1FNy0+MSk7Lyg8MCg4LSU8MSg1KiM4LiY9Myo6LiRfWleopqehm5aYkY2VmJ+Jlad8go9tcXhmZ2oAXEs8Yk9BXUxAXk9CW0tATkE4W0xBSjw0TD81TD40TT40Wk1FaWBecWhmc2tpb2dlamNhZl5cYVdVXFFQAHFeTmxZSmJOQlJANFI/NU49M1E+NU08Mkw7Mks6MEg4L08/NlVGPFZHPVhKQVxPSFxQSVtNSFhMRVZKRcheVnT1bph/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"image\"\n        title=\"\"\n        src=\"/static/7d91e83cc1cee4e7c723289ed8f39057/42603/image.png\"\n        srcset=\"/static/7d91e83cc1cee4e7c723289ed8f39057/f931c/image.png 200w,\n/static/7d91e83cc1cee4e7c723289ed8f39057/e8031/image.png 400w,\n/static/7d91e83cc1cee4e7c723289ed8f39057/42603/image.png 800w,\n/static/7d91e83cc1cee4e7c723289ed8f39057/5b8b9/image.png 1200w,\n/static/7d91e83cc1cee4e7c723289ed8f39057/1443f/image.png 1400w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>勉強会の名前自体は「新宿もくもく」なんですが、開催場所は代々木です。\n会場提供は<a href=\"https://www.wantedly.com/companies/repro?aql=gaFxpXJlcHJv\">Repro</a>さん。\n2019年6月からは、オフィス拡張に伴い新設したフロアでやっているらしいです。\n僕は6月に転勤になって東京を離れてしまったのでフロア移動後の勉強会には参加していませんが、\n5月に工事中のフロアを見せてもらった時は、こんなに素敵な空間でもくもく会できるなんて！と思いました。</p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>みなさん是非、<a href=\"https://shinjuku-moku.connpass.com/\">新宿もくもく</a>に参加してみてください🍅</p>","fields":{"slug":"/shinjuku-mokumoku-programming","title":"もくもく会ならShinjuku Mokumoku Programmingがオススメ","date":"2019-06-23T09:00:00.000-07:00","excerpt":"なにこれ一時期いろんな勉強会に行きましたが、「勉強会に参加すると勉強している気になるだけで実際そうじゃない」ので最近はモクモク会にしか顔を出さなくなりました。その中でもShinjuku Mokumoku Programming(通称「新宿も...","tags":["勉強会"],"keywords":["勉強会"],"thumbnail":"thumbnail/2019/06/shinjuku-mokumoku-programming.png"}},{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>自分専用のRSSリーダーを<a href=\"https://gatsbyjs.org\">Gatsby</a> + <a href=\"https://netlify.com\">Netlify</a> + <a href=\"https://zapier.com/\">Zapier</a>を使って作りました。Gatsbyビルド時にRSSとOGPを取得して、Webサイトに表示しています。\n今回はこのWebサイトのビルドの仕組みと、GatsbyビルドでRSS+OGPを取得する方法をご紹介します。</p>\n<p>サイトはコチラ↓</p>\n<div class=\"iframely-embed\"><div class=\"iframely-responsive\" style=\"height: 140px; padding-bottom: 0;\"><a href=\"https://favorite-blogs.netlify.com//\" data-iframely-url=\"//cdn.iframe.ly/api/iframe?url=https%3A%2F%2Ffavorite-blogs.netlify.com&key=0658bf78be97cafcf2b0b9f96c1270ee\"></a></div></div>\n<br/>\n<p>ソースはコチラ↓</p>\n<div class=\"iframely-embed\"><div class=\"iframely-responsive\" style=\"height: 140px; padding-bottom: 0;\"><a href=\"https://github.com/Takumon/blog-rss\" data-iframely-url=\"//cdn.iframe.ly/B8twzEh\"></a></div></div>\n<br/>\n<h2 id=\"ビルドの仕組み\"><a href=\"#%E3%83%93%E3%83%AB%E3%83%89%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ビルドの仕組み</h2>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 105.86881472957421%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABcRAAAXEQHKJvM/AAADJElEQVQ4y6WVW3PTRhiG/dt70avedmhpO0Og0EIChCQOYAcfZNmSZVmWLB8U2zlgwKFTEgewSdI0+/TTyk5CJ1DaXnyzHu3q1fN+h3WKZoWrQgVlCC3eWhuMcmuMy1k+uEV5Zus9FZ+Lz/ztvdQnBX0TOg57dh7zl5/IL1zjlZmFrZCzeO8T76U+S9iymEQ9jF+zBGmb/fAlDELZMxPCfy3YsfjdjzBuuriLIVFuC3Y6mv6/CbYqTHs7mA+rrP6wzsvaSCy3/5/g22hANvOMhesL7FpD2P5SwlhgVjV1SfCwOyAMIqKwz7C6pwn5xxzOxS6Lxmvb5mgwoF3y2LV9oX0hRWl9JKhb6BJIKhZQbQfVqoqAc0EnceyVGHsW07AOu6GI+ahO7Xx/3glceielmvIgfw9Ky6icrF4hEd90mdaK9J6s0kk/4o35lH1pbuT8eWPLuUPrGUd1Q2CqM8LNBkoLPgTjPqpbg9W7qFvfg/x+H9aoLC3Sz6wwNDLQ80VUaDY9/XtnY4V9Oyf0TaF3RbAfcNxrspVd5TRqwLCHSi+iblwDITqql2gu/azJ4pS896siss5pp55QSp61ZRlToroIivLILfPozi2sOz/qKv7p5Dmr5UGsbKfvk/72G04kn9O6ySRwmDhFjtt1TgProihiX2lBIRx6Ntuj1+xUCsmsBhU9XrHlSdNhkHks+TR4XcqwXdzgg3zwpF3Tl4ee+Tjk0kgIRWDcDXjuuxw05VBfZrU5O9iymUiFh0aRUdlgr5znhSXUmTX262K364pVWwdSfSJPqiyJjCnpSf4GgbSQbAiBzonEgVeVvDn85li88+MPNpJWicVEIKZKwtO2U7pJGwZnckg9XoKb36GePkBJm9CpclDJMxG7Y6vAGyGcOIau8tnMqpqFth334fmkSB9RXIcHUtHl26jsMrh5Dqsmpw2TQ7vESaMiogVNwrwXPzvLkrO4EKrrJAkX668Ka9reQTXH2M5y0qoxKqxIaq4WvSCcr7GF+dr3mRpfy+rxh3+XY+eGvg8nxa90i3yZ4EeXg5B2hVQIiZLQhZCx1HN/xX/KX27fz4YdRTNFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"build flow\"\n        title=\"\"\n        src=\"/static/d3807cd064fa752ebfead37f471691c0/42603/build-flow.png\"\n        srcset=\"/static/d3807cd064fa752ebfead37f471691c0/f931c/build-flow.png 200w,\n/static/d3807cd064fa752ebfead37f471691c0/e8031/build-flow.png 400w,\n/static/d3807cd064fa752ebfead37f471691c0/42603/build-flow.png 800w,\n/static/d3807cd064fa752ebfead37f471691c0/5b8b9/build-flow.png 1200w,\n/static/d3807cd064fa752ebfead37f471691c0/c7ea5/build-flow.png 1600w,\n/static/d3807cd064fa752ebfead37f471691c0/bc63a/build-flow.png 2400w,\n/static/d3807cd064fa752ebfead37f471691c0/81c80/build-flow.png 2607w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>以下時系列で説明します。</p>\n<ul>\n<li>\n<p>Zapier</p>\n<ul>\n<li>ジョブで定義したRSSを監視</li>\n<li>RSSに更新があったらNetlifyビルドをトリガー</li>\n</ul>\n</li>\n<li>\n<p>Netlify</p>\n<ul>\n<li>ビルドでGitHubからGatsbyプロジェクトのリポジトリをフェッチ</li>\n<li>Gatsbyプロジェクトのビルドを実行</li>\n<li>Gatsbyプロジェクトのビルドの中で、設定ファイルに定義したRSSをフェッチ</li>\n<li>ビルドが終わったらCDNにホスティング</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"netlifyとgithubの連携\"><a href=\"#netlify%E3%81%A8github%E3%81%AE%E9%80%A3%E6%90%BA\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NetlifyとGitHubの連携</h3>\n<p>Netlify上でGitHubリポジトリをビルド＆ホストできるようにしておきます。\n連携はNelityのGUIで簡単にできます。</p>\n<h3 id=\"zapierとnetlifyの連携\"><a href=\"#zapier%E3%81%A8netlify%E3%81%AE%E9%80%A3%E6%90%BA\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ZapierとNetlifyの連携</h3>\n<p>RSSリーダーは「RSSが更新されたらビルドをトリガーする」ような仕組みが必要です。この仕組みはNetlifyとZapierで実現できます。\nZapierはいろんなサービスやアプリを連携させて自動化できるWebサービスで、Netlifyにも対応しています。\nZapierの画面上で、監視したいRSSをポチポチ登録すると「RSSが更新されたらNetlifyのビルドをトリガーする」が簡単に実現できます。</p>\n<h2 id=\"rss--ogp取得\"><a href=\"#rss--ogp%E5%8F%96%E5%BE%97\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RSS + OGP取得</h2>\n<p>さてビルドの仕組みを整えたので、次はGatsbyのビルドでRSSを取得する方法について説明します。</p>\n<p>どのRSSを引っ張ってくるかは、GitHubリポジトリに設定ファイルにて定義します（<a href=\"https://github.com/Takumon/blog-rss/blob/master/favorite-blog-rss.js\">実際の設定ファイル</a>）。\nただコレ、ZapierのジョブのRSS定義と二重管理になるのが難点です。Zapierのタスクがyamlで書けるようになったら一元管理できるかもですが...</p>\n<div class=\"gatsby-code-title\">gatsby-node.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> striptags <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'striptags'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> axios <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'axios'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> cheerio <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cheerio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> crypto <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"crypto\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> Parser <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rss-parser'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> parser <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Parser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  headers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'something different'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">INTERNAL_TYPE_BLOG</span> <span class=\"token operator\">=</span> <span class=\"token string\">'blog'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">INTERNAL_TYPE_BLOG_POST</span> <span class=\"token operator\">=</span> <span class=\"token string\">'blogPost'</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">// RSSのような外部リソースを</span>\n<span class=\"token comment\">// GatsbyでGraphQLのデータとして扱うためには</span>\n<span class=\"token comment\">// sorceNodeで処理する</span>\nexports<span class=\"token punctuation\">.</span>sourceNodes <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> actions<span class=\"token punctuation\">,</span> createNodeId<span class=\"token punctuation\">,</span> store<span class=\"token punctuation\">,</span> cache <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> feeds <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token comment\">// 設定ファイルかなにかしらの方法でRSSのURLを読み込む</span>\n  <span class=\"token keyword\">const</span> blogUrls <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'rss-url-1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rss-url-2'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> blogUrl <span class=\"token keyword\">of</span> blogUrls<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \n    <span class=\"token comment\">// rss-parserでRSS情報を取得する</span>\n    <span class=\"token keyword\">const</span> feed <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> parser<span class=\"token punctuation\">.</span><span class=\"token function\">parseURL</span><span class=\"token punctuation\">(</span>blogUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>feed <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>feed<span class=\"token punctuation\">,</span>\n        items<span class=\"token punctuation\">:</span> feed<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>item <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          title<span class=\"token punctuation\">:</span> item<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n          excerpt<span class=\"token punctuation\">:</span> <span class=\"token function\">excerpt</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">,</span> <span class=\"token number\">120</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          content<span class=\"token punctuation\">:</span> item<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">,</span>\n          pubDate<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>pubDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toISOString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          link <span class=\"token punctuation\">:</span> item<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    feeds<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>feed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n\n  <span class=\"token comment\">// ブログごとにノード生成</span>\n  feeds\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>feed <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      title<span class=\"token punctuation\">:</span> feed<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n      description<span class=\"token punctuation\">:</span> feed<span class=\"token punctuation\">.</span>description<span class=\"token punctuation\">,</span>\n      link<span class=\"token punctuation\">:</span> feed<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">,</span>\n      lastBuildDate<span class=\"token punctuation\">:</span> feed<span class=\"token punctuation\">.</span>lastBuildDate<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>b <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> contentDigest <span class=\"token operator\">=</span> crypto<span class=\"token punctuation\">.</span><span class=\"token function\">createHash</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`md5`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">digest</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      \n      actions<span class=\"token punctuation\">.</span><span class=\"token function\">createNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>b<span class=\"token punctuation\">,</span>\n        id<span class=\"token punctuation\">:</span> <span class=\"token function\">createNodeId</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">INTERNAL_TYPE_BLOG</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>b<span class=\"token punctuation\">.</span>link<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        children<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        parent<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`__SOURCE__`</span></span><span class=\"token punctuation\">,</span>\n        internal<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n          type<span class=\"token punctuation\">:</span> <span class=\"token constant\">INTERNAL_TYPE_BLOG</span><span class=\"token punctuation\">,</span>\n          contentDigest<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// RSSに加えて、OGPを取得</span>\n  <span class=\"token keyword\">const</span> rssPosts <span class=\"token operator\">=</span> feeds<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>feed <span class=\"token operator\">=></span> feed<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>a<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> rssPostsWithImageUrl <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Promise.allでやると503になるのでfor文を使う</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> p <span class=\"token keyword\">of</span> rssPosts<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> pWithImageUrl <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      headers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'something different'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>res <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token comment\">// 取得したHTMLからOGPを取得</span>\n      <span class=\"token keyword\">const</span> $ <span class=\"token operator\">=</span> cheerio<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">let</span> imageUrl<span class=\"token punctuation\">;</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'head meta'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">each</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> el<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> property <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'property'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'content'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>property <span class=\"token operator\">===</span> <span class=\"token string\">'og:image'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          imageUrl <span class=\"token operator\">=</span> content\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// 記事情報にOGPのURLを追加</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>p<span class=\"token punctuation\">,</span>\n        imageUrl<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    rssPostsWithImageUrl<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>pWithImageUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n\n  <span class=\"token comment\">// OGP画像のノードを生成</span>\n  <span class=\"token comment\">// 重複を考慮してユニークにしてから処理する</span>\n  <span class=\"token keyword\">const</span> imageUrls <span class=\"token operator\">=</span> <span class=\"token function\">_uniq</span><span class=\"token punctuation\">(</span>rssPostsWithImageUrl<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">=></span> p<span class=\"token punctuation\">.</span>imageUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">=></span> p<span class=\"token punctuation\">.</span>imageUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">await</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span>imageUrls<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> imageUrl <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> fileNode <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">createRemoteFileNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      url<span class=\"token punctuation\">:</span> imageUrl<span class=\"token punctuation\">,</span>\n      cache<span class=\"token punctuation\">,</span>\n      store<span class=\"token punctuation\">,</span>\n      createNode<span class=\"token punctuation\">:</span> actions<span class=\"token punctuation\">.</span>createNode<span class=\"token punctuation\">,</span>\n      createNodeId<span class=\"token punctuation\">:</span> createNodeId<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">await</span> actions<span class=\"token punctuation\">.</span><span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">:</span> fileNode<span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'ThumbnailImage'</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> <span class=\"token string\">'true'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> actions<span class=\"token punctuation\">.</span><span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">:</span> fileNode<span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'link'</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> imageUrl<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> fileNode<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n  <span class=\"token comment\">// ブログ記事ごとのノード生成</span>\n  rssPostsWithImageUrl<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>p <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> contentDigest <span class=\"token operator\">=</span> crypto<span class=\"token punctuation\">.</span><span class=\"token function\">createHash</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`md5`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">digest</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">const</span> excerpt <span class=\"token operator\">=</span> \n    actions<span class=\"token punctuation\">.</span><span class=\"token function\">createNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token operator\">...</span>p<span class=\"token punctuation\">,</span>\n      id<span class=\"token punctuation\">:</span> <span class=\"token function\">createNodeId</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">INTERNAL_TYPE_BLOG_POST</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>p<span class=\"token punctuation\">.</span>link<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      children<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      parent<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`__SOURCE__`</span></span><span class=\"token punctuation\">,</span>\n      internal<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        type<span class=\"token punctuation\">:</span> <span class=\"token constant\">INTERNAL_TYPE_BLOG_POST</span><span class=\"token punctuation\">,</span>\n        contentDigest<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">// 記事要約は記事本文から抽出</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">excerpt</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">,</span> maxLength<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> rowText <span class=\"token operator\">=</span> <span class=\"token function\">striptags</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;pre>'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/&lt;pre[\\s\\S]+?>[\\s\\S]+?&lt;\\/pre>/g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/\\n/g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/ /g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> rowText<span class=\"token punctuation\">.</span>length <span class=\"token operator\">>=</span> maxLength\n    <span class=\"token operator\">?</span> rowText<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> maxLength<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'...'</span>\n    <span class=\"token punctuation\">:</span> rowText<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>OGP画像をGatsbyで扱う処理は今も参考にしてみてください。</p>\n<div class=\"iframely-embed\"><div class=\"iframely-responsive\" style=\"padding-bottom: 52.5%; padding-top: 120px;\"><a href=\"https://takumon.com/gatsby-image-of-remote-in-building-by-using-create-remote-file-node\" data-iframely-url=\"//cdn.iframe.ly/r1GTW3Y\"></a></div></div>\n<h3 id=\"リソース取得は間隔を置かないと503になる\"><a href=\"#%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E5%8F%96%E5%BE%97%E3%81%AF%E9%96%93%E9%9A%94%E3%82%92%E7%BD%AE%E3%81%8B%E3%81%AA%E3%81%84%E3%81%A8503%E3%81%AB%E3%81%AA%E3%82%8B\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>リソース取得は間隔を置かないと503になる</h3>\n<p>ビルド時にRSSやらOGPやらを引っ張ってくるために、大量のリクエストを発行しますが、サイトによっては時間当たりのリクエスト上限に引っかかって503エラーになることがあります。\n対処法としては、<code class=\"language-text\">Promise.all</code>で一度にリクエストを投げずに、for文でリクエスト1つずつawaitしながら投げて、適度に間隔を開けるのが良いと思います。</p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>RSSリーダーのようなものをSPAだけで作ろうとすると、フロント側の高負荷処理で画面描画が遅くなってしまいますが、\nGatsbyを使えばビルド時に重い処理を流せるので、パフォーマンスの向上が期待できます。\nまた今回のように、NetlifyやZapierなど他サービスと連携することで、作れる静的サイトの幅も広がります。\nSPA(Single Page Application)でこのような静的サイトを作っている方は一度Gatsbyを導入してみてはいかがでしょうか🍅</p>","fields":{"slug":"/gatsby-rss-reader-with-netlify-and-zapier","title":"Gatsby + Netlify + ZapierでRSSリーダーを作る","date":"2019-06-18T10:00:00.000-07:00","excerpt":"なにこれ自分専用のRSSリーダーをGatsby + Netlify + Zapierを使って作りました。Gatsbyビルド時にRSSとOGPを取得して、Webサイトに表示しています。今回はこのWebサイトのビルドの仕組みと、Gatsbyビル...","tags":["Gatsby","Netlify","Zapier","RSS","gatsby-plugin-feed"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2019/06/gatsby-rss-reader-with-netlify-zapier.png"}},{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"https://www.netlify.com/docs/form-handling/\">Netlify Forms</a>はNetlifyにホストしている静的サイトでお問い合わせフォームを作れる機能です。DBを用意しなくても、お問い合わせフォーム送信結果はNetlify側で保持しれくれます。Netlifyの管理画面からCSVダウンロードなども可能です。\nさらに<a href=\"https://zapier.com/\">Zapier</a>と連携すると、お問い合わフォームで入力したメールアドレス宛てに定型フォーマットのメールを送信できたりもします。\nそんな便利なNetlify Formsですが、ググっても、お問い合わせフォームを同期的に送信する簡単な方法しか実装サンプルを見つけられませんでした。そこで今回は以下のような実用的サンプルの実装方法をご紹介します。</p>\n<ul>\n<li>お問い合わせフォームにファイルアップロードを含む</li>\n<li>Reactを使う</li>\n<li>入力チェックに<a href=\"https://jaredpalmer.com/formik/\">Formik</a>を使う</li>\n<li><a href=\"https://github.com/axios/axios\">axios</a>で非同期にお問い合わせフォームを送信する</li>\n</ul>\n<h2 id=\"step1-ファイルアップロード--単純なhmlt--同期送信\"><a href=\"#step1-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89--%E5%8D%98%E7%B4%94%E3%81%AAhmlt--%E5%90%8C%E6%9C%9F%E9%80%81%E4%BF%A1\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step.1 ファイルアップロード + 単純なHMLT + 同期送信</h2>\n<p>もっとも単純なパターン、こちら<a href=\"https://www.netlify.com/docs/form-handling/\">Netlifyの公式サイト</a>に書いてある情報を参考に実装します。</p>\n<div class=\"gatsby-code-title\">index.html</div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- (中略) --></span>\n  <span class=\"token comment\">&lt;!-- name：Formの名前NetlifyのおけるFormの識別子となる --></span>\n  <span class=\"token comment\">&lt;!-- novalidate：Formikで入力チェックするためブラウザの入力チェックはオフ --></span>\n  <span class=\"token comment\">&lt;!-- data-netlify：NetlifyでFormを認識させるための属性 --></span>\n  <span class=\"token comment\">&lt;!-- netlify-honeypot：NetlifyでFormを認識させるための属性 --></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span>\n    <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>POST<span class=\"token punctuation\">\"</span></span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>contact<span class=\"token punctuation\">\"</span></span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token attr-name\">novalidate</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token attr-name\">data-netlify</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token attr-name\">netlify-honeypot</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>bot-field<span class=\"token punctuation\">\"</span></span>\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">></span></span>\n</span>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sampleText<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sampleFile<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n    \n    <span class=\"token comment\">&lt;!-- 送信ボタン --></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span>\n      SUBMIT\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- (中略) --></span></code></pre></div>\n<br/>\n<h2 id=\"step2-ファイルアップロード--react--同期送信\"><a href=\"#step2-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89--react--%E5%90%8C%E6%9C%9F%E9%80%81%E4%BF%A1\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step.2 ファイルアップロード + React + 同期送信</h2>\n<p>次にReactの場合です。Reactの場合はフォーム情報に<code class=\"language-text\">bot-field</code>と<code class=\"language-text\">form-name</code>を付与する必要があります。\nこれらは<code class=\"language-text\">&lt;input type=&quot;hidden&quot;&gt;</code>で実装します。</p>\n<div class=\"gatsby-code-title\">SampleForm.jsx</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>  <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>form\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"contact\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* Formの名前NetlifyのおけるFormの識別子となる */</span><span class=\"token punctuation\">}</span>\n    method<span class=\"token operator\">=</span><span class=\"token string\">\"POST\"</span>\n    novalidate<span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* Formikで入力チェックするためブラウザの入力チェックはオフ */</span><span class=\"token punctuation\">}</span>\n    data<span class=\"token operator\">-</span>netlify<span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>  <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyでFormを認識させるための属性 */</span><span class=\"token punctuation\">}</span>\n    netlify<span class=\"token operator\">-</span>honeypot<span class=\"token operator\">=</span><span class=\"token string\">\"bot-field\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyでFormを認識させるための属性 */</span><span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">></span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyFormで必要な値 */</span><span class=\"token punctuation\">}</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>bot-field<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyFormで必要な値 */</span><span class=\"token punctuation\">}</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>form-name<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n</span><span class=\"gatsby-highlight-code-line\">\n</span>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sampleText<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sampleFile<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n    \n    <span class=\"token punctuation\">{</span><span class=\"token comment\">/* 送信ボタン */</span><span class=\"token punctuation\">}</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      SUBMIT</span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">);</span></code></pre></div>\n<br/>\n<h2 id=\"step3-ファイルアップロード--react--formik--同期送信\"><a href=\"#step3-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89--react--formik--%E5%90%8C%E6%9C%9F%E9%80%81%E4%BF%A1\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step.3 ファイルアップロード + React + Formik + 同期送信</h2>\n<p>Netlify Formsはサーバー側のバリデーション機能はないので、\n実際使うときはフロント側のバリデーションが必要です。\nここでは、Reactのバリデーションライブラリ<a href=\"https://jaredpalmer.com/formik/\">Fromik</a>を使ってバリデーションを追加します。</p>\n<p>入力チェックエラーメッセージ表示はコンポーネント化します。そのほうがすっきりするので。</p>\n<div class=\"gatsby-code-title\">ErrorMessage.jsx</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Field<span class=\"token punctuation\">,</span> getIn <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'formik'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Formikエラーメッセージ表示用コンポーネント</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> name <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Field</span>\n    <span class=\"token attr-name\">name</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">render</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> form <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> error <span class=\"token operator\">=</span> <span class=\"token function\">getIn</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span>errors<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> touch <span class=\"token operator\">=</span> <span class=\"token function\">getIn</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span>touched<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      cosnt isShowError <span class=\"token operator\">=</span> touch <span class=\"token operator\">&amp;&amp;</span> error<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">return</span> isShowError\n        <span class=\"token operator\">?</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>error<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<p>入力フォームのコンポーネントはFormikの作法にしたがって以下を実装します。<br/></p>\n<ul>\n<li><code class=\"language-text\">initialValues</code>:入力フォーム初期値設定処理</li>\n<li><code class=\"language-text\">validate</code>: 入力チェック処理</li>\n<li><code class=\"language-text\">render</code>: 入力フォーム描画処理</li>\n</ul>\n<p>ただしファイルについてはFormikが用意している<code class=\"language-text\">Field</code>タグは<code class=\"language-text\">type=file</code>をサポートしていないので、HTMLの<code class=\"language-text\">input</code>タグでファイル変更時に手動でFormikにファイルを追加します。</p>\n<div class=\"gatsby-code-title\">SampleForm.jsx</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> navigate <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gatsby\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Formik<span class=\"token punctuation\">,</span> Field <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'formik'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ErrorMessage <span class=\"token keyword\">from</span> <span class=\"token string\">'./ErrorMessage'</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">// フォームの値を初期化</span>\n<span class=\"token keyword\">const</span> initialValues <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'form-name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'contact'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// NetlifyFormで必要な値</span>\n  <span class=\"token string\">'bot-field'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// NetlifyFormで必要な値</span>\n  sampleText<span class=\"token punctuation\">]</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  sampleFile<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">// 入力チェック</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleValidate</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> errors <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// sampleText</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>values<span class=\"token punctuation\">.</span>sampleText<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    errors<span class=\"token punctuation\">.</span>sampleText <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`テキストを記入してください`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// sampleFile</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>values<span class=\"token punctuation\">.</span>sampleFile<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    errors<span class=\"token punctuation\">.</span>sampleFile <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`ファイルを添付してください`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">.</span>sampleFile<span class=\"token punctuation\">.</span>size <span class=\"token operator\">></span> <span class=\"token number\">100000000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    errors<span class=\"token punctuation\">.</span>sampleFile <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`100MB以下のファイルを添付してください`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> errors<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">// Form描画処理</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">renderForm</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  dirty<span class=\"token punctuation\">,</span>\n  isSubmitting<span class=\"token punctuation\">,</span>\n  setFieldValue<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>form\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"contact\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* Formの名前NetlifyのおけるFormの識別子となる */</span><span class=\"token punctuation\">}</span>\n    method<span class=\"token operator\">=</span><span class=\"token string\">\"POST\"</span>\n    novalidate<span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* Formikで入力チェックするためブラウザの入力チェックはオフ */</span><span class=\"token punctuation\">}</span>\n    data<span class=\"token operator\">-</span>netlify<span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>  <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyでFormを認識させるための属性 */</span><span class=\"token punctuation\">}</span>\n    netlify<span class=\"token operator\">-</span>honeypot<span class=\"token operator\">=</span><span class=\"token string\">\"bot-field\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyでFormを認識させるための属性 */</span><span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Field</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>bot-field<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyFormで必要な値 */</span><span class=\"token punctuation\">}</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Field</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>form-name<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyFormで必要な値 */</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Field</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sampleText<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ErrorMessage</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sampleText<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n\n    <span class=\"token punctuation\">{</span><span class=\"token comment\">/* FormikのFieldタグではなくHTMLのinputタグを使う */</span><span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span>input\n      id<span class=\"token operator\">=</span><span class=\"token string\">\"sampleFile\"</span>\n      name<span class=\"token operator\">=</span><span class=\"token string\">\"sampleFile\"</span>\n      type<span class=\"token operator\">=</span><span class=\"token string\">\"file\"</span>\n      <span class=\"token punctuation\">{</span><span class=\"token comment\">/* ファイル変更時に、手動でFormikの値に設定 */</span><span class=\"token punctuation\">}</span>\n      onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>event <span class=\"token operator\">=></span> <span class=\"token function\">setFieldValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sampleFile\"</span><span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">.</span>currentTarget<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ErrorMessage</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sampleFile<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    \n    <span class=\"token punctuation\">{</span><span class=\"token comment\">/* 送信ボタン */</span><span class=\"token punctuation\">}</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">disabled</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>isSubmitting<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span> isSubmitting <span class=\"token operator\">?</span> <span class=\"token string\">'SUBMITTING...'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'SUBMIT'</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n);\n\n\n// Form用Reactコンポーネント\nexport default () =>  (\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Formik</span>\n    <span class=\"token attr-name\">initialValues</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>initialValues<span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">validate</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleValidate<span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">render</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>renderForm<span class=\"token punctuation\">}</span></span>\n  <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n);</span></code></pre></div>\n<br />\n<h2 id=\"step5-ファイルアップロード--react--formik--非同期送信axios\"><a href=\"#step5-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89--react--formik--%E9%9D%9E%E5%90%8C%E6%9C%9F%E9%80%81%E4%BF%A1axios\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step.5 ファイルアップロード + React + Formik + 非同期送信(Axios)</h2>\n<p>Reactを使っている場合、SPAなので同期通信は極力控えたほうが良いです。\nそのため入力フォームの送信も非同期でやるのが現実的でしょう。\nここでは、<code class=\"language-text\">Formik</code>の<code class=\"language-text\">onSubmit</code>でAxiosを使ってお問い合わせフォームを非同期送信する例を示します。<br/>\n<code class=\"language-text\">Formik</code>タグは<code class=\"language-text\">onSubmit</code>プロパティでサブミット処理を自分で定義できます。\nこの<code class=\"language-text\">onSubmit</code>にて、axiosを使うことで非同期処理が可能です。<br/></p>\n<p><small>大半は前セクションと同じなので差分にフォーカスして説明します</small></p>\n<p>エラーメッセージ用コンポーネントは前回と同じなので割愛します。</p>\n<p>以下フォーム用コンポーネントです。</p>\n<div class=\"gatsby-code-title\">SampleForm.jsx</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> navigate <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gatsby\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Formik<span class=\"token punctuation\">,</span> Field <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'formik'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ErrorMessage <span class=\"token keyword\">from</span> <span class=\"token string\">'./ErrorMessage'</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">\"axios\"</span><span class=\"token punctuation\">;</span>\n</span>\n<span class=\"token comment\">// フォームの値を初期化</span>\n<span class=\"token comment\">/* (略) */</span>\n\n<span class=\"token comment\">// 入力チェック</span>\n<span class=\"token comment\">/* (略) */</span>\n\n<span class=\"token comment\">// サブミット処理</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleSubmit</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>values<span class=\"token punctuation\">,</span> actions<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// FormData作成</span>\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span>  params <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FormData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">\n</span><span class=\"gatsby-highlight-code-line\">  params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'form-name'</span><span class=\"token punctuation\">,</span> values<span class=\"token punctuation\">[</span><span class=\"token string\">'form-name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// for Netlify Forms</span>\n</span><span class=\"gatsby-highlight-code-line\">  params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bot-field'</span><span class=\"token punctuation\">,</span> values<span class=\"token punctuation\">[</span><span class=\"token string\">'bot-field'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// for Netlify Forms</span>\n</span><span class=\"gatsby-highlight-code-line\">  params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sampleText'</span><span class=\"token punctuation\">,</span> values<span class=\"token punctuation\">[</span><span class=\"token string\">'sampleText'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">  params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sampleFile'</span><span class=\"token punctuation\">,</span> values<span class=\"token punctuation\">[</span><span class=\"token string\">'sampleFile'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// Formikの送信中フラグをオンにする</span>\n</span><span class=\"gatsby-highlight-code-line\">  actions<span class=\"token punctuation\">.</span><span class=\"token function\">setSubmitting</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// axiosで非同期にお問い合わせフォームを送信</span>\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">    method<span class=\"token punctuation\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    headers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"application/x-www-form-urlencoded\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    data<span class=\"token punctuation\">:</span> params<span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    url<span class=\"token punctuation\">:</span> <span class=\"token string\">\"/\"</span>\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>res <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// フォーム送信完了後</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// 他画面に遷移（同期遷移ではなくSPAとしての遷移）</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">navigate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/application-complete'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// フォーム内容初期化</span>\n</span><span class=\"gatsby-highlight-code-line\">    actions<span class=\"token punctuation\">.</span><span class=\"token function\">resetForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// 最後にFormikの送信中フラグをオフにする</span>\n</span><span class=\"gatsby-highlight-code-line\">    actions<span class=\"token punctuation\">.</span><span class=\"token function\">setSubmitting</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// なにかしらエラーハンドリング</span>\n</span><span class=\"gatsby-highlight-code-line\">    actions<span class=\"token punctuation\">.</span><span class=\"token function\">setSubmitting</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span><span class=\"gatsby-highlight-code-line\">\n</span>    <span class=\"token comment\">/* (中略) */</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">// Form描画処理</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">renderForm</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  handleSubmit<span class=\"token punctuation\">,</span>\n  dirty<span class=\"token punctuation\">,</span>\n  isSubmitting<span class=\"token punctuation\">,</span>\n  setFieldValue<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>form\n    name<span class=\"token operator\">=</span><span class=\"token string\">\"contact\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* Formの名前NetlifyのおけるFormの識別子となる */</span><span class=\"token punctuation\">}</span>\n    method<span class=\"token operator\">=</span><span class=\"token string\">\"POST\"</span>\n    novalidate<span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* Formikで入力チェックするためブラウザの入力チェックはオフ */</span><span class=\"token punctuation\">}</span>\n    data<span class=\"token operator\">-</span>netlify<span class=\"token operator\">=</span><span class=\"token string\">\"true\"</span>  <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyでFormを認識させるための属性 */</span><span class=\"token punctuation\">}</span>\n    netlify<span class=\"token operator\">-</span>honeypot<span class=\"token operator\">=</span><span class=\"token string\">\"bot-field\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* NetlifyでFormを認識させるための属性 */</span><span class=\"token punctuation\">}</span>\n    onSubmit<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleSubmit<span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">></span>\n    <span class=\"token punctuation\">{</span><span class=\"token comment\">/* (中略) */</span><span class=\"token punctuation\">}</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">// Form用Reactコンポーネント</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>  <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Formik</span>\n    <span class=\"token attr-name\">initialValues</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>initialValues<span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">validate</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleValidate<span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">render</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>renderForm<span class=\"token punctuation\">}</span></span>\n    <span class=\"token attr-name\">onSubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleSubmit<span class=\"token punctuation\">}</span></span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br />\n<p>これでようやくNetlify FormsにおいてReactを使って非同期でファイルアップロードできるようになりました！</p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>自分の復習も兼ねてステップごとに実装方法をご紹介しました。\nAngularとVueで実装する場合も今回紹介した実装と似たような感じになると思います。\n参考にしてみてください🍅</p>","fields":{"slug":"/async-file-upload-in-netlify-forms-with-react-formik-axios","title":"Netlify Formsでファイルを非同期アップロード with React + Formik + Axios","date":"2019-06-01T22:00:00.000-07:00","excerpt":"なにこれNetlify FormsはNetlifyにホストしている静的サイトでお問い合わせフォームを作れる機能です。DBを用意しなくても、お問い合わせフォーム送信結果はNetlify側で保持しれくれます。Netlifyの管理画面からCSVダ...","tags":["Netlify","NetlifyForms","React","Fromik","Axios"],"keywords":["Netlify"],"thumbnail":"thumbnail/2019/06/async-file-upload-in-netlify-forms-with-react-formik-axios.png"}},{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>Gatsbyで画像を扱う場合<a href=\"https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-image\">gatsby-image</a>を使うとイイ感じに最適化してくれます。\nWebサイトのリポジトリ内の画像については<code class=\"language-text\">gatsby-config.js</code>で簡単に設定できますが、<strong>今回はビルド時に動的に取得する外部画像に対して設定する方法をご紹介します。</strong></p>\n<h2 id=\"実装方法\"><a href=\"#%E5%AE%9F%E8%A3%85%E6%96%B9%E6%B3%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装方法</h2>\n<h3 id=\"step1-外部画像ファイルノード生成\"><a href=\"#step1-%E5%A4%96%E9%83%A8%E7%94%BB%E5%83%8F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%8E%E3%83%BC%E3%83%89%E7%94%9F%E6%88%90\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step1. 外部画像ファイルノード生成</h3>\n<p>Gatsbyの<a href=\"\">gatsby-source-filesystem</a>では、外部画像を扱うためのAPI(<code class=\"language-text\">createRemoteFileNode</code>)が用意されています。\nコチラを<code class=\"language-text\">gatsby-node.js</code>の<code class=\"language-text\">sourceNodes</code>で呼び出せば外部画像にgatsby-imageを適用できます。\nあと、ちょっとしたハックとして、Reactコンポーネント側で他ファイルノードと区別できるように、ノード生成時に識別子を付けましょう。これは後述する外部画像表示用コンポーネントで使うためのものです。</p>\n<div class=\"gatsby-code-title\">gatsby-node.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createRemoteFileNode <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`gatsby-source-filesystem`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// sourceNodesにて外部画像のファイルノードを作成する</span>\nexports<span class=\"token punctuation\">.</span>sourceNodes <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> actions<span class=\"token punctuation\">,</span> createNodeId<span class=\"token punctuation\">,</span> cache<span class=\"token punctuation\">,</span> store <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* (中略) */</span>\n\n  <span class=\"token comment\">// ここでは外部画像のURLの配列を処理するサンプルを示す</span>\n  <span class=\"token keyword\">await</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span>sampleImageUrls<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> sampleImageUrl <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// createRemoteFileNodeで外部の画像のファイルノードを作成する</span>\n    <span class=\"token keyword\">const</span> fileNode <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">createRemoteFileNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      url<span class=\"token punctuation\">:</span> sampleImageUrl<span class=\"token punctuation\">,</span>\n      cache<span class=\"token punctuation\">,</span>\n      store<span class=\"token punctuation\">,</span>\n      createNode<span class=\"token punctuation\">:</span> actions<span class=\"token punctuation\">.</span>createNode<span class=\"token punctuation\">,</span>\n      createNodeId<span class=\"token punctuation\">:</span> createNodeId<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 他ファイルノードと区別するための識別子を付与</span>\n    <span class=\"token keyword\">await</span> actions<span class=\"token punctuation\">.</span><span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">:</span> fileNode<span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'SampleImage'</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> <span class=\"token string\">'true'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// メタ情報として画像のURLを付与</span>\n    <span class=\"token keyword\">await</span> actions<span class=\"token punctuation\">.</span><span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">:</span> fileNode<span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'link'</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> sampleImageUrl<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> fileNode<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/* (中略) */</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h3 id=\"step2-外部画像表示用reactコンポーネント作成\"><a href=\"#step2-%E5%A4%96%E9%83%A8%E7%94%BB%E5%83%8F%E8%A1%A8%E7%A4%BA%E7%94%A8react%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E4%BD%9C%E6%88%90\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step2. 外部画像表示用Reactコンポーネント作成</h3>\n<p>外部画像のファイルノードを生成できたら、\n今度はReactコンポーネント側で、それに<code class=\"language-text\">gatsby-iamge</code>を適用して表示します。\nGraphQLのクエリで、ファイルノードを生成時に付与した識別子を使い、すべてのファイルノードから外部画像だけを抽出するようにしましょう。</p>\n<div class=\"gatsby-code-title\">sample-image.jsx</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> GatsbyImage <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby-image'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> StaticQuery<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// OGP画像のURLを引数に取る</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> url <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n</span>  <span class=\"token operator\">&lt;</span>StaticQuery\n    query<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>graphql<span class=\"token template-string\"><span class=\"token string\">`\n      query {\n        allFile(\n          # Gatsby Buildで付与した識別子をもとに\n          # 全ファイルからOPG画像のみ抽出\n          filter: {fields: {SampleImage: {eq: \"true\"}}}\n        ){\n          edges {\n            node {\n              childImageSharp {\n                resolutions {\n                  ...GatsbyImageSharpResolutions\n                }\n              }\n              id\n              fields {\n                # 一応メタ情報も取得する\n                SampleImage\n                link\n              }\n            }\n          }\n        }\n      }\n    `</span></span><span class=\"token punctuation\">}</span>\n    render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>data <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// OGP画像リストの中から、コンポーネント引数で指定したURLの画像を抽出する</span>\n</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">const</span> targetEdge <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>allFile<span class=\"token punctuation\">.</span>edges<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>edge <span class=\"token operator\">=></span> edge<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>fields<span class=\"token punctuation\">.</span>link <span class=\"token operator\">===</span> url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span>\n      <span class=\"token comment\">// 画像が取得できた場合のみgatsby-imageのコンポーネントを返す</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        targetEdge <span class=\"token operator\">&amp;&amp;</span> targetEdge<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>childImageSharp\n          <span class=\"token operator\">&amp;&amp;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>GatsbyImage</span> <span class=\"token attr-name\">resolutions</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>targetEdge<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>childImageSharp<span class=\"token punctuation\">.</span>resolutions<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n          <span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<h3 id=\"step3-上記で作成したコンポーネントの呼び出し\"><a href=\"#step3-%E4%B8%8A%E8%A8%98%E3%81%A7%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%81%AE%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step3. 上記で作成したコンポーネントの呼び出し</h3>\n<p>最後に上記コンポーネントの呼び出します。以下のように外部画像のURLを指定してあげましょう。</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SampleImage</span> <span class=\"token attr-name\">url</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>SampleImageUrl<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<br/>\n<p>これで外部画像に<code class=\"language-text\">gatsby-image</code>を適用してイイ感じに表示できます！</p>\n<h2 id=\"例：webサイトurlからogp画像を取得する場合\"><a href=\"#%E4%BE%8B%EF%BC%9Aweb%E3%82%B5%E3%82%A4%E3%83%88url%E3%81%8B%E3%82%89ogp%E7%94%BB%E5%83%8F%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>例：WEBサイトURLからOGP画像を取得する場合</h2>\n<p>実用的な例として、複数のWebサイトのOGP画像を<code class=\"language-text\">gatsby-image</code>として扱う方法をご紹介します。</p>\n<div class=\"gatsby-code-title\">gatsby-node.js</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> axios <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'axios'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> cheerio <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cheerio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createRemoteFileNode <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`gatsby-source-filesystem`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// sourceNodesにて外部画像のファイルノードを作成する</span>\nexports<span class=\"token punctuation\">.</span>sourceNodes <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> actions<span class=\"token punctuation\">,</span> createNodeId<span class=\"token punctuation\">,</span> cache<span class=\"token punctuation\">,</span> store <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* (中略) */</span>\n\n\n  <span class=\"token comment\">// WEBサイトURLからHTMLを取得してOGPを抽出</span>\n  <span class=\"token keyword\">const</span> ogpImageUrls <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Promise.allで処理するとリクエスト多可で503になるのでfor文で一件ずつ処理する</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> postUrl <span class=\"token keyword\">of</span> postUrls<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    \n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>postUrl<span class=\"token punctuation\">.</span>link<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      headers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'something different'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// cheerioを使ってHMTLからOGP画像URLを抽出</span>\n    <span class=\"token keyword\">let</span> ogpImageUrl<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> $ <span class=\"token operator\">=</span> cheerio<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'head meta'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">each</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> el<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> property <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'property'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'content'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>property <span class=\"token operator\">===</span> <span class=\"token string\">'og:image'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        ogpImageUrls<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>ogpImageUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 取得したOGP画像URLをもとにファイルノードを生成</span>\n  <span class=\"token keyword\">await</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span>ogpImageUrls<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> imageUrl <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> fileNode <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">createRemoteFileNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      url<span class=\"token punctuation\">:</span> imageUrl<span class=\"token punctuation\">,</span>\n      cache<span class=\"token punctuation\">,</span>\n      store<span class=\"token punctuation\">,</span>\n      createNode<span class=\"token punctuation\">:</span> actions<span class=\"token punctuation\">.</span>createNode<span class=\"token punctuation\">,</span>\n      createNodeId<span class=\"token punctuation\">:</span> createNodeId<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 他ファイルノードと区別するための識別子を付与</span>\n    <span class=\"token keyword\">await</span> actions<span class=\"token punctuation\">.</span><span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">:</span> fileNode<span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'OgpImage'</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> <span class=\"token string\">'true'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// メタ情報として画像のURLを付与</span>\n    <span class=\"token keyword\">await</span> actions<span class=\"token punctuation\">.</span><span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">:</span> fileNode<span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'link'</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> imageUrl<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> fileNode<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<p>Reactのコンポーネントの定義、呼び出し側定義は<a href=\"#%E5%AE%9F%E8%A3%85%E6%96%B9%E6%B3%95\">実装方法</a>で紹介した内容とほぼ同じなので割愛します。</p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>今回の方法を使えば、外部から画像をかき集めてリッチなWebサイトを構築する場合でも、Gatsby側でブラウザ表示を最適化してくれて、画面表示が遅くなる心配もありません。\n是非参考にしてみてください🍅</p>\n<h2 id=\"参考\"><a href=\"#%E5%8F%82%E8%80%83\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://www.wildsmithstudio.com/blog/remote-images-with-gatsby/\">Wrangling remote images with Gatsby</a></li>\n<li><a href=\"https://stackoverflow.com/questions/52612936/gatsby-fetching-remote-images-with-createremotefilenode\">graphql - Gatsby - fetching remote images with createRemoteFileNode - Stack Overflow</a></li>\n</ul>","fields":{"slug":"/gatsby-image-of-remote-in-building-by-using-create-remote-file-node","title":"Gatsbyにおける外部取得画像へのgatsby-image適用方法","date":"2019-06-01T21:30:00.000-07:00","excerpt":"なにこれGatsbyで画像を扱う場合gatsby-imageを使うとイイ感じに最適化してくれます。Webサイトのリポジトリ内の画像についてはgatsby-config.jsで簡単に設定できますが、今回はビルド時に動的に取得する外部画像に対し...","tags":["Gatsby","gatsby-image"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2019/06/gatsby-image-of-remote-in-building-by-using-create-remote-file-node.png"}},{"html":"<h2 id=\"なにこれ\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>GatsbyでWebサイトを作るときに、ブログや職種紹介など2種類以上のマークダウンファイルを管理する場合があると思います。通常だとMarkdownRemarkNodeの<code class=\"language-text\">fileAbsolutePath</code>でしか両者のマークダウンファイルを見分ける術がありませんが、ここではもっとスマートなやり方を紹介します。簡単に言うとFileNodeの<code class=\"language-text\">sourceInstanceName</code>をMarkdownRemarkNodeに引き継ぐことにより、GraphQLのfilterで簡単に区別できるという方法です。</p>\n<h2 id=\"実装方法\"><a href=\"#%E5%AE%9F%E8%A3%85%E6%96%B9%E6%B3%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装方法</h2>\n<h3 id=\"step1-マークダウンファイルのflenodeでsourceinstancenameを定義\"><a href=\"#step1-%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%80%E3%82%A6%E3%83%B3%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AEflenode%E3%81%A7sourceinstancename%E3%82%92%E5%AE%9A%E7%BE%A9\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step1. マークダウンファイルのFleNodeでsourceInstanceNameを定義</h3>\n<p>マークダウンファイルの読み込み設定はgatsby-config.jsで以下のようにします。\n<code class=\"language-text\">name</code>を付けることでマークダウンファイルのFileNodeにおいて<code class=\"language-text\">sourceInstanceName</code>が設定できます。</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* (中略) */</span>\n\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">/* (中略) */</span>\n\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token punctuation\">:</span> <span class=\"token string\">'gatsby-source-filesystem'</span><span class=\"token punctuation\">,</span>\n      options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token comment\">// オプションでname(FileNodeにおけるsourceInstanceName)を指定</span>\n</span><span class=\"gatsby-highlight-code-line\">        name<span class=\"token punctuation\">:</span> <span class=\"token string\">'posts'</span><span class=\"token punctuation\">,</span>\n</span>        path<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/content/posts`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token punctuation\">:</span> <span class=\"token string\">'gatsby-source-filesystem'</span><span class=\"token punctuation\">,</span>\n      options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token comment\">// オプションでname(FileNodeにおけるsourceInstanceName)を指定</span>\n</span><span class=\"gatsby-highlight-code-line\">        name<span class=\"token punctuation\">:</span> <span class=\"token string\">'jobs'</span><span class=\"token punctuation\">,</span>\n</span>        path<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/content/jobs`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'gatsby-transformer-remark'</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token comment\">/* (中略) */</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">/* (中略) */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<h3 id=\"step2-filenodeのnameをmarkdownfilenodeに引継ぐ\"><a href=\"#step2-filenode%E3%81%AEname%E3%82%92markdownfilenode%E3%81%AB%E5%BC%95%E7%B6%99%E3%81%90\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step2. FileNodeのnameをMarkdownFileNodeに引継ぐ</h3>\n<p>何もしないとFileNodeの<code class=\"language-text\">sourceInstanceName</code>はMarkdownRemarkNodeに引き継がれません。\nそのため<code class=\"language-text\">gatsby-node.js</code>で引継ぎ処理を実装します。</p>\n<div class=\"gatsby-code-title\">gatsby-node.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onCreateNode</span>  <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">,</span> boundActionCreators<span class=\"token punctuation\">,</span> getNode <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createNodeField <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> boundActionCreators\n\n  <span class=\"token comment\">// MarkdownRemarkNodeの場合のみ処処</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node <span class=\"token operator\">&amp;&amp;</span> node<span class=\"token punctuation\">.</span>internal <span class=\"token operator\">&amp;&amp;</span> node<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'MarkdownRemark'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// 親のFileNodeを取得して</span>\n    <span class=\"token keyword\">const</span> parent <span class=\"token operator\">=</span> <span class=\"token function\">getNode</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// gatsby-config.jsで設定したFileNodeのsourceInstanceNameを</span>\n    <span class=\"token comment\">// MarkdownRemarkのフィールドに引き継ぐ</span>\n    <span class=\"token comment\">// 名前はMarkdownRemarkの他プロパティとかぶらないようにcollectionとしている</span>\n    <span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">,</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'collection'</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> parent<span class=\"token punctuation\">.</span>sourceInstanceName<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<h3 id=\"step3-graphqlでnameをもとにマークダウンを区別\"><a href=\"#step3-graphql%E3%81%A7name%E3%82%92%E3%82%82%E3%81%A8%E3%81%AB%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%80%E3%82%A6%E3%83%B3%E3%82%92%E5%8C%BA%E5%88%A5\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step3. GraphQLでnameをもとにマークダウンを区別</h3>\n<p>GraphQLではcollectionフィールドで、それぞれを区別します。</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> <span class=\"token punctuation\">{</span>\n  allMarkdownRemark<span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\"># collectionにて記事のNodeのみ抽出</span>\n</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token attr-name\">filter</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">fields</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">collection</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">eq</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"posts\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n</span>  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    edges <span class=\"token punctuation\">{</span>\n      node <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\"># (中略)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>簡単ですがGatsbyで良く困る事例の1つを紹介しました。\nGatsbyは多くのフックポイントを設けているので、今回のよう、やろうと思えば結構いろんなことができます🍅</p>\n<h2 id=\"参考\"><a href=\"#%E5%8F%82%E8%80%83\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://github.com/gatsbyjs/gatsby/issues/1634\">Question: How do I query based on gatsby-source-filesystem name? · Issue #1634 · gatsbyjs/gatsby</a></li>\n</ul>","fields":{"slug":"/how-to-distinct-2-kinds-of-markdown-in-gatsby","title":"Gatsbyで2種類のマークダウンファイルの区別する方法","date":"2019-06-01T21:00:00.000-07:00","excerpt":"なにこれGatsbyでWebサイトを作るときに、ブログや職種紹介など2種類以上のマークダウンファイルを管理する場合があると思います。通常だとMarkdownRemarkNodeのfileAbsolutePathでしか両者のマークダウンファイ...","tags":["Gatsby"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2019/06/how-to-distinct-2-kinds-of-markdown-in-gatsby.png"}}],"previous":{"fields":{"slug":"/41febdc6-bf5d-50b8-a695-3c017b8f766a/","title":"10分でできる！ @ngrx/storeチュートリアル with @ngrx/schematics","date":"2018-07-30T18:01:02+09:00","excerpt":"なにこれAngularで状態管理する方法をざっくり把握するためのチュートリアルです。@ngrx/storeベースの簡単なアプリ（数をカウントするアプリ）を作成します。作るだけなら10分程度で出来上がるので、とりあえず手を動かしてngrxを最...","tags":["Angular","angular-cli","ngrx","Angular6","Qiita"],"keywords":["Angular"],"thumbnail":""},"id":"41febdc6-bf5d-50b8-a695-3c017b8f766a","title":"10分でできる！ @ngrx/storeチュートリアル with @ngrx/schematics","rendered_body":"\n<h2>\n<span id=\"なにこれ\" class=\"fragment\"></span><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\"><i class=\"fa fa-link\"></i></a>なにこれ</h2>\n\n<p>Angularで状態管理する方法をざっくり把握するためのチュートリアルです。<a href=\"http://ngrx.github.io/\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/store</a>ベースの簡単なアプリ（数をカウントするアプリ）を作成します。作るだけなら10分程度で出来上がるので、とりあえず手を動かしてngrxを最低限を把握したい人向けです。ソースコードも<a href=\"https://github.com/Takumon/ngrx-tutorial/tree/with-ngrx\" rel=\"nofollow noopener\" target=\"_blank\">GitHub</a>に置いているので参考にしてください。<br>\nngrxを使うとボイラープレートが非常に多くなりますが、今回のチュートリアルでは<a href=\"https://github.com/ngrx/platform/tree/master/docs/schematics\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/schematics</a> を使い、ボイラープレートを自動生成することで極力手間を省いています。</p>\n\n<h2>\n<span id=\"アプリの完成イメージ\" class=\"fragment\"></span><a href=\"#%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E5%AE%8C%E6%88%90%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8\"><i class=\"fa fa-link\"></i></a>アプリの完成イメージ</h2>\n\n<ul>\n<li>\n<code>+</code>ボタンをクリックするとCountが+1される</li>\n<li>\n<code>-</code> ボタンをクリックするとCountが- 1される\n<a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2F8e6f645e-a734-db8d-ec6b-144c0fdee1b0.gif?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=16be2e343ffc0360aede0ef0577a348f\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2F8e6f645e-a734-db8d-ec6b-144c0fdee1b0.gif?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=16be2e343ffc0360aede0ef0577a348f\" alt=\"counterapp.gif\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/8e6f645e-a734-db8d-ec6b-144c0fdee1b0.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2F8e6f645e-a734-db8d-ec6b-144c0fdee1b0.gif?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=920759101c278aecc6a4f3a339eeed60 1x\" loading=\"lazy\"></a>\n</li>\n</ul>\n\n<h2>\n<span id=\"やることやらないこと\" class=\"fragment\"></span><a href=\"#%E3%82%84%E3%82%8B%E3%81%93%E3%81%A8%E3%82%84%E3%82%89%E3%81%AA%E3%81%84%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>やること/やらないこと</h2>\n\n<ul>\n<li>やる\n\n<ul>\n<li>\n<a href=\"https://github.com/ngrx/platform/blob/master/docs/store/README.md\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/store</a>の使い方\n\n<ul>\n<li>Storeの作り方</li>\n<li>Stateの作り方</li>\n<li>Reducerの作り方</li>\n<li>Actionsの作り方</li>\n</ul>\n</li>\n<li>\n<a href=\"https://github.com/ngrx/platform/blob/master/docs/schematics/README.md\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/schematics</a>の使い方\n\n<ul>\n<li>オプションなどを使い極力手間を減らす方法</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>やらない （下記を理解するには<a href=\"#%E5%8F%82%E8%80%83\">参考</a>のQiitaの記事を見てください。）\n\n<ul>\n<li>状態管理の説明</li>\n<li>Reduxの説明</li>\n<li>\n<a href=\"https://github.com/ngrx/platform/blob/master/docs/router-store/README.md\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/router-store</a>の使い方</li>\n<li>\n<a href=\"https://github.com/ngrx/platform/blob/master/docs/entity/README.md\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/entity</a>の使い方</li>\n<li>\n<a href=\"https://github.com/ngrx/platform/blob/master/docs/effects/README.md\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/effect</a>の使い方<br>\n</li>\n</ul>\n</li>\n</ul>\n\n<h2>\n<span id=\"チュートリアル概要\" class=\"fragment\"></span><a href=\"#%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB%E6%A6%82%E8%A6%81\"><i class=\"fa fa-link\"></i></a>チュートリアル概要</h2>\n\n<p>段階を踏んで、ステップごとに動作確認しながら作成していきます。<br>\n各ステップ終了時点のソースコードはGitHubに用意しています。参考にしてください。<br>\n大部分はSchematicsを使ってngコマンドでボイラープレートを自動生成し、メイン部分のみ実装という感じです。</p>\n\n<ol>\n<li>Angularアプリを生成（1分）  ※<a href=\"https://github.com/Takumon/ngrx-tutorial/tree/generated-with-angualr-cli\" rel=\"nofollow noopener\" target=\"_blank\">終了時点のソース</a>\n</li>\n<li>ngrxを使わずにカウント処理実装（2分）※<a href=\"https://github.com/Takumon/ngrx-tutorial/tree/no-ngrx\" rel=\"nofollow noopener\" target=\"_blank\">終了時点のソース</a>\n</li>\n<li>ngrxインストール、初期設定（2分） ※<a href=\"https://github.com/Takumon/ngrx-tutorial/tree/after-ngrx-setting\" rel=\"nofollow noopener\" target=\"_blank\">終了時点のソース</a>\n</li>\n<li>ngrxを使ってカウント処理実装（5分） ※<a href=\"https://github.com/Takumon/ngrx-tutorial/tree/with-ngrx\" rel=\"nofollow noopener\" target=\"_blank\">終了時点のソース</a>\n</li>\n</ol>\n\n<h2>\n<span id=\"前提条件\" class=\"fragment\"></span><a href=\"#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\"><i class=\"fa fa-link\"></i></a>前提条件</h2>\n\n<ul>\n<li>\n<a href=\"https://nodejs.org/ja/\" rel=\"nofollow noopener\" target=\"_blank\">Node.js</a>インストール済み</li>\n<li>\n<a href=\"https://cli.angular.io/\" rel=\"nofollow noopener\" target=\"_blank\">Angular CLI</a>グローバルインストール済み</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>npm i <span class=\"nt\">-g</span> @angular/cli\n</pre></div></div>\n\n<ul>\n<li>\n<a href=\"https://cli.angular.io/\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/schematics</a>グローバルインストール済み</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>npm i <span class=\"nt\">-g</span> @ngrx/schematics\n</pre></div></div>\n\n<h2>\n<span id=\"1-angularアプリを生成1分\" class=\"fragment\"></span><a href=\"#1-angular%E3%82%A2%E3%83%97%E3%83%AA%E3%82%92%E7%94%9F%E6%88%901%E5%88%86\"><i class=\"fa fa-link\"></i></a>1. Angularアプリを生成（1分）</h2>\n\n<ul>\n<li>ng newコマンドを実行します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng new ngrx-tutorial\n</pre></div></div>\n\n<ul>\n<li>生成されたアプリ配下に移動し、一旦Webアプリを立ち上げてみます。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span><span class=\"nb\">cd </span>ngrx-tutorial\n<span class=\"gp\">$</span><span class=\"w\"> </span>ng serve <span class=\"nt\">-o</span>\n</pre></div></div>\n\n<ul>\n<li>ブラウザが起動し下記のような画面が表示されたら成功です。\n<a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2F5c19c3f0-104a-3ef2-a33d-315c0f0a3f9f.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=41591f1d8b4ef47d30f6e0c4c497dbcd\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2F5c19c3f0-104a-3ef2-a33d-315c0f0a3f9f.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=41591f1d8b4ef47d30f6e0c4c497dbcd\" alt=\"スクリーンショット 2018-07-30 1.03.59.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/5c19c3f0-104a-3ef2-a33d-315c0f0a3f9f.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2F5c19c3f0-104a-3ef2-a33d-315c0f0a3f9f.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6383e6e198e4d925b38ced18509cf4c0 1x\" loading=\"lazy\"></a>\n</li>\n</ul>\n\n<h2>\n<span id=\"2-ngrxを使わずにカウント処理実装2分\" class=\"fragment\"></span><a href=\"#2-ngrx%E3%82%92%E4%BD%BF%E3%82%8F%E3%81%9A%E3%81%AB%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E5%87%A6%E7%90%86%E5%AE%9F%E8%A3%852%E5%88%86\"><i class=\"fa fa-link\"></i></a>2. ngrxを使わずにカウント処理実装（2分）</h2>\n\n<p>カウント処理の資産は全て<code>src/app/counter</code>フォルダ配下に作成します。<br>\nまずはコマンドラインからボイラープレートを作成し、その後カウント処理を実装します。</p>\n\n<h3>\n<span id=\"ボイラープレート作成\" class=\"fragment\"></span><a href=\"#%E3%83%9C%E3%82%A4%E3%83%A9%E3%83%BC%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E4%BD%9C%E6%88%90\"><i class=\"fa fa-link\"></i></a>ボイラープレート作成</h3>\n\n<ul>\n<li>カウント処理関連資産をまとめるモジュールを作成します。\n\n<ul>\n<li>このモジュールをアプリ全体のモジュールに登録するため<code>--module</code>オプションを指定します。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng g module counter <span class=\"nt\">--module</span><span class=\"o\">=</span>app.module.ts\n</pre></div></div>\n\n<ul>\n<li>カウント処理用のコンポーネントを作成します。\n\n<ul>\n<li>上記で作成したモジュールにコンポーネントを登録するため<code>--module</code>オプションを指定します。</li>\n<li>最終的にアプリ全体のモジュールにコンポーネントを登録するため<code>--export</code>オプションを指定します。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng g component counter <span class=\"nt\">--module</span><span class=\"o\">=</span>counter/counter.module.ts <span class=\"nt\">--export</span>\n</pre></div></div>\n\n<ul>\n<li>\n<code>app.component.html</code>修正し、作成したカウント処理用のコンポーネントを呼び出すようにします。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"html\">\n<div class=\"code-lang\"><span class=\"bold\">app.component.html</span></div>\n<div class=\"highlight\"><pre><span class=\"nt\">&lt;app-counter&gt;&lt;/app-counter&gt;</span>\n</pre></div>\n</div>\n\n<ul>\n<li>一旦ここまででWebアプリを立ち上げてみます。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng serve <span class=\"nt\">-o</span>\n</pre></div></div>\n\n<ul>\n<li>ブラウザが起動し、下記画面が表示されます。開発者ツールでエラーがなければ成功です。</li>\n</ul>\n\n<p><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2F772a7501-34a7-3ef1-6666-d13e79382ce6.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f0cb5e50637de92322b41d838dd12d57\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2F772a7501-34a7-3ef1-6666-d13e79382ce6.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f0cb5e50637de92322b41d838dd12d57\" alt=\"スクリーンショット 2018-07-30 1.06.30.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/772a7501-34a7-3ef1-6666-d13e79382ce6.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2F772a7501-34a7-3ef1-6666-d13e79382ce6.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2964fe5a2bc7955a10ef2eadf237b73e 1x\" loading=\"lazy\"></a></p>\n\n<h3>\n<span id=\"処理実装\" class=\"fragment\"></span><a href=\"#%E5%87%A6%E7%90%86%E5%AE%9F%E8%A3%85\"><i class=\"fa fa-link\"></i></a>処理実装</h3>\n\n<ul>\n<li>カウント用コンポーネントで実際の処理を記述します。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"ts\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/counter/counter.component.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">Component</span><span class=\"p\">,</span> <span class=\"nx\">OnInit</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">@angular/core</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n\n<span class=\"p\">@</span><span class=\"nd\">Component</span><span class=\"p\">({</span>\n  <span class=\"na\">selector</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">app-counter</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n  <span class=\"na\">templateUrl</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">./counter.component.html</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n  <span class=\"na\">styleUrls</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">./counter.component.css</span><span class=\"dl\">'</span><span class=\"p\">]</span>\n<span class=\"p\">})</span>\n<span class=\"k\">export</span> <span class=\"kd\">class</span> <span class=\"nx\">CounterComponent</span> <span class=\"kr\">implements</span> <span class=\"nx\">OnInit</span> <span class=\"p\">{</span>\n  <span class=\"nx\">count</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n\n  <span class=\"kd\">constructor</span><span class=\"p\">()</span> <span class=\"p\">{</span> <span class=\"p\">}</span>\n\n  <span class=\"nx\">ngOnInit</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"nx\">increment</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n    <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">count</span> <span class=\"o\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">count</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">;</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"nx\">decrement</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n    <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">count</span> <span class=\"o\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">count</span> <span class=\"o\">-</span> <span class=\"mi\">1</span><span class=\"p\">;</span>\n  <span class=\"p\">}</span>\n\n<span class=\"p\">}</span>\n\n</pre></div>\n</div>\n\n<div class=\"code-frame\" data-lang=\"html\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/counter/counter.component.html</span></div>\n<div class=\"highlight\"><pre><span class=\"nt\">&lt;button</span> <span class=\"na\">(click)=</span><span class=\"s\">\"increment()\"</span><span class=\"nt\">&gt;</span>+<span class=\"nt\">&lt;/button&gt;</span>\n<span class=\"nt\">&lt;button</span> <span class=\"na\">(click)=</span><span class=\"s\">\"decrement()\"</span><span class=\"nt\">&gt;</span>-<span class=\"nt\">&lt;/button&gt;</span>\n<span class=\"nt\">&lt;div&gt;</span>Count: {{count}}<span class=\"nt\">&lt;/div&gt;</span>\n</pre></div>\n</div>\n\n<ul>\n<li>ここまででWebアプリを立ち上げてみます。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng serve <span class=\"nt\">-o</span>\n</pre></div></div>\n\n<ul>\n<li>ブラウザが起動し下記画面が表示されます。<code>+</code>,<code>-</code>ボタンをクリックすると数字が増えたり減ったりした、開発者ツールでもエラーがなければ成功です。</li>\n</ul>\n\n<p><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2Fd506bc6e-cdce-4d00-1109-2af9f4780663.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a71cb7de15695ea2bec74d39f85be6c2\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2Fd506bc6e-cdce-4d00-1109-2af9f4780663.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a71cb7de15695ea2bec74d39f85be6c2\" alt=\"スクリーンショット 2018-07-30 0.59.12.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/d506bc6e-cdce-4d00-1109-2af9f4780663.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2Fd506bc6e-cdce-4d00-1109-2af9f4780663.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2b97ddf9f63fdc1ed9c4c0c36d4330e2 1x\" loading=\"lazy\"></a></p>\n\n<h2>\n<span id=\"3-ngrxインストール初期設定2分\" class=\"fragment\"></span><a href=\"#3-ngrx%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E5%88%9D%E6%9C%9F%E8%A8%AD%E5%AE%9A2%E5%88%86\"><i class=\"fa fa-link\"></i></a>3. ngrxインストール、初期設定（2分）</h2>\n\n<p>@ngrx/storeをアプリに導入し、初期設定をします。</p>\n\n<ul>\n<li>下記ライブラリをインストールします。\n\n<ul>\n<li>\n<code>@ngrx/schematics</code>\n\n<ul>\n<li>Angualr CLIでngrxの雛形を作るためのライブラリ</li>\n</ul>\n</li>\n<li>\n<code>@ngrx/store</code>\n\n<ul>\n<li>ngrxでStore,Reducer,Actionを使うためのライブラリ</li>\n</ul>\n</li>\n<li>\n<code>@ngrx/store-devtools</code>\n\n<ul>\n<li>強力なデバッカを使えるようにするためのライブラリ</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>npm i <span class=\"nt\">-D</span> @ngrx/schematics\n<span class=\"gp\">$</span><span class=\"w\"> </span>npm i <span class=\"nt\">-s</span> @ngrx/store\n<span class=\"gp\">$</span><span class=\"w\"> </span>npm i <span class=\"nt\">-s</span> @ngrx/store-devtools\n</pre></div></div>\n\n<p>*<code>@ngrx/schematics</code>をデフォルトのSchematicsに追加します（コマンドラインでngrxのボイラープレート生成時に<code>@ngrx/schematics</code>の指定を省略できるようにするためです。）</p>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng config cli.defaultCollection @ngrx/schematics\n</pre></div></div>\n\n<ul>\n<li>上記を実行すると、<code>angular.json</code>にこのような設定が追加されます。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"json\">\n<div class=\"code-lang\"><span class=\"bold\">angular.json</span></div>\n<div class=\"highlight\"><pre><span class=\"w\">  </span><span class=\"nl\">\"defaultProject\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"ngrx-tutorial\"</span><span class=\"err\">,</span><span class=\"w\">\n  </span><span class=\"nl\">\"cli\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"defaultCollection\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"@ngrx/schematics\"</span><span class=\"w\">\n  </span><span class=\"p\">}</span><span class=\"w\">\n</span></pre></div>\n</div>\n\n<ul>\n<li>ルートのStoreを作成します。\n\n<ul>\n<li>\n<code>src/app/state</code>配下に生成したいので<code>--statePath</code>オプションを指定します。</li>\n<li>アプリ全体のモジュールに登録したいので<code>--module</code>オプションを指定します。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng g store state <span class=\"nt\">--statePath</span> state <span class=\"nt\">--root</span> <span class=\"nt\">--module</span> app.module.ts\n</pre></div></div>\n\n<ul>\n<li>上記コマンドで更新した<code>src/app/app.module.ts</code>で<code>environment</code>のimport文のパスでエラーが出ている場合は修正してください。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">app/src/app.module.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"gd\">- import { environment } from '../../environments/environment';\n</span><span class=\"gi\">+ import { environment } from '../environments/environment';\n</span></pre></div>\n</div>\n\n<ul>\n<li>ここまででWebアプリを立ち上げてみます。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng serve <span class=\"nt\">-o</span>\n</pre></div></div>\n\n<ul>\n<li>手順2の動作確認時と同様の挙動になります、開発者ツールでもエラーがなければ成功です。</li>\n</ul>\n\n<p><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2Fd506bc6e-cdce-4d00-1109-2af9f4780663.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a71cb7de15695ea2bec74d39f85be6c2\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2Fd506bc6e-cdce-4d00-1109-2af9f4780663.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a71cb7de15695ea2bec74d39f85be6c2\" alt=\"スクリーンショット 2018-07-30 0.59.12.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/d506bc6e-cdce-4d00-1109-2af9f4780663.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2Fd506bc6e-cdce-4d00-1109-2af9f4780663.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2b97ddf9f63fdc1ed9c4c0c36d4330e2 1x\" loading=\"lazy\"></a></p>\n\n<h2>\n<span id=\"4-ngrxを使ってカウント処理実装5分\" class=\"fragment\"></span><a href=\"#4-ngrx%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E5%87%A6%E7%90%86%E5%AE%9F%E8%A3%855%E5%88%86\"><i class=\"fa fa-link\"></i></a>4. ngrxを使ってカウント処理実装（5分）</h2>\n\n<p>ここからは実際にStore、Reducer、Actionを作成し、カウント処理の値をStoreに移行します。<br>\nここで作成する資産はカウンター処理に閉じたものなので、<code>src/app/counter/state</code>配下に作成します。<br>\nまた<code>@ngrx/schemetics</code>のデフォルトではReducer、Actionなどの資産が、役割ごとにフォルダ分けされてしまいますが、１フォルダに集約したほうがソースが修正しやすいので、今回は全て<code>src/app/counter/state</code>の直下に作成します。</p>\n\n<h3>\n<span id=\"ボイラープレート生成\" class=\"fragment\"></span><a href=\"#%E3%83%9C%E3%82%A4%E3%83%A9%E3%83%BC%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E7%94%9F%E6%88%90\"><i class=\"fa fa-link\"></i></a>ボイラープレート生成</h3>\n\n<ul>\n<li>Store\n\n<ul>\n<li>\n<code>src/app/counter/state</code>直下に作成するため<code>--statePath</code>オプションを指定します。</li>\n<li>カウント処理関連モジュールに登録したいので<code>--module</code>オプションを指定します。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng g store counter/counter <span class=\"nt\">--statePath</span> state <span class=\"nt\">--module</span> counter.module.ts\n</pre></div></div>\n\n<ul>\n<li>Reducer\n\n<ul>\n<li>上記で作成したStoreに本Reducerを登録したいため<code>--reducers</code>オプションを指定します。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng g reducer counter/state/counter <span class=\"nt\">--reducers</span> index.ts\n</pre></div></div>\n\n<ul>\n<li>Action\n\n<ul>\n<li>\n<code>src/app/counter/state</code>直下に作成するため<code>--flat</code>オプションを登録します。</li>\n</ul>\n</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng g action counter/state/counter <span class=\"nt\">--flat</span>\n</pre></div></div>\n\n<p>※この時点ではコンパイルエラーがでますので、動作確認はできません。そのまま次に進みます。</p>\n\n<h2>\n<span id=\"処理実装-1\" class=\"fragment\"></span><a href=\"#%E5%87%A6%E7%90%86%E5%AE%9F%E8%A3%85-1\"><i class=\"fa fa-link\"></i></a>処理実装</h2>\n\n<p>依存関係の都合でボイラープレートとは逆順で実装していきます。</p>\n\n<h3>\n<span id=\"action\" class=\"fragment\"></span><a href=\"#action\"><i class=\"fa fa-link\"></i></a>Action</h3>\n\n<p>ボイラープレート生成時から下記のように修正します。<br>\n※コメントはコードの説明なので無視して実装してください。</p>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/counter/state/counter.actions.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"p\">import { Action } from '@ngrx/store';\n</span>\nexport enum CounterActionTypes {\n<span class=\"err\">//</span> Actionごとに型を定義します。\n<span class=\"gd\">-  LoadCounters = '[Counter] Load Counters'\n</span><span class=\"gi\">+  CountIncrement = '[Counter] Increment Count',\n+  CountDecrement = '[Counter] Decrement Count'\n</span><span class=\"err\">}</span>\n\n<span class=\"err\">//</span> Actionごとに@ngrx.storeのActionをインプリしたクラスを作成します。\n<span class=\"err\">//</span> 複雑な処理をする場合はコンストラクタ引数をとりますが、\n<span class=\"err\">//</span> 本チュートリアルでは簡単のため引数なしにしています。\n<span class=\"gd\">- export class Counter implements Action {\n-   readonly type = CounterActionTypes.LoadCounters;\n- }\n</span><span class=\"gi\">+ export class CountIncrement implements Action {\n+   readonly type = CounterActionTypes.CountIncrement;\n+   public constructor() {}\n+ }\n+ \n+ export class CountDecrement implements Action {\n+   readonly type = CounterActionTypes.CountDecrement;\n+   public constructor() {}\n+ }\n</span>\n\n<span class=\"err\">//</span> 上記で定義したActionクラスを集約した型を定義します。Reducerで使うためです。\n<span class=\"gd\">- export type CounterActions = LoadCounters;\n</span><span class=\"gi\">+ export type CounterActions = CountIncrement | CountDecrement;\n</span></pre></div>\n</div>\n\n<h2>\n<span id=\"reducer作成\" class=\"fragment\"></span><a href=\"#reducer%E4%BD%9C%E6%88%90\"><i class=\"fa fa-link\"></i></a>Reducer作成</h2>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/counter/state/counter.reducer.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"p\">import { Action } from '@ngrx/store';\n</span><span class=\"gi\">+ import { CounterActionTypes } from './counter.actions';\n</span>\n\n<span class=\"p\">export interface State {\n</span><span class=\"err\">//</span> カウンター処理に置けるStateを定義します。\n<span class=\"gi\">+   count: number;\n</span><span class=\"err\">}</span>\n\n<span class=\"p\">export const initialState: State = {\n</span><span class=\"err\">//</span> カウンター処理に置けるStateの初期値を定義します。\n<span class=\"gi\">+   count: 0\n</span><span class=\"err\">};</span>\n\n\nexport function reducer(state = initialState, action: Action): State {\n  switch (action.type) {\n<span class=\"err\">//</span> 引数として受け取ったActionの型に応じて処理を振り分けます\n<span class=\"err\">//</span> ここではカウンター処理に関連するアクションのみ拾って、他はStateをそのまま返します。\n<span class=\"gi\">+     case CounterActionTypes.CountIncrement:\n</span><span class=\"err\">//</span> Stateを変更する場合は、Stateがイミュータブルになるように元のStateには変更を加えず\n<span class=\"err\">//</span> Object.assingで新規オブジェクトを作るようにします。\n<span class=\"gi\">+       return Object.assign({}, { ...state, count : state.count + 1 });\n+     case CounterActionTypes.CountDecrement:\n+       return Object.assign({}, { ...state, count : state.count - 1 });\n</span>    default:\n      return state;\n  }\n<span class=\"err\">}</span>\n\n<span class=\"err\">//</span> コンポーネントでStateのCountを取得するための関数を定義します。\n<span class=\"err\">//</span> Storeの方にも定義しますが、ここでは本ファイルで定義している\n<span class=\"err\">//</span> Stateのプロパティに関連する処理のみ定義します。\n<span class=\"gi\">+ export const getCount = (state: State) =&gt; state.count;\n</span></pre></div>\n</div>\n\n<ul>\n<li>Store</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/counter/state/index.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"p\">import {\n</span>  ActionReducerMap,\n  createFeatureSelector,\n  createSelector,\n  MetaReducer\n<span class=\"err\">}</span> from '@ngrx/store';\n<span class=\"err\">//</span> ng gコマンド生成時は相対パスがずれている可能性があるため\n<span class=\"err\">//</span> その場合は修正する\n<span class=\"gd\">- import { environment } from '../../environments/environment';\n</span><span class=\"gi\">+ import { environment } from '../../../environments/environment';\n</span><span class=\"p\">import * as fromCounter from './counter.reducer';\n</span>\nexport interface State {\n\n  counter: fromCounter.State;\n<span class=\"err\">}</span>\n\n<span class=\"p\">export const reducers: ActionReducerMap&lt;State&gt; = {\n</span>\n  counter: fromCounter.reducer,\n<span class=\"err\">};</span>\n\n\nexport const metaReducers: MetaReducer&lt;State&gt;[] = !environment.production ? [] : [];\n\n// コンポーネントでStateのプロパティを取得するための関数を定義します。\n<span class=\"err\">//</span> 複数コンポーネントで使う度に定義するのは冗長なのでココで共通的に定義します。\n<span class=\"gi\">+ export const getCounterFeatureState = createFeatureSelector&lt;State&gt;('counter');\n+ export const getCounter = createSelector(getCounterFeatureState, s =&gt; s.counter);\n+ export const getCount = createSelector(getCounter, fromCounter.getCount);\n</span></pre></div>\n</div>\n\n<ul>\n<li>Component</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/counter/counter.component.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"p\">import { Component, OnInit } from '@angular/core';\n</span><span class=\"gi\">+ import { Observable } from 'rxjs';\n+ import { Store } from '@ngrx/store';\n</span>\n+ import * as CounterReducer from './state/counter.reducer';\n<span class=\"gi\">+ import * as CounterActions from './state/counter.actions';\n+ import { getCount } from './state';\n</span>\n@Component({\n  selector: 'app-counter',\n  templateUrl: './counter.component.html',\n  styleUrls: ['./counter.component.css']\n<span class=\"err\">})</span>\nexport class CounterComponent implements OnInit {\n<span class=\"err\">//</span> Storeでの値変更を順次受け付けれるように型をObservableに変更します\n<span class=\"gd\">-   count = 0;\n</span><span class=\"gi\">+   count$: Observable&lt;number&gt;;\n</span>\n// Storeをインジェクションします\n<span class=\"gd\">-   constructor() { }\n</span><span class=\"gi\">+   constructor(private store: Store&lt;CounterReducer.State&gt;) {\n</span><span class=\"err\">//</span> Storeからカウンタを取得します\n<span class=\"gi\">+     this.count$ = store.select(getCount);\n+  }\n</span>\n  ngOnInit() {\n  }\n\n  increment() {\n<span class=\"err\">//</span> インクリメントの実処理はカウンタのReducerに任せるので\n<span class=\"err\">//</span> ここではActionをdispatchするだけです。\n<span class=\"gd\">-     this.count = this.count + 1;\n</span><span class=\"gi\">+     this.store.dispatch(new CounterActions.CountIncrement());\n</span>  }\n\n  decrement() {\n<span class=\"gd\">-     this.count = this.count - 1;\n</span><span class=\"gi\">+     this.store.dispatch(new CounterActions.CountDecrement());\n</span>  }\n\n}\n</pre></div>\n</div>\n\n<ul>\n<li>ConponentのHTML</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"diff\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/counter/counter.component.html</span></div>\n<div class=\"highlight\"><pre><span class=\"gd\">&lt;button (click)=\"increment()\"&gt;+&lt;/button&gt;\n&lt;button (click)=\"decrement()\"&gt;-&lt;/button&gt;\n&lt;!-- 変数名と型が変わったのでHTMLも若干修正します --&gt;\n- &lt;div&gt;Count: {{count }}&lt;/div&gt;\n</span><span class=\"gi\">+ &lt;div&gt;Count: {{count$ | async }}&lt;/div&gt;\n</span></pre></div>\n</div>\n\n<ul>\n<li>Webアプリを立ち上げてみます。</li>\n</ul>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><span class=\"gp\">$</span><span class=\"w\"> </span>ng serve <span class=\"nt\">-o</span>\n</pre></div></div>\n\n<ul>\n<li>開発者ツールなどで全くエラーが出ていなければ成功です。見た目は変わっていませんが、Countは<code>@ngrx/store</code>で管理されるようになっています。</li>\n</ul>\n\n<p><a href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2Fd506bc6e-cdce-4d00-1109-2af9f4780663.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a71cb7de15695ea2bec74d39f85be6c2\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2Fd506bc6e-cdce-4d00-1109-2af9f4780663.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a71cb7de15695ea2bec74d39f85be6c2\" alt=\"スクリーンショット 2018-07-30 0.59.12.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/49915/d506bc6e-cdce-4d00-1109-2af9f4780663.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F49915%2Fd506bc6e-cdce-4d00-1109-2af9f4780663.png?ixlib=rb-1.2.2&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2b97ddf9f63fdc1ed9c4c0c36d4330e2 1x\" loading=\"lazy\"></a></p>\n\n<h2>\n<span id=\"補足ストアとストア登録方法\" class=\"fragment\"></span><a href=\"#%E8%A3%9C%E8%B6%B3%E3%82%B9%E3%83%88%E3%82%A2%E3%81%A8%E3%82%B9%E3%83%88%E3%82%A2%E7%99%BB%E9%8C%B2%E6%96%B9%E6%B3%95\"><i class=\"fa fa-link\"></i></a>補足：ストアとストア登録方法</h2>\n\n<p>ストアとストア登録処理はボイラープレートで生成するのでココで改めて説明します。</p>\n\n<p><strong>まずはルートのストアです。</strong><br>\nストアは<code>src/app/state/index.ts</code>に作成されます。<br>\n中身を見るとわかりますが、実態はReducerを集約したActionReducerMapです。<br>\nReducerを新しく作成した時は、このマップにどんどん追加していきます。</p>\n\n<div class=\"code-frame\" data-lang=\"ts\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/state/index.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"k\">import</span> <span class=\"p\">{</span>\n  <span class=\"nx\">ActionReducer</span><span class=\"p\">,</span>\n  <span class=\"nx\">ActionReducerMap</span><span class=\"p\">,</span>\n  <span class=\"nx\">createFeatureSelector</span><span class=\"p\">,</span>\n  <span class=\"nx\">createSelector</span><span class=\"p\">,</span>\n  <span class=\"nx\">MetaReducer</span>\n<span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">@ngrx/store</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">environment</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">../../environments/environment</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n\n<span class=\"k\">export</span> <span class=\"kr\">interface</span> <span class=\"nx\">State</span> <span class=\"p\">{</span>\n\n<span class=\"p\">}</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">reducers</span><span class=\"p\">:</span> <span class=\"nx\">ActionReducerMap</span><span class=\"o\">&lt;</span><span class=\"nx\">State</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n  <span class=\"c1\">// ココにReducerが追加されていきます。</span>\n  <span class=\"c1\">// 今回のチュートリアルではルートのストアに１つもReducerを定義していないので空っぽです。</span>\n<span class=\"p\">};</span>\n\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">metaReducers</span><span class=\"p\">:</span> <span class=\"nx\">MetaReducer</span><span class=\"o\">&lt;</span><span class=\"nx\">State</span><span class=\"o\">&gt;</span><span class=\"p\">[]</span> <span class=\"o\">=</span> <span class=\"o\">!</span><span class=\"nx\">environment</span><span class=\"p\">.</span><span class=\"nx\">production</span> <span class=\"p\">?</span> <span class=\"p\">[]</span> <span class=\"p\">:</span> <span class=\"p\">[];</span>\n\n</pre></div>\n</div>\n\n<p>ストアをモジュールに登録するには下記のように<code>StoreModule.forRoot</code>を使います(ボイラープレートでやってくれます)</p>\n\n<div class=\"code-frame\" data-lang=\"ts\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/app.module.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"p\">@</span><span class=\"nd\">NgModule</span><span class=\"p\">({</span>\n  <span class=\"c1\">// ・・・</span>\n  <span class=\"na\">imports</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"c1\">// ・・・</span>\n    <span class=\"nx\">StoreModule</span><span class=\"p\">.</span><span class=\"nx\">forRoot</span><span class=\"p\">(</span><span class=\"nx\">reducers</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"nx\">metaReducers</span> <span class=\"p\">}),</span>\n    <span class=\"o\">!</span><span class=\"nx\">environment</span><span class=\"p\">.</span><span class=\"nx\">production</span> <span class=\"p\">?</span> <span class=\"nx\">StoreDevtoolsModule</span><span class=\"p\">.</span><span class=\"nx\">instrument</span><span class=\"p\">()</span> <span class=\"p\">:</span> <span class=\"p\">[]</span>\n    <span class=\"c1\">// ・・・</span>\n  <span class=\"p\">],</span>\n  <span class=\"c1\">// ・・・</span>\n<span class=\"p\">})</span>\n<span class=\"k\">export</span> <span class=\"kd\">class</span> <span class=\"nx\">AppModule</span> <span class=\"p\">{</span> <span class=\"p\">}</span>\n\n</pre></div>\n</div>\n\n<p><strong>次にカウンタのストアに関してです。</strong><br>\nこちらもルートの場合とほぼ同じです。</p>\n\n<div class=\"code-frame\" data-lang=\"ts\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/counter/state/index.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"c1\">// ・・・</span>\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">reducers</span><span class=\"p\">:</span> <span class=\"nx\">ActionReducerMap</span><span class=\"o\">&lt;</span><span class=\"nx\">State</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n  <span class=\"c1\">// カウンタのReducerをマップに登録しています。</span>\n  <span class=\"na\">counter</span><span class=\"p\">:</span> <span class=\"nx\">fromCounter</span><span class=\"p\">.</span><span class=\"nx\">reducer</span><span class=\"p\">,</span>\n<span class=\"p\">};</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">metaReducers</span><span class=\"p\">:</span> <span class=\"nx\">MetaReducer</span><span class=\"o\">&lt;</span><span class=\"nx\">State</span><span class=\"o\">&gt;</span><span class=\"p\">[]</span> <span class=\"o\">=</span> <span class=\"o\">!</span><span class=\"nx\">environment</span><span class=\"p\">.</span><span class=\"nx\">production</span> <span class=\"p\">?</span> <span class=\"p\">[]</span> <span class=\"p\">:</span> <span class=\"p\">[];</span>\n<span class=\"c1\">// ・・・</span>\n</pre></div>\n</div>\n\n<p>ただ登録は<code>StoreModule.forFeature</code>を使います。<br>\nこのメソッドは、機能毎に状態管理する時に使うもので、ルートのストアに指定した名前で登録されます。使う時になったら遅延ロードしてくれる機能を持っています。</p>\n\n<div class=\"code-frame\" data-lang=\"ts\">\n<div class=\"code-lang\"><span class=\"bold\">src/app/counter/counter.module.ts</span></div>\n<div class=\"highlight\"><pre><span class=\"c1\">// ・・・</span>\n<span class=\"k\">import</span> <span class=\"o\">*</span> <span class=\"k\">as</span> <span class=\"nx\">fromCounter</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">./state</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n<span class=\"c1\">// ・・・</span>\n<span class=\"p\">@</span><span class=\"nd\">NgModule</span><span class=\"p\">({</span>\n  <span class=\"na\">imports</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"c1\">// ・・・</span>\n    <span class=\"c1\">// アプリ全体のストアにcounterという名前で登録します</span>\n    <span class=\"nx\">StoreModule</span><span class=\"p\">.</span><span class=\"nx\">forFeature</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">counter</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"nx\">fromCounter</span><span class=\"p\">.</span><span class=\"nx\">reducers</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"na\">metaReducers</span><span class=\"p\">:</span> <span class=\"nx\">fromCounter</span><span class=\"p\">.</span><span class=\"nx\">metaReducers</span> <span class=\"p\">})</span>\n    <span class=\"c1\">// ・・・</span>\n  <span class=\"p\">],</span>\n  <span class=\"c1\">// ・・・</span>\n<span class=\"p\">})</span>\n<span class=\"k\">export</span> <span class=\"kd\">class</span> <span class=\"nx\">CounterModule</span> <span class=\"p\">{</span> <span class=\"p\">}</span>\n\n</pre></div>\n</div>\n\n<h2>\n<span id=\"まとめ\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>まとめ</h2>\n\n<p>以上で<code>@ngrx/schematics</code>を使った<code>@ngrx/store</code>のチュートリアルは終了です。<br>\n<code>ngrx</code>ライブラリは他にも<code>@ngrx/router-store</code>、<code>@ngrx/entity</code>、<code>@ngrx/effect</code>があるので、<br>\n今回のアプリをベースに拡張し、理解を深めてみるのも良いかもしれません。</p>\n\n<p>AngularはVue.jsなどと比較するとボイラープレートが多くなってしまいます。<br>\nしかし、ソースコード自動生成機能が充実しているので、けっこう便利なフレームワークです！<br>\nあまり周りでAngular使ってる人がいなくて寂しいのですが、、、、皆さん是非Angular使いましょう！</p>\n\n<h2>\n<span id=\"参考\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83\"><i class=\"fa fa-link\"></i></a>参考</h2>\n\n<ul>\n<li>GitHub\n\n<ul>\n<li>\n<a href=\"https://github.com/ngrx/platform/blob/master/docs/store/README.md#ngrxstore\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/store</a>\n\n<ul>\n<li>公式ページ。サンプルは少し古いですが、ドキュメントは充実しています。</li>\n</ul>\n</li>\n<li>\n<a href=\"https://github.com/ngrx/platform/blob/master/docs/schematics/README.md\" rel=\"nofollow noopener\" target=\"_blank\">@ngrx/schematics</a>\n\n<ul>\n<li>各リンクに行くと、コマンドのオプションの説明などが記載されています。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Medium\n\n<ul>\n<li>\n<a href=\"https://blog.nrwl.io/managing-state-in-angular-applications-22b75ef5625f\" rel=\"nofollow noopener\" target=\"_blank\">Managing State in Angular Applications</a>\n\n<ul>\n<li>Angularで状態管理する時のベストプラクティスを検討し、最終的に@ngrx/storeを紹介している記事です。ソースコードもGitHubにあり、大変参考になります。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Qiita\n\n<ul>\n<li>\n<a href=\"https://qiita.com/puku0x/items/0a8e7224761dc549bd06\" id=\"reference-55d4d1f3588dbe22005a\">@ngrx/storeと@ngrx/effectsの使い方</a>\n\n<ul>\n<li>GitHubに<a href=\"https://github.com/puku0x/ngrx-todo\" rel=\"nofollow noopener\" target=\"_blank\">サンプル</a>もありコード例が多く大変参考になりました。</li>\n</ul>\n</li>\n<li>\n<a href=\"https://qiita.com/musou1500/items/8003c4a3f2b2e80d919f\" id=\"reference-0b88f55e95af744439cc\">@ngrx/schematicsを触ってみる</a>\n\n<ul>\n<li>\n<code>@ngrx/schematics</code>の使い方が網羅されており参考になりました。</li>\n</ul>\n</li>\n<li>\n<a href=\"https://qiita.com/gen2-gk/items/5e5c5b81243def8edc2c#ngrx-%E9%96%A2%E9%80%A3%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AF1%E3%81%A4%E3%81%AE%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AB%E3%81%BE%E3%81%A8%E3%82%81%E3%82%8B\" id=\"reference-00af0c3c5f2c814f6e6e\">ngrxでハマったポイント</a>\n\n<ul>\n<li>ngrx関連資産をstoreフォルダ配下に集約するという知見はココを参考にさせていただきました。</li>\n</ul>\n</li>\n<li>\n<a href=\"https://qiita.com/kouMatsumoto/items/c8297466c1824953632f\" id=\"reference-2bdc06375583d7c16351\">ngrx紹介</a>\n\n<ul>\n<li>ngrxを知るきっかけになった記事です。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n","body":"## なにこれ\nAngularで状態管理する方法をざっくり把握するためのチュートリアルです。[@ngrx/store](http://ngrx.github.io/)ベースの簡単なアプリ（数をカウントするアプリ）を作成します。作るだけなら10分程度で出来上がるので、とりあえず手を動かしてngrxを最低限を把握したい人向けです。ソースコードも[GitHub](https://github.com/Takumon/ngrx-tutorial/tree/with-ngrx)に置いているので参考にしてください。\nngrxを使うとボイラープレートが非常に多くなりますが、今回のチュートリアルでは[@ngrx/schematics](https://github.com/ngrx/platform/tree/master/docs/schematics) を使い、ボイラープレートを自動生成することで極力手間を省いています。\n\n\n## アプリの完成イメージ\n* `+`ボタンをクリックするとCountが+1される\n* `-` ボタンをクリックするとCountが- 1される\n![counterapp.gif](https://qiita-image-store.s3.amazonaws.com/0/49915/8e6f645e-a734-db8d-ec6b-144c0fdee1b0.gif)\n\n## やること/やらないこと\n* やる\n    * [@ngrx/store](https://github.com/ngrx/platform/blob/master/docs/store/README.md)の使い方\n        * Storeの作り方\n        * Stateの作り方\n        * Reducerの作り方\n        * Actionsの作り方\n    * [@ngrx/schematics](https://github.com/ngrx/platform/blob/master/docs/schematics/README.md)の使い方\n        * オプションなどを使い極力手間を減らす方法\n* やらない （下記を理解するには[参考](#参考)のQiitaの記事を見てください。）\n    * 状態管理の説明\n    * Reduxの説明\n    * [@ngrx/router-store](https://github.com/ngrx/platform/blob/master/docs/router-store/README.md)の使い方\n    * [@ngrx/entity](https://github.com/ngrx/platform/blob/master/docs/entity/README.md)の使い方\n    * [@ngrx/effect](https://github.com/ngrx/platform/blob/master/docs/effects/README.md)の使い方  \n    \n\n\n## チュートリアル概要\n段階を踏んで、ステップごとに動作確認しながら作成していきます。\n各ステップ終了時点のソースコードはGitHubに用意しています。参考にしてください。\n大部分はSchematicsを使ってngコマンドでボイラープレートを自動生成し、メイン部分のみ実装という感じです。\n\n1. Angularアプリを生成（1分）  ※[終了時点のソース](https://github.com/Takumon/ngrx-tutorial/tree/generated-with-angualr-cli)\n1. ngrxを使わずにカウント処理実装（2分）※[終了時点のソース](https://github.com/Takumon/ngrx-tutorial/tree/no-ngrx)\n1. ngrxインストール、初期設定（2分） ※[終了時点のソース](https://github.com/Takumon/ngrx-tutorial/tree/after-ngrx-setting)\n1. ngrxを使ってカウント処理実装（5分） ※[終了時点のソース](https://github.com/Takumon/ngrx-tutorial/tree/with-ngrx)\n\n\n\n\n## 前提条件\n* [Node.js](https://nodejs.org/ja/)インストール済み\n* [Angular CLI](https://cli.angular.io/)グローバルインストール済み\n\n```terminal\n$ npm i -g @angular/cli\n```\n\n* [@ngrx/schematics](https://cli.angular.io/)グローバルインストール済み\n\n```terminal\n$ npm i -g @ngrx/schematics\n```\n\n\n## 1. Angularアプリを生成（1分）\n\n* ng newコマンドを実行します。\n\n```terminal\n$ ng new ngrx-tutorial\n```\n\n* 生成されたアプリ配下に移動し、一旦Webアプリを立ち上げてみます。\n\n```terminal\n$ cd ngrx-tutorial\n$ ng serve -o\n```\n\n* ブラウザが起動し下記のような画面が表示されたら成功です。\n![スクリーンショット 2018-07-30 1.03.59.png](https://qiita-image-store.s3.amazonaws.com/0/49915/5c19c3f0-104a-3ef2-a33d-315c0f0a3f9f.png)\n\n\n\n## 2. ngrxを使わずにカウント処理実装（2分）\nカウント処理の資産は全て`src/app/counter`フォルダ配下に作成します。\nまずはコマンドラインからボイラープレートを作成し、その後カウント処理を実装します。\n### ボイラープレート作成\n\n\n* カウント処理関連資産をまとめるモジュールを作成します。\n    * このモジュールをアプリ全体のモジュールに登録するため`--module`オプションを指定します。\n\n```terminal\n$ ng g module counter --module=app.module.ts\n```\n\n\n* カウント処理用のコンポーネントを作成します。\n    * 上記で作成したモジュールにコンポーネントを登録するため`--module`オプションを指定します。\n    * 最終的にアプリ全体のモジュールにコンポーネントを登録するため`--export`オプションを指定します。\n\n```terminal\n$ ng g component counter --module=counter/counter.module.ts --export\n```\n\n\n* `app.component.html`修正し、作成したカウント処理用のコンポーネントを呼び出すようにします。\n\n```html:app.component.html\n<app-counter></app-counter>\n```\n\n* 一旦ここまででWebアプリを立ち上げてみます。\n\n```terminal\n$ ng serve -o\n```\n\n* ブラウザが起動し、下記画面が表示されます。開発者ツールでエラーがなければ成功です。\n\n![スクリーンショット 2018-07-30 1.06.30.png](https://qiita-image-store.s3.amazonaws.com/0/49915/772a7501-34a7-3ef1-6666-d13e79382ce6.png)\n\n\n### 処理実装\n\n* カウント用コンポーネントで実際の処理を記述します。\n\n```ts:src/app/counter/counter.component.ts\nimport { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-counter',\n  templateUrl: './counter.component.html',\n  styleUrls: ['./counter.component.css']\n})\nexport class CounterComponent implements OnInit {\n  count = 0;\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n  increment() {\n    this.count = this.count + 1;\n  }\n\n  decrement() {\n    this.count = this.count - 1;\n  }\n\n}\n\n```\n\n\n```html:src/app/counter/counter.component.html\n<button (click)=\"increment()\">+</button>\n<button (click)=\"decrement()\">-</button>\n<div>Count: {{count}}</div>\n```\n\n\n* ここまででWebアプリを立ち上げてみます。\n\n```terminal\n$ ng serve -o\n```\n\n* ブラウザが起動し下記画面が表示されます。`+`,`-`ボタンをクリックすると数字が増えたり減ったりした、開発者ツールでもエラーがなければ成功です。\n\n![スクリーンショット 2018-07-30 0.59.12.png](https://qiita-image-store.s3.amazonaws.com/0/49915/d506bc6e-cdce-4d00-1109-2af9f4780663.png)\n\n\n## 3. ngrxインストール、初期設定（2分）\n@ngrx/storeをアプリに導入し、初期設定をします。\n\n\n* 下記ライブラリをインストールします。\n    * `@ngrx/schematics`\n        * Angualr CLIでngrxの雛形を作るためのライブラリ\n    * `@ngrx/store`\n        * ngrxでStore,Reducer,Actionを使うためのライブラリ\n    * `@ngrx/store-devtools`\n        * 強力なデバッカを使えるようにするためのライブラリ\n\n```terminal\n$ npm i -D @ngrx/schematics\n$ npm i -s @ngrx/store\n$ npm i -s @ngrx/store-devtools\n```\n\n\n*`@ngrx/schematics`をデフォルトのSchematicsに追加します（コマンドラインでngrxのボイラープレート生成時に`@ngrx/schematics`の指定を省略できるようにするためです。）\n\n```terminal\n$ ng config cli.defaultCollection @ngrx/schematics\n```\n\n* 上記を実行すると、`angular.json`にこのような設定が追加されます。\n\n```json:angular.json\n  \"defaultProject\": \"ngrx-tutorial\",\n  \"cli\": {\n    \"defaultCollection\": \"@ngrx/schematics\"\n  }\n```\n\n* ルートのStoreを作成します。\n    * `src/app/state`配下に生成したいので`--statePath`オプションを指定します。\n    * アプリ全体のモジュールに登録したいので`--module`オプションを指定します。\n\n```terminal\n$ ng g store state --statePath state --root --module app.module.ts\n```\n\n* 上記コマンドで更新した`src/app/app.module.ts`で`environment`のimport文のパスでエラーが出ている場合は修正してください。\n\n```diff:app/src/app.module.ts\n- import { environment } from '../../environments/environment';\n+ import { environment } from '../environments/environment';\n```\n\n* ここまででWebアプリを立ち上げてみます。\n\n```terminal\n$ ng serve -o\n```\n\n* 手順2の動作確認時と同様の挙動になります、開発者ツールでもエラーがなければ成功です。\n\n![スクリーンショット 2018-07-30 0.59.12.png](https://qiita-image-store.s3.amazonaws.com/0/49915/d506bc6e-cdce-4d00-1109-2af9f4780663.png)\n\n\n## 4. ngrxを使ってカウント処理実装（5分）\nここからは実際にStore、Reducer、Actionを作成し、カウント処理の値をStoreに移行します。\nここで作成する資産はカウンター処理に閉じたものなので、`src/app/counter/state`配下に作成します。\nまた`@ngrx/schemetics`のデフォルトではReducer、Actionなどの資産が、役割ごとにフォルダ分けされてしまいますが、１フォルダに集約したほうがソースが修正しやすいので、今回は全て`src/app/counter/state`の直下に作成します。\n\n\n### ボイラープレート生成\n\n\n* Store\n    * `src/app/counter/state`直下に作成するため`--statePath`オプションを指定します。\n    * カウント処理関連モジュールに登録したいので`--module`オプションを指定します。\n\n```terminal\n$ ng g store counter/counter --statePath state --module counter.module.ts\n```\n\n* Reducer\n    * 上記で作成したStoreに本Reducerを登録したいため`--reducers`オプションを指定します。\n\n```terminal\n$ ng g reducer counter/state/counter --reducers index.ts\n```\n\n* Action\n    * `src/app/counter/state`直下に作成するため`--flat`オプションを登録します。\n\n```terminal\n$ ng g action counter/state/counter --flat\n``` \n\n※この時点ではコンパイルエラーがでますので、動作確認はできません。そのまま次に進みます。\n\n\n## 処理実装\n依存関係の都合でボイラープレートとは逆順で実装していきます。\n\n### Action\nボイラープレート生成時から下記のように修正します。\n※コメントはコードの説明なので無視して実装してください。\n\n```diff:src/app/counter/state/counter.actions.ts\nimport { Action } from '@ngrx/store';\n\nexport enum CounterActionTypes {\n// Actionごとに型を定義します。\n-  LoadCounters = '[Counter] Load Counters'\n+  CountIncrement = '[Counter] Increment Count',\n+  CountDecrement = '[Counter] Decrement Count'\n}\n\n// Actionごとに@ngrx.storeのActionをインプリしたクラスを作成します。\n// 複雑な処理をする場合はコンストラクタ引数をとりますが、\n// 本チュートリアルでは簡単のため引数なしにしています。\n- export class Counter implements Action {\n-   readonly type = CounterActionTypes.LoadCounters;\n- }\n+ export class CountIncrement implements Action {\n+   readonly type = CounterActionTypes.CountIncrement;\n+   public constructor() {}\n+ }\n+ \n+ export class CountDecrement implements Action {\n+   readonly type = CounterActionTypes.CountDecrement;\n+   public constructor() {}\n+ }\n\n\n// 上記で定義したActionクラスを集約した型を定義します。Reducerで使うためです。\n- export type CounterActions = LoadCounters;\n+ export type CounterActions = CountIncrement | CountDecrement;\n```\n\n\n## Reducer作成\n\n```diff:src/app/counter/state/counter.reducer.ts\nimport { Action } from '@ngrx/store';\n+ import { CounterActionTypes } from './counter.actions';\n\n\nexport interface State {\n// カウンター処理に置けるStateを定義します。\n+   count: number;\n}\n\nexport const initialState: State = {\n// カウンター処理に置けるStateの初期値を定義します。\n+   count: 0\n};\n\n\nexport function reducer(state = initialState, action: Action): State {\n  switch (action.type) {\n// 引数として受け取ったActionの型に応じて処理を振り分けます\n// ここではカウンター処理に関連するアクションのみ拾って、他はStateをそのまま返します。\n+     case CounterActionTypes.CountIncrement:\n// Stateを変更する場合は、Stateがイミュータブルになるように元のStateには変更を加えず\n// Object.assingで新規オブジェクトを作るようにします。\n+       return Object.assign({}, { ...state, count : state.count + 1 });\n+     case CounterActionTypes.CountDecrement:\n+       return Object.assign({}, { ...state, count : state.count - 1 });\n    default:\n      return state;\n  }\n}\n\n// コンポーネントでStateのCountを取得するための関数を定義します。\n// Storeの方にも定義しますが、ここでは本ファイルで定義している\n// Stateのプロパティに関連する処理のみ定義します。\n+ export const getCount = (state: State) => state.count;\n```\n\n* Store\n\n```diff:src/app/counter/state/index.ts\nimport {\n  ActionReducerMap,\n  createFeatureSelector,\n  createSelector,\n  MetaReducer\n} from '@ngrx/store';\n// ng gコマンド生成時は相対パスがずれている可能性があるため\n// その場合は修正する\n- import { environment } from '../../environments/environment';\n+ import { environment } from '../../../environments/environment';\nimport * as fromCounter from './counter.reducer';\n\nexport interface State {\n\n  counter: fromCounter.State;\n}\n\nexport const reducers: ActionReducerMap<State> = {\n\n  counter: fromCounter.reducer,\n};\n\n\nexport const metaReducers: MetaReducer<State>[] = !environment.production ? [] : [];\n\n// コンポーネントでStateのプロパティを取得するための関数を定義します。\n// 複数コンポーネントで使う度に定義するのは冗長なのでココで共通的に定義します。\n+ export const getCounterFeatureState = createFeatureSelector<State>('counter');\n+ export const getCounter = createSelector(getCounterFeatureState, s => s.counter);\n+ export const getCount = createSelector(getCounter, fromCounter.getCount);\n```\n\n\n\n* Component\n\n```diff:src/app/counter/counter.component.ts\nimport { Component, OnInit } from '@angular/core';\n+ import { Observable } from 'rxjs';\n+ import { Store } from '@ngrx/store';\n\n+ import * as CounterReducer from './state/counter.reducer';\n+ import * as CounterActions from './state/counter.actions';\n+ import { getCount } from './state';\n\n@Component({\n  selector: 'app-counter',\n  templateUrl: './counter.component.html',\n  styleUrls: ['./counter.component.css']\n})\nexport class CounterComponent implements OnInit {\n// Storeでの値変更を順次受け付けれるように型をObservableに変更します\n-   count = 0;\n+   count$: Observable<number>;\n\n// Storeをインジェクションします\n-   constructor() { }\n+   constructor(private store: Store<CounterReducer.State>) {\n// Storeからカウンタを取得します\n+     this.count$ = store.select(getCount);\n+  }\n\n  ngOnInit() {\n  }\n\n  increment() {\n// インクリメントの実処理はカウンタのReducerに任せるので\n// ここではActionをdispatchするだけです。\n-     this.count = this.count + 1;\n+     this.store.dispatch(new CounterActions.CountIncrement());\n  }\n\n  decrement() {\n-     this.count = this.count - 1;\n+     this.store.dispatch(new CounterActions.CountDecrement());\n  }\n\n}\n```\n\n* ConponentのHTML\n\n```diff:src/app/counter/counter.component.html\n<button (click)=\"increment()\">+</button>\n<button (click)=\"decrement()\">-</button>\n<!-- 変数名と型が変わったのでHTMLも若干修正します -->\n- <div>Count: {{count }}</div>\n+ <div>Count: {{count$ | async }}</div>\n```\n\n* Webアプリを立ち上げてみます。\n\n```terminal\n$ ng serve -o\n```\n\n* 開発者ツールなどで全くエラーが出ていなければ成功です。見た目は変わっていませんが、Countは`@ngrx/store`で管理されるようになっています。\n\n![スクリーンショット 2018-07-30 0.59.12.png](https://qiita-image-store.s3.amazonaws.com/0/49915/d506bc6e-cdce-4d00-1109-2af9f4780663.png)\n\n## 補足：ストアとストア登録方法\nストアとストア登録処理はボイラープレートで生成するのでココで改めて説明します。\n\n**まずはルートのストアです。**\nストアは`src/app/state/index.ts`に作成されます。\n中身を見るとわかりますが、実態はReducerを集約したActionReducerMapです。\nReducerを新しく作成した時は、このマップにどんどん追加していきます。\n\n```ts:src/app/state/index.ts\nimport {\n  ActionReducer,\n  ActionReducerMap,\n  createFeatureSelector,\n  createSelector,\n  MetaReducer\n} from '@ngrx/store';\nimport { environment } from '../../environments/environment';\n\nexport interface State {\n\n}\n\nexport const reducers: ActionReducerMap<State> = {\n  // ココにReducerが追加されていきます。\n  // 今回のチュートリアルではルートのストアに１つもReducerを定義していないので空っぽです。\n};\n\n\nexport const metaReducers: MetaReducer<State>[] = !environment.production ? [] : [];\n\n```\n\nストアをモジュールに登録するには下記のように`StoreModule.forRoot`を使います(ボイラープレートでやってくれます)\n\n```ts:src/app/app.module.ts\n@NgModule({\n  // ・・・\n  imports: [\n    // ・・・\n    StoreModule.forRoot(reducers, { metaReducers }),\n    !environment.production ? StoreDevtoolsModule.instrument() : []\n    // ・・・\n  ],\n  // ・・・\n})\nexport class AppModule { }\n\n```\n\n**次にカウンタのストアに関してです。**\nこちらもルートの場合とほぼ同じです。\n\n```ts:src/app/counter/state/index.ts\n// ・・・\nexport const reducers: ActionReducerMap<State> = {\n  // カウンタのReducerをマップに登録しています。\n  counter: fromCounter.reducer,\n};\n\nexport const metaReducers: MetaReducer<State>[] = !environment.production ? [] : [];\n// ・・・\n```\n\nただ登録は`StoreModule.forFeature`を使います。\nこのメソッドは、機能毎に状態管理する時に使うもので、ルートのストアに指定した名前で登録されます。使う時になったら遅延ロードしてくれる機能を持っています。\n\n```ts:src/app/counter/counter.module.ts\n// ・・・\nimport * as fromCounter from './state';\n// ・・・\n@NgModule({\n  imports: [\n    // ・・・\n    // アプリ全体のストアにcounterという名前で登録します\n    StoreModule.forFeature('counter', fromCounter.reducers, { metaReducers: fromCounter.metaReducers })\n    // ・・・\n  ],\n  // ・・・\n})\nexport class CounterModule { }\n\n```\n\n\n## まとめ\n以上で`@ngrx/schematics`を使った`@ngrx/store`のチュートリアルは終了です。\n`ngrx`ライブラリは他にも`@ngrx/router-store`、`@ngrx/entity`、`@ngrx/effect`があるので、\n今回のアプリをベースに拡張し、理解を深めてみるのも良いかもしれません。\n\nAngularはVue.jsなどと比較するとボイラープレートが多くなってしまいます。\nしかし、ソースコード自動生成機能が充実しているので、けっこう便利なフレームワークです！\nあまり周りでAngular使ってる人がいなくて寂しいのですが、、、、皆さん是非Angular使いましょう！\n\n## 参考\n* GitHub\n    * [@ngrx/store](https://github.com/ngrx/platform/blob/master/docs/store/README.md#ngrxstore)\n        * 公式ページ。サンプルは少し古いですが、ドキュメントは充実しています。\n    * [@ngrx/schematics](https://github.com/ngrx/platform/blob/master/docs/schematics/README.md)\n        * 各リンクに行くと、コマンドのオプションの説明などが記載されています。\n* Medium\n    * [Managing State in Angular Applications](https://blog.nrwl.io/managing-state-in-angular-applications-22b75ef5625f)\n        * Angularで状態管理する時のベストプラクティスを検討し、最終的に@ngrx/storeを紹介している記事です。ソースコードもGitHubにあり、大変参考になります。\n* Qiita\n    * [@ngrx/storeと@ngrx/effectsの使い方](https://qiita.com/puku0x/items/0a8e7224761dc549bd06)\n        * GitHubに[サンプル](https://github.com/puku0x/ngrx-todo)もありコード例が多く大変参考になりました。\n    * [@ngrx/schematicsを触ってみる](https://qiita.com/musou1500/items/8003c4a3f2b2e80d919f)\n        * `@ngrx/schematics`の使い方が網羅されており参考になりました。\n    * [ngrxでハマったポイント](https://qiita.com/gen2-gk/items/5e5c5b81243def8edc2c#ngrx-%E9%96%A2%E9%80%A3%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AF1%E3%81%A4%E3%81%AE%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AB%E3%81%BE%E3%81%A8%E3%82%81%E3%82%8B)\n        * ngrx関連資産をstoreフォルダ配下に集約するという知見はココを参考にさせていただきました。\n    * [ngrx紹介](https://qiita.com/kouMatsumoto/items/c8297466c1824953632f)\n        * ngrxを知るきっかけになった記事です。\n\n\n\n","comments_count":1,"created_at":"2018-07-30T18:01:02+09:00","likes_count":32,"reactions_count":0},"next":{"html":"<h2 id=\"ブログ開設手順\"><a href=\"#%E3%83%96%E3%83%AD%E3%82%B0%E9%96%8B%E8%A8%AD%E6%89%8B%E9%A0%86\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブログ開設手順</h2>\n<p>Gatsbyってなにって状態から30分程度でブログを開設できました。\n下記にそのときの手順をメモしておきます。</p>\n<h2 id=\"0-前提条件\"><a href=\"#0-%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 前提条件</h2>\n<p>Git、Node、npmは事前にインストールしておいてください。</p>\n<h2 id=\"1-ブログのスターターキットを起動\"><a href=\"#1-%E3%83%96%E3%83%AD%E3%82%B0%E3%81%AE%E3%82%B9%E3%82%BF%E3%83%BC%E3%82%BF%E3%83%BC%E3%82%AD%E3%83%83%E3%83%88%E3%82%92%E8%B5%B7%E5%8B%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ブログのスターターキットを起動</h2>\n<p>Gatsbyはブログをすぐ始められるようにスターターキット(スキャフォールド)を用意しています。\nまずはそれを使ってローカルでブログを起動してみます。</p>\n<h3 id=\"1-1-gatsbyインストール\"><a href=\"#1-1-gatsby%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-1. Gatsbyインストール</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> -g gatsby</code></pre></div>\n<h3 id=\"1-2-プロジェクト生成\"><a href=\"#1-2-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E7%94%9F%E6%88%90\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-2. プロジェクト生成</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">gatsby new blog https://github.com/gatsbyjs/gatsby-starter-blog</code></pre></div>\n<h3 id=\"1-3-ローカルで起動\"><a href=\"#1-3-%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A7%E8%B5%B7%E5%8B%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-3. ローカルで起動</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cd</span> blog\n<span class=\"token function\">npm</span> run dev</code></pre></div>\n<p><a href=\"http://localhost:8000/\">http://localhost:8000</a>にアクセスするとブログが表示されます。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7e3132994c4eb6ab77004896a109d06d/11526/blog_image_1_main.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 784px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 101.7857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADAklEQVQ4y5WUy07bQBSG81iVuqoULquCxLP0BUgKYlfYgJBAiG4qKnWDBM0CtVIXEIcIVJTSQBIUEt9jO4mN787fM5MLOEIVWPr1j489n2fOOZ7Mwts3H94vvvuVX109yudyhXz+Y2Fzc7OwsrJSWFpaKmSz2cLc3BzX7Ows1/ieaX5+nr1zPJOd+bGwsJjPfDs4+FouC/h9dYV6rYZWqwXTtNDpdNBoNFCv17nX6NnYb25uUK1Wudi4XC5DEAQQ6mfGdpx9DK/A6lqxYRgxwWJZlmPf92PTNHnMdV0+fnh4iJMkien9pwoZ4OLi8ihjWdbnETA6OTnB+vo6dnd3kcvlsL29jZ2dHSwvL2NrawsbGxvc6QN8AoExGAzIBwyKUqn0PQU8PDzE2toa9vb2UKlUYNv2ZFIURfylOOZzeeyJHoHdbncCvKX8CKUSGPj6+hovuf4LlJp3uKeiuK4HXdN4QdqiBFnrDKXqUMkVkk5FC8NwDB0CBSENvG/U0KxVYVCVNU2HQZOMrg21F0DpeuQ+9L7PPYwYY2rLQvERSImN8JrruRwWz9IrVPsBapqLRsfHreah7ycvzePzwKak47J6jxvRxN+2Ac2y4bkuHMfh7o5Evcg7gMVpZxNg8WwK2O9S7mQRhqbA1BWossT/HFEUIbbb3CVJ4n3IYMO2egJMr3AQ+WEM2wvhkJgHYcT7jon14XjM8vbcloViMb3Cumrj/M7CH9XDleyh94Icpqs8tWXWJmK7BU1VoJMs06S+03kL6XqH4io/NFRydoD0er0UsHx+mgY6/T4sg/pPU6EqCjoMwmFDqCTJfKwoKi8OS8NT4HlpCqjYMRpmhNtOiIfoNS05zuEpPxwmx5ekW0mtpSaS6SSOFyRRGCZBECZ0jJEHQ9HY9wMeYyIYKYlGVT7OUB6+jL9k93vUKjLPH9syaxOdtipTq8iyQi7ze/oIwiAgD1IrFYSzk4yua5/oJzfpYYPU9Jl8v+l5PncmFg9GceaUuya1D9cofkcxtVK52v8HdAO2pf8ZX28AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"ブログ初期イメージ\"\n        title=\"\"\n        src=\"/static/7e3132994c4eb6ab77004896a109d06d/11526/blog_image_1_main.png\"\n        srcset=\"/static/7e3132994c4eb6ab77004896a109d06d/6b0e3/blog_image_1_main.png 200w,\n/static/7e3132994c4eb6ab77004896a109d06d/d1d7f/blog_image_1_main.png 400w,\n/static/7e3132994c4eb6ab77004896a109d06d/11526/blog_image_1_main.png 784w\"\n        sizes=\"(max-width: 784px) 100vw, 784px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h2 id=\"2-ブログの記事などを自分仕様にカスタマイズ\"><a href=\"#2-%E3%83%96%E3%83%AD%E3%82%B0%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AA%E3%81%A9%E3%82%92%E8%87%AA%E5%88%86%E4%BB%95%E6%A7%98%E3%81%AB%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ブログの記事などを自分仕様にカスタマイズ</h2>\n<p>現状だと、ブロガーがKyle Mathews氏(Gatsbyの作者)になっていたり、仮の記事が3つある状態なので、\n自分仕様にカスタマイズします。\n<small>ここでは僕の例を示します。</small></p>\n<h3 id=\"2-1-ブラウザタブのタイトル修正\"><a href=\"#2-1-%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%82%BF%E3%83%96%E3%81%AE%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-1. ブラウザタブのタイトル修正</h3>\n<p><code class=\"language-text\">gatsby-config.js</code>の<code class=\"language-text\">siteMetadata</code>を下記のように修正します。\nなお<code class=\"language-text\">siteUrl</code>はGitHub Pagesでの公開を想定したものです。</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  siteMetadata<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    title<span class=\"token punctuation\">:</span> <span class=\"token string\">'Takumon Blog'</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    author<span class=\"token punctuation\">:</span> <span class=\"token string\">'Takuto Inoue'</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    description<span class=\"token punctuation\">:</span> <span class=\"token string\">'日々の作業をつづっていきます。'</span><span class=\"token punctuation\">,</span>\n</span><span class=\"gatsby-highlight-code-line\">    siteUrl<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://takumon.github.io/blog'</span><span class=\"token punctuation\">,</span>\n</span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  ・・・\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"2-2-画面タイトル修正\"><a href=\"#2-2-%E7%94%BB%E9%9D%A2%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-2. 画面タイトル修正</h3>\n<p><code class=\"language-text\">src/layouts/index.js</code>を修正します。\n<code class=\"language-text\">Gatsby Starter Blog</code>となっている部分が2カ所あるので、自分のブログ名に修正します。\n僕は<code class=\"language-text\">Takumon Blog</code>にしました。</p>\n<h3 id=\"2-3-プロフィール修正\"><a href=\"#2-3-%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-3. プロフィール修正</h3>\n<p><code class=\"language-text\">src/components/Bio.js</code>のアバター(imgタグ)と自己紹介文(pタグ)を修正します。</p>\n<div class=\"gatsby-code-title\">src/components/Bio.js</div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">&lt;img\n<span class=\"gatsby-highlight-code-line\">  src=\"https://s.gravatar.com/avatar/37d27f624f8c9c8db6fe6b6581b256f1?s=80\"\n</span><span class=\"gatsby-highlight-code-line\">  alt={`Takuto Inoue`}\n</span><span class=\"gatsby-highlight-code-line\">  style={{\n</span><span class=\"gatsby-highlight-code-line\">    marginRight: rhythm(1 / 2),\n</span><span class=\"gatsby-highlight-code-line\">    marginBottom: 0,\n</span><span class=\"gatsby-highlight-code-line\">    width: rhythm(2),\n</span><span class=\"gatsby-highlight-code-line\">    height: rhythm(2),\n</span><span class=\"gatsby-highlight-code-line\">    borderRadius: rhythm(1),\n</span>  }}\n/>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n<span class=\"gatsby-highlight-code-line\">  Written by <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span><span class=\"token punctuation\">></span></span>Takuto Inoue<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span> who lives and works in Tokyo building useful things.\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h3 id=\"2-4-余計な記事を削除\"><a href=\"#2-4-%E4%BD%99%E8%A8%88%E3%81%AA%E8%A8%98%E4%BA%8B%E3%82%92%E5%89%8A%E9%99%A4\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-4. 余計な記事を削除</h3>\n<p>記事は<code class=\"language-text\">src/page</code>配下にフォルダ分けされて存在します。\n1つ目以外の記事は不要なのでフォルダごと削除します。\nあと1つ目の記事て使っている画像も削除します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">src/\n├── pages\n│   ├── hello-world\n│   │   ├── index.md\n<span class=\"gatsby-highlight-code-line\">│   │   └── salty_egg.jpg ・・・削除対象\n</span><span class=\"gatsby-highlight-code-line\">│   ├── hi-folks          ・・・削除対象\n</span><span class=\"gatsby-highlight-code-line\">│   │   └── index.md\n</span><span class=\"gatsby-highlight-code-line\">│   └── my-second-post    ・・・削除対象\n</span><span class=\"gatsby-highlight-code-line\">│       └── index.md\n</span></code></pre></div>\n<h3 id=\"2-5-記事を編集\"><a href=\"#2-5-%E8%A8%98%E4%BA%8B%E3%82%92%E7%B7%A8%E9%9B%86\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-5. 記事を編集</h3>\n<p>1つめの記事<code class=\"language-text\">src/pages/hello-world/index.md</code>を編集します。\nマークダウンファイル上部にメタ情報としてタイトルと作成日時を、その下に本文を記載しましょう。</p>\n<div class=\"gatsby-code-title\">src/pages/hello-world/index.md</div>\n<div class=\"gatsby-highlight\" data-language=\"markup\"><pre class=\"language-markup\"><code class=\"language-markup\">---\n<span class=\"gatsby-highlight-code-line\">title: Hello World\n</span><span class=\"gatsby-highlight-code-line\">date: \"2018-09-10T12:00:00.000Z\"\n</span>---\n\n<span class=\"gatsby-highlight-code-line\">Gatsbyでブログ始めました！\n</span></code></pre></div>\n<h3 id=\"2-6-ローカルで起動\"><a href=\"#2-6-%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A7%E8%B5%B7%E5%8B%95\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-6. ローカルで起動</h3>\n<p>この状態で<code class=\"language-text\">npm run dev</code>して<a href=\"http://localhost:8000\">http://localhost:8000</a>を見てみると下記のようになっています。</p>\n<p>記事一覧\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7da4ae8b009b5d5c1bd9f97e99c153a7/916a4/blog_image_2_main.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 100.86100861008612%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACGklEQVQ4y92Uz2saQRTH9w+yioSEEi+Fpuf+F4UmXhKop6wElRSSHsSCRysFW3LoRfDnxWvxYrri7noQgjEUrK7bXdfsGve9vv0Ru0ZsNfTUL3zZ2Zl5n3nzZneYl0+3t/aePYm92n99HHkTYSORCBuLxdhwOMyGdkOsz+djA4EA6/f7bVttr4PBoOXj3VAo/nzvxRaTODk5+vzpI1aqVazX69hoXGKn00GB57FWq2GxWMRKpYJVGreepVIJy6Wy8yyXMZ/PY/ZDFr9cXODp6dsjRhDFfSSZpqlrmjZVVfXOEnUt2DCMpT6PdYvBcdwBI4piGB3Nut0uJOIJOH93DplMBlKpFKTTacjlchCNRiGZTNrvuq4DzQdKAixZsS4wzAiC4AABZjQC8q2K0lBCSZKw3+/bHo1G+FNRcDgYYqvVwslkgpSxtSsERx4gz88z/NH4Cq3sexxKMvauezgggEKg8Vglj23ruoGyLNsLTu3K4GKG4n2G1GmqCsy+31BjRoG3uI6Wt+yp4RQQNBrWDBPvTGdxa/5f/ADIt+bAgaLDtysJL7sjHIyn9xlsBhSF3zWkWsFN75qKP7APwiq8F7rWlsV2ew4ET5R7gpsDec+huJ/AQvAq0OoMPYfiBXrBf4IuAdsrtryu/gPgY/QQeOACDfcn38hujDG/vgh4iP9IzWbzkKFbd4fjmmdEj5MTjzGB4uSzQqGw8wtf9qFNOS60nQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"ブログ修正後イメージ_記事一覧\"\n        title=\"\"\n        src=\"/static/7da4ae8b009b5d5c1bd9f97e99c153a7/42603/blog_image_2_main.png\"\n        srcset=\"/static/7da4ae8b009b5d5c1bd9f97e99c153a7/f931c/blog_image_2_main.png 200w,\n/static/7da4ae8b009b5d5c1bd9f97e99c153a7/e8031/blog_image_2_main.png 400w,\n/static/7da4ae8b009b5d5c1bd9f97e99c153a7/42603/blog_image_2_main.png 800w,\n/static/7da4ae8b009b5d5c1bd9f97e99c153a7/916a4/blog_image_2_main.png 813w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>記事詳細\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ddf78c319bfb9bdb52617201c72de7df/97b7b/blog_image_2_detail.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 101.10974106041924%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAB60lEQVQ4y+WUTWsTURSG5xdpM6FdaBQt7vwdVugHlrTqwsxm/AG60k0QxA/QVdpmkGYRyGqmxEjoJIj5cFFboQkxM8lkMs1M7uu5kzFNoKlp6K4vvFy4l/eZc+ZcrnB/XgzfWxTlpeXl2JPHT6VH6+tSdGNTerD0ULpxMyJduz4nhURRmgudOjRiMRyW5hcWYpFbt5/fubsYFuTYs+j7d2/wZXcXe9oestkscrkc9nUd6XQa2zs7UBQFyaQyWJXxNZFIIB6P4/OHj5BleVP4USqtgOS6rtPpdHqGYbimafrm21Pa4Qxd11eFaqWyioG8er3OVFVl+XyeaZrGjo9rrNvtMq5+v3+muQIoCoXCmlAul4fAg18HbHtrC6qqIZPJIEntlkpl/5DC4NkzzOUFFa4JlZEKu7bN6rUaqF1QZRh8HJNAQyDPDiscBfaoBbvn4sRxYFkWPNfD/3Qu0Kodst/fv8Jqd0DDQaPxB81mE61WC+1W219Nk2yYtG/wQfrMiUBj/xv7+ektGhQ4OjzyAbx1hyoeNd+zbRue500GBj+W4YI6t+XgfkwziOmGElyBscA/+MwVXnrLVxA4i8aA9DisBMATOnP5fbyoefb0+apWo7gkFYvFDYGeqQhBX5FfkF/OaJ59nUqlIn8BqESsK9UQHY4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"ブログ修正後イメージ_記事詳細\"\n        title=\"\"\n        src=\"/static/ddf78c319bfb9bdb52617201c72de7df/42603/blog_image_2_detail.png\"\n        srcset=\"/static/ddf78c319bfb9bdb52617201c72de7df/f931c/blog_image_2_detail.png 200w,\n/static/ddf78c319bfb9bdb52617201c72de7df/e8031/blog_image_2_detail.png 400w,\n/static/ddf78c319bfb9bdb52617201c72de7df/42603/blog_image_2_detail.png 800w,\n/static/ddf78c319bfb9bdb52617201c72de7df/97b7b/blog_image_2_detail.png 811w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>ここまでで一通り自分のブログをローカルで作ることができました。</p>\n<h2 id=\"3-github-pagesにブログを公開\"><a href=\"#3-github-pages%E3%81%AB%E3%83%96%E3%83%AD%E3%82%B0%E3%82%92%E5%85%AC%E9%96%8B\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. GitHub Pagesにブログを公開</h2>\n<p>Gatsbyを使うとnpmスクリプト一発でGitHub Pageに公開ができます。\nここではGitHubでのリポジトリ作成などの事前準備も含めて手順を示します。</p>\n<h3 id=\"3-1-githubにリポジトリ作成\"><a href=\"#3-1-github%E3%81%AB%E3%83%AA%E3%83%9D%E3%82%B8%E3%83%88%E3%83%AA%E4%BD%9C%E6%88%90\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-1. GitHubにリポジトリ作成</h3>\n<p>GitHubにリポジトリを作り、手順2で作成した資産をプッシュしてください。</p>\n<h3 id=\"3-2-github-pagesの設定\"><a href=\"#3-2-github-pages%E3%81%AE%E8%A8%AD%E5%AE%9A\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-2. GitHub Pagesの設定</h3>\n<p>GitHubのリポジトリ > settings > GitHub Pages > Source で<code class=\"language-text\">gh-pages branch</code>を選択します。</p>\n<h3 id=\"3-3-メタ情報の修正\"><a href=\"#3-3-%E3%83%A1%E3%82%BF%E6%83%85%E5%A0%B1%E3%81%AE%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-3. メタ情報の修正</h3>\n<p>手順2によりローカルでブログを起動できるようになりましたが、GitHub Pagesに公開するには、まだ少し修正が必要です。</p>\n<h4 id=\"gatsby-configjsのpathprefixの修正\"><a href=\"#gatsby-configjs%E3%81%AEpathprefix%E3%81%AE%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>gatsby-config.jsのpathPrefixの修正</h4>\n<p>ブログのコンテキストURLは、現状だとスターターキットの値なので修正します。\nこれを指定するとブログのURLが<code class=\"language-text\">https://[オーナー名].github.io/[pathPrefixの値]/</code>のようになります。\n僕の場合は<code class=\"language-text\">https://takumon.github.io/blog</code>のようになります。</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  ・・・\n<span class=\"gatsby-highlight-code-line\">  pathPrefix<span class=\"token punctuation\">:</span> <span class=\"token string\">'/blog'</span><span class=\"token punctuation\">,</span>\n</span>  ・・・\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"packagejson、pacakge-lockjson、readmemdのメタ情報修正\"><a href=\"#packagejson%E3%80%81pacakge-lockjson%E3%80%81readmemd%E3%81%AE%E3%83%A1%E3%82%BF%E6%83%85%E5%A0%B1%E4%BF%AE%E6%AD%A3\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>package.json、pacakge-lock.json、README.mdのメタ情報修正</h4>\n<p>上記3ファイルにおいて、プロジェクト名や、管理者、ブログのURLなどが、すべてスターターキットの状態になっているので\n自分仕様に修正します。</p>\n<h3 id=\"3-4-資産をgh-pagesブランチにプッシュ\"><a href=\"#3-4-%E8%B3%87%E7%94%A3%E3%82%92gh-pages%E3%83%96%E3%83%A9%E3%83%B3%E3%83%81%E3%81%AB%E3%83%97%E3%83%83%E3%82%B7%E3%83%A5\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-4. 資産をgh-pagesブランチにプッシュ</h3>\n<p><code class=\"language-text\">git push origin master</code>でマスターに最新資産をプッシュします。</p>\n<p><code class=\"language-text\">npm run deploy</code>を実行します。実態は<code class=\"language-text\">gatsby build &amp;&amp; gh-pages -d public</code>というコマンドです。これを実行するとgatbyコマンドによりビルド資産をgh-pagesブランチにプッシュしてくれます。</p>\n<h3 id=\"3-5-公開できたことを確認\"><a href=\"#3-5-%E5%85%AC%E9%96%8B%E3%81%A7%E3%81%8D%E3%81%9F%E3%81%93%E3%81%A8%E3%82%92%E7%A2%BA%E8%AA%8D\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-5. 公開できたことを確認</h3>\n<p>GitHub Pagesの公開URLをブラウザでたたき、自分のブログが公開されていることを確認します。</p>\n<h2 id=\"まとめ\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>以上でブログの公開手順は終了です。\nGatsbyを使えばとても簡単にブログを始められます。\nみなさんもGatsbyでブログ始めてみてはいかがでしょうか🍅</p>\n<h2 id=\"参考記事\"><a href=\"#%E5%8F%82%E8%80%83%E8%A8%98%E4%BA%8B\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考記事</h2>\n<ul>\n<li>\n<p><a href=\"https://qiita.com/jaxx2104/items/5f28915355a85d36e38a\">React.js製の静的サイトジェネレーターGatsbyに移行した</a></p>\n<ul>\n<li>Gatsbyを始めるきっかけとなった記事です。この記事のおかげで簡単にGatsby製ブログを開設できました。</li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/2018/09/10/","title":"Gatsby製ブログ開設手順","date":"2018-09-10T19:00:00.000Z","excerpt":"ブログ開設手順Gatsbyってなにって状態から30分程度でブログを開設できました。下記にそのときの手順をメモしておきます。0. 前提条件Git、Node、npmは事前にインストールしておいてください。1. ブログのスターターキットを起動Ga...","tags":["Gatsby","ブログ"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2018/how-to-start-a-blog-with-gatsby.png"}}}}