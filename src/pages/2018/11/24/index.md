---
title: Gatsby themeã‚’ä½¿ã£ã¦ã¿ã‚‹
date: '2018-11-24T23:40:00.000+09:00'
tags:
  - Gatsby
  - Gatsby theme
keywords:
  - Gatsby
slug: /2018/11/24/
thumbnail: thumbnail/2018/gatsby-theme.png
---

## ãªã«ã“ã‚Œ

ä¸‹è¨˜ã®[è¨˜äº‹](https://www.gatsbyjs.org/blog/2018-11-11-introducing-gatsby-themes/)ã‚’èª­ã‚“ã§ã€
å®Ÿé¨“çš„ã«è¿½åŠ ã•ã‚ŒãŸGatsby themeã§ä½•ãŒã§ãã‚‹ã®ã‹[ã‚µãƒ³ãƒ—ãƒ«](chrome://flags/#enable-ephemeral-flash-permission)ä½œã£ã¦è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚ãã®ã¨ãã®ãƒ¡ãƒ¢ã§ã™ã€‚

<blockquote class="twitter-tweet" data-lang="ja"><p lang="en" dir="ltr">Excited to talk a bit about something I&#39;ve been working on a lot lately<br><br>Introducing <a href="https://twitter.com/gatsbyjs?ref_src=twsrc%5Etfw">@gatsbyjs</a> Themes <a href="https://t.co/ysDITHlbsV">https://t.co/ysDITHlbsV</a></p>&mdash; :party-corgi: (@chrisbiscardi) <a href="https://twitter.com/chrisbiscardi/status/1062426813840814080?ref_src=twsrc%5Etfw">2018å¹´11æœˆ13æ—¥</a></blockquote>


## Gatsby themeã¯ã©ã‚“ãªå•é¡Œã‚’è§£æ±ºã—ã¦ãã‚Œã‚‹ã‹

Gatsbyã¯ã‚¹ã‚­ãƒ£ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰æ©Ÿèƒ½ãŒã‚ã£ã¦åˆæœŸå°å…¥ãŒéå¸¸ã«ç°¡å˜ã§ã™ã€‚æœ€å°æ§‹æˆã®ã‚‚ã®ã‹ã‚‰ã€ã‹ãªã‚Šãƒ‡ã‚¶ã‚¤ãƒ³ãŒä½œã‚Šè¾¼ã¾ã‚ŒãŸã‚‚ã®ã¾ã§65å€‹(2018/11/24ç¾åœ¨)ã®ã‚¹ã‚­ãƒ£ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ãŒå­˜åœ¨ã—ã€[Gatsby Starter](https://www.gatsbyjs.org/starters/?v=2)ã‹ã‚‰å¥½ããªã‚‚ã®ã‚’é¸ã¹ã¾ã™ã€‚<br>
ãŸã ã—åˆæœŸå°å…¥å¾Œã¯ã‚¹ã‚­ãƒ£ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«è¿½å¾“ã§ãã¾ã›ã‚“ã—ã€é€”ä¸­ã§åˆ¥ã®ã‚‚ã®ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚å®¹æ˜“ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å¤‰æ›´ã§ããŸã¨ã—ã¦ã‚‚å®Ÿè³ªä½œã‚Šç›´ã—ã¨åŒã˜ãã‚‰ã„æ”¹ä¿®ãŒå¿…è¦ã§ã—ã‚‡ã†ã€‚ï¼ˆã‚¹ã‚­ãƒ£ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ãªã‚“ã§ã‚ãŸã‚Šã¾ãˆã§ã™ãŒ...ï¼‰
ãƒ†ãƒ¼ãƒã‚’å®¹æ˜“ã«å¤‰æ›´ã§ãã‚‹ã‚ˆã†ãªWordPressãªã©ã«æ¯”ã¹ã‚‹ã¨æ‹¡å¼µæ€§ã®é¢ã§åŠ£ã£ã¦ã„ã¾ã™ã€‚<br>
Gatsby themeã¯ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½ã§ã™ã€‚


## Gatsby themeã®æ¦‚è¦

* ãƒ†ãƒ¼ãƒã§ã¯ä¸‹è¨˜ã‚’å®šç¾©ã§ãã€Gatsbyã®è³‡ç”£ã®å¤§éƒ¨åˆ†ã‚’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‹ã‚‰åˆ‡ã‚Šé›¢ã—ã¦npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ç®¡ç†ã§ãã¾ã™ã€‚
    * ä¾å­˜é–¢ä¿‚ï¼ˆpackage.jsonï¼‰
    * è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆgatsby-config.jsï¼‰
    * ãƒšãƒ¼ã‚¸ï¼ˆblog-post.jsã‚„index.jsãªã©ï¼‰
    * ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆBio.jsã‚„Layout.jsãªã©ï¼‰
* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´ã¯ã€ä»Šã¾ã§ã®ã‚ˆã†ã«`package.json`ã§å¤§é‡ã®Gatsbyãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã—ãŸã‚Šã€`gatsby-config.js`ã§å¤§é‡ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è¨­å®šã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™ã€ä½¿ç”¨ãƒ†ãƒ¼ãƒã®å®£è¨€ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å®šç¾©ã ã‘ã§ã€Webã‚µã‚¤ãƒˆã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚
* ãƒ†ãƒ¼ãƒã®è¨­å®šã¯å¼•æ•°ã‚’è¨±å®¹ã™ã‚‹ã®ã§ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´ã‹ã‚‰æŒ‡å®šã—ãŸå€¤ã‚’è¨­å®šå€¤ã«åæ˜ ã§ãã¾ã™ã€‚
* ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ã‚„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´ã§ä¸Šæ›¸ãã§ãã€åˆ¥é€”è¿½åŠ ä½œæˆã‚‚å¯èƒ½ã§ã™ã€‚ã€€â€»ç¾æ™‚ç‚¹ã§ã¯è‹¥å¹²è‡ªåŠ›å®Ÿè£…ãŒå¿…è¦ã§ã™ãŒ...


## Gatsby themeã®ä½œã‚Šæ–¹

ã“ã“ã§ã¯2ç¨®é¡ã®ãƒ†ãƒ¼ãƒã¨3ç¨®é¡ã®ãƒ–ãƒ­ã‚°ã‚’ä½œã‚Šã¾ã™ã€‚<br>
<small>â€»ã‚½ãƒ¼ã‚¹ã¯[GitHub](https://github.com/Takumon/my-gatsby-theme-sample)å‚ç…§</small>


### 1. ã¨ã‚Šã‚ãˆãšãƒ†ãƒ¼ãƒã‚’ä½œã‚‹

[gatsby-starter-blog](https://github.com/gatsbyjs/gatsby-starter-blog)ã‚’æœ€å°é™ã®ä¿®æ­£ã§ãƒ†ãƒ¼ãƒåŒ–ã—ã¾ã™ã€‚<br>
<small>â€»[ã‚½ãƒ¼ã‚¹](https://github.com/Takumon/my-gatsby-theme-sample/tree/master/themes/gatsby-blog-theme)ã€[å‚è€ƒã‚³ãƒŸãƒƒãƒˆ](https://github.com/Takumon/my-gatsby-theme-sample/commit/10b68c4f3ad5158973952432da2b4d518570f53d)</small>


#### 1-1. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«(gatsby-config.js)ä¿®æ­£

ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´ã®ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚’å…ƒã«ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’çµ„ã¿ç«‹ã¦ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```javascript{3-4,10-11,18-22,25-31}:title=gatsby-config.jsã®ä¸€éƒ¨
const path = require('path')

// ãƒ¦ãƒ¼ã‚¶å´ã‹ã‚‰ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¦ã€ãã‚Œã‚’ã‚‚ã¨ã«è¨­å®šã®ä¸­ã§ãƒ‘ã‚¹ã‚’çµ„ã¿ç«‹ã¦ã‚‹
module.exports = ({ root }) => ({
  // ï½¥ï½¥ï½¥
  plugins: [
    {
      resolve: `gatsby-source-filesystem`,
      options: {
        // ãƒšãƒ¼ã‚¸ã¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´ã®è³‡ç”£ã‚’èª­ã¿è¾¼ã‚€
        path: `src/pages`,
        name: 'pages',
      },
    },
    {
      resolve: 'gatsby-plugin-typography',
      options: {
        // typographyã¯ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ãŸè³‡ç”£ã‚’ä½¿ã†ã®ã§rootã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ã‚’æŒ‡å®šã™ã‚‹
        pathToConfigModule: path.relative(
          root,
          require.resolve('./src/utils/typography')
        ),
      },
    },
    // ãƒšãƒ¼ã‚¸ã¨ã—ã¦ã€ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ãŸè³‡ç”£ã‚’èª­ã¿è¾¼ã‚€
    {
      resolve: `gatsby-plugin-page-creator`,
      options: {
        path: require.resolve(`./src/pages`),
      },
    },
  ],
})
```


#### 1-2. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹è¨­å®šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£(with-theme-path.js)ä½œæˆ

ãƒ‘ã‚¹æŒ‡å®šæ™‚ã«ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´è³‡ç”£ã‚’å„ªå…ˆçš„ã«ä½¿ã„ã€ç„¡ã‘ã‚Œã°ãƒ†ãƒ¼ãƒå´è³‡ç”£ã‚’ä½¿ã†ã‚ˆã†ã™ã‚‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ä½œæˆã—ã¾ã™ã€‚â€»è‡ªåŠ›ã§å®Ÿè£…ã—ã¾ã™ã€‚

```javascript:title=with-theme-path.js
const path = require('path')

/**
 * ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ãŸãƒšãƒ¼ã‚¸ã‚’ãƒ¦ãƒ¼ã‚¶ãŒä¸Šæ›¸ãå¯èƒ½ã«ã™ã‚‹ãŸã‚ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹è§£æ±ºãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
 *
 * æŒ‡å®šã—ãŸç›¸å¯¾ãƒ‘ã‚¹ã‹ã‚‰
 * 1. ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’è¿”å´ã™ã‚‹
 * 2. ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã‘ã‚Œã°ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ã¦ã„ã‚‹ãƒ‘ã‚¹ã‚’è¿”å´ã™ã‚‹
 * 3. ãƒ†ãƒ¼ãƒã§ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã—ã¦ã„ãªã„å ´åˆã€æŒ‡å®šã—ãŸç›¸å¯¾ãƒ‘ã‚¹ã‚’ãã®ã¾ã¾è¿”å´ã™ã‚‹
 */
module.exports = relativePath => {
  let pathResolvedPath = path.resolve(relativePath)
  let finalPath = pathResolvedPath

  try {
    // ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿æ™‚ã«ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    require.resolve(pathResolvedPath)
    // 1. ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’è¿”å´ã™ã‚‹
    finalPath = pathResolvedPath
  } catch (e) {
    try {
      // 2. ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã‘ã‚Œã°ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ã¦ã„ã‚‹ãƒ‘ã‚¹ã‚’è¿”å´ã™ã‚‹
      finalPath = require.resolve(relativePath)
    } catch (e) {
      // 3. ãƒ†ãƒ¼ãƒã§ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã—ã¦ã„ãªã„å ´åˆã€æŒ‡å®šã—ãŸç›¸å¯¾ãƒ‘ã‚¹ã‚’ãã®ã¾ã¾è¿”å´ã™ã‚‹
      console.log(e)
      return relativePath
    }
  }

  return finalPath
}
```

#### 1-3. gatsby-node.jsä¿®æ­£

å…ˆã»ã©ä½œã£ãŸwith-theme-pash.jsã‚’ä½¿ã£ã¦ãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ã—ã¾ã™ã€‚
ã¾ãŸnpmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹ç”¨ã®ãƒ“ãƒ«ãƒ‰è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚
â€»ã“ã“ã‚‰ã¸ã‚“ã‚‚è‡ªåŠ›å®Ÿè£…ã§ã™ã€‚

```javascript{2,8-9,18-35,37-45}:title=gatsby-node.jsã®ä¸€éƒ¨
const fs = require('fs')
const withThemePath = require('./with-theme-path')

exports.createPages = ({ graphql, actions }) => {
  const { createPage } = actions

  return new Promise((resolve, reject) => {
    // withThemePathã‚’ä½¿ã£ã¦ã€ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã—ãŸãƒšãƒ¼ã‚¸ã¾ãŸã¯ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚€
    const blogPost = withThemePath('./src/templates/blog-post.js')
    resolve(
        // ï½¥ï½¥ï½¥
    )
  })
}

// ï½¥ï½¥ï½¥

/*
 * Gatsbyãƒ†ãƒ¼ãƒã®ãƒ“ãƒ«ãƒ‰æ–¹æ³•ã‚’webpackã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚
 * NPMãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å…¬é–‹æ™‚ã¯ã€(1)äº‹å‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã‹ã€(2)ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ–¹æ³•ã®è¨­å®šè¿½åŠ  ã©ã¡ã‚‰ã‹ãŒå¿…è¦ã§ã™ã€‚
 * Gatsbyãƒ†ãƒ¼ãƒã®å ´åˆ(2)ãŒå¯èƒ½ãªã®ã§ã€ã“ã“ã§è¨­å®šã—ã¦ã„ã¾ã™ã€‚
 */
exports.onCreateWebpackConfig = ({ stage, loaders, actions }) => {
  actions.setWebpackConfig({
    module: {
      rules: [
        {
          test: /\.js$/,
          include: path.dirname(require.resolve('gatsby-blog-theme')),
          use: [loaders.js()],
        },
      ],
    },
  })
}

// ãƒ¦ãƒ¼ã‚¶ãŒsrc/pagesæœªä½œæˆã®å ´åˆã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã‚’é˜²ããŸã‚ã€ç„¡ã‘ã‚Œã°ä½œæˆã™ã‚‹
exports.onPreBootstrap = ({ store }) => {
  const { program } = store.getState()
  const dir = `${program.directory}/src/pages`

  if (!fs.existsSync(dir)) {
    fs.mkdirSync(dir)
  }
}
```

#### 1-4. index.jsä½œæˆ

npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹ç”¨ã«ç©ºã®index.jsã‚’ä½œæˆã—ã¾ã™ã€‚


#### 1-5. src/components/Layout.jsä¿®æ­£

ESLintã‚¨ãƒ©ãƒ¼ã‚’è§£æ¶ˆã™ãŸã‚ã®è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚

```javascript{1}:title=src/components/Layout.jsã®ä¸€éƒ¨
/* eslint-disable */
// å†’é ­ã«ä¸Šè¨˜ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ 
```

<br>

ã“ã‚Œã§ãƒ†ãƒ¼ãƒåŒ–å®Œäº†ã§ã™ã€‚

### 2. ã¨ã‚Šã‚ãˆãšãƒ†ãƒ¼ãƒã‚’ä½¿ã£ã¦ã¿ã‚‹

å‰æ‰‹é †ã§ä½œã£ãŸãƒ†ãƒ¼ãƒã‚’ä½¿ã£ã¦æœ€å°æ§‹æˆã§ãƒ–ãƒ­ã‚°ã‚’ä½œã‚Šã¾ã™ã€‚<br>
<small>[ã‚½ãƒ¼ã‚¹](https://github.com/Takumon/my-gatsby-theme-sample/tree/master/ui-surfaces/blog-minimal)ã€[å‚è€ƒã‚³ãƒŸãƒƒãƒˆ](https://github.com/Takumon/my-gatsby-theme-sample/commit/72b955f8d82dfca2ff009c477e72f53386e4a6a7)</small>


#### 2-1. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«(gatsby-config.js)ä½œæˆ

ã“ã“ãŒGatsby themeã«ãŠã„ã¦è‚ã¨ãªã‚‹æ©Ÿèƒ½ã§ã€
`__experimentalThemes`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ä½¿ç”¨ãƒ†ãƒ¼ãƒã‚’æŒ‡å®šã§ãã¾ã™ã€‚
ã“ã“ã§ã¯ä½¿ç”¨ãƒ†ãƒ¼ãƒã«å‰æ‰‹é †ã§ä½œã£ãŸ`gatsby-blog-theme`ã‚’æŒ‡å®šã—ã¾ã™ã€‚
ãã®éš›ã€`gatsby-blog-theme`ã¯è¨­å®šå¼•æ•°ã¨ã—ã¦ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã¨ã‚‹ã®ã§ã€ãã‚Œã‚‚æŒ‡å®šã—ã¾ã™ã€‚â€»ã“ã“ã¯Gatsbyå´ã§ã‚ˆã—ãªã‚Šã‚„ã£ã¦ãã‚Œã¾ã™ã€‚

```javascript:title=gatsby-config.js
module.exports = {
  // ãƒ†ãƒ¼ãƒã‚’æŒ‡å®šã™ã‚‹
  __experimentalThemes: [
    {
      // ãƒ†ãƒ¼ãƒã«gatsby-blog-themeã‚’æŒ‡å®šã™ã‚‹
      resolve: "gatsby-blog-theme",
      // ãƒ†ãƒ¼ãƒgatsby-blog-themeã§ã¯rootã‚’ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å—ã‘å–ã‚‹æƒ³å®šãªã®ã§æœ¬ãƒ–ãƒ­ã‚°ã®ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®šã™ã‚‹
      options: { root: __dirname }
    }
  ]
};
```



#### 2-2. package.jsonä½œæˆ

`gatsby`ã¨`gatsby-blog-theme`ã‚’ä¾å­˜é–¢ä¿‚ã«æŒ‡å®šã™ã‚‹ã ã‘ã®ç°¡å˜ãªpackage.jsonã‚’ä½œæˆã—ã¾ã™ã€‚


```javascript{7-10}:title=package.json
{
  "name": "blog-minimal",
  "scripts": {
    "develop": "gatsby develop",
    "build": "gatsby build"
  },
  "dependencies": {
    "gatsby": "^2.0.19",
    "gatsby-blog-theme": "*"
  }
}
```


#### 2-3. src/pagesé…ä¸‹ã«è¨˜äº‹ä½œæˆ

æ–‡å­—é€šã‚Šã€ãƒ†ã‚­ãƒˆãƒ¼ã«ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨˜äº‹ã‚’ä½œæˆã—ã¾ã™ã€‚


#### 2-4. src/assets/gatsby-icon.pngé…ç½®

æœ¬ç·¨ã¨ã¯ã‚ã¾ã‚Šé–¢ä¿‚ç„¡ã„ä¿®æ­£ã§ã™ãŒã€ãƒ†ãƒ¼ãƒã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´ã®ã‚¢ã‚¤ã‚³ãƒ³è³‡ç”£èª­ã¿è¾¼ã¿ã‚’æœŸå¾…ã—ã¦ã„ã‚‹ã®ã§ã€ã“ã‚ŒãŒãªã„ã¨ã‚¨ãƒ©ãƒ¼ã§è½ã¡ã¾ã™ã€‚ã€€â€»å·¥å¤«æ¬¡ç¬¬ã§ã“ã‚Œã‚‚ã€Œãªã‘ã‚Œã°ãƒ†ãƒ¼ãƒå´ã®è³‡ç”£ã‚’ä½¿ã†ã€ã‚ˆã†ã«ã¯ã§ãã‚‹ã®ã§ã—ã‚‡ã†ãŒæœ¬è¨˜äº‹ã§ã¯ãã“ã¾ã§è§¦ã‚Œã¦ã„ã¾ã›ã‚“ã€‚



#### 2-5. å‹•ä½œç¢ºèª

ã“ã®çŠ¶æ…‹ã§ãƒ–ãƒ­ã‚°ã‚’èµ·å‹•ã™ã‚‹ã¨ã€ä¸‹è¨˜ã®ã‚ˆã†ãªç”»é¢ãŒè¡¨ç¤ºã§ãã¾ã™ã€‚

![blog-mininal](./blog-minimal.png)

å¾“æ¥ã®Gatsbyã§ã‚ã‚Œã°ã€ä¸€è¦§ç”¨ãƒšãƒ¼ã‚¸ã€è¨˜äº‹è©³ç´°ãƒšãƒ¼ã‚¸ã€ãã®ä»–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãªã©ãªã©éå¸¸ã«å¤šãã®è³‡ç”£ã‚’å¿…è¦ã¨ã—ã¾ã™ãŒã€
ãƒ†ãƒ¼ãƒã‚’ä½¿ãˆã°ã€ã»ã¼gatsby-node.jsã¨package.jsonã ã‘ã§ãƒ–ãƒ­ã‚°ãŒå®Œæˆã—ã¾ã™ã€‚<br>
ã¾ãŸãƒ†ãƒ¼ãƒå´ãŒã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ãŸå ´åˆã‚‚ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä¸Šã’ã‚Œã°ã„ã„ã ã‘ãªã®ã§å¸¸ã«æœ€æ–°ã®ãƒ†ãƒ¼ãƒã‚’é©ç”¨ã§ãã¾ã™ã€‚



### 3. ãƒ†ãƒ¼ãƒã®ãƒšãƒ¼ã‚¸ã‚’ä¸Šæ›¸ãã—ã¦ã¿ã‚‹

æœ€å°æ§‹æˆã®ãƒ–ãƒ­ã‚°ã«ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¦ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ã‚’ä¸Šæ›¸ãã—ã¾ã™ã€‚<br>
<small>[ã‚½ãƒ¼ã‚¹](https://github.com/Takumon/my-gatsby-theme-sample/tree/master/ui-surfaces/blog-override-page)ã€[å‚è€ƒã‚³ãƒŸãƒƒãƒˆ](https://github.com/Takumon/my-gatsby-theme-sample/commit/7a09088d774035f3cbf370730e7af9ac6869849b)</small>

#### 3-1. è¨˜äº‹è©³ç´°ãƒšãƒ¼ã‚¸ä½œæˆ

ãƒšãƒ¼ã‚¸ã¯ãƒ†ãƒ¼ãƒã¨åŒã˜ç›¸å¯¾ãƒ‘ã‚¹ã«é…ç½®ã—ã¾ã™ã€‚with-theme-pathã«ã‚ˆã‚Šã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´ã®ãƒšãƒ¼ã‚¸ãŒå„ªå…ˆçš„ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚

```javascript{1-4}:title=src/templates/blog-post.jsã®ä¸€éƒ¨
// ä¸Šæ›¸ããƒšãƒ¼ã‚¸ã§ã¯ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã§ãã‚‹
import Bio from 'gatsby-blog-theme/src/components/Bio'
import Layout from 'gatsby-blog-theme/src/components/Layout'
import { rhythm, scale } from 'gatsby-blog-theme/src/utils/typography'

class BlogPostTemplate extends React.Component {
  render() {
      // ãƒ†ãƒ¼ãƒã®blog-post.jsã¨åŒã˜å®Ÿè£…
  }
}
```

#### 3-2. å‹•ä½œç¢ºèª

ã“ã‚Œã§ãƒ–ãƒ­ã‚°ã‚’ç«‹ã¡ä¸Šã’ã‚‹ã¨ã€è¨˜äº‹è©³ç´°ã®ãƒšãƒ¼ã‚¸ãŒå·®ã—æ›¿ã‚ã£ã¦ã„ã‚‹ã®ãŒç¢ºèªã§ãã¾ã™ã€‚

![blog-override-page](./blog-override-page.png)



### 4. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå·®ã—æ›¿ãˆå¯èƒ½ãªãƒ†ãƒ¼ãƒã‚’ä½œã‚‹

ä»Šã¾ã§ä½œã£ãŸãƒ†ãƒ¼ãƒã§ã¯ã€ãƒšãƒ¼ã‚¸ã§ä½¿ã†ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã ã‘ã‚’ã‚’å·®ã—æ›¿ãˆã‚‹ã‚ˆã†ãªã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
ã“ã“ã§ã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã ã‘ã‚’å·®ã—æ›¿ãˆã‚‰ã‚Œã‚‹ã‚ˆã†ãªãƒ†ãƒ¼ãƒã‚’ä½œã‚Šã¾ã™ã€‚<br>
<small>[ã‚½ãƒ¼ã‚¹](https://github.com/Takumon/my-gatsby-theme-sample/tree/master/themes/gatsby-blog-component-replacement-theme)ã€[å‚è€ƒã‚³ãƒŸãƒƒãƒˆ](https://github.com/Takumon/my-gatsby-theme-sample/commit/c9a14eb985ffcbc7c639ae82512c8a507ad149e1)</small>


#### 4-1. gatsby-node.jsä¿®æ­£

gatsby-node.jsã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã ã‘å·®ã—æ›¿ãˆã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã®ã¨ãã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´ã®å·®ã—æ›¿ãˆè³‡ç”£é…ç½®å ´æ‰€ã‚’æ±ºã‚ã¾ã™ã€‚
ã“ã“ã§ã¯`src/components/gatsby-blog-component-replacement-theme--component`ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚
ã¾ãŸã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’è¨­å®šã—ã¦`gatsby-blog-component-replacement-theme--component/ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå`ã§importã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚
â€»ã“ã‚Œã‚‚è‡ªåŠ›å®Ÿè£…ã§ã™ã€‚


```javascript{1-4,8-16}:title=gatsby-node.jsã®ä¸€éƒ¨
// ãƒ†ãƒ¼ãƒå·®ã—æ›¿ãˆç”¨ãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®šã—ã¦
// ãƒ¦ãƒ¼ã‚¶ãŒãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’é…ç½®ã—ã¦ã„ã‚‹å ´åˆã€ãƒ†ãƒ¼ãƒã§ç”¨æ„ã—ãŸã‚‚ã®ã¨å·®ã—æ›¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
const THEME_PREFIX = 'gatsby-blog-component-replacement-theme--component'
const RELATIVE_DIR_PATH_OF_REPLACEMENT_COMPONETS = `./src/components/${THEME_PREFIX}`

exports.onCreateWebpackConfig = ({ actions, store }) => {

  // ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆèª­ã¿è¾¼ã‚“ã§
  // ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½œæˆã™ã‚‹
  const userComponents = fs
    .readdirSync(path.resolve(RELATIVE_DIR_PATH_OF_REPLACEMENT_COMPONETS))
    .reduce(
      (acc, componentName) => ({
        ...acc,
        [`${THEME_PREFIX}/${componentName.substr(0, componentName.lastIndexOf('.'))}`]: path.resolve(
          `${RELATIVE_DIR_PATH_OF_REPLACEMENT_COMPONETS}/${componentName}`
        ),
      }),
      {}
    )

  // ã‚¨ã‚¤ãƒªã‚¢ã‚¹è¨­å®šã§ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å…ˆã«å®šç¾©ã™ã‚‹ã“ã¨ã§
  // ãƒ¦ãƒ¼ã‚¶ãŒä½œæˆã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å„ªå…ˆçš„ã«èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ã™ã‚‹
  actions.setWebpackConfig({
    resolve: {
      alias: {
        ...userComponents,
        [THEME_PREFIX]: path.join(__dirname, './src/components'),
      },
    },
  })
}


// ãƒ¦ãƒ¼ã‚¶ãŒsrc/pagesæœªä½œæˆã®å ´åˆã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã‚’é˜²ããŸã‚ã€ç„¡ã‘ã‚Œã°ä½œæˆã™ã‚‹
// RELATIVE_DIR_PATH_OF_REPLACEMENT_COMPONETSã‚‚åŒæ§˜
exports.onPreBootstrap = ({ store }) => {
  const { program } = store.getState()

  const pageDir = `${program.directory}/src/pages/`
  const componentDir = `${program.directory}/src/components/`
  const replaceComponentDir = `${componentDir}/${THEME_PREFIX}/`

  mkdir(pageDir)
  mkdir(componentDir)
  mkdir(replaceComponentDir)
}

function mkdir(path) {
  if (!fs.existsSync(path)) {
    fs.mkdirSync(path)
  }
}
```


#### 4-2. ãƒšãƒ¼ã‚¸ä¿®æ­£

å„ãƒšãƒ¼ã‚¸ã®importæ–‡ã‚’ä¸Šè¨˜ã§æŒ‡å®šã—ãŸã‚¨ã‚¤ãƒªã‚¢ã‚¹ã«ä¿®æ­£ã—ã¾ã™ã€‚


```javascript:title=src/pages/404.jsã®ä¸€éƒ¨
// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆèª­ã¿è¾¼ã¿ã¯gatsby-node.jsã§æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‹ã‚‰èª­ã¿è¾¼ã‚€
import Layout from 'gatsby-blog-component-replacement-theme--component/Layout'
```

```javascript:title=src/pages/index.jsã®ä¸€éƒ¨
// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆèª­ã¿è¾¼ã¿ã¯gatsby-node.jsã§æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‹ã‚‰èª­ã¿è¾¼ã‚€
import Bio from 'gatsby-blog-component-replacement-theme--component/Bio'
import Layout from 'gatsby-blog-component-replacement-theme--component/Layout'
```

```javascript:title=src/templates/blog-post.jsã®ä¸€éƒ¨
// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆèª­ã¿è¾¼ã¿ã¯gatsby-node.jsã§æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‹ã‚‰èª­ã¿è¾¼ã‚€
import Bio from 'gatsby-blog-component-replacement-theme--component/Bio'
import Layout from 'gatsby-blog-component-replacement-theme--component/Layout'
```


### 5. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å·®ã—æ›¿ãˆã¦ã¿ã‚‹

å‰æ‰‹é †ã§ä½œã£ãŸãƒ†ãƒ¼ãƒã‚’ä½¿ã„ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã¿ã‚’å·®ã—æ›¿ãˆã¦ã¿ã¾ã™ã€‚<br>
<small>[ã‚½ãƒ¼ã‚¹](https://github.com/Takumon/my-gatsby-theme-sample/tree/master/ui-surfaces/blog-component-replacement)ã€[å‚è€ƒã‚³ãƒŸãƒƒãƒˆ](https://github.com/Takumon/my-gatsby-theme-sample/commit/c9a14eb985ffcbc7c639ae82512c8a507ad149e1)</small>


#### 5-1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ

src/components/gatsby-blog-component-replacement-theme--component/Bio.jsã‚’ä½œæˆã—ã¾ã™ã€‚

```javascript:title=src/components/gatsby-blog-component-replacement-theme--component/Bio.jsã®ä¸€éƒ¨
// ä¸Šæ›¸ãã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ã‚‚ãƒ†ãƒ¼ãƒè³‡ç”£ã¯ä½¿ãˆã‚‹
import profilePic from 'gatsby-blog-component-replacement-theme/src/components/profile-pic.jpg'
import { rhythm } from 'gatsby-blog-component-replacement-theme/src/utils/typography'

// ãƒ†ãƒ¼ãƒå´ã§æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹ã«ãƒ†ãƒ¼ãƒè³‡ç”£ã¨åŒåã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¦ä¸Šæ›¸ãã™ã‚‹
class Bio extends React.Component {
  render() {
      // ï½¥ï½¥ï½¥
  }
}
```

#### 5-2. å‹•ä½œç¢ºèª

ã“ã‚Œã§ãƒ–ãƒ­ã‚°ã‚’ç«‹ã¡ä¸Šã’ã‚‹ã¨ã€è¨˜äº‹ä¸€è¦§ãƒšãƒ¼ã‚¸ã§Bioã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã ã‘å·®ã—æ›¿ã‚ã£ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚

![blog-override-page](./blog-override-page.png)




## ã¾ã¨ã‚
Gatsby themeã¯ç™ºå±•é€”ä¸Šã®æ©Ÿèƒ½ãªã®ã§ã€ãƒ‘ã‚¹è¨­å®šãªã©ã¯è‡ªåŠ›ã§ã‚„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãŸã ã“ã‚Œã‚‰ã«ã¤ã„ã¦ã‚‚ç©æ¥µçš„ã«é–‹ç™ºãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚
å°†æ¥çš„ã«ã¯Gatsby Starterã®ã‚ˆã†ã«å…¨ãƒ†ãƒ¼ãƒä¸€è¦§ãŒé–‹è¨­ã•ã‚Œã¦ã€ã™ããªãƒ†ãƒ¼ãƒã‚’é¸ã¹ã‚‹ã€ã‹ã¤æ°—è»½ã«å¤‰æ›´ã§ãã‚‹ã€ã‹ã¤æ°—è»½ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å´ã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹ã¿ãŸã„ãªã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ğŸ…


## å‚è€ƒ
* [Gatsby theme | Gatsby blog](https://www.gatsbyjs.org/blog/2018-11-11-introd ucing-gatsby-themes/)
    * [ChristopherBiscardi](https://github.com/ChristopherBiscardi)ã•ã‚“ãŒæ›¸ã„ãŸGastby themeã®ç´¹ä»‹ãƒ–ãƒ­ã‚°ã§ã™ã€‚
* [gatsby-theme-examples | GitHub](https://github.com/ChristopherBiscardi/gatsby-theme-examples)
    * [Gatsby-starter-blog](https://github.com/gatsbyjs/gatsby-starter-blog)ã‚’themeåŒ–ã—ãŸã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚
* [gatsby-theme-blog | npm](https://www.npmjs.com/package/gatsby-theme-blog)
    * ä¸Šè¨˜ã‚µãƒ³ãƒ—ãƒ«ã®themeãŒnpmãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚
* [gatsby-themes | spectrum](https://spectrum.chat/gatsby-themes)
    * æœ€æ–°æƒ…å ±ã¯spectrumã§å…¥æ‰‹ã§ãã¾ã™ã€‚
